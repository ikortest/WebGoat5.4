{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"servlets"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"ServletException"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"HttpServlet"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"HttpServletResponse"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Controller"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"HttpServlet","loc":{"start":{"line":39},"end":{"line":39}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"serialVersionUID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":43},"end":{"line":43}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doGet"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":45},"end":{"line":45}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":45},"end":{"line":45}}}}],"thrown":[{"type":"Identifier","name":"ServletException","loc":{"start":{"line":45},"end":{"line":45}}},{"type":"Identifier","name":"IOException","loc":{"start":{"line":45},"end":{"line":45}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"doPost","loc":{"start":{"line":49},"end":{"line":49}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":49},"end":{"line":49}}},{"type":"Identifier","name":"response","loc":{"start":{"line":49},"end":{"line":49}}}],"loc":{"start":{"line":49},"end":{"line":49}}},"loc":{"start":{"line":49},"end":{"line":49}}}],"loc":{"start":{"line":47},"end":{"line":51}}},"code":"\nprotected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    doPost(request, response);\n}","loc":{"start":{"line":45},"end":{"line":51}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doPost"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":53},"end":{"line":53}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":53},"end":{"line":53}}}}],"thrown":[{"type":"Identifier","name":"ServletException","loc":{"start":{"line":53},"end":{"line":53}}},{"type":"Identifier","name":"IOException","loc":{"start":{"line":54},"end":{"line":54}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userAgent","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":58},"end":{"line":58}}},"property":{"type":"Identifier","name":"getHeader"},"loc":{"start":{"line":58},"end":{"line":58}}},"arguments":[{"type":"Literal","value":"user-agent","raw":"user-agent"}],"loc":{"start":{"line":58},"end":{"line":58}}},"loc":{"start":{"line":58},"end":{"line":58}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"clientBrowser","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}},"init":{"type":"Literal","value":"Not known!","raw":"Not known!"},"loc":{"start":{"line":60},"end":{"line":60}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":62},"end":{"line":62}}},"right":{"type":"Literal"},"loc":{"start":{"line":62},"end":{"line":62}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":66},"end":{"line":66}}},"right":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":66},"end":{"line":66}}},"loc":{"start":{"line":66},"end":{"line":66}}},"loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":64},"end":{"line":68}}},"loc":{"start":{"line":62},"end":{"line":68}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":70},"end":{"line":70}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[{"type":"Literal","value":"client.browser","raw":"client.browser"},{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":70},"end":{"line":70}}}],"loc":{"start":{"line":70},"end":{"line":70}}},"loc":{"start":{"line":70},"end":{"line":70}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"getRequestDispatcher"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Literal","value":"/view.jsp","raw":"/view.jsp"}],"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"forward"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":72},"end":{"line":72}}},{"type":"Identifier","name":"response","loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":56},"end":{"line":74}}},"code":"\nprotected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    String userAgent \u003d request.getHeader(\"user-agent\");\n    String clientBrowser \u003d \"Not known!\";\n    if (userAgent !\u003d null) {\n        clientBrowser \u003d userAgent;\n    }\n    request.setAttribute(\"client.browser\", clientBrowser);\n    request.getRequestDispatcher(\"/view.jsp\").forward(request, response);\n}","loc":{"start":{"line":53},"end":{"line":74}}}],"loc":{"start":{"line":39},"end":{"line":76}}}],"loc":{"start":{"line":2},"end":{"line":76}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/servlets/Controller.java"}