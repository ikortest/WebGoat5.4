{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"Enumeration"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ServletException"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"HttpServletResponse"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Catcher"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"HammerHead","loc":{"start":{"line":44},"end":{"line":44}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"serialVersionUID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":7441856110845727651,"raw":7441856110845727651},"loc":{"start":{"line":50},"end":{"line":50}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"START_SOURCE_SKIP","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}},"init":{"type":"Literal","value":"START_OMIT_SOURCE","raw":"START_OMIT_SOURCE"},"loc":{"start":{"line":55},"end":{"line":55}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"END_SOURCE_SKIP","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}},"init":{"type":"Literal","value":"END_OMIT_SOURCE","raw":"END_OMIT_SOURCE"},"loc":{"start":{"line":57},"end":{"line":57}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"PROPERTY","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}},"init":{"type":"Literal","value":"PROPERTY","raw":"PROPERTY"},"loc":{"start":{"line":59},"end":{"line":59}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"EMPTY_STRING","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}},"init":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":61},"end":{"line":61}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doPost"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":75},"end":{"line":75}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":75},"end":{"line":75}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":75},"end":{"line":75}}},{"type":"Identifier","name":"ServletException","loc":{"start":{"line":75},"end":{"line":75}}}],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Throwable","loc":{"start":{"line":113},"end":{"line":113}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":115},"end":{"line":115}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[],"loc":{"start":{"line":115},"end":{"line":115}}},"loc":{"start":{"line":115},"end":{"line":115}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"ERROR: ","raw":"ERROR: "},"right":{"type":"Identifier","name":"t","loc":{"start":{"line":116},"end":{"line":116}}},"loc":{"start":{"line":116},"end":{"line":116}}}],"loc":{"start":{"line":116},"end":{"line":116}}},"loc":{"start":{"line":116},"end":{"line":116}}}],"loc":{"start":{"line":114},"end":{"line":117}}},"loc":{"start":{"line":113},"end":{"line":117}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":83},"end":{"line":83}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":83},"end":{"line":83}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":83},"end":{"line":83}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":83},"end":{"line":83}}}],"loc":{"start":{"line":83},"end":{"line":83}}},"loc":{"start":{"line":83},"end":{"line":83}}},"loc":{"start":{"line":83},"end":{"line":83}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":84},"end":{"line":84}}},"property":{"type":"Identifier","name":"update"},"loc":{"start":{"line":84},"end":{"line":84}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":84},"end":{"line":84}}},{"type":"Identifier","name":"response","loc":{"start":{"line":84},"end":{"line":84}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getServletName"},"loc":{"start":{"line":84},"end":{"line":84}}},"arguments":[],"loc":{"start":{"line":84},"end":{"line":84}}}],"loc":{"start":{"line":84},"end":{"line":84}}},"loc":{"start":{"line":84},"end":{"line":84}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":87},"end":{"line":87}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":88},"end":{"line":88}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":88},"end":{"line":88}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":88},"end":{"line":88}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":88},"end":{"line":88}}},"arguments":[],"loc":{"start":{"line":88},"end":{"line":88}}},"loc":{"start":{"line":88},"end":{"line":88}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":89},"end":{"line":89}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":89},"end":{"line":89}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":89},"end":{"line":89}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":89},"end":{"line":89}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":89},"end":{"line":89}}}],"loc":{"start":{"line":89},"end":{"line":89}}},"loc":{"start":{"line":89},"end":{"line":89}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":91},"end":{"line":91}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},"right":{"type":"Literal","value":" | ","raw":" | "},"loc":{"start":{"line":91},"end":{"line":91}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":91},"end":{"line":91}}}],"loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":91},"end":{"line":91}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"property","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":93},"end":{"line":93}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":93},"end":{"line":93}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"String","loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"Identifier","name":"PROPERTY","loc":{"start":{"line":93},"end":{"line":93}}},{"type":"Identifier","name":"EMPTY_STRING","loc":{"start":{"line":93},"end":{"line":93}}}],"loc":{"start":{"line":93},"end":{"line":93}}}],"loc":{"start":{"line":93},"end":{"line":93}}},"loc":{"start":{"line":93},"end":{"line":93}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"property","loc":{"start":{"line":97},"end":{"line":97}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[{"type":"Identifier","name":"EMPTY_STRING","loc":{"start":{"line":97},"end":{"line":97}}}],"loc":{"start":{"line":97},"end":{"line":97}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":97},"end":{"line":97}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Enumeration","loc":{"start":{"line":99},"end":{"line":99}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Enumeration","loc":{"start":{"line":99},"end":{"line":99}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"getParameterNames"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"hasMoreElements"},"loc":{"start":{"line":101},"end":{"line":101}}},"arguments":[],"loc":{"start":{"line":101},"end":{"line":101}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":103},"end":{"line":103}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":103},"end":{"line":103}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":103},"end":{"line":103}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"nextElement"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[],"loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":104},"end":{"line":104}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":104},"end":{"line":104}}},"init":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"getParameterValues"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[],"loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"setProperty"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":105},"end":{"line":105}}},{"type":"Identifier","name":"value","loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":102},"end":{"line":106}}},"loc":{"start":{"line":101},"end":{"line":106}}}],"loc":{"start":{"line":98},"end":{"line":107}}},"loc":{"start":{"line":97},"end":{"line":107}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":108},"end":{"line":108}}}],"loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"store"},"loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":108},"end":{"line":108}}},{"type":"Identifier","name":"lesson","loc":{"start":{"line":108},"end":{"line":108}}}],"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"getParameter"},"loc":{"start":{"line":111},"end":{"line":111}}},"arguments":[{"type":"Literal","value":"Deleter","raw":"Deleter"}],"loc":{"start":{"line":111},"end":{"line":111}}},"right":{"type":"Literal"},"loc":{"start":{"line":111},"end":{"line":111}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"BlindScript"},"loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"StaticDeleter"},"loc":{"start":{"line":111},"end":{"line":111}}},"arguments":[],"loc":{"start":{"line":111},"end":{"line":111}}},"loc":{"start":{"line":111},"end":{"line":111}}}],"loc":{"start":{"line":111},"end":{"line":111}}},"loc":{"start":{"line":111},"end":{"line":111}}}],"loc":{"start":{"line":78},"end":{"line":113}}},"loc":{"start":{"line":77},"end":{"line":117}}}],"loc":{"start":{"line":76},"end":{"line":118}}},"code":"\npublic void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    try {\n        WebSession session \u003d (WebSession)request.getSession(true).getAttribute(WebSession.SESSION);\n        session.update(request, response, this.getServletName());\n        int scr \u003d session.getCurrentScreen();\n        Course course \u003d session.getCourse();\n        AbstractLesson lesson \u003d course.getLesson(session, scr, AbstractLesson.USER_ROLE);\n        log(request, lesson.getClass().getName() + \" | \" + session.getParser().toString());\n        String property \u003d new String(session.getParser().getStringParameter(PROPERTY, EMPTY_STRING));\n        if (!property.equals(EMPTY_STRING)) {\n            Enumeration e \u003d session.getParser().getParameterNames();\n            while (e.hasMoreElements()) {\n                String name \u003d (String)e.nextElement();\n                String value \u003d session.getParser().getParameterValues(name)[0];\n                lesson.getLessonTracker(session).getLessonProperties().setProperty(name, value);\n            }\n        }\n        lesson.getLessonTracker(session).store(session, lesson);\n        if (request.getParameter(\"Deleter\") !\u003d null) {\n            org.owasp.webgoat.lessons.BlindScript.StaticDeleter();\n        }\n    } catch (Throwable t) {\n        t.printStackTrace();\n        log(\"ERROR: \" + t);\n    }\n}","loc":{"start":{"line":75},"end":{"line":118}}}],"loc":{"start":{"line":44},"end":{"line":119}}}],"loc":{"start":{"line":2},"end":{"line":119}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/Catcher.java"}