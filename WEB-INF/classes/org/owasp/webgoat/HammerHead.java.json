{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"PrintWriter"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"text"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"SimpleDateFormat"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"Date"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"Locale"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"TimeZone"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"ServletContext"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ServletException"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"HttpServlet"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"HttpServletResponse"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"HttpSession"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"WelcomeScreen"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"admin"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"WelcomeAdminScreen"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"ErrorScreen"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"Screen"},"loc":{"start":{"line":21},"end":{"line":21}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"UserTracker"},"loc":{"start":{"line":22},"end":{"line":22}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":23},"end":{"line":23}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"WebgoatContext"},"loc":{"start":{"line":24},"end":{"line":24}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"HammerHead"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"HttpServlet","loc":{"start":{"line":59},"end":{"line":59}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"WELCOMED","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":62},"end":{"line":62}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":62},"end":{"line":62}}},"init":{"type":"Literal","value":"welcomed","raw":"welcomed"},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"serialVersionUID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":645640331343188020,"raw":645640331343188020},"loc":{"start":{"line":67},"end":{"line":67}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"httpDateFormat","vartype":{"type":"Identifier","name":"SimpleDateFormat","loc":{"start":{"line":72},"end":{"line":72}}}},"modifiers":{"type":"Modifiers","modifiers":["protected","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"SimpleDateFormat","loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"sessionTimeoutSeconds","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"BinaryExpression","operator":"MULTIPLY","left":{"type":"BinaryExpression","operator":"MULTIPLY","left":{"type":"BinaryExpression","operator":"MULTIPLY","left":{"type":"Literal","value":60,"raw":60},"right":{"type":"Literal","value":60,"raw":60},"loc":{"start":{"line":77},"end":{"line":77}}},"right":{"type":"Literal","value":24,"raw":24},"loc":{"start":{"line":77},"end":{"line":77}}},"right":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":77},"end":{"line":77}}},"loc":{"start":{"line":77},"end":{"line":77}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"propertiesPath","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":84},"end":{"line":84}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":84},"end":{"line":84}}},"init":{"type":"Literal"},"loc":{"start":{"line":84},"end":{"line":84}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"webgoatContext","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":89},"end":{"line":89}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":89},"end":{"line":89}}},"init":{"type":"Literal"},"loc":{"start":{"line":89},"end":{"line":89}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doGet"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":103},"end":{"line":103}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":103},"end":{"line":103}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":103},"end":{"line":103}}},{"type":"Identifier","name":"ServletException","loc":{"start":{"line":103},"end":{"line":103}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"doPost","loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":105},"end":{"line":105}}},{"type":"Identifier","name":"response","loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":104},"end":{"line":106}}},"code":"\npublic void doGet(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    doPost(request, response);\n}","loc":{"start":{"line":103},"end":{"line":106}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doPost"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":120},"end":{"line":120}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":120},"end":{"line":120}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":120},"end":{"line":120}}},{"type":"Identifier","name":"ServletException","loc":{"start":{"line":120},"end":{"line":120}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"screen","vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":122},"end":{"line":122}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":122},"end":{"line":122}}},"init":{"type":"Literal"},"loc":{"start":{"line":122},"end":{"line":122}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"mySession","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":124},"end":{"line":124}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":124},"end":{"line":124}}},"init":{"type":"Literal"},"loc":{"start":{"line":124},"end":{"line":124}}},{"type":"TryStatement","finalizer":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"thr","vartype":{"type":"Identifier","name":"Throwable","loc":{"start":{"line":195},"end":{"line":195}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"thr","loc":{"start":{"line":197},"end":{"line":197}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":197},"end":{"line":197}}},"arguments":[],"loc":{"start":{"line":197},"end":{"line":197}}},"loc":{"start":{"line":197},"end":{"line":197}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":198},"end":{"line":198}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Could not write error screen: ","raw":"Could not write error screen: "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"thr","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"getMessage"},"loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[],"loc":{"start":{"line":198},"end":{"line":198}}},"loc":{"start":{"line":198},"end":{"line":198}}}],"loc":{"start":{"line":198},"end":{"line":198}}},"loc":{"start":{"line":198},"end":{"line":198}}}],"loc":{"start":{"line":196},"end":{"line":199}}},"loc":{"start":{"line":195},"end":{"line":199}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"writeScreen"},"loc":{"start":{"line":194},"end":{"line":194}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":194},"end":{"line":194}}},{"type":"Identifier","name":"screen","loc":{"start":{"line":194},"end":{"line":194}}},{"type":"Identifier","name":"response","loc":{"start":{"line":194},"end":{"line":194}}}],"loc":{"start":{"line":194},"end":{"line":194}}},"loc":{"start":{"line":194},"end":{"line":194}}}],"loc":{"start":{"line":193},"end":{"line":195}}},"loc":{"start":{"line":192},"end":{"line":199}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":200},"end":{"line":200}}},"property":{"type":"Identifier","name":"returnConnection"},"loc":{"start":{"line":200},"end":{"line":200}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":200},"end":{"line":200}}}],"loc":{"start":{"line":200},"end":{"line":200}}},"loc":{"start":{"line":200},"end":{"line":200}}}],"loc":{"start":{"line":191},"end":{"line":202}}},"handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Throwable","loc":{"start":{"line":185},"end":{"line":185}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":187},"end":{"line":187}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":187},"end":{"line":187}}},"arguments":[],"loc":{"start":{"line":187},"end":{"line":187}}},"loc":{"start":{"line":187},"end":{"line":187}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":188},"end":{"line":188}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"ERROR: ","raw":"ERROR: "},"right":{"type":"Identifier","name":"t","loc":{"start":{"line":188},"end":{"line":188}}},"loc":{"start":{"line":188},"end":{"line":188}}}],"loc":{"start":{"line":188},"end":{"line":188}}},"loc":{"start":{"line":188},"end":{"line":188}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":189},"end":{"line":189}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":189},"end":{"line":189}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":189},"end":{"line":189}}},{"type":"Identifier","name":"t","loc":{"start":{"line":189},"end":{"line":189}}}],"loc":{"start":{"line":189},"end":{"line":189}}},"loc":{"start":{"line":189},"end":{"line":189}}},"loc":{"start":{"line":189},"end":{"line":189}}}],"loc":{"start":{"line":186},"end":{"line":190}}},"loc":{"start":{"line":185},"end":{"line":190}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":132},"end":{"line":132}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":132},"end":{"line":132}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getServletContext","loc":{"start":{"line":132},"end":{"line":132}}},"arguments":[],"loc":{"start":{"line":132},"end":{"line":132}}},"loc":{"start":{"line":132},"end":{"line":132}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"mySession","loc":{"start":{"line":136},"end":{"line":136}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"updateSession","loc":{"start":{"line":136},"end":{"line":136}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":136},"end":{"line":136}}},{"type":"Identifier","name":"response","loc":{"start":{"line":136},"end":{"line":136}}},{"type":"Identifier","name":"context","loc":{"start":{"line":136},"end":{"line":136}}}],"loc":{"start":{"line":136},"end":{"line":136}}},"loc":{"start":{"line":136},"end":{"line":136}}},"loc":{"start":{"line":136},"end":{"line":136}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":137},"end":{"line":137}}},"property":{"type":"Identifier","name":"isCommitted"},"loc":{"start":{"line":137},"end":{"line":137}}},"arguments":[],"loc":{"start":{"line":137},"end":{"line":137}}},"consequent":{"type":"ReturnStatement","loc":{"start":{"line":137},"end":{"line":137}}},"loc":{"start":{"line":137},"end":{"line":137}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":146},"end":{"line":146}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeScreen","loc":{"start":{"line":146},"end":{"line":146}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":146},"end":{"line":146}}}],"loc":{"start":{"line":146},"end":{"line":146}}},"loc":{"start":{"line":146},"end":{"line":146}}},"loc":{"start":{"line":146},"end":{"line":146}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":148},"end":{"line":148}}},"property":{"type":"Identifier","name":"isCommitted"},"loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[],"loc":{"start":{"line":148},"end":{"line":148}}},"consequent":{"type":"ReturnStatement","loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}},{"type":"IfStatement","test":{"type":"TypeTest","expression":{"type":"Identifier","name":"screen","loc":{"start":{"line":151},"end":{"line":151}}},"clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":153},"end":{"line":153}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":153},"end":{"line":153}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":153},"end":{"line":153}}},"expression":{"type":"Identifier","name":"screen","loc":{"start":{"line":153},"end":{"line":153}}},"loc":{"start":{"line":153},"end":{"line":153}}},"loc":{"start":{"line":153},"end":{"line":153}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Literal","value":"GET","raw":"GET"},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":156},"end":{"line":156}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":156},"end":{"line":156}}},"property":{"type":"Identifier","name":"getMethod"},"loc":{"start":{"line":156},"end":{"line":156}}},"arguments":[],"loc":{"start":{"line":156},"end":{"line":156}}}],"loc":{"start":{"line":156},"end":{"line":156}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uri","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":158},"end":{"line":158}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":158},"end":{"line":158}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":158},"end":{"line":158}}},"property":{"type":"Identifier","name":"getRequestURI"},"loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[],"loc":{"start":{"line":158},"end":{"line":158}}},"right":{"type":"Literal","value":"?","raw":"?"},"loc":{"start":{"line":158},"end":{"line":158}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":158},"end":{"line":158}}},"property":{"type":"Identifier","name":"getQueryString"},"loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[],"loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uri","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"getLink"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[],"loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":159},"end":{"line":159}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":159},"end":{"line":159}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"incrementNumVisits"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[],"loc":{"start":{"line":159},"end":{"line":159}}},"loc":{"start":{"line":159},"end":{"line":159}}},"loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":157},"end":{"line":160}}},"alternate":{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Literal","value":"POST","raw":"POST"},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":161},"end":{"line":161}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":161},"end":{"line":161}}},"property":{"type":"Identifier","name":"getMethod"},"loc":{"start":{"line":161},"end":{"line":161}}},"arguments":[],"loc":{"start":{"line":161},"end":{"line":161}}}],"loc":{"start":{"line":161},"end":{"line":161}}},"right":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"getPreviousScreen"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[],"loc":{"start":{"line":162},"end":{"line":162}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":161},"end":{"line":162}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":164},"end":{"line":164}}}],"loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"incrementNumVisits"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[],"loc":{"start":{"line":164},"end":{"line":164}}},"loc":{"start":{"line":164},"end":{"line":164}}}],"loc":{"start":{"line":163},"end":{"line":165}}},"loc":{"start":{"line":161},"end":{"line":165}}},"loc":{"start":{"line":156},"end":{"line":165}}}],"loc":{"start":{"line":152},"end":{"line":166}}},"loc":{"start":{"line":151},"end":{"line":166}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userTracker","vartype":{"type":"Identifier","name":"UserTracker","loc":{"start":{"line":169},"end":{"line":169}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"UserTracker","loc":{"start":{"line":169},"end":{"line":169}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"UserTracker","loc":{"start":{"line":169},"end":{"line":169}}},"property":{"type":"Identifier","name":"instance"},"loc":{"start":{"line":169},"end":{"line":169}}},"arguments":[],"loc":{"start":{"line":169},"end":{"line":169}}},"loc":{"start":{"line":169},"end":{"line":169}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userTracker","loc":{"start":{"line":170},"end":{"line":170}}},"property":{"type":"Identifier","name":"update"},"loc":{"start":{"line":170},"end":{"line":170}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":170},"end":{"line":170}}},{"type":"Identifier","name":"screen","loc":{"start":{"line":170},"end":{"line":170}}}],"loc":{"start":{"line":170},"end":{"line":170}}},"loc":{"start":{"line":170},"end":{"line":170}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":171},"end":{"line":171}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[],"loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[],"loc":{"start":{"line":171},"end":{"line":171}}},"right":{"type":"Literal","value":" | ","raw":" | "},"loc":{"start":{"line":171},"end":{"line":171}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[],"loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[],"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}}],"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userAgent","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":174},"end":{"line":174}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":174},"end":{"line":174}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":174},"end":{"line":174}}},"property":{"type":"Identifier","name":"getHeader"},"loc":{"start":{"line":174},"end":{"line":174}}},"arguments":[{"type":"Literal","value":"user-agent","raw":"user-agent"}],"loc":{"start":{"line":174},"end":{"line":174}}},"loc":{"start":{"line":174},"end":{"line":174}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"clientBrowser","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":175},"end":{"line":175}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":175},"end":{"line":175}}},"init":{"type":"Literal","value":"Not known!","raw":"Not known!"},"loc":{"start":{"line":175},"end":{"line":175}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":176},"end":{"line":176}}},"right":{"type":"Literal"},"loc":{"start":{"line":176},"end":{"line":176}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":178},"end":{"line":178}}},"right":{"type":"Identifier","name":"userAgent","loc":{"start":{"line":178},"end":{"line":178}}},"loc":{"start":{"line":178},"end":{"line":178}}},"loc":{"start":{"line":178},"end":{"line":178}}}],"loc":{"start":{"line":177},"end":{"line":179}}},"loc":{"start":{"line":176},"end":{"line":179}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[{"type":"Literal","value":"client.browser","raw":"client.browser"},{"type":"Identifier","name":"clientBrowser","loc":{"start":{"line":180},"end":{"line":180}}}],"loc":{"start":{"line":180},"end":{"line":180}}},"loc":{"start":{"line":180},"end":{"line":180}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[],"loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[{"type":"Literal","value":"websession","raw":"websession"},{"type":"Identifier","name":"mySession","loc":{"start":{"line":181},"end":{"line":181}}}],"loc":{"start":{"line":181},"end":{"line":181}}},"loc":{"start":{"line":181},"end":{"line":181}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[],"loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[{"type":"Literal","value":"course","raw":"course"},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"mySession","loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[],"loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":184},"end":{"line":184}}},"property":{"type":"Identifier","name":"getRequestDispatcher"},"loc":{"start":{"line":184},"end":{"line":184}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getViewPage","loc":{"start":{"line":184},"end":{"line":184}}},"arguments":[{"type":"Identifier","name":"mySession","loc":{"start":{"line":184},"end":{"line":184}}}],"loc":{"start":{"line":184},"end":{"line":184}}}],"loc":{"start":{"line":184},"end":{"line":184}}},"property":{"type":"Identifier","name":"forward"},"loc":{"start":{"line":184},"end":{"line":184}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":184},"end":{"line":184}}},{"type":"Identifier","name":"response","loc":{"start":{"line":184},"end":{"line":184}}}],"loc":{"start":{"line":184},"end":{"line":184}}},"loc":{"start":{"line":184},"end":{"line":184}}}],"loc":{"start":{"line":126},"end":{"line":185}}},"loc":{"start":{"line":125},"end":{"line":202}}}],"loc":{"start":{"line":121},"end":{"line":203}}},"code":"\npublic void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    Screen screen \u003d null;\n    WebSession mySession \u003d null;\n    try {\n        ServletContext context \u003d getServletContext();\n        mySession \u003d updateSession(request, response, context);\n        if (response.isCommitted()) return;\n        screen \u003d makeScreen(mySession);\n        if (response.isCommitted()) return;\n        if (screen instanceof AbstractLesson) {\n            AbstractLesson lesson \u003d (AbstractLesson)screen;\n            if (\"GET\".equals(request.getMethod())) {\n                String uri \u003d request.getRequestURI() + \"?\" + request.getQueryString();\n                if (!uri.endsWith(lesson.getLink())) screen.getLessonTracker(mySession).incrementNumVisits();\n            } else if (\"POST\".equals(request.getMethod()) \u0026\u0026 mySession.getPreviousScreen() \u003d\u003d mySession.getCurrentScreen()) {\n                screen.getLessonTracker(mySession).incrementNumVisits();\n            }\n        }\n        UserTracker userTracker \u003d UserTracker.instance();\n        userTracker.update(mySession, screen);\n        log(request, screen.getClass().getName() + \" | \" + mySession.getParser().toString());\n        String userAgent \u003d request.getHeader(\"user-agent\");\n        String clientBrowser \u003d \"Not known!\";\n        if (userAgent !\u003d null) {\n            clientBrowser \u003d userAgent;\n        }\n        request.setAttribute(\"client.browser\", clientBrowser);\n        request.getSession().setAttribute(\"websession\", mySession);\n        request.getSession().setAttribute(\"course\", mySession.getCourse());\n        request.getRequestDispatcher(getViewPage(mySession)).forward(request, response);\n    } catch (Throwable t) {\n        t.printStackTrace();\n        log(\"ERROR: \" + t);\n        screen \u003d new ErrorScreen(mySession, t);\n    } finally {\n        try {\n            this.writeScreen(mySession, screen, response);\n        } catch (Throwable thr) {\n            thr.printStackTrace();\n            log(request, \"Could not write error screen: \" + thr.getMessage());\n        }\n        WebSession.returnConnection(mySession);\n    }\n}","loc":{"start":{"line":120},"end":{"line":203}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getViewPage"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":205},"end":{"line":205}}},"typarams":[],"params":[{"type":"Identifier","name":"webSession","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":205},"end":{"line":205}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"page","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":207},"end":{"line":207}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":207},"end":{"line":207}}},"loc":{"start":{"line":207},"end":{"line":207}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":210},"end":{"line":210}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":210},"end":{"line":210}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"webSession","loc":{"start":{"line":210},"end":{"line":210}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":210},"end":{"line":210}}},"arguments":[],"loc":{"start":{"line":210},"end":{"line":210}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":210},"end":{"line":210}}},"arguments":[],"loc":{"start":{"line":210},"end":{"line":210}}},"loc":{"start":{"line":210},"end":{"line":210}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":211},"end":{"line":211}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":211},"end":{"line":211}}},"arguments":[{"type":"Identifier","name":"WELCOMED","loc":{"start":{"line":211},"end":{"line":211}}}],"loc":{"start":{"line":211},"end":{"line":211}}},"right":{"type":"Literal"},"loc":{"start":{"line":211},"end":{"line":211}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":213},"end":{"line":213}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":213},"end":{"line":213}}},"arguments":[{"type":"Identifier","name":"WELCOMED","loc":{"start":{"line":213},"end":{"line":213}}},{"type":"Literal","value":"true","raw":"true"}],"loc":{"start":{"line":213},"end":{"line":213}}},"loc":{"start":{"line":213},"end":{"line":213}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"page","loc":{"start":{"line":214},"end":{"line":214}}},"right":{"type":"Literal","value":"/webgoat.jsp","raw":"/webgoat.jsp"},"loc":{"start":{"line":214},"end":{"line":214}}},"loc":{"start":{"line":214},"end":{"line":214}}}],"loc":{"start":{"line":212},"end":{"line":215}}},"alternate":{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"page","loc":{"start":{"line":217},"end":{"line":217}}},"right":{"type":"Literal","value":"/main.jsp","raw":"/main.jsp"},"loc":{"start":{"line":217},"end":{"line":217}}},"loc":{"start":{"line":217},"end":{"line":217}}},"loc":{"start":{"line":211},"end":{"line":217}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"page","loc":{"start":{"line":219},"end":{"line":219}}},"loc":{"start":{"line":219},"end":{"line":219}}}],"loc":{"start":{"line":206},"end":{"line":220}}},"code":"\nprivate String getViewPage(WebSession webSession) {\n    String page;\n    HttpSession session \u003d webSession.getRequest().getSession();\n    if (session.getAttribute(WELCOMED) \u003d\u003d null) {\n        session.setAttribute(WELCOMED, \"true\");\n        page \u003d \"/webgoat.jsp\";\n    } else page \u003d \"/main.jsp\";\n    return page;\n}","loc":{"start":{"line":205},"end":{"line":220}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"formatHttpDate"},"modifiers":{"type":"Modifiers","modifiers":["protected","static"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":229},"end":{"line":229}}},"typarams":[],"params":[{"type":"Identifier","name":"date","vartype":{"type":"Identifier","name":"Date","loc":{"start":{"line":229},"end":{"line":229}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"SynchronizedStatement","lock":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":231},"end":{"line":231}}},"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":233},"end":{"line":233}}},"property":{"type":"Identifier","name":"format"},"loc":{"start":{"line":233},"end":{"line":233}}},"arguments":[{"type":"Identifier","name":"date","loc":{"start":{"line":233},"end":{"line":233}}}],"loc":{"start":{"line":233},"end":{"line":233}}},"loc":{"start":{"line":233},"end":{"line":233}}}],"loc":{"start":{"line":232},"end":{"line":234}}},"loc":{"start":{"line":231},"end":{"line":234}}}],"loc":{"start":{"line":230},"end":{"line":235}}},"code":"\nprotected static String formatHttpDate(Date date) {\n    synchronized (httpDateFormat) {\n        return httpDateFormat.format(date);\n    }\n}","loc":{"start":{"line":229},"end":{"line":235}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getServletInfo"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":242},"end":{"line":242}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"WebGoat is sponsored by Aspect Security.","raw":"WebGoat is sponsored by Aspect Security."},"loc":{"start":{"line":244},"end":{"line":244}}}],"loc":{"start":{"line":243},"end":{"line":245}}},"code":"\npublic String getServletInfo() {\n    return \"WebGoat is sponsored by Aspect Security.\";\n}","loc":{"start":{"line":242},"end":{"line":245}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"init"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[{"type":"Identifier","name":"ServletException","loc":{"start":{"line":252},"end":{"line":252}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":254},"end":{"line":254}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"SimpleDateFormat","loc":{"start":{"line":254},"end":{"line":254}}},"arguments":[{"type":"Literal","value":"EEE, dd MMM yyyyy HH:mm:ss z","raw":"EEE, dd MMM yyyyy HH:mm:ss z"},{"type":"MemberExpression","object":{"type":"Identifier","name":"Locale","loc":{"start":{"line":254},"end":{"line":254}}},"property":{"type":"Identifier","name":"US"},"loc":{"start":{"line":254},"end":{"line":254}}}],"loc":{"start":{"line":254},"end":{"line":254}}},"loc":{"start":{"line":254},"end":{"line":254}}},"loc":{"start":{"line":254},"end":{"line":254}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"httpDateFormat","loc":{"start":{"line":255},"end":{"line":255}}},"property":{"type":"Identifier","name":"setTimeZone"},"loc":{"start":{"line":255},"end":{"line":255}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"TimeZone","loc":{"start":{"line":255},"end":{"line":255}}},"property":{"type":"Identifier","name":"getTimeZone"},"loc":{"start":{"line":255},"end":{"line":255}}},"arguments":[{"type":"Literal","value":"GMT","raw":"GMT"}],"loc":{"start":{"line":255},"end":{"line":255}}}],"loc":{"start":{"line":255},"end":{"line":255}}},"loc":{"start":{"line":255},"end":{"line":255}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"propertiesPath","loc":{"start":{"line":256},"end":{"line":256}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getServletContext","loc":{"start":{"line":256},"end":{"line":256}}},"arguments":[],"loc":{"start":{"line":256},"end":{"line":256}}},"property":{"type":"Identifier","name":"getRealPath"},"loc":{"start":{"line":256},"end":{"line":256}}},"arguments":[{"type":"Literal","value":"./WEB-INF/webgoat.properties","raw":"./WEB-INF/webgoat.properties"}],"loc":{"start":{"line":256},"end":{"line":256}}},"loc":{"start":{"line":256},"end":{"line":256}}},"loc":{"start":{"line":256},"end":{"line":256}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"webgoatContext","loc":{"start":{"line":257},"end":{"line":257}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":257},"end":{"line":257}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":257},"end":{"line":257}}},"loc":{"start":{"line":257},"end":{"line":257}}},"loc":{"start":{"line":257},"end":{"line":257}}}],"loc":{"start":{"line":253},"end":{"line":258}}},"code":"\npublic void init() throws ServletException {\n    httpDateFormat \u003d new SimpleDateFormat(\"EEE, dd MMM yyyyy HH:mm:ss z\", Locale.US);\n    httpDateFormat.setTimeZone(TimeZone.getTimeZone(\"GMT\"));\n    propertiesPath \u003d getServletContext().getRealPath(\"./WEB-INF/webgoat.properties\");\n    webgoatContext \u003d new WebgoatContext(this);\n}","loc":{"start":{"line":252},"end":{"line":258}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"log"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":268},"end":{"line":268}}}},{"type":"Identifier","name":"message","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":268},"end":{"line":268}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"output","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":270},"end":{"line":270}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":270},"end":{"line":270}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Date","loc":{"start":{"line":270},"end":{"line":270}}},"arguments":[],"loc":{"start":{"line":270},"end":{"line":270}}},"right":{"type":"Literal","value":" | ","raw":" | "},"loc":{"start":{"line":270},"end":{"line":270}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":270},"end":{"line":270}}},"property":{"type":"Identifier","name":"getRemoteHost"},"loc":{"start":{"line":270},"end":{"line":270}}},"arguments":[],"loc":{"start":{"line":270},"end":{"line":270}}},"loc":{"start":{"line":270},"end":{"line":270}}},"right":{"type":"Literal","value":":","raw":":"},"loc":{"start":{"line":270},"end":{"line":270}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":270},"end":{"line":270}}},"property":{"type":"Identifier","name":"getRemoteAddr"},"loc":{"start":{"line":270},"end":{"line":270}}},"arguments":[],"loc":{"start":{"line":270},"end":{"line":270}}},"loc":{"start":{"line":270},"end":{"line":270}}},"right":{"type":"Literal","value":" | ","raw":" | "},"loc":{"start":{"line":270},"end":{"line":270}}},"right":{"type":"Identifier","name":"message","loc":{"start":{"line":270},"end":{"line":270}}},"loc":{"start":{"line":270},"end":{"line":270}}},"loc":{"start":{"line":270},"end":{"line":270}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":271},"end":{"line":271}}},"arguments":[{"type":"Identifier","name":"output","loc":{"start":{"line":271},"end":{"line":271}}}],"loc":{"start":{"line":271},"end":{"line":271}}},"loc":{"start":{"line":271},"end":{"line":271}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":272},"end":{"line":272}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":272},"end":{"line":272}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":272},"end":{"line":272}}},"arguments":[{"type":"Identifier","name":"output","loc":{"start":{"line":272},"end":{"line":272}}}],"loc":{"start":{"line":272},"end":{"line":272}}},"loc":{"start":{"line":272},"end":{"line":272}}}],"loc":{"start":{"line":269},"end":{"line":273}}},"code":"\npublic void log(HttpServletRequest request, String message) {\n    String output \u003d new Date() + \" | \" + request.getRemoteHost() + \":\" + request.getRemoteAddr() + \" | \" + message;\n    log(output);\n    System.out.println(output);\n}","loc":{"start":{"line":268},"end":{"line":273}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"makeScreen"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":288},"end":{"line":288}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":288},"end":{"line":288}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"screen","vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":290},"end":{"line":290}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":290},"end":{"line":290}}},"init":{"type":"Literal"},"loc":{"start":{"line":290},"end":{"line":290}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":291},"end":{"line":291}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":291},"end":{"line":291}}},"arguments":[],"loc":{"start":{"line":291},"end":{"line":291}}},"loc":{"start":{"line":291},"end":{"line":291}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":292},"end":{"line":292}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":292},"end":{"line":292}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":292},"end":{"line":292}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":292},"end":{"line":292}}},"arguments":[],"loc":{"start":{"line":292},"end":{"line":292}}},"loc":{"start":{"line":292},"end":{"line":292}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":294},"end":{"line":294}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":294},"end":{"line":294}}},"arguments":[],"loc":{"start":{"line":294},"end":{"line":294}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":294},"end":{"line":294}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":294},"end":{"line":294}}},"arguments":[],"loc":{"start":{"line":294},"end":{"line":294}}},"loc":{"start":{"line":294},"end":{"line":294}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"scr","loc":{"start":{"line":296},"end":{"line":296}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":296},"end":{"line":296}}},"property":{"type":"Identifier","name":"WELCOME"},"loc":{"start":{"line":296},"end":{"line":296}}},"loc":{"start":{"line":296},"end":{"line":296}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":298},"end":{"line":298}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WelcomeScreen","loc":{"start":{"line":298},"end":{"line":298}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":298},"end":{"line":298}}}],"loc":{"start":{"line":298},"end":{"line":298}}},"loc":{"start":{"line":298},"end":{"line":298}}},"loc":{"start":{"line":298},"end":{"line":298}}}],"loc":{"start":{"line":297},"end":{"line":299}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":302},"end":{"line":302}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":302},"end":{"line":302}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":302},"end":{"line":302}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":302},"end":{"line":302}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":302},"end":{"line":302}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":302},"end":{"line":302}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":302},"end":{"line":302}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":302},"end":{"line":302}}}],"loc":{"start":{"line":302},"end":{"line":302}}},"loc":{"start":{"line":302},"end":{"line":302}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":303},"end":{"line":303}}},"right":{"type":"Literal"},"loc":{"start":{"line":303},"end":{"line":303}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":303},"end":{"line":303}}},"property":{"type":"Identifier","name":"isHackedAdmin"},"loc":{"start":{"line":303},"end":{"line":303}}},"arguments":[],"loc":{"start":{"line":303},"end":{"line":303}}},"loc":{"start":{"line":303},"end":{"line":303}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":307},"end":{"line":307}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":307},"end":{"line":307}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":307},"end":{"line":307}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":307},"end":{"line":307}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":307},"end":{"line":307}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":307},"end":{"line":307}}},"property":{"type":"Identifier","name":"HACKED_ADMIN_ROLE"},"loc":{"start":{"line":307},"end":{"line":307}}}],"loc":{"start":{"line":307},"end":{"line":307}}},"loc":{"start":{"line":307},"end":{"line":307}}},"loc":{"start":{"line":307},"end":{"line":307}}}],"loc":{"start":{"line":304},"end":{"line":308}}},"loc":{"start":{"line":303},"end":{"line":308}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":310},"end":{"line":310}}},"right":{"type":"Literal"},"loc":{"start":{"line":310},"end":{"line":310}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":312},"end":{"line":312}}},"right":{"type":"Identifier","name":"lesson","loc":{"start":{"line":312},"end":{"line":312}}},"loc":{"start":{"line":312},"end":{"line":312}}},"loc":{"start":{"line":312},"end":{"line":312}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":322},"end":{"line":322}}},"property":{"type":"Identifier","name":"setHasHackableAdmin"},"loc":{"start":{"line":322},"end":{"line":322}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":322},"end":{"line":322}}},"property":{"type":"Identifier","name":"getRole"},"loc":{"start":{"line":322},"end":{"line":322}}},"arguments":[],"loc":{"start":{"line":322},"end":{"line":322}}}],"loc":{"start":{"line":322},"end":{"line":322}}},"loc":{"start":{"line":322},"end":{"line":322}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":324},"end":{"line":324}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":324},"end":{"line":324}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":324},"end":{"line":324}}}],"loc":{"start":{"line":324},"end":{"line":324}}},"loc":{"start":{"line":324},"end":{"line":324}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"setCurrentMenu"},"loc":{"start":{"line":325},"end":{"line":325}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"getCategory"},"loc":{"start":{"line":325},"end":{"line":325}}},"arguments":[],"loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"getRanking"},"loc":{"start":{"line":325},"end":{"line":325}}},"arguments":[],"loc":{"start":{"line":325},"end":{"line":325}}}],"loc":{"start":{"line":325},"end":{"line":325}}},"loc":{"start":{"line":325},"end":{"line":325}}}],"loc":{"start":{"line":311},"end":{"line":326}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":329},"end":{"line":329}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":329},"end":{"line":329}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":329},"end":{"line":329}}},{"type":"Literal","value":"Invalid screen requested.  Try: http://localhost/WebGoat/attack","raw":"Invalid screen requested.  Try: http://localhost/WebGoat/attack"}],"loc":{"start":{"line":329},"end":{"line":329}}},"loc":{"start":{"line":329},"end":{"line":329}}},"loc":{"start":{"line":329},"end":{"line":329}}}],"loc":{"start":{"line":328},"end":{"line":330}}},"loc":{"start":{"line":310},"end":{"line":330}}}],"loc":{"start":{"line":301},"end":{"line":331}}},"loc":{"start":{"line":296},"end":{"line":331}}}],"loc":{"start":{"line":295},"end":{"line":332}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":333},"end":{"line":333}}},"property":{"type":"Identifier","name":"isAdmin"},"loc":{"start":{"line":333},"end":{"line":333}}},"arguments":[],"loc":{"start":{"line":333},"end":{"line":333}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"scr","loc":{"start":{"line":335},"end":{"line":335}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":335},"end":{"line":335}}},"property":{"type":"Identifier","name":"WELCOME"},"loc":{"start":{"line":335},"end":{"line":335}}},"loc":{"start":{"line":335},"end":{"line":335}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":337},"end":{"line":337}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WelcomeAdminScreen","loc":{"start":{"line":337},"end":{"line":337}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":337},"end":{"line":337}}}],"loc":{"start":{"line":337},"end":{"line":337}}},"loc":{"start":{"line":337},"end":{"line":337}}},"loc":{"start":{"line":337},"end":{"line":337}}}],"loc":{"start":{"line":336},"end":{"line":338}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":343},"end":{"line":343}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":343},"end":{"line":343}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":343},"end":{"line":343}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":343},"end":{"line":343}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":343},"end":{"line":343}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":343},"end":{"line":343}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":343},"end":{"line":343}}},"property":{"type":"Identifier","name":"ADMIN_ROLE"},"loc":{"start":{"line":343},"end":{"line":343}}}],"loc":{"start":{"line":343},"end":{"line":343}}},"loc":{"start":{"line":343},"end":{"line":343}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":344},"end":{"line":344}}},"right":{"type":"Literal"},"loc":{"start":{"line":344},"end":{"line":344}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":346},"end":{"line":346}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":346},"end":{"line":346}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":346},"end":{"line":346}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":346},"end":{"line":346}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":346},"end":{"line":346}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":346},"end":{"line":346}}},"property":{"type":"Identifier","name":"HACKED_ADMIN_ROLE"},"loc":{"start":{"line":346},"end":{"line":346}}}],"loc":{"start":{"line":346},"end":{"line":346}}},"loc":{"start":{"line":346},"end":{"line":346}}},"loc":{"start":{"line":346},"end":{"line":346}}}],"loc":{"start":{"line":345},"end":{"line":347}}},"loc":{"start":{"line":344},"end":{"line":347}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":348},"end":{"line":348}}},"right":{"type":"Literal"},"loc":{"start":{"line":348},"end":{"line":348}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":350},"end":{"line":350}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":350},"end":{"line":350}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":350},"end":{"line":350}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":350},"end":{"line":350}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":350},"end":{"line":350}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":350},"end":{"line":350}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":350},"end":{"line":350}}}],"loc":{"start":{"line":350},"end":{"line":350}}},"loc":{"start":{"line":350},"end":{"line":350}}},"loc":{"start":{"line":350},"end":{"line":350}}}],"loc":{"start":{"line":349},"end":{"line":351}}},"loc":{"start":{"line":348},"end":{"line":351}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":353},"end":{"line":353}}},"right":{"type":"Literal"},"loc":{"start":{"line":353},"end":{"line":353}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":355},"end":{"line":355}}},"right":{"type":"Identifier","name":"lesson","loc":{"start":{"line":355},"end":{"line":355}}},"loc":{"start":{"line":355},"end":{"line":355}}},"loc":{"start":{"line":355},"end":{"line":355}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":365},"end":{"line":365}}},"property":{"type":"Identifier","name":"setHasHackableAdmin"},"loc":{"start":{"line":365},"end":{"line":365}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":365},"end":{"line":365}}},"property":{"type":"Identifier","name":"getRole"},"loc":{"start":{"line":365},"end":{"line":365}}},"arguments":[],"loc":{"start":{"line":365},"end":{"line":365}}}],"loc":{"start":{"line":365},"end":{"line":365}}},"loc":{"start":{"line":365},"end":{"line":365}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":367},"end":{"line":367}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":367},"end":{"line":367}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":367},"end":{"line":367}}}],"loc":{"start":{"line":367},"end":{"line":367}}},"loc":{"start":{"line":367},"end":{"line":367}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":368},"end":{"line":368}}},"property":{"type":"Identifier","name":"setCurrentMenu"},"loc":{"start":{"line":368},"end":{"line":368}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":368},"end":{"line":368}}},"property":{"type":"Identifier","name":"getCategory"},"loc":{"start":{"line":368},"end":{"line":368}}},"arguments":[],"loc":{"start":{"line":368},"end":{"line":368}}},"property":{"type":"Identifier","name":"getRanking"},"loc":{"start":{"line":368},"end":{"line":368}}},"arguments":[],"loc":{"start":{"line":368},"end":{"line":368}}}],"loc":{"start":{"line":368},"end":{"line":368}}},"loc":{"start":{"line":368},"end":{"line":368}}}],"loc":{"start":{"line":354},"end":{"line":369}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":372},"end":{"line":372}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":372},"end":{"line":372}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":372},"end":{"line":372}}},{"type":"Literal","value":"Invalid screen requested.  Try Setting Admin to false or Try: http://localhost/WebGoat/attack","raw":"Invalid screen requested.  Try Setting Admin to false or Try: http://localhost/WebGoat/attack"}],"loc":{"start":{"line":372},"end":{"line":373}}},"loc":{"start":{"line":372},"end":{"line":373}}},"loc":{"start":{"line":372},"end":{"line":373}}}],"loc":{"start":{"line":371},"end":{"line":374}}},"loc":{"start":{"line":353},"end":{"line":374}}}],"loc":{"start":{"line":340},"end":{"line":375}}},"loc":{"start":{"line":335},"end":{"line":375}}}],"loc":{"start":{"line":334},"end":{"line":376}}},"loc":{"start":{"line":333},"end":{"line":376}}},"loc":{"start":{"line":294},"end":{"line":376}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"screen","loc":{"start":{"line":378},"end":{"line":378}}},"loc":{"start":{"line":378},"end":{"line":378}}}],"loc":{"start":{"line":289},"end":{"line":379}}},"code":"\nprotected Screen makeScreen(WebSession s) {\n    Screen screen \u003d null;\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        if (scr \u003d\u003d WebSession.WELCOME) {\n            screen \u003d new WelcomeScreen(s);\n        } else {\n            AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n            if (lesson \u003d\u003d null \u0026\u0026 s.isHackedAdmin()) {\n                lesson \u003d course.getLesson(s, scr, AbstractLesson.HACKED_ADMIN_ROLE);\n            }\n            if (lesson !\u003d null) {\n                screen \u003d lesson;\n                s.setHasHackableAdmin(screen.getRole());\n                lesson.handleRequest(s);\n                s.setCurrentMenu(lesson.getCategory().getRanking());\n            } else {\n                screen \u003d new ErrorScreen(s, \"Invalid screen requested.  Try: http://localhost/WebGoat/attack\");\n            }\n        }\n    } else if (s.isAdmin()) {\n        if (scr \u003d\u003d WebSession.WELCOME) {\n            screen \u003d new WelcomeAdminScreen(s);\n        } else {\n            AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.ADMIN_ROLE);\n            if (lesson \u003d\u003d null) {\n                lesson \u003d course.getLesson(s, scr, AbstractLesson.HACKED_ADMIN_ROLE);\n            }\n            if (lesson \u003d\u003d null) {\n                lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n            }\n            if (lesson !\u003d null) {\n                screen \u003d lesson;\n                s.setHasHackableAdmin(screen.getRole());\n                lesson.handleRequest(s);\n                s.setCurrentMenu(lesson.getCategory().getRanking());\n            } else {\n                screen \u003d new ErrorScreen(s, \"Invalid screen requested.  Try Setting Admin to false or Try: http://localhost/WebGoat/attack\");\n            }\n        }\n    }\n    return (screen);\n}","loc":{"start":{"line":288},"end":{"line":379}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setCacheHeaders"},"modifiers":{"type":"Modifiers","modifiers":["protected","static"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":390},"end":{"line":390}}}},{"type":"Identifier","name":"expiry","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"expiry","loc":{"start":{"line":392},"end":{"line":392}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":392},"end":{"line":392}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":394},"end":{"line":394}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":394},"end":{"line":394}}},"arguments":[{"type":"Literal","value":"Pragma","raw":"Pragma"},{"type":"Literal","value":"no-cache","raw":"no-cache"}],"loc":{"start":{"line":394},"end":{"line":394}}},"loc":{"start":{"line":394},"end":{"line":394}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":395},"end":{"line":395}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":395},"end":{"line":395}}},"arguments":[{"type":"Literal","value":"Cache-Control","raw":"Cache-Control"},{"type":"Literal","value":"no-cache","raw":"no-cache"}],"loc":{"start":{"line":395},"end":{"line":395}}},"loc":{"start":{"line":395},"end":{"line":395}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":396},"end":{"line":396}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":396},"end":{"line":396}}},"arguments":[{"type":"Literal","value":"Expires","raw":"Expires"},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"formatHttpDate","loc":{"start":{"line":396},"end":{"line":396}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Date","loc":{"start":{"line":396},"end":{"line":396}}},"arguments":[],"loc":{"start":{"line":396},"end":{"line":396}}}],"loc":{"start":{"line":396},"end":{"line":396}}}],"loc":{"start":{"line":396},"end":{"line":396}}},"loc":{"start":{"line":396},"end":{"line":396}}}],"loc":{"start":{"line":393},"end":{"line":397}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"expiryDate","vartype":{"type":"Identifier","name":"Date","loc":{"start":{"line":400},"end":{"line":400}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Date","loc":{"start":{"line":400},"end":{"line":400}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Date","loc":{"start":{"line":400},"end":{"line":400}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":400},"end":{"line":400}}},"property":{"type":"Identifier","name":"currentTimeMillis"},"loc":{"start":{"line":400},"end":{"line":400}}},"arguments":[],"loc":{"start":{"line":400},"end":{"line":400}}},"right":{"type":"Identifier","name":"expiry","loc":{"start":{"line":400},"end":{"line":400}}},"loc":{"start":{"line":400},"end":{"line":400}}}],"loc":{"start":{"line":400},"end":{"line":400}}},"loc":{"start":{"line":400},"end":{"line":400}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":401},"end":{"line":401}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":401},"end":{"line":401}}},"arguments":[{"type":"Literal","value":"Expires","raw":"Expires"},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"formatHttpDate","loc":{"start":{"line":401},"end":{"line":401}}},"arguments":[{"type":"Identifier","name":"expiryDate","loc":{"start":{"line":401},"end":{"line":401}}}],"loc":{"start":{"line":401},"end":{"line":401}}}],"loc":{"start":{"line":401},"end":{"line":401}}},"loc":{"start":{"line":401},"end":{"line":401}}}],"loc":{"start":{"line":399},"end":{"line":402}}},"loc":{"start":{"line":392},"end":{"line":402}}}],"loc":{"start":{"line":391},"end":{"line":403}}},"code":"\nprotected static void setCacheHeaders(HttpServletResponse response, int expiry) {\n    if (expiry \u003d\u003d 0) {\n        response.setHeader(\"Pragma\", \"no-cache\");\n        response.setHeader(\"Cache-Control\", \"no-cache\");\n        response.setHeader(\"Expires\", formatHttpDate(new Date()));\n    } else {\n        Date expiryDate \u003d new Date(System.currentTimeMillis() + expiry);\n        response.setHeader(\"Expires\", formatHttpDate(expiryDate));\n    }\n}","loc":{"start":{"line":390},"end":{"line":403}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"updateSession"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":416},"end":{"line":416}}},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":416},"end":{"line":416}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":416},"end":{"line":416}}}},{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":416},"end":{"line":416}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":417},"end":{"line":417}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hs","vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":419},"end":{"line":419}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"HttpSession","loc":{"start":{"line":419},"end":{"line":419}}},"loc":{"start":{"line":419},"end":{"line":419}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"hs","loc":{"start":{"line":420},"end":{"line":420}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":420},"end":{"line":420}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":420},"end":{"line":420}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":420},"end":{"line":420}}},"loc":{"start":{"line":420},"end":{"line":420}}},"loc":{"start":{"line":420},"end":{"line":420}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":425},"end":{"line":425}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":425},"end":{"line":425}}},"init":{"type":"Literal"},"loc":{"start":{"line":425},"end":{"line":425}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"o","vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":426},"end":{"line":426}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":426},"end":{"line":426}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":426},"end":{"line":426}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":426},"end":{"line":426}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":426},"end":{"line":426}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":426},"end":{"line":426}}}],"loc":{"start":{"line":426},"end":{"line":426}}},"loc":{"start":{"line":426},"end":{"line":426}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"o","loc":{"start":{"line":428},"end":{"line":428}}},"right":{"type":"Literal"},"loc":{"start":{"line":428},"end":{"line":428}}},"right":{"type":"TypeTest","expression":{"type":"Identifier","name":"o","loc":{"start":{"line":428},"end":{"line":428}}},"clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":428},"end":{"line":428}}},"loc":{"start":{"line":428},"end":{"line":428}}},"loc":{"start":{"line":428},"end":{"line":428}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"session","loc":{"start":{"line":430},"end":{"line":430}}},"right":{"type":"TypeCast","clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":430},"end":{"line":430}}},"expression":{"type":"Identifier","name":"o","loc":{"start":{"line":430},"end":{"line":430}}},"loc":{"start":{"line":430},"end":{"line":430}}},"loc":{"start":{"line":430},"end":{"line":430}}},"loc":{"start":{"line":430},"end":{"line":430}}}],"loc":{"start":{"line":429},"end":{"line":431}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"session","loc":{"start":{"line":436},"end":{"line":436}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":436},"end":{"line":436}}},"arguments":[{"type":"Identifier","name":"webgoatContext","loc":{"start":{"line":436},"end":{"line":436}}},{"type":"Identifier","name":"context","loc":{"start":{"line":436},"end":{"line":436}}}],"loc":{"start":{"line":436},"end":{"line":436}}},"loc":{"start":{"line":436},"end":{"line":436}}},"loc":{"start":{"line":436},"end":{"line":436}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":438},"end":{"line":438}}},"property":{"type":"Identifier","name":"removeAttribute"},"loc":{"start":{"line":438},"end":{"line":438}}},"arguments":[{"type":"Identifier","name":"WELCOMED","loc":{"start":{"line":438},"end":{"line":438}}}],"loc":{"start":{"line":438},"end":{"line":438}}},"loc":{"start":{"line":438},"end":{"line":438}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":439},"end":{"line":439}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":439},"end":{"line":439}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":439},"end":{"line":439}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":439},"end":{"line":439}}},{"type":"Identifier","name":"session","loc":{"start":{"line":439},"end":{"line":439}}}],"loc":{"start":{"line":439},"end":{"line":439}}},"loc":{"start":{"line":439},"end":{"line":439}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hs","loc":{"start":{"line":441},"end":{"line":441}}},"property":{"type":"Identifier","name":"setMaxInactiveInterval"},"loc":{"start":{"line":441},"end":{"line":441}}},"arguments":[{"type":"Identifier","name":"sessionTimeoutSeconds","loc":{"start":{"line":441},"end":{"line":441}}}],"loc":{"start":{"line":441},"end":{"line":441}}},"loc":{"start":{"line":441},"end":{"line":441}}}],"loc":{"start":{"line":433},"end":{"line":443}}},"loc":{"start":{"line":428},"end":{"line":443}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":445},"end":{"line":445}}},"property":{"type":"Identifier","name":"update"},"loc":{"start":{"line":445},"end":{"line":445}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":445},"end":{"line":445}}},{"type":"Identifier","name":"response","loc":{"start":{"line":445},"end":{"line":445}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getServletName"},"loc":{"start":{"line":445},"end":{"line":445}}},"arguments":[],"loc":{"start":{"line":445},"end":{"line":445}}}],"loc":{"start":{"line":445},"end":{"line":445}}},"loc":{"start":{"line":445},"end":{"line":445}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"session","loc":{"start":{"line":450},"end":{"line":450}}},"loc":{"start":{"line":450},"end":{"line":450}}}],"loc":{"start":{"line":418},"end":{"line":451}}},"code":"\nprotected WebSession updateSession(HttpServletRequest request, HttpServletResponse response, ServletContext context) throws IOException {\n    HttpSession hs;\n    hs \u003d request.getSession(true);\n    WebSession session \u003d null;\n    Object o \u003d hs.getAttribute(WebSession.SESSION);\n    if ((o !\u003d null) \u0026\u0026 o instanceof WebSession) {\n        session \u003d (WebSession)o;\n    } else {\n        session \u003d new WebSession(webgoatContext, context);\n        hs.removeAttribute(WELCOMED);\n        hs.setAttribute(WebSession.SESSION, session);\n        hs.setMaxInactiveInterval(sessionTimeoutSeconds);\n    }\n    session.update(request, response, this.getServletName());\n    return (session);\n}","loc":{"start":{"line":416},"end":{"line":451}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"writeScreen"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":463},"end":{"line":463}}}},{"type":"Identifier","name":"screen","vartype":{"type":"Identifier","name":"Screen","loc":{"start":{"line":463},"end":{"line":463}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":463},"end":{"line":463}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":463},"end":{"line":463}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":465},"end":{"line":465}}},"property":{"type":"Identifier","name":"setContentType"},"loc":{"start":{"line":465},"end":{"line":465}}},"arguments":[{"type":"Literal","value":"text/html","raw":"text/html"}],"loc":{"start":{"line":465},"end":{"line":465}}},"loc":{"start":{"line":465},"end":{"line":465}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"out","vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":467},"end":{"line":467}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":467},"end":{"line":467}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":467},"end":{"line":467}}},"property":{"type":"Identifier","name":"getWriter"},"loc":{"start":{"line":467},"end":{"line":467}}},"arguments":[],"loc":{"start":{"line":467},"end":{"line":467}}},"loc":{"start":{"line":467},"end":{"line":467}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"s","loc":{"start":{"line":469},"end":{"line":469}}},"right":{"type":"Literal"},"loc":{"start":{"line":469},"end":{"line":469}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"screen","loc":{"start":{"line":471},"end":{"line":471}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ErrorScreen","loc":{"start":{"line":471},"end":{"line":471}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":471},"end":{"line":471}}},{"type":"Literal","value":"Page to display was null","raw":"Page to display was null"}],"loc":{"start":{"line":471},"end":{"line":471}}},"loc":{"start":{"line":471},"end":{"line":471}}},"loc":{"start":{"line":471},"end":{"line":471}}}],"loc":{"start":{"line":470},"end":{"line":472}}},"loc":{"start":{"line":469},"end":{"line":472}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":476},"end":{"line":476}}},"property":{"type":"Identifier","name":"setContentLength"},"loc":{"start":{"line":476},"end":{"line":476}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":476},"end":{"line":476}}},"property":{"type":"Identifier","name":"getContentLength"},"loc":{"start":{"line":476},"end":{"line":476}}},"arguments":[],"loc":{"start":{"line":476},"end":{"line":476}}}],"loc":{"start":{"line":476},"end":{"line":476}}},"loc":{"start":{"line":476},"end":{"line":476}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":477},"end":{"line":477}}},"property":{"type":"Identifier","name":"setHeader"},"loc":{"start":{"line":477},"end":{"line":477}}},"arguments":[{"type":"Literal","value":"Content-Length","raw":"Content-Length"},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":477},"end":{"line":477}}},"property":{"type":"Identifier","name":"getContentLength"},"loc":{"start":{"line":477},"end":{"line":477}}},"arguments":[],"loc":{"start":{"line":477},"end":{"line":477}}},"right":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":477},"end":{"line":477}}}],"loc":{"start":{"line":477},"end":{"line":477}}},"loc":{"start":{"line":477},"end":{"line":477}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"screen","loc":{"start":{"line":479},"end":{"line":479}}},"property":{"type":"Identifier","name":"output"},"loc":{"start":{"line":479},"end":{"line":479}}},"arguments":[{"type":"Identifier","name":"out","loc":{"start":{"line":479},"end":{"line":479}}}],"loc":{"start":{"line":479},"end":{"line":479}}},"loc":{"start":{"line":479},"end":{"line":479}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"out","loc":{"start":{"line":480},"end":{"line":480}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":480},"end":{"line":480}}},"arguments":[],"loc":{"start":{"line":480},"end":{"line":480}}},"loc":{"start":{"line":480},"end":{"line":480}}}],"loc":{"start":{"line":464},"end":{"line":481}}},"code":"\nprotected void writeScreen(WebSession s, Screen screen, HttpServletResponse response) throws IOException {\n    response.setContentType(\"text/html\");\n    PrintWriter out \u003d response.getWriter();\n    if (s \u003d\u003d null) {\n        screen \u003d new ErrorScreen(s, \"Page to display was null\");\n    }\n    response.setContentLength(screen.getContentLength());\n    response.setHeader(\"Content-Length\", screen.getContentLength() + \"\");\n    screen.output(out);\n    out.close();\n}","loc":{"start":{"line":463},"end":{"line":481}}}],"loc":{"start":{"line":59},"end":{"line":482}}}],"loc":{"start":{"line":2},"end":{"line":482}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/HammerHead.java"}