{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"Arrays"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"Collections"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"Iterator"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"Set"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"Vector"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"LinkedList"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ServletContext"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"HammerHead"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Course"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lessons","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":54},"end":{"line":54}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":54},"end":{"line":54}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"LinkedList","loc":{"start":{"line":54},"end":{"line":54}}},"arguments":[],"loc":{"start":{"line":54},"end":{"line":54}}},"loc":{"start":{"line":54},"end":{"line":54}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"PROPERTIES_FILENAME","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":56},"end":{"line":56}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":56},"end":{"line":56}}},"init":{"type":"MemberExpression","object":{"type":"Identifier","name":"HammerHead","loc":{"start":{"line":56},"end":{"line":56}}},"property":{"type":"Identifier","name":"propertiesPath"},"loc":{"start":{"line":56},"end":{"line":56}}},"loc":{"start":{"line":56},"end":{"line":56}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"properties","vartype":{"type":"Identifier","name":"WebgoatProperties","loc":{"start":{"line":58},"end":{"line":58}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"WebgoatProperties","loc":{"start":{"line":58},"end":{"line":58}}},"init":{"type":"Literal"},"loc":{"start":{"line":58},"end":{"line":58}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"files","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":60},"end":{"line":60}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":60},"end":{"line":60}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"LinkedList","loc":{"start":{"line":60},"end":{"line":60}}},"arguments":[],"loc":{"start":{"line":60},"end":{"line":60}}},"loc":{"start":{"line":60},"end":{"line":60}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"webgoatContext","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":62},"end":{"line":62}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"IOException","loc":{"start":{"line":70},"end":{"line":70}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Literal","value":"Error loading WebGoat properties","raw":"Error loading WebGoat properties"}],"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":73},"end":{"line":73}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[],"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":71},"end":{"line":74}}},"loc":{"start":{"line":70},"end":{"line":74}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"properties","loc":{"start":{"line":69},"end":{"line":69}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"WebgoatProperties","loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[{"type":"Identifier","name":"PROPERTIES_FILENAME","loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":69},"end":{"line":69}}},"loc":{"start":{"line":69},"end":{"line":69}}},"loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":68},"end":{"line":70}}},"loc":{"start":{"line":67},"end":{"line":74}}}],"loc":{"start":{"line":66},"end":{"line":75}}},"code":"\npublic \u003cinit\u003e() {\n    try {\n        properties \u003d new WebgoatProperties(PROPERTIES_FILENAME);\n    } catch (IOException e) {\n        System.out.println(\"Error loading WebGoat properties\");\n        e.printStackTrace();\n    }\n}","loc":{"start":{"line":65},"end":{"line":75}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getFileName"},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":88},"end":{"line":88}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":88},"end":{"line":88}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":90},"end":{"line":90}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":90},"end":{"line":90}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":90},"end":{"line":90}}}],"loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[],"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":90},"end":{"line":90}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":92},"end":{"line":92}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":92},"end":{"line":92}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":94},"end":{"line":94}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"lastIndexOf"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":94},"end":{"line":94}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":94},"end":{"line":94}}}],"loc":{"start":{"line":94},"end":{"line":94}}},"loc":{"start":{"line":94},"end":{"line":94}}},"loc":{"start":{"line":94},"end":{"line":94}}}],"loc":{"start":{"line":93},"end":{"line":95}}},"loc":{"start":{"line":92},"end":{"line":95}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":97},"end":{"line":97}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[{"type":"Literal","value":".","raw":"."}],"loc":{"start":{"line":97},"end":{"line":97}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":97},"end":{"line":97}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":99},"end":{"line":99}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[{"type":"Literal","value":0,"raw":0},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[{"type":"Literal","value":".","raw":"."}],"loc":{"start":{"line":99},"end":{"line":99}}}],"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}}],"loc":{"start":{"line":98},"end":{"line":100}}},"loc":{"start":{"line":97},"end":{"line":100}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"fileName","loc":{"start":{"line":102},"end":{"line":102}}},"loc":{"start":{"line":102},"end":{"line":102}}}],"loc":{"start":{"line":89},"end":{"line":103}}},"code":"\nprivate static String getFileName(String s) {\n    String fileName \u003d new File(s).getName();\n    if (fileName.indexOf(\"/\") !\u003d -1) {\n        fileName \u003d fileName.substring(fileName.lastIndexOf(\"/\"), fileName.length());\n    }\n    if (fileName.indexOf(\".\") !\u003d -1) {\n        fileName \u003d fileName.substring(0, fileName.indexOf(\".\"));\n    }\n    return fileName;\n}","loc":{"start":{"line":88},"end":{"line":103}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSourceFile"},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":113},"end":{"line":113}}},"typarams":[],"params":[{"type":"Identifier","name":"className","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":113},"end":{"line":113}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"sb","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":115},"end":{"line":115}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":115},"end":{"line":115}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[],"loc":{"start":{"line":115},"end":{"line":115}}},"loc":{"start":{"line":115},"end":{"line":115}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sb","loc":{"start":{"line":117},"end":{"line":117}}},"property":{"type":"Identifier","name":"append"},"loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"className","loc":{"start":{"line":117},"end":{"line":117}}},"property":{"type":"Identifier","name":"replace"},"loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[{"type":"Literal","value":".","raw":"."},{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":117},"end":{"line":117}}}],"loc":{"start":{"line":117},"end":{"line":117}}},"loc":{"start":{"line":117},"end":{"line":117}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sb","loc":{"start":{"line":118},"end":{"line":118}}},"property":{"type":"Identifier","name":"append"},"loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[{"type":"Literal","value":".java","raw":".java"}],"loc":{"start":{"line":118},"end":{"line":118}}},"loc":{"start":{"line":118},"end":{"line":118}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sb","loc":{"start":{"line":120},"end":{"line":120}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[],"loc":{"start":{"line":120},"end":{"line":120}}},"loc":{"start":{"line":120},"end":{"line":120}}}],"loc":{"start":{"line":114},"end":{"line":121}}},"code":"\nprivate static String getSourceFile(String className) {\n    StringBuffer sb \u003d new StringBuffer();\n    sb.append(className.replace(\".\", \"/\"));\n    sb.append(\".java\");\n    return sb.toString();\n}","loc":{"start":{"line":113},"end":{"line":121}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getClassFile"},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":132},"end":{"line":132}}},"typarams":[],"params":[{"type":"Identifier","name":"fileName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":132},"end":{"line":132}}}},{"type":"Identifier","name":"path","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":132},"end":{"line":132}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ext","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":134},"end":{"line":134}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":134},"end":{"line":134}}},"init":{"type":"Literal","value":".class","raw":".class"},"loc":{"start":{"line":134},"end":{"line":134}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":135},"end":{"line":135}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":135},"end":{"line":135}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[],"loc":{"start":{"line":135},"end":{"line":135}}},"loc":{"start":{"line":135},"end":{"line":135}}},"loc":{"start":{"line":135},"end":{"line":135}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":141},"end":{"line":141}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[{"type":"Identifier","name":"ext","loc":{"start":{"line":141},"end":{"line":141}}}],"loc":{"start":{"line":141},"end":{"line":141}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal"},"loc":{"start":{"line":141},"end":{"line":141}}}],"loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"index","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":144},"end":{"line":144}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":144},"end":{"line":144}}},"arguments":[{"type":"Literal","value":"/WEB-INF/classes/","raw":"/WEB-INF/classes/"}],"loc":{"start":{"line":144},"end":{"line":144}}},"loc":{"start":{"line":144},"end":{"line":144}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"index","loc":{"start":{"line":145},"end":{"line":145}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":145},"end":{"line":145}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":147},"end":{"line":147}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":147},"end":{"line":147}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":147},"end":{"line":147}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"index","loc":{"start":{"line":147},"end":{"line":147}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Literal","value":"/WEB-INF/classes/","raw":"/WEB-INF/classes/"},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":147},"end":{"line":147}}},"arguments":[],"loc":{"start":{"line":147},"end":{"line":147}}},"loc":{"start":{"line":147},"end":{"line":147}}},{"type":"BinaryExpression","operator":"MINUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":147},"end":{"line":147}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":147},"end":{"line":147}}},"arguments":[],"loc":{"start":{"line":147},"end":{"line":147}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ext","loc":{"start":{"line":147},"end":{"line":147}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":147},"end":{"line":147}}},"arguments":[],"loc":{"start":{"line":147},"end":{"line":147}}},"loc":{"start":{"line":147},"end":{"line":147}}}],"loc":{"start":{"line":147},"end":{"line":147}}},"loc":{"start":{"line":147},"end":{"line":147}}},"loc":{"start":{"line":147},"end":{"line":147}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":148},"end":{"line":148}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":148},"end":{"line":148}}},"property":{"type":"Identifier","name":"replace"},"loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[{"type":"Literal","value":47,"raw":47},{"type":"Literal","value":46,"raw":46}],"loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":149},"end":{"line":149}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":149},"end":{"line":149}}},"property":{"type":"Identifier","name":"replace"},"loc":{"start":{"line":149},"end":{"line":149}}},"arguments":[{"type":"Literal","value":92,"raw":92},{"type":"Literal","value":46,"raw":46}],"loc":{"start":{"line":149},"end":{"line":149}}},"loc":{"start":{"line":149},"end":{"line":149}}},"loc":{"start":{"line":149},"end":{"line":149}}}],"loc":{"start":{"line":146},"end":{"line":150}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":154},"end":{"line":154}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"path","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[],"loc":{"start":{"line":154},"end":{"line":154}}},{"type":"BinaryExpression","operator":"MINUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[],"loc":{"start":{"line":154},"end":{"line":154}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ext","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":152},"end":{"line":155}}},"loc":{"start":{"line":145},"end":{"line":155}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"fileName","loc":{"start":{"line":157},"end":{"line":157}}},"loc":{"start":{"line":157},"end":{"line":157}}}],"loc":{"start":{"line":133},"end":{"line":158}}},"code":"\nprivate static String getClassFile(String fileName, String path) {\n    String ext \u003d \".class\";\n    fileName \u003d fileName.trim();\n    if (fileName.endsWith(\"/\") || !fileName.endsWith(ext)) {\n        return null;\n    }\n    int index \u003d fileName.indexOf(\"/WEB-INF/classes/\");\n    if (index !\u003d -1) {\n        fileName \u003d fileName.substring(index + \"/WEB-INF/classes/\".length(), fileName.length() - ext.length());\n        fileName \u003d fileName.replace(\u0027/\u0027, \u0027.\u0027);\n        fileName \u003d fileName.replace(\u0027\\\\\u0027, \u0027.\u0027);\n    } else {\n        fileName \u003d fileName.substring(path.length(), fileName.length() - ext.length());\n    }\n    return fileName;\n}","loc":{"start":{"line":132},"end":{"line":158}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getCategories"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":165},"end":{"line":165}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"categories","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":167},"end":{"line":167}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":167},"end":{"line":167}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":167},"end":{"line":167}}},"arguments":[],"loc":{"start":{"line":167},"end":{"line":167}}},"loc":{"start":{"line":167},"end":{"line":167}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"iter","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":168},"end":{"line":168}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":168},"end":{"line":168}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessons","loc":{"start":{"line":168},"end":{"line":168}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":168},"end":{"line":168}}},"arguments":[],"loc":{"start":{"line":168},"end":{"line":168}}},"loc":{"start":{"line":168},"end":{"line":168}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":170},"end":{"line":170}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":170},"end":{"line":170}}},"arguments":[],"loc":{"start":{"line":170},"end":{"line":170}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":172},"end":{"line":172}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":172},"end":{"line":172}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":172},"end":{"line":172}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":172},"end":{"line":172}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":172},"end":{"line":172}}},"arguments":[],"loc":{"start":{"line":172},"end":{"line":172}}},"loc":{"start":{"line":172},"end":{"line":172}}},"loc":{"start":{"line":172},"end":{"line":172}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"categories","loc":{"start":{"line":174},"end":{"line":174}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":174},"end":{"line":174}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":174},"end":{"line":174}}},"property":{"type":"Identifier","name":"getCategory"},"loc":{"start":{"line":174},"end":{"line":174}}},"arguments":[],"loc":{"start":{"line":174},"end":{"line":174}}}],"loc":{"start":{"line":174},"end":{"line":174}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":174},"end":{"line":174}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"categories","loc":{"start":{"line":176},"end":{"line":176}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":176},"end":{"line":176}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":176},"end":{"line":176}}},"property":{"type":"Identifier","name":"getCategory"},"loc":{"start":{"line":176},"end":{"line":176}}},"arguments":[],"loc":{"start":{"line":176},"end":{"line":176}}}],"loc":{"start":{"line":176},"end":{"line":176}}},"loc":{"start":{"line":176},"end":{"line":176}}}],"loc":{"start":{"line":175},"end":{"line":177}}},"loc":{"start":{"line":174},"end":{"line":177}}}],"loc":{"start":{"line":171},"end":{"line":178}}},"loc":{"start":{"line":170},"end":{"line":178}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Collections","loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"sort"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[{"type":"Identifier","name":"categories","loc":{"start":{"line":180},"end":{"line":180}}}],"loc":{"start":{"line":180},"end":{"line":180}}},"loc":{"start":{"line":180},"end":{"line":180}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"categories","loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":166},"end":{"line":183}}},"code":"\npublic List getCategories() {\n    List\u003cCategory\u003e categories \u003d new ArrayList\u003cCategory\u003e();\n    Iterator iter \u003d lessons.iterator();\n    while (iter.hasNext()) {\n        AbstractLesson lesson \u003d (AbstractLesson)iter.next();\n        if (!categories.contains(lesson.getCategory())) {\n            categories.add(lesson.getCategory());\n        }\n    }\n    Collections.sort(categories);\n    return categories;\n}","loc":{"start":{"line":165},"end":{"line":183}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getFirstLesson"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":190},"end":{"line":190}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":192},"end":{"line":192}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":192},"end":{"line":192}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":192},"end":{"line":192}}},"arguments":[],"loc":{"start":{"line":192},"end":{"line":192}}},"loc":{"start":{"line":192},"end":{"line":192}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":193},"end":{"line":193}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":193},"end":{"line":193}}}],"loc":{"start":{"line":193},"end":{"line":193}}},"loc":{"start":{"line":193},"end":{"line":193}}},{"type":"ReturnStatement","argument":{"type":"TypeCast","clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":196},"end":{"line":196}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessons","loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"TypeCast","clazz":{"type":"Identifier","name":"Category","loc":{"start":{"line":196},"end":{"line":196}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getCategories","loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[],"loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":196},"end":{"line":196}}},"loc":{"start":{"line":196},"end":{"line":196}}},{"type":"Identifier","name":"roles","loc":{"start":{"line":196},"end":{"line":196}}}],"loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":196},"end":{"line":196}}},"loc":{"start":{"line":196},"end":{"line":196}}},"loc":{"start":{"line":196},"end":{"line":196}}}],"loc":{"start":{"line":191},"end":{"line":197}}},"code":"\npublic AbstractLesson getFirstLesson() {\n    List\u003cString\u003e roles \u003d new ArrayList\u003cString\u003e();\n    roles.add(AbstractLesson.USER_ROLE);\n    return ((AbstractLesson)getLessons((Category)getCategories().get(0), roles).get(0));\n}","loc":{"start":{"line":190},"end":{"line":197}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLesson"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":208},"end":{"line":208}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":208},"end":{"line":208}}}},{"type":"Identifier","name":"lessonId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":208},"end":{"line":208}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":210},"end":{"line":210}}},"property":{"type":"Identifier","name":"isHackedAdmin"},"loc":{"start":{"line":210},"end":{"line":210}}},"arguments":[],"loc":{"start":{"line":210},"end":{"line":210}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":212},"end":{"line":212}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":212},"end":{"line":212}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":212},"end":{"line":212}}},"property":{"type":"Identifier","name":"HACKED_ADMIN_ROLE"},"loc":{"start":{"line":212},"end":{"line":212}}}],"loc":{"start":{"line":212},"end":{"line":212}}},"loc":{"start":{"line":212},"end":{"line":212}}}],"loc":{"start":{"line":211},"end":{"line":213}}},"loc":{"start":{"line":210},"end":{"line":213}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"iter","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":215},"end":{"line":215}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":215},"end":{"line":215}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessons","loc":{"start":{"line":215},"end":{"line":215}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":215},"end":{"line":215}}},"arguments":[],"loc":{"start":{"line":215},"end":{"line":215}}},"loc":{"start":{"line":215},"end":{"line":215}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[],"loc":{"start":{"line":217},"end":{"line":217}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":219},"end":{"line":219}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":219},"end":{"line":219}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":219},"end":{"line":219}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":219},"end":{"line":219}}},"arguments":[],"loc":{"start":{"line":219},"end":{"line":219}}},"loc":{"start":{"line":219},"end":{"line":219}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":222},"end":{"line":222}}},"property":{"type":"Identifier","name":"getScreenId"},"loc":{"start":{"line":222},"end":{"line":222}}},"arguments":[],"loc":{"start":{"line":222},"end":{"line":222}}},"right":{"type":"Identifier","name":"lessonId","loc":{"start":{"line":222},"end":{"line":222}}},"loc":{"start":{"line":222},"end":{"line":222}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":222},"end":{"line":222}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":222},"end":{"line":222}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":222},"end":{"line":222}}},"property":{"type":"Identifier","name":"getRole"},"loc":{"start":{"line":222},"end":{"line":222}}},"arguments":[],"loc":{"start":{"line":222},"end":{"line":222}}}],"loc":{"start":{"line":222},"end":{"line":222}}},"loc":{"start":{"line":222},"end":{"line":222}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"lesson","loc":{"start":{"line":222},"end":{"line":222}}},"loc":{"start":{"line":222},"end":{"line":222}}}],"loc":{"start":{"line":222},"end":{"line":222}}},"loc":{"start":{"line":222},"end":{"line":222}}}],"loc":{"start":{"line":218},"end":{"line":223}}},"loc":{"start":{"line":217},"end":{"line":223}}},{"type":"ReturnStatement","argument":{"type":"Literal"},"loc":{"start":{"line":225},"end":{"line":225}}}],"loc":{"start":{"line":209},"end":{"line":226}}},"code":"\npublic AbstractLesson getLesson(WebSession s, int lessonId, List\u003cString\u003e roles) {\n    if (s.isHackedAdmin()) {\n        roles.add(AbstractLesson.HACKED_ADMIN_ROLE);\n    }\n    Iterator\u003cAbstractLesson\u003e iter \u003d lessons.iterator();\n    while (iter.hasNext()) {\n        AbstractLesson lesson \u003d iter.next();\n        if (lesson.getScreenId() \u003d\u003d lessonId \u0026\u0026 roles.contains(lesson.getRole())) {\n            return lesson;\n        }\n    }\n    return null;\n}","loc":{"start":{"line":208},"end":{"line":226}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLesson"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":228},"end":{"line":228}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":228},"end":{"line":228}}}},{"type":"Identifier","name":"lessonId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"role","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":228},"end":{"line":228}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":230},"end":{"line":230}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":230},"end":{"line":230}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Vector","loc":{"start":{"line":230},"end":{"line":230}}},"arguments":[],"loc":{"start":{"line":230},"end":{"line":230}}},"loc":{"start":{"line":230},"end":{"line":230}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":231},"end":{"line":231}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":231},"end":{"line":231}}},"arguments":[{"type":"Identifier","name":"role","loc":{"start":{"line":231},"end":{"line":231}}}],"loc":{"start":{"line":231},"end":{"line":231}}},"loc":{"start":{"line":231},"end":{"line":231}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLesson","loc":{"start":{"line":232},"end":{"line":232}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":232},"end":{"line":232}}},{"type":"Identifier","name":"lessonId","loc":{"start":{"line":232},"end":{"line":232}}},{"type":"Identifier","name":"roles","loc":{"start":{"line":232},"end":{"line":232}}}],"loc":{"start":{"line":232},"end":{"line":232}}},"loc":{"start":{"line":232},"end":{"line":232}}}],"loc":{"start":{"line":229},"end":{"line":233}}},"code":"\npublic AbstractLesson getLesson(WebSession s, int lessonId, String role) {\n    List\u003cString\u003e roles \u003d new Vector\u003cString\u003e();\n    roles.add(role);\n    return getLesson(s, lessonId, roles);\n}","loc":{"start":{"line":228},"end":{"line":233}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessons"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":235},"end":{"line":235}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":235},"end":{"line":235}}}},{"type":"Identifier","name":"role","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":235},"end":{"line":235}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":237},"end":{"line":237}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":237},"end":{"line":237}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Vector","loc":{"start":{"line":237},"end":{"line":237}}},"arguments":[],"loc":{"start":{"line":237},"end":{"line":237}}},"loc":{"start":{"line":237},"end":{"line":237}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":238},"end":{"line":238}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":238},"end":{"line":238}}},"arguments":[{"type":"Identifier","name":"role","loc":{"start":{"line":238},"end":{"line":238}}}],"loc":{"start":{"line":238},"end":{"line":238}}},"loc":{"start":{"line":238},"end":{"line":238}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessons","loc":{"start":{"line":239},"end":{"line":239}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":239},"end":{"line":239}}},{"type":"Identifier","name":"roles","loc":{"start":{"line":239},"end":{"line":239}}}],"loc":{"start":{"line":239},"end":{"line":239}}},"loc":{"start":{"line":239},"end":{"line":239}}}],"loc":{"start":{"line":236},"end":{"line":240}}},"code":"\npublic List getLessons(WebSession s, String role) {\n    List\u003cString\u003e roles \u003d new Vector\u003cString\u003e();\n    roles.add(role);\n    return getLessons(s, roles);\n}","loc":{"start":{"line":235},"end":{"line":240}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessons"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":249},"end":{"line":249}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":249},"end":{"line":249}}}},{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":249},"end":{"line":249}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":251},"end":{"line":251}}},"property":{"type":"Identifier","name":"isHackedAdmin"},"loc":{"start":{"line":251},"end":{"line":251}}},"arguments":[],"loc":{"start":{"line":251},"end":{"line":251}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":253},"end":{"line":253}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":253},"end":{"line":253}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":253},"end":{"line":253}}},"property":{"type":"Identifier","name":"HACKED_ADMIN_ROLE"},"loc":{"start":{"line":253},"end":{"line":253}}}],"loc":{"start":{"line":253},"end":{"line":253}}},"loc":{"start":{"line":253},"end":{"line":253}}}],"loc":{"start":{"line":252},"end":{"line":254}}},"loc":{"start":{"line":251},"end":{"line":254}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lessonList","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":255},"end":{"line":255}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":255},"end":{"line":255}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":255},"end":{"line":255}}},"arguments":[],"loc":{"start":{"line":255},"end":{"line":255}}},"loc":{"start":{"line":255},"end":{"line":255}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"categoryIter","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":256},"end":{"line":256}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":256},"end":{"line":256}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getCategories","loc":{"start":{"line":256},"end":{"line":256}}},"arguments":[],"loc":{"start":{"line":256},"end":{"line":256}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":256},"end":{"line":256}}},"arguments":[],"loc":{"start":{"line":256},"end":{"line":256}}},"loc":{"start":{"line":256},"end":{"line":256}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"categoryIter","loc":{"start":{"line":258},"end":{"line":258}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":258},"end":{"line":258}}},"arguments":[],"loc":{"start":{"line":258},"end":{"line":258}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessonList","loc":{"start":{"line":260},"end":{"line":260}}},"property":{"type":"Identifier","name":"addAll"},"loc":{"start":{"line":260},"end":{"line":260}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessons","loc":{"start":{"line":260},"end":{"line":260}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":260},"end":{"line":260}}},{"type":"TypeCast","clazz":{"type":"Identifier","name":"Category","loc":{"start":{"line":260},"end":{"line":260}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"categoryIter","loc":{"start":{"line":260},"end":{"line":260}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":260},"end":{"line":260}}},"arguments":[],"loc":{"start":{"line":260},"end":{"line":260}}},"loc":{"start":{"line":260},"end":{"line":260}}},{"type":"Identifier","name":"roles","loc":{"start":{"line":260},"end":{"line":260}}}],"loc":{"start":{"line":260},"end":{"line":260}}}],"loc":{"start":{"line":260},"end":{"line":260}}},"loc":{"start":{"line":260},"end":{"line":260}}}],"loc":{"start":{"line":259},"end":{"line":261}}},"loc":{"start":{"line":258},"end":{"line":261}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"lessonList","loc":{"start":{"line":262},"end":{"line":262}}},"loc":{"start":{"line":262},"end":{"line":262}}}],"loc":{"start":{"line":250},"end":{"line":263}}},"code":"\npublic List\u003cAbstractLesson\u003e getLessons(WebSession s, List\u003cString\u003e roles) {\n    if (s.isHackedAdmin()) {\n        roles.add(AbstractLesson.HACKED_ADMIN_ROLE);\n    }\n    List\u003cAbstractLesson\u003e lessonList \u003d new ArrayList\u003cAbstractLesson\u003e();\n    Iterator categoryIter \u003d getCategories().iterator();\n    while (categoryIter.hasNext()) {\n        lessonList.addAll(getLessons(s, (Category)categoryIter.next(), roles));\n    }\n    return lessonList;\n}","loc":{"start":{"line":249},"end":{"line":263}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessons"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":274},"end":{"line":274}}},"typarams":[],"params":[{"type":"Identifier","name":"category","vartype":{"type":"Identifier","name":"Category","loc":{"start":{"line":274},"end":{"line":274}}}},{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":274},"end":{"line":274}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lessonList","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":276},"end":{"line":276}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":276},"end":{"line":276}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":276},"end":{"line":276}}},"arguments":[],"loc":{"start":{"line":276},"end":{"line":276}}},"loc":{"start":{"line":276},"end":{"line":276}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"iter","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":278},"end":{"line":278}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":278},"end":{"line":278}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessons","loc":{"start":{"line":278},"end":{"line":278}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":278},"end":{"line":278}}},"arguments":[],"loc":{"start":{"line":278},"end":{"line":278}}},"loc":{"start":{"line":278},"end":{"line":278}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":279},"end":{"line":279}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":279},"end":{"line":279}}},"arguments":[],"loc":{"start":{"line":279},"end":{"line":279}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":281},"end":{"line":281}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":281},"end":{"line":281}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":281},"end":{"line":281}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":281},"end":{"line":281}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":281},"end":{"line":281}}},"arguments":[],"loc":{"start":{"line":281},"end":{"line":281}}},"loc":{"start":{"line":281},"end":{"line":281}}},"loc":{"start":{"line":281},"end":{"line":281}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":283},"end":{"line":283}}},"property":{"type":"Identifier","name":"getCategory"},"loc":{"start":{"line":283},"end":{"line":283}}},"arguments":[],"loc":{"start":{"line":283},"end":{"line":283}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":283},"end":{"line":283}}},"arguments":[{"type":"Identifier","name":"category","loc":{"start":{"line":283},"end":{"line":283}}}],"loc":{"start":{"line":283},"end":{"line":283}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":283},"end":{"line":283}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":283},"end":{"line":283}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":283},"end":{"line":283}}},"property":{"type":"Identifier","name":"getRole"},"loc":{"start":{"line":283},"end":{"line":283}}},"arguments":[],"loc":{"start":{"line":283},"end":{"line":283}}}],"loc":{"start":{"line":283},"end":{"line":283}}},"loc":{"start":{"line":283},"end":{"line":283}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessonList","loc":{"start":{"line":285},"end":{"line":285}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":285},"end":{"line":285}}},"arguments":[{"type":"Identifier","name":"lesson","loc":{"start":{"line":285},"end":{"line":285}}}],"loc":{"start":{"line":285},"end":{"line":285}}},"loc":{"start":{"line":285},"end":{"line":285}}}],"loc":{"start":{"line":284},"end":{"line":286}}},"loc":{"start":{"line":283},"end":{"line":286}}}],"loc":{"start":{"line":280},"end":{"line":287}}},"loc":{"start":{"line":279},"end":{"line":287}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Collections","loc":{"start":{"line":289},"end":{"line":289}}},"property":{"type":"Identifier","name":"sort"},"loc":{"start":{"line":289},"end":{"line":289}}},"arguments":[{"type":"Identifier","name":"lessonList","loc":{"start":{"line":289},"end":{"line":289}}}],"loc":{"start":{"line":289},"end":{"line":289}}},"loc":{"start":{"line":289},"end":{"line":289}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"lessonList","loc":{"start":{"line":291},"end":{"line":291}}},"loc":{"start":{"line":291},"end":{"line":291}}}],"loc":{"start":{"line":275},"end":{"line":292}}},"code":"\nprivate List\u003cAbstractLesson\u003e getLessons(Category category, List roles) {\n    List\u003cAbstractLesson\u003e lessonList \u003d new ArrayList\u003cAbstractLesson\u003e();\n    Iterator iter \u003d lessons.iterator();\n    while (iter.hasNext()) {\n        AbstractLesson lesson \u003d (AbstractLesson)iter.next();\n        if (lesson.getCategory().equals(category) \u0026\u0026 roles.contains(lesson.getRole())) {\n            lessonList.add(lesson);\n        }\n    }\n    Collections.sort(lessonList);\n    return lessonList;\n}","loc":{"start":{"line":274},"end":{"line":292}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessons"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":294},"end":{"line":294}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":294},"end":{"line":294}}}},{"type":"Identifier","name":"category","vartype":{"type":"Identifier","name":"Category","loc":{"start":{"line":294},"end":{"line":294}}}},{"type":"Identifier","name":"role","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":294},"end":{"line":294}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":296},"end":{"line":296}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":296},"end":{"line":296}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Vector","loc":{"start":{"line":296},"end":{"line":296}}},"arguments":[],"loc":{"start":{"line":296},"end":{"line":296}}},"loc":{"start":{"line":296},"end":{"line":296}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":297},"end":{"line":297}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":297},"end":{"line":297}}},"arguments":[{"type":"Identifier","name":"role","loc":{"start":{"line":297},"end":{"line":297}}}],"loc":{"start":{"line":297},"end":{"line":297}}},"loc":{"start":{"line":297},"end":{"line":297}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessons","loc":{"start":{"line":298},"end":{"line":298}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":298},"end":{"line":298}}},{"type":"Identifier","name":"category","loc":{"start":{"line":298},"end":{"line":298}}},{"type":"Identifier","name":"roles","loc":{"start":{"line":298},"end":{"line":298}}}],"loc":{"start":{"line":298},"end":{"line":298}}},"loc":{"start":{"line":298},"end":{"line":298}}}],"loc":{"start":{"line":295},"end":{"line":299}}},"code":"\npublic List getLessons(WebSession s, Category category, String role) {\n    List\u003cString\u003e roles \u003d new Vector\u003cString\u003e();\n    roles.add(role);\n    return getLessons(s, category, roles);\n}","loc":{"start":{"line":294},"end":{"line":299}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessons"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":301},"end":{"line":301}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":301},"end":{"line":301}}}},{"type":"Identifier","name":"category","vartype":{"type":"Identifier","name":"Category","loc":{"start":{"line":301},"end":{"line":301}}}},{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":301},"end":{"line":301}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":303},"end":{"line":303}}},"property":{"type":"Identifier","name":"isHackedAdmin"},"loc":{"start":{"line":303},"end":{"line":303}}},"arguments":[],"loc":{"start":{"line":303},"end":{"line":303}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":305},"end":{"line":305}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":305},"end":{"line":305}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":305},"end":{"line":305}}},"property":{"type":"Identifier","name":"HACKED_ADMIN_ROLE"},"loc":{"start":{"line":305},"end":{"line":305}}}],"loc":{"start":{"line":305},"end":{"line":305}}},"loc":{"start":{"line":305},"end":{"line":305}}}],"loc":{"start":{"line":304},"end":{"line":306}}},"loc":{"start":{"line":303},"end":{"line":306}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessons","loc":{"start":{"line":307},"end":{"line":307}}},"arguments":[{"type":"Identifier","name":"category","loc":{"start":{"line":307},"end":{"line":307}}},{"type":"Identifier","name":"roles","loc":{"start":{"line":307},"end":{"line":307}}}],"loc":{"start":{"line":307},"end":{"line":307}}},"loc":{"start":{"line":307},"end":{"line":307}}}],"loc":{"start":{"line":302},"end":{"line":308}}},"code":"\npublic List\u003cAbstractLesson\u003e getLessons(WebSession s, Category category, List\u003cString\u003e roles) {\n    if (s.isHackedAdmin()) {\n        roles.add(AbstractLesson.HACKED_ADMIN_ROLE);\n    }\n    return getLessons(category, roles);\n}","loc":{"start":{"line":301},"end":{"line":308}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"loadFiles"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":316},"end":{"line":316}}}},{"type":"Identifier","name":"path","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":316},"end":{"line":316}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resourcePaths","vartype":{"type":"Identifier","name":"Set","loc":{"start":{"line":318},"end":{"line":318}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Set","loc":{"start":{"line":318},"end":{"line":318}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":318},"end":{"line":318}}},"property":{"type":"Identifier","name":"getResourcePaths"},"loc":{"start":{"line":318},"end":{"line":318}}},"arguments":[{"type":"Identifier","name":"path","loc":{"start":{"line":318},"end":{"line":318}}}],"loc":{"start":{"line":318},"end":{"line":318}}},"loc":{"start":{"line":318},"end":{"line":318}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"itr","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":319},"end":{"line":319}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":319},"end":{"line":319}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"resourcePaths","loc":{"start":{"line":319},"end":{"line":319}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":319},"end":{"line":319}}},"arguments":[],"loc":{"start":{"line":319},"end":{"line":319}}},"loc":{"start":{"line":319},"end":{"line":319}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"itr","loc":{"start":{"line":321},"end":{"line":321}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":321},"end":{"line":321}}},"arguments":[],"loc":{"start":{"line":321},"end":{"line":321}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":323},"end":{"line":323}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":323},"end":{"line":323}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":323},"end":{"line":323}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"itr","loc":{"start":{"line":323},"end":{"line":323}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":323},"end":{"line":323}}},"arguments":[],"loc":{"start":{"line":323},"end":{"line":323}}},"loc":{"start":{"line":323},"end":{"line":323}}},"loc":{"start":{"line":323},"end":{"line":323}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"file","loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":325},"end":{"line":325}}},"arguments":[],"loc":{"start":{"line":325},"end":{"line":325}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":325},"end":{"line":325}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"file","loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":325},"end":{"line":325}}},"arguments":[{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":325},"end":{"line":325}}},"loc":{"start":{"line":325},"end":{"line":325}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"loadFiles","loc":{"start":{"line":327},"end":{"line":327}}},"arguments":[{"type":"Identifier","name":"context","loc":{"start":{"line":327},"end":{"line":327}}},{"type":"Identifier","name":"file","loc":{"start":{"line":327},"end":{"line":327}}}],"loc":{"start":{"line":327},"end":{"line":327}}},"loc":{"start":{"line":327},"end":{"line":327}}}],"loc":{"start":{"line":326},"end":{"line":328}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files","loc":{"start":{"line":331},"end":{"line":331}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":331},"end":{"line":331}}},"arguments":[{"type":"Identifier","name":"file","loc":{"start":{"line":331},"end":{"line":331}}}],"loc":{"start":{"line":331},"end":{"line":331}}},"loc":{"start":{"line":331},"end":{"line":331}}}],"loc":{"start":{"line":330},"end":{"line":332}}},"loc":{"start":{"line":325},"end":{"line":332}}}],"loc":{"start":{"line":322},"end":{"line":333}}},"loc":{"start":{"line":321},"end":{"line":333}}}],"loc":{"start":{"line":317},"end":{"line":334}}},"code":"\nprivate void loadFiles(ServletContext context, String path) {\n    Set resourcePaths \u003d context.getResourcePaths(path);\n    Iterator itr \u003d resourcePaths.iterator();\n    while (itr.hasNext()) {\n        String file \u003d (String)itr.next();\n        if (file.length() !\u003d 1 \u0026\u0026 file.endsWith(\"/\")) {\n            loadFiles(context, file);\n        } else {\n            files.add(file);\n        }\n    }\n}","loc":{"start":{"line":316},"end":{"line":334}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"loadLessons"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"path","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":341},"end":{"line":341}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"itr","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":343},"end":{"line":343}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":343},"end":{"line":343}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files","loc":{"start":{"line":343},"end":{"line":343}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":343},"end":{"line":343}}},"arguments":[],"loc":{"start":{"line":343},"end":{"line":343}}},"loc":{"start":{"line":343},"end":{"line":343}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"itr","loc":{"start":{"line":345},"end":{"line":345}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":345},"end":{"line":345}}},"arguments":[],"loc":{"start":{"line":345},"end":{"line":345}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":347},"end":{"line":347}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":347},"end":{"line":347}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":347},"end":{"line":347}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"itr","loc":{"start":{"line":347},"end":{"line":347}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":347},"end":{"line":347}}},"arguments":[],"loc":{"start":{"line":347},"end":{"line":347}}},"loc":{"start":{"line":347},"end":{"line":347}}},"loc":{"start":{"line":347},"end":{"line":347}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"className","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":348},"end":{"line":348}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":348},"end":{"line":348}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getClassFile","loc":{"start":{"line":348},"end":{"line":348}}},"arguments":[{"type":"Identifier","name":"file","loc":{"start":{"line":348},"end":{"line":348}}},{"type":"Identifier","name":"path","loc":{"start":{"line":348},"end":{"line":348}}}],"loc":{"start":{"line":348},"end":{"line":348}}},"loc":{"start":{"line":348},"end":{"line":348}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"className","loc":{"start":{"line":350},"end":{"line":350}}},"right":{"type":"Literal"},"loc":{"start":{"line":350},"end":{"line":350}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"className","loc":{"start":{"line":350},"end":{"line":350}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":350},"end":{"line":350}}},"arguments":[{"type":"Literal","value":"_i","raw":"_i"}],"loc":{"start":{"line":350},"end":{"line":350}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":350},"end":{"line":350}}},"loc":{"start":{"line":350},"end":{"line":350}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":369},"end":{"line":369}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":370},"end":{"line":372}}},"loc":{"start":{"line":369},"end":{"line":372}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"c","vartype":{"type":"Identifier","name":"Class","loc":{"start":{"line":354},"end":{"line":354}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Class","loc":{"start":{"line":354},"end":{"line":354}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Class","loc":{"start":{"line":354},"end":{"line":354}}},"property":{"type":"Identifier","name":"forName"},"loc":{"start":{"line":354},"end":{"line":354}}},"arguments":[{"type":"Identifier","name":"className","loc":{"start":{"line":354},"end":{"line":354}}}],"loc":{"start":{"line":354},"end":{"line":354}}},"loc":{"start":{"line":354},"end":{"line":354}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"o","vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":355},"end":{"line":355}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":355},"end":{"line":355}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"c","loc":{"start":{"line":355},"end":{"line":355}}},"property":{"type":"Identifier","name":"newInstance"},"loc":{"start":{"line":355},"end":{"line":355}}},"arguments":[],"loc":{"start":{"line":355},"end":{"line":355}}},"loc":{"start":{"line":355},"end":{"line":355}}},{"type":"IfStatement","test":{"type":"TypeTest","expression":{"type":"Identifier","name":"o","loc":{"start":{"line":357},"end":{"line":357}}},"clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":357},"end":{"line":357}}},"loc":{"start":{"line":357},"end":{"line":357}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":359},"end":{"line":359}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":359},"end":{"line":359}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":359},"end":{"line":359}}},"expression":{"type":"Identifier","name":"o","loc":{"start":{"line":359},"end":{"line":359}}},"loc":{"start":{"line":359},"end":{"line":359}}},"loc":{"start":{"line":359},"end":{"line":359}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":360},"end":{"line":360}}},"property":{"type":"Identifier","name":"setWebgoatContext"},"loc":{"start":{"line":360},"end":{"line":360}}},"arguments":[{"type":"Identifier","name":"webgoatContext","loc":{"start":{"line":360},"end":{"line":360}}}],"loc":{"start":{"line":360},"end":{"line":360}}},"loc":{"start":{"line":360},"end":{"line":360}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":362},"end":{"line":362}}},"property":{"type":"Identifier","name":"update"},"loc":{"start":{"line":362},"end":{"line":362}}},"arguments":[{"type":"Identifier","name":"properties","loc":{"start":{"line":362},"end":{"line":362}}}],"loc":{"start":{"line":362},"end":{"line":362}}},"loc":{"start":{"line":362},"end":{"line":362}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":364},"end":{"line":364}}},"property":{"type":"Identifier","name":"getHidden"},"loc":{"start":{"line":364},"end":{"line":364}}},"arguments":[],"loc":{"start":{"line":364},"end":{"line":364}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":364},"end":{"line":364}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessons","loc":{"start":{"line":366},"end":{"line":366}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":366},"end":{"line":366}}},"arguments":[{"type":"Identifier","name":"lesson","loc":{"start":{"line":366},"end":{"line":366}}}],"loc":{"start":{"line":366},"end":{"line":366}}},"loc":{"start":{"line":366},"end":{"line":366}}}],"loc":{"start":{"line":365},"end":{"line":367}}},"loc":{"start":{"line":364},"end":{"line":367}}}],"loc":{"start":{"line":358},"end":{"line":368}}},"loc":{"start":{"line":357},"end":{"line":368}}}],"loc":{"start":{"line":353},"end":{"line":369}}},"loc":{"start":{"line":352},"end":{"line":372}}}],"loc":{"start":{"line":351},"end":{"line":373}}},"loc":{"start":{"line":350},"end":{"line":373}}}],"loc":{"start":{"line":346},"end":{"line":374}}},"loc":{"start":{"line":345},"end":{"line":374}}}],"loc":{"start":{"line":342},"end":{"line":375}}},"code":"\nprivate void loadLessons(String path) {\n    Iterator itr \u003d files.iterator();\n    while (itr.hasNext()) {\n        String file \u003d (String)itr.next();\n        String className \u003d getClassFile(file, path);\n        if (className !\u003d null \u0026\u0026 !className.endsWith(\"_i\")) {\n            try {\n                Class c \u003d Class.forName(className);\n                Object o \u003d c.newInstance();\n                if (o instanceof AbstractLesson) {\n                    AbstractLesson lesson \u003d (AbstractLesson)o;\n                    lesson.setWebgoatContext(webgoatContext);\n                    lesson.update(properties);\n                    if (lesson.getHidden() \u003d\u003d false) {\n                        lessons.add(lesson);\n                    }\n                }\n            } catch (Exception e) {\n            }\n        }\n    }\n}","loc":{"start":{"line":341},"end":{"line":375}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLanguageFromFileName"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":377},"end":{"line":377}}},"typarams":[],"params":[{"type":"Identifier","name":"first","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":377},"end":{"line":377}}}},{"type":"Identifier","name":"absoluteFile","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":377},"end":{"line":377}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"p1","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":378},"end":{"line":378}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":378},"end":{"line":378}}},"arguments":[{"type":"Literal","value":"/","raw":"/"},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":378},"end":{"line":378}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":378},"end":{"line":378}}},"arguments":[{"type":"Identifier","name":"first","loc":{"start":{"line":378},"end":{"line":378}}}],"loc":{"start":{"line":378},"end":{"line":378}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":378},"end":{"line":378}}}],"loc":{"start":{"line":378},"end":{"line":378}}},"loc":{"start":{"line":378},"end":{"line":378}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"p2","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":379},"end":{"line":379}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":379},"end":{"line":379}}},"arguments":[{"type":"Literal","value":"/","raw":"/"},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"p1","loc":{"start":{"line":379},"end":{"line":379}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":379},"end":{"line":379}}}],"loc":{"start":{"line":379},"end":{"line":379}}},"loc":{"start":{"line":379},"end":{"line":379}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"langStr","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":380},"end":{"line":380}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":380},"end":{"line":380}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":380},"end":{"line":380}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":380},"end":{"line":380}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"p1","loc":{"start":{"line":380},"end":{"line":380}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":380},"end":{"line":380}}},{"type":"Identifier","name":"p2","loc":{"start":{"line":380},"end":{"line":380}}}],"loc":{"start":{"line":380},"end":{"line":380}}},"loc":{"start":{"line":380},"end":{"line":380}}},{"type":"ReturnStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"String","loc":{"start":{"line":383},"end":{"line":383}}},"arguments":[{"type":"Identifier","name":"langStr","loc":{"start":{"line":383},"end":{"line":383}}}],"loc":{"start":{"line":383},"end":{"line":383}}},"loc":{"start":{"line":383},"end":{"line":383}}}],"loc":{"start":{"line":377},"end":{"line":384}}},"code":"\nprivate String getLanguageFromFileName(String first, String absoluteFile) {\n    int p1 \u003d absoluteFile.indexOf(\"/\", absoluteFile.indexOf(first) + 1);\n    int p2 \u003d absoluteFile.indexOf(\"/\", p1 + 1);\n    String langStr \u003d absoluteFile.substring(p1 + 1, p2);\n    return new String(langStr);\n}","loc":{"start":{"line":377},"end":{"line":384}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"loadResources"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lessonItr","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":391},"end":{"line":391}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":391},"end":{"line":391}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessons","loc":{"start":{"line":391},"end":{"line":391}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":391},"end":{"line":391}}},"arguments":[],"loc":{"start":{"line":391},"end":{"line":391}}},"loc":{"start":{"line":391},"end":{"line":391}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessonItr","loc":{"start":{"line":393},"end":{"line":393}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":393},"end":{"line":393}}},"arguments":[],"loc":{"start":{"line":393},"end":{"line":393}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":395},"end":{"line":395}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":395},"end":{"line":395}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":395},"end":{"line":395}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lessonItr","loc":{"start":{"line":395},"end":{"line":395}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":395},"end":{"line":395}}},"arguments":[],"loc":{"start":{"line":395},"end":{"line":395}}},"loc":{"start":{"line":395},"end":{"line":395}}},"loc":{"start":{"line":395},"end":{"line":395}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"className","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":396},"end":{"line":396}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":396},"end":{"line":396}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":396},"end":{"line":396}}},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":396},"end":{"line":396}}},"arguments":[],"loc":{"start":{"line":396},"end":{"line":396}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":396},"end":{"line":396}}},"arguments":[],"loc":{"start":{"line":396},"end":{"line":396}}},"loc":{"start":{"line":396},"end":{"line":396}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"classFile","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":397},"end":{"line":397}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":397},"end":{"line":397}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getSourceFile","loc":{"start":{"line":397},"end":{"line":397}}},"arguments":[{"type":"Identifier","name":"className","loc":{"start":{"line":397},"end":{"line":397}}}],"loc":{"start":{"line":397},"end":{"line":397}}},"loc":{"start":{"line":397},"end":{"line":397}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileItr","vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":399},"end":{"line":399}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Iterator","loc":{"start":{"line":399},"end":{"line":399}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"files","loc":{"start":{"line":399},"end":{"line":399}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":399},"end":{"line":399}}},"arguments":[],"loc":{"start":{"line":399},"end":{"line":399}}},"loc":{"start":{"line":399},"end":{"line":399}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileItr","loc":{"start":{"line":401},"end":{"line":401}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":401},"end":{"line":401}}},"arguments":[],"loc":{"start":{"line":401},"end":{"line":401}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"absoluteFile","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":403},"end":{"line":403}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":403},"end":{"line":403}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":403},"end":{"line":403}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileItr","loc":{"start":{"line":403},"end":{"line":403}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":403},"end":{"line":403}}},"arguments":[],"loc":{"start":{"line":403},"end":{"line":403}}},"loc":{"start":{"line":403},"end":{"line":403}}},"loc":{"start":{"line":403},"end":{"line":403}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":404},"end":{"line":404}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":404},"end":{"line":404}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getFileName","loc":{"start":{"line":404},"end":{"line":404}}},"arguments":[{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":404},"end":{"line":404}}}],"loc":{"start":{"line":404},"end":{"line":404}}},"loc":{"start":{"line":404},"end":{"line":404}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":407},"end":{"line":407}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":407},"end":{"line":407}}},"arguments":[{"type":"Identifier","name":"classFile","loc":{"start":{"line":407},"end":{"line":407}}}],"loc":{"start":{"line":407},"end":{"line":407}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":410},"end":{"line":410}}},"property":{"type":"Identifier","name":"setSourceFileName"},"loc":{"start":{"line":410},"end":{"line":410}}},"arguments":[{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":410},"end":{"line":410}}}],"loc":{"start":{"line":410},"end":{"line":410}}},"loc":{"start":{"line":410},"end":{"line":410}}}],"loc":{"start":{"line":408},"end":{"line":411}}},"loc":{"start":{"line":407},"end":{"line":411}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":413},"end":{"line":413}}},"property":{"type":"Identifier","name":"startsWith"},"loc":{"start":{"line":413},"end":{"line":413}}},"arguments":[{"type":"Literal","value":"/lesson_plans","raw":"/lesson_plans"}],"loc":{"start":{"line":413},"end":{"line":413}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":413},"end":{"line":413}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":413},"end":{"line":413}}},"arguments":[{"type":"Literal","value":".html","raw":".html"}],"loc":{"start":{"line":413},"end":{"line":413}}},"loc":{"start":{"line":413},"end":{"line":413}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"className","loc":{"start":{"line":414},"end":{"line":414}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":414},"end":{"line":414}}},"arguments":[{"type":"Identifier","name":"fileName","loc":{"start":{"line":414},"end":{"line":414}}}],"loc":{"start":{"line":414},"end":{"line":414}}},"loc":{"start":{"line":413},"end":{"line":414}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"language","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":420},"end":{"line":420}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":420},"end":{"line":420}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLanguageFromFileName","loc":{"start":{"line":420},"end":{"line":420}}},"arguments":[{"type":"Literal","value":"/lesson_plans","raw":"/lesson_plans"},{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":420},"end":{"line":420}}}],"loc":{"start":{"line":420},"end":{"line":420}}},"loc":{"start":{"line":420},"end":{"line":420}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":421},"end":{"line":421}}},"property":{"type":"Identifier","name":"setLessonPlanFileName"},"loc":{"start":{"line":421},"end":{"line":421}}},"arguments":[{"type":"Identifier","name":"language","loc":{"start":{"line":421},"end":{"line":421}}},{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":421},"end":{"line":421}}}],"loc":{"start":{"line":421},"end":{"line":421}}},"loc":{"start":{"line":421},"end":{"line":421}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"webgoatContext"},"loc":{"start":{"line":422},"end":{"line":422}}},"property":{"type":"Identifier","name":"getWebgoatI18N"},"loc":{"start":{"line":422},"end":{"line":422}}},"arguments":[],"loc":{"start":{"line":422},"end":{"line":422}}},"property":{"type":"Identifier","name":"loadLanguage"},"loc":{"start":{"line":422},"end":{"line":422}}},"arguments":[{"type":"Identifier","name":"language","loc":{"start":{"line":422},"end":{"line":422}}}],"loc":{"start":{"line":422},"end":{"line":422}}},"loc":{"start":{"line":422},"end":{"line":422}}}],"loc":{"start":{"line":415},"end":{"line":423}}},"loc":{"start":{"line":413},"end":{"line":423}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":424},"end":{"line":424}}},"property":{"type":"Identifier","name":"startsWith"},"loc":{"start":{"line":424},"end":{"line":424}}},"arguments":[{"type":"Literal","value":"/lesson_solutions","raw":"/lesson_solutions"}],"loc":{"start":{"line":424},"end":{"line":424}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":424},"end":{"line":424}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":424},"end":{"line":424}}},"arguments":[{"type":"Literal","value":".html","raw":".html"}],"loc":{"start":{"line":424},"end":{"line":424}}},"loc":{"start":{"line":424},"end":{"line":424}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"className","loc":{"start":{"line":425},"end":{"line":425}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":425},"end":{"line":425}}},"arguments":[{"type":"Identifier","name":"fileName","loc":{"start":{"line":425},"end":{"line":425}}}],"loc":{"start":{"line":425},"end":{"line":425}}},"loc":{"start":{"line":424},"end":{"line":425}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":431},"end":{"line":431}}},"property":{"type":"Identifier","name":"setLessonSolutionFileName"},"loc":{"start":{"line":431},"end":{"line":431}}},"arguments":[{"type":"Identifier","name":"absoluteFile","loc":{"start":{"line":431},"end":{"line":431}}}],"loc":{"start":{"line":431},"end":{"line":431}}},"loc":{"start":{"line":431},"end":{"line":431}}}],"loc":{"start":{"line":426},"end":{"line":432}}},"loc":{"start":{"line":424},"end":{"line":432}}}],"loc":{"start":{"line":402},"end":{"line":433}}},"loc":{"start":{"line":401},"end":{"line":433}}}],"loc":{"start":{"line":394},"end":{"line":434}}},"loc":{"start":{"line":393},"end":{"line":434}}}],"loc":{"start":{"line":390},"end":{"line":435}}},"code":"\nprivate void loadResources() {\n    Iterator lessonItr \u003d lessons.iterator();\n    while (lessonItr.hasNext()) {\n        AbstractLesson lesson \u003d (AbstractLesson)lessonItr.next();\n        String className \u003d lesson.getClass().getName();\n        String classFile \u003d getSourceFile(className);\n        Iterator fileItr \u003d files.iterator();\n        while (fileItr.hasNext()) {\n            String absoluteFile \u003d (String)fileItr.next();\n            String fileName \u003d getFileName(absoluteFile);\n            if (absoluteFile.endsWith(classFile)) {\n                lesson.setSourceFileName(absoluteFile);\n            }\n            if (absoluteFile.startsWith(\"/lesson_plans\") \u0026\u0026 absoluteFile.endsWith(\".html\") \u0026\u0026 className.endsWith(fileName)) {\n                String language \u003d getLanguageFromFileName(\"/lesson_plans\", absoluteFile);\n                lesson.setLessonPlanFileName(language, absoluteFile);\n                this.webgoatContext.getWebgoatI18N().loadLanguage(language);\n            }\n            if (absoluteFile.startsWith(\"/lesson_solutions\") \u0026\u0026 absoluteFile.endsWith(\".html\") \u0026\u0026 className.endsWith(fileName)) {\n                lesson.setLessonSolutionFileName(absoluteFile);\n            }\n        }\n    }\n}","loc":{"start":{"line":389},"end":{"line":435}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"loadCourses"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"webgoatContext","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":445},"end":{"line":445}}}},{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"ServletContext","loc":{"start":{"line":445},"end":{"line":445}}}},{"type":"Identifier","name":"path","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":445},"end":{"line":445}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"webgoatContext"},"loc":{"start":{"line":447},"end":{"line":447}}},"right":{"type":"Identifier","name":"webgoatContext","loc":{"start":{"line":447},"end":{"line":447}}},"loc":{"start":{"line":447},"end":{"line":447}}},"loc":{"start":{"line":447},"end":{"line":447}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"loadFiles","loc":{"start":{"line":448},"end":{"line":448}}},"arguments":[{"type":"Identifier","name":"context","loc":{"start":{"line":448},"end":{"line":448}}},{"type":"Identifier","name":"path","loc":{"start":{"line":448},"end":{"line":448}}}],"loc":{"start":{"line":448},"end":{"line":448}}},"loc":{"start":{"line":448},"end":{"line":448}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"loadLessons","loc":{"start":{"line":449},"end":{"line":449}}},"arguments":[{"type":"Identifier","name":"path","loc":{"start":{"line":449},"end":{"line":449}}}],"loc":{"start":{"line":449},"end":{"line":449}}},"loc":{"start":{"line":449},"end":{"line":449}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"loadResources","loc":{"start":{"line":450},"end":{"line":450}}},"arguments":[],"loc":{"start":{"line":450},"end":{"line":450}}},"loc":{"start":{"line":450},"end":{"line":450}}}],"loc":{"start":{"line":446},"end":{"line":451}}},"code":"\npublic void loadCourses(WebgoatContext webgoatContext, ServletContext context, String path) {\n    this.webgoatContext \u003d webgoatContext;\n    loadFiles(context, path);\n    loadLessons(path);\n    loadResources();\n}","loc":{"start":{"line":445},"end":{"line":451}}}],"loc":{"start":{"line":51},"end":{"line":452}}}],"loc":{"start":{"line":2},"end":{"line":452}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/session/Course.java"}