{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"Hashtable"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"Map"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Authorization"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"permissions","vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":38},"end":{"line":38}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":38},"end":{"line":38}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Hashtable","loc":{"start":{"line":38},"end":{"line":38}}},"arguments":[],"loc":{"start":{"line":38},"end":{"line":38}}},"loc":{"start":{"line":38},"end":{"line":38}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":41},"end":{"line":42}}},"code":"\npublic \u003cinit\u003e() {\n}","loc":{"start":{"line":40},"end":{"line":42}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setPermission"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"functionId","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"permissions","loc":{"start":{"line":46},"end":{"line":46}}},"property":{"type":"Identifier","name":"put"},"loc":{"start":{"line":46},"end":{"line":46}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":46},"end":{"line":46}}},"arguments":[{"type":"Identifier","name":"userId","loc":{"start":{"line":46},"end":{"line":46}}}],"loc":{"start":{"line":46},"end":{"line":46}}},{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":46},"end":{"line":46}}},"arguments":[{"type":"Identifier","name":"functionId","loc":{"start":{"line":46},"end":{"line":46}}}],"loc":{"start":{"line":46},"end":{"line":46}}}],"loc":{"start":{"line":46},"end":{"line":46}}},"loc":{"start":{"line":46},"end":{"line":46}}}],"loc":{"start":{"line":45},"end":{"line":47}}},"code":"\npublic void setPermission(int userId, int functionId) {\n    permissions.put(new Integer(userId), new Integer(functionId));\n}","loc":{"start":{"line":44},"end":{"line":47}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"isAllowed"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"functionId","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"permissions","loc":{"start":{"line":51},"end":{"line":51}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":51},"end":{"line":51}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":51},"end":{"line":51}}},"arguments":[{"type":"Identifier","name":"userId","loc":{"start":{"line":51},"end":{"line":51}}}],"loc":{"start":{"line":51},"end":{"line":51}}}],"loc":{"start":{"line":51},"end":{"line":51}}},"right":{"type":"Literal"},"loc":{"start":{"line":51},"end":{"line":51}}},"loc":{"start":{"line":51},"end":{"line":51}}}],"loc":{"start":{"line":50},"end":{"line":52}}},"code":"\npublic boolean isAllowed(int userId, int functionId) {\n    return (permissions.get(new Integer(userId)) !\u003d null);\n}","loc":{"start":{"line":49},"end":{"line":52}}}],"loc":{"start":{"line":35},"end":{"line":53}}}],"loc":{"start":{"line":2},"end":{"line":53}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/session/Authorization.java"}