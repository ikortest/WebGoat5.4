{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"DriverManager"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"ResultSetMetaData"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"SQLException"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"HashMap"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"Map"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"MultiPartElement"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"B"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"TD"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"TR"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"Table"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"DatabaseUtilities"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connections","vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":51},"end":{"line":51}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":51},"end":{"line":51}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":51},"end":{"line":51}}},"arguments":[],"loc":{"start":{"line":51},"end":{"line":51}}},"loc":{"start":{"line":51},"end":{"line":51}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"dbBuilt","vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":52},"end":{"line":52}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"Map","loc":{"start":{"line":52},"end":{"line":52}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[],"loc":{"start":{"line":52},"end":{"line":52}}},"loc":{"start":{"line":52},"end":{"line":52}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getConnection"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":54},"end":{"line":54}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":54},"end":{"line":54}}}}],"thrown":[{"type":"Identifier","name":"SQLException","loc":{"start":{"line":54},"end":{"line":54}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getConnection","loc":{"start":{"line":56},"end":{"line":56}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":56},"end":{"line":56}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":56},"end":{"line":56}}},"arguments":[],"loc":{"start":{"line":56},"end":{"line":56}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":56},"end":{"line":56}}},"property":{"type":"Identifier","name":"getWebgoatContext"},"loc":{"start":{"line":56},"end":{"line":56}}},"arguments":[],"loc":{"start":{"line":56},"end":{"line":56}}}],"loc":{"start":{"line":56},"end":{"line":56}}},"loc":{"start":{"line":56},"end":{"line":56}}}],"loc":{"start":{"line":55},"end":{"line":57}}},"code":"\npublic static Connection getConnection(WebSession s) throws SQLException {\n    return getConnection(s.getUserName(), s.getWebgoatContext());\n}","loc":{"start":{"line":54},"end":{"line":57}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getConnection"},"modifiers":{"type":"Modifiers","modifiers":["public","static","synchronized"],"annotations":[]},"restype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":59},"end":{"line":59}}},"typarams":[],"params":[{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}}},{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":59},"end":{"line":59}}}}],"thrown":[{"type":"Identifier","name":"SQLException","loc":{"start":{"line":59},"end":{"line":59}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"conn","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":61},"end":{"line":61}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":61},"end":{"line":61}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connections","loc":{"start":{"line":61},"end":{"line":61}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":61},"end":{"line":61}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":61},"end":{"line":61}}}],"loc":{"start":{"line":61},"end":{"line":61}}},"loc":{"start":{"line":61},"end":{"line":61}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"conn","loc":{"start":{"line":62},"end":{"line":62}}},"right":{"type":"Literal"},"loc":{"start":{"line":62},"end":{"line":62}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"conn","loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"isClosed"},"loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[],"loc":{"start":{"line":62},"end":{"line":62}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},"consequent":{"type":"ReturnStatement","argument":{"type":"Identifier","name":"conn","loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"conn","loc":{"start":{"line":63},"end":{"line":63}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeConnection","loc":{"start":{"line":63},"end":{"line":63}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":63},"end":{"line":63}}},{"type":"Identifier","name":"context","loc":{"start":{"line":63},"end":{"line":63}}}],"loc":{"start":{"line":63},"end":{"line":63}}},"loc":{"start":{"line":63},"end":{"line":63}}},"loc":{"start":{"line":63},"end":{"line":63}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connections","loc":{"start":{"line":64},"end":{"line":64}}},"property":{"type":"Identifier","name":"put"},"loc":{"start":{"line":64},"end":{"line":64}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":64},"end":{"line":64}}},{"type":"Identifier","name":"conn","loc":{"start":{"line":64},"end":{"line":64}}}],"loc":{"start":{"line":64},"end":{"line":64}}},"loc":{"start":{"line":64},"end":{"line":64}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"dbBuilt","loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":66},"end":{"line":66}}},"right":{"type":"Literal"},"loc":{"start":{"line":66},"end":{"line":66}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"CreateDB","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[],"loc":{"start":{"line":68},"end":{"line":68}}},"property":{"type":"Identifier","name":"makeDB"},"loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"Identifier","name":"conn","loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"dbBuilt","loc":{"start":{"line":69},"end":{"line":69}}},"property":{"type":"Identifier","name":"put"},"loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":69},"end":{"line":69}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"Boolean","loc":{"start":{"line":69},"end":{"line":69}}},"property":{"type":"Identifier","name":"TRUE"},"loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":69},"end":{"line":69}}},"loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":67},"end":{"line":70}}},"loc":{"start":{"line":66},"end":{"line":70}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"conn","loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":60},"end":{"line":73}}},"code":"\npublic static synchronized Connection getConnection(String user, WebgoatContext context) throws SQLException {\n    Connection conn \u003d connections.get(user);\n    if (conn !\u003d null \u0026\u0026 !conn.isClosed()) return conn;\n    conn \u003d makeConnection(user, context);\n    connections.put(user, conn);\n    if (dbBuilt.get(user) \u003d\u003d null) {\n        new CreateDB().makeDB(conn);\n        dbBuilt.put(user, Boolean.TRUE);\n    }\n    return conn;\n}","loc":{"start":{"line":59},"end":{"line":73}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"returnConnection"},"modifiers":{"type":"Modifiers","modifiers":["public","static","synchronized"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":75},"end":{"line":75}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"sqle","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":83},"end":{"line":83}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqle","loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":85},"end":{"line":85}}},"arguments":[],"loc":{"start":{"line":85},"end":{"line":85}}},"loc":{"start":{"line":85},"end":{"line":85}}}],"loc":{"start":{"line":84},"end":{"line":86}}},"loc":{"start":{"line":83},"end":{"line":86}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":79},"end":{"line":79}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":79},"end":{"line":79}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connections","loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"connection","loc":{"start":{"line":80},"end":{"line":80}}},"right":{"type":"Literal"},"loc":{"start":{"line":80},"end":{"line":80}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"isClosed"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[],"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},"consequent":{"type":"ReturnStatement","loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"getMetaData"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[],"loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"getDatabaseProductName"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[],"loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[],"loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"Literal","value":"oracle","raw":"oracle"}],"loc":{"start":{"line":82},"end":{"line":82}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[],"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":78},"end":{"line":83}}},"loc":{"start":{"line":77},"end":{"line":86}}}],"loc":{"start":{"line":76},"end":{"line":87}}},"code":"\npublic static synchronized void returnConnection(String user) {\n    try {\n        Connection connection \u003d connections.get(user);\n        if (connection \u003d\u003d null || connection.isClosed()) return;\n        if (connection.getMetaData().getDatabaseProductName().toLowerCase().contains(\"oracle\")) connection.close();\n    } catch (SQLException sqle) {\n        sqle.printStackTrace();\n    }\n}","loc":{"start":{"line":75},"end":{"line":87}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"makeConnection"},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"restype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":89},"end":{"line":89}}},"typarams":[],"params":[{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":89},"end":{"line":89}}}},{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":89},"end":{"line":89}}}}],"thrown":[{"type":"Identifier","name":"SQLException","loc":{"start":{"line":89},"end":{"line":89}}}],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"cnfe","vartype":{"type":"Identifier","name":"ClassNotFoundException","loc":{"start":{"line":101},"end":{"line":101}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"cnfe","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[],"loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}},{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Couldn\u0027t load the database driver: ","raw":"Couldn\u0027t load the database driver: "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"cnfe","loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"getLocalizedMessage"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":102},"end":{"line":105}}},"loc":{"start":{"line":101},"end":{"line":105}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Class","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"forName"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"getDatabaseDriver"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":93}}}],"loc":{"start":{"line":93},"end":{"line":93}}},"loc":{"start":{"line":93},"end":{"line":93}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":95},"end":{"line":95}}},"property":{"type":"Identifier","name":"getDatabaseConnectionString"},"loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[],"loc":{"start":{"line":95},"end":{"line":95}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[{"type":"Literal","value":"hsqldb","raw":"hsqldb"}],"loc":{"start":{"line":95},"end":{"line":95}}},"consequent":{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getHsqldbConnection","loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":95},"end":{"line":95}}},{"type":"Identifier","name":"context","loc":{"start":{"line":95},"end":{"line":95}}}],"loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":95},"end":{"line":95}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userPrefix","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":97},"end":{"line":97}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":97},"end":{"line":97}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":97},"end":{"line":97}}},"property":{"type":"Identifier","name":"getDatabaseUser"},"loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[],"loc":{"start":{"line":97},"end":{"line":97}}},"loc":{"start":{"line":97},"end":{"line":97}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"password","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":98},"end":{"line":98}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":98},"end":{"line":98}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":98},"end":{"line":98}}},"property":{"type":"Identifier","name":"getDatabasePassword"},"loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[],"loc":{"start":{"line":98},"end":{"line":98}}},"loc":{"start":{"line":98},"end":{"line":98}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"url","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":99},"end":{"line":99}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":99},"end":{"line":99}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"getDatabaseConnectionString"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DriverManager","loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"Identifier","name":"url","loc":{"start":{"line":100},"end":{"line":100}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"userPrefix","loc":{"start":{"line":100},"end":{"line":100}}},"right":{"type":"Literal","value":"_","raw":"_"},"loc":{"start":{"line":100},"end":{"line":100}}},"right":{"type":"Identifier","name":"user","loc":{"start":{"line":100},"end":{"line":100}}},"loc":{"start":{"line":100},"end":{"line":100}}},{"type":"Identifier","name":"password","loc":{"start":{"line":100},"end":{"line":100}}}],"loc":{"start":{"line":100},"end":{"line":100}}},"loc":{"start":{"line":100},"end":{"line":100}}}],"loc":{"start":{"line":92},"end":{"line":101}}},"loc":{"start":{"line":91},"end":{"line":105}}}],"loc":{"start":{"line":90},"end":{"line":106}}},"code":"\nprivate static Connection makeConnection(String user, WebgoatContext context) throws SQLException {\n    try {\n        Class.forName(context.getDatabaseDriver());\n        if (context.getDatabaseConnectionString().contains(\"hsqldb\")) return getHsqldbConnection(user, context);\n        String userPrefix \u003d context.getDatabaseUser();\n        String password \u003d context.getDatabasePassword();\n        String url \u003d context.getDatabaseConnectionString();\n        return DriverManager.getConnection(url, userPrefix + \"_\" + user, password);\n    } catch (ClassNotFoundException cnfe) {\n        cnfe.printStackTrace();\n        throw new SQLException(\"Couldn\\\u0027t load the database driver: \" + cnfe.getLocalizedMessage());\n    }\n}","loc":{"start":{"line":89},"end":{"line":106}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHsqldbConnection"},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"restype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":108},"end":{"line":108}}},"typarams":[],"params":[{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":108},"end":{"line":108}}}},{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":108},"end":{"line":108}}}}],"thrown":[{"type":"Identifier","name":"ClassNotFoundException","loc":{"start":{"line":108},"end":{"line":108}}},{"type":"Identifier","name":"SQLException","loc":{"start":{"line":109},"end":{"line":109}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"url","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":111},"end":{"line":111}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":111},"end":{"line":111}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"getDatabaseConnectionString"},"loc":{"start":{"line":111},"end":{"line":111}}},"arguments":[],"loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":111},"end":{"line":111}}},"arguments":[{"type":"Literal","value":"\\$\\{USER\\}","raw":"\\$\\{USER\\}"},{"type":"Identifier","name":"user","loc":{"start":{"line":111},"end":{"line":111}}}],"loc":{"start":{"line":111},"end":{"line":111}}},"loc":{"start":{"line":111},"end":{"line":111}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DriverManager","loc":{"start":{"line":112},"end":{"line":112}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":112},"end":{"line":112}}},"arguments":[{"type":"Identifier","name":"url","loc":{"start":{"line":112},"end":{"line":112}}},{"type":"Literal","value":"sa","raw":"sa"},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":112},"end":{"line":112}}},"loc":{"start":{"line":112},"end":{"line":112}}}],"loc":{"start":{"line":110},"end":{"line":113}}},"code":"\nprivate static Connection getHsqldbConnection(String user, WebgoatContext context) throws ClassNotFoundException, SQLException {\n    String url \u003d context.getDatabaseConnectionString().replaceAll(\"\\\\$\\\\{USER\\\\}\", user);\n    return DriverManager.getConnection(url, \"sa\", \"\");\n}","loc":{"start":{"line":108},"end":{"line":113}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"writeTable"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"Identifier","name":"MultiPartElement","loc":{"start":{"line":130},"end":{"line":130}}},"typarams":[],"params":[{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":130},"end":{"line":130}}}},{"type":"Identifier","name":"resultsMetaData","vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":130},"end":{"line":130}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":130},"end":{"line":130}}},{"type":"Identifier","name":"SQLException","loc":{"start":{"line":131},"end":{"line":131}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"numColumns","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"resultsMetaData","loc":{"start":{"line":133},"end":{"line":133}}},"property":{"type":"Identifier","name":"getColumnCount"},"loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[],"loc":{"start":{"line":133},"end":{"line":133}}},"loc":{"start":{"line":133},"end":{"line":133}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":134},"end":{"line":134}}},"property":{"type":"Identifier","name":"beforeFirst"},"loc":{"start":{"line":134},"end":{"line":134}}},"arguments":[],"loc":{"start":{"line":134},"end":{"line":134}}},"loc":{"start":{"line":134},"end":{"line":134}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":136},"end":{"line":136}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":136},"end":{"line":136}}},"arguments":[],"loc":{"start":{"line":136},"end":{"line":136}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":138},"end":{"line":138}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":138},"end":{"line":138}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Table","loc":{"start":{"line":138},"end":{"line":138}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":138},"end":{"line":138}}},"loc":{"start":{"line":138},"end":{"line":138}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":139},"end":{"line":139}}},"property":{"type":"Identifier","name":"setCellPadding"},"loc":{"start":{"line":139},"end":{"line":139}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":139},"end":{"line":139}}},"loc":{"start":{"line":139},"end":{"line":139}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tr","vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":141},"end":{"line":141}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":141},"end":{"line":141}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[],"loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}},{"type":"ForStatement","init":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"i","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":143},"end":{"line":143}}}],"test":{"type":"BinaryExpression","operator":"LESS_THAN","left":{"type":"Identifier","name":"i","loc":{"start":{"line":143},"end":{"line":143}}},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"numColumns","loc":{"start":{"line":143},"end":{"line":143}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}},"update":[{"type":"ExpressionStatement","expression":{"argument":{"type":"Identifier","name":"i","loc":{"start":{"line":143},"end":{"line":143}}},"type":"UpdateExpression","operator":"++","prefix":false},"loc":{"start":{"line":143},"end":{"line":143}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":145},"end":{"line":145}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":145},"end":{"line":145}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":145},"end":{"line":145}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"B","loc":{"start":{"line":145},"end":{"line":145}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"resultsMetaData","loc":{"start":{"line":145},"end":{"line":145}}},"property":{"type":"Identifier","name":"getColumnName"},"loc":{"start":{"line":145},"end":{"line":145}}},"arguments":[{"type":"Identifier","name":"i","loc":{"start":{"line":145},"end":{"line":145}}}],"loc":{"start":{"line":145},"end":{"line":145}}}],"loc":{"start":{"line":145},"end":{"line":145}}}],"loc":{"start":{"line":145},"end":{"line":145}}}],"loc":{"start":{"line":145},"end":{"line":145}}},"loc":{"start":{"line":145},"end":{"line":145}}}],"loc":{"start":{"line":144},"end":{"line":146}}},"loc":{"start":{"line":143},"end":{"line":146}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":148},"end":{"line":148}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":148},"end":{"line":148}}}],"loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":149},"end":{"line":149}}},"property":{"type":"Identifier","name":"beforeFirst"},"loc":{"start":{"line":149},"end":{"line":149}}},"arguments":[],"loc":{"start":{"line":149},"end":{"line":149}}},"loc":{"start":{"line":149},"end":{"line":149}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":151},"end":{"line":151}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":151},"end":{"line":151}}},"arguments":[],"loc":{"start":{"line":151},"end":{"line":151}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"row","vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":153},"end":{"line":153}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":153},"end":{"line":153}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":153},"end":{"line":153}}},"arguments":[],"loc":{"start":{"line":153},"end":{"line":153}}},"loc":{"start":{"line":153},"end":{"line":153}}},{"type":"ForStatement","init":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"i","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":155},"end":{"line":155}}}],"test":{"type":"BinaryExpression","operator":"LESS_THAN","left":{"type":"Identifier","name":"i","loc":{"start":{"line":155},"end":{"line":155}}},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"numColumns","loc":{"start":{"line":155},"end":{"line":155}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":155},"end":{"line":155}}},"loc":{"start":{"line":155},"end":{"line":155}}},"update":[{"type":"ExpressionStatement","expression":{"argument":{"type":"Identifier","name":"i","loc":{"start":{"line":155},"end":{"line":155}}},"type":"UpdateExpression","operator":"++","prefix":false},"loc":{"start":{"line":155},"end":{"line":155}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"str","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":157},"end":{"line":157}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":157},"end":{"line":157}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":157},"end":{"line":157}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":157},"end":{"line":157}}},"arguments":[{"type":"Identifier","name":"i","loc":{"start":{"line":157},"end":{"line":157}}}],"loc":{"start":{"line":157},"end":{"line":157}}},"loc":{"start":{"line":157},"end":{"line":157}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"str","loc":{"start":{"line":158},"end":{"line":158}}},"right":{"type":"Literal"},"loc":{"start":{"line":158},"end":{"line":158}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"str","loc":{"start":{"line":158},"end":{"line":158}}},"right":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"row","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"str","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"Literal","value":" ","raw":" "},{"type":"Literal","value":"\u0026nbsp;","raw":"\u0026nbsp;"}],"loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":159},"end":{"line":159}}},"loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":156},"end":{"line":160}}},"loc":{"start":{"line":155},"end":{"line":160}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"Identifier","name":"row","loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":152},"end":{"line":163}}},"loc":{"start":{"line":151},"end":{"line":163}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"t","loc":{"start":{"line":165},"end":{"line":165}}},"loc":{"start":{"line":165},"end":{"line":165}}}],"loc":{"start":{"line":137},"end":{"line":166}}},"alternate":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"B","loc":{"start":{"line":169},"end":{"line":169}}},"arguments":[{"type":"Literal","value":"Query Successful; however no data was returned from this query.","raw":"Query Successful; however no data was returned from this query."}],"loc":{"start":{"line":169},"end":{"line":169}}},"loc":{"start":{"line":169},"end":{"line":169}}}],"loc":{"start":{"line":168},"end":{"line":170}}},"loc":{"start":{"line":136},"end":{"line":170}}}],"loc":{"start":{"line":132},"end":{"line":171}}},"code":"\npublic static MultiPartElement writeTable(ResultSet results, ResultSetMetaData resultsMetaData) throws IOException, SQLException {\n    int numColumns \u003d resultsMetaData.getColumnCount();\n    results.beforeFirst();\n    if (results.next()) {\n        Table t \u003d new Table(1);\n        t.setCellPadding(1);\n        TR tr \u003d new TR();\n        for (int i \u003d 1; i \u003c (numColumns + 1); i++) {\n            tr.addElement(new TD(new B(resultsMetaData.getColumnName(i))));\n        }\n        t.addElement(tr);\n        results.beforeFirst();\n        while (results.next()) {\n            TR row \u003d new TR();\n            for (int i \u003d 1; i \u003c (numColumns + 1); i++) {\n                String str \u003d results.getString(i);\n                if (str \u003d\u003d null) str \u003d \"\";\n                row.addElement(new TD(str.replaceAll(\" \", \"\u0026nbsp;\")));\n            }\n            t.addElement(row);\n        }\n        return (t);\n    } else {\n        return (new B(\"Query Successful; however no data was returned from this query.\"));\n    }\n}","loc":{"start":{"line":130},"end":{"line":171}}}],"loc":{"start":{"line":48},"end":{"line":173}}}],"loc":{"start":{"line":2},"end":{"line":173}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/session/DatabaseUtilities.java"}