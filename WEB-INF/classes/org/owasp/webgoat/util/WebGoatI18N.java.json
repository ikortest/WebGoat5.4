{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1},"end":{"line":1}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1},"end":{"line":1}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1},"end":{"line":1}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":1},"end":{"line":1}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":3},"end":{"line":3}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":3},"end":{"line":3}}},"property":{"type":"Identifier","name":"HashMap"},"loc":{"start":{"line":3},"end":{"line":3}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"Locale"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"ResourceBundle"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"WebgoatContext"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"WebGoatI18N"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"labels","vartype":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":11},"end":{"line":11}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":11},"end":{"line":11}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"HashMap","loc":{"start":{"line":11},"end":{"line":11}}},"arguments":[],"loc":{"start":{"line":11},"end":{"line":11}}},"loc":{"start":{"line":11},"end":{"line":11}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"defaultLanguage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":12},"end":{"line":12}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":12},"end":{"line":12}}},"loc":{"start":{"line":12},"end":{"line":12}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"currentLanguage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":13},"end":{"line":13}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":13},"end":{"line":13}}},"loc":{"start":{"line":13},"end":{"line":13}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[{"type":"Identifier","name":"context","vartype":{"type":"Identifier","name":"WebgoatContext","loc":{"start":{"line":15},"end":{"line":15}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"l","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":16},"end":{"line":16}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":16},"end":{"line":16}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Locale","loc":{"start":{"line":16},"end":{"line":16}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"getDefaultLanguage"},"loc":{"start":{"line":16},"end":{"line":16}}},"arguments":[],"loc":{"start":{"line":16},"end":{"line":16}}}],"loc":{"start":{"line":16},"end":{"line":16}}},"loc":{"start":{"line":16},"end":{"line":16}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"defaultLanguage"},"loc":{"start":{"line":17},"end":{"line":17}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"getDefaultLanguage"},"loc":{"start":{"line":17},"end":{"line":17}}},"arguments":[],"loc":{"start":{"line":17},"end":{"line":17}}},"loc":{"start":{"line":17},"end":{"line":17}}},"loc":{"start":{"line":17},"end":{"line":17}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"put"},"loc":{"start":{"line":18},"end":{"line":18}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"context","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"getDefaultLanguage"},"loc":{"start":{"line":18},"end":{"line":18}}},"arguments":[],"loc":{"start":{"line":18},"end":{"line":18}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ResourceBundle","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"getBundle"},"loc":{"start":{"line":18},"end":{"line":18}}},"arguments":[{"type":"Literal","value":"WebGoatLabels_english","raw":"WebGoatLabels_english"},{"type":"Identifier","name":"l","loc":{"start":{"line":18},"end":{"line":18}}}],"loc":{"start":{"line":18},"end":{"line":18}}}],"loc":{"start":{"line":18},"end":{"line":18}}},"loc":{"start":{"line":18},"end":{"line":18}}}],"loc":{"start":{"line":15},"end":{"line":19}}},"code":"\npublic \u003cinit\u003e(WebgoatContext context) {\n    Locale l \u003d new Locale(context.getDefaultLanguage());\n    WebGoatI18N.defaultLanguage \u003d context.getDefaultLanguage();\n    labels.put(context.getDefaultLanguage(), ResourceBundle.getBundle(\"WebGoatLabels_english\", l));\n}","loc":{"start":{"line":15},"end":{"line":19}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"loadLanguage"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"language","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":21},"end":{"line":21}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"l","vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":22},"end":{"line":22}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Locale","loc":{"start":{"line":22},"end":{"line":22}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Locale","loc":{"start":{"line":22},"end":{"line":22}}},"arguments":[{"type":"Identifier","name":"language","loc":{"start":{"line":22},"end":{"line":22}}}],"loc":{"start":{"line":22},"end":{"line":22}}},"loc":{"start":{"line":22},"end":{"line":22}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"put"},"loc":{"start":{"line":23},"end":{"line":23}}},"arguments":[{"type":"Identifier","name":"language","loc":{"start":{"line":23},"end":{"line":23}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ResourceBundle","loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"getBundle"},"loc":{"start":{"line":23},"end":{"line":23}}},"arguments":[{"type":"Literal","value":"WebGoatLabels_english","raw":"WebGoatLabels_english"},{"type":"Identifier","name":"l","loc":{"start":{"line":23},"end":{"line":23}}}],"loc":{"start":{"line":23},"end":{"line":23}}}],"loc":{"start":{"line":23},"end":{"line":23}}},"loc":{"start":{"line":23},"end":{"line":23}}}],"loc":{"start":{"line":21},"end":{"line":24}}},"code":"\npublic static void loadLanguage(String language) {\n    Locale l \u003d new Locale(language);\n    labels.put(language, ResourceBundle.getBundle(\"WebGoatLabels_english\", l));\n}","loc":{"start":{"line":21},"end":{"line":24}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setCurrentLanguage"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"language","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":26},"end":{"line":26}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":27},"end":{"line":27}}},"property":{"type":"Identifier","name":"currentLanguage"},"loc":{"start":{"line":27},"end":{"line":27}}},"right":{"type":"Identifier","name":"language","loc":{"start":{"line":27},"end":{"line":27}}},"loc":{"start":{"line":27},"end":{"line":27}}},"loc":{"start":{"line":27},"end":{"line":27}}}],"loc":{"start":{"line":26},"end":{"line":28}}},"code":"\npublic static void setCurrentLanguage(String language) {\n    WebGoatI18N.currentLanguage \u003d language;\n}","loc":{"start":{"line":26},"end":{"line":28}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"get"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":30},"end":{"line":30}}},"typarams":[],"params":[{"type":"Identifier","name":"strName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":30},"end":{"line":30}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":31},"end":{"line":31}}},"property":{"type":"Identifier","name":"containsKey"},"loc":{"start":{"line":31},"end":{"line":31}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":31},"end":{"line":31}}},"property":{"type":"Identifier","name":"currentLanguage"},"loc":{"start":{"line":31},"end":{"line":31}}}],"loc":{"start":{"line":31},"end":{"line":31}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":32},"end":{"line":32}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":32},"end":{"line":32}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":32},"end":{"line":32}}},"property":{"type":"Identifier","name":"currentLanguage"},"loc":{"start":{"line":32},"end":{"line":32}}}],"loc":{"start":{"line":32},"end":{"line":32}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":32},"end":{"line":32}}},"arguments":[{"type":"Identifier","name":"strName","loc":{"start":{"line":32},"end":{"line":32}}}],"loc":{"start":{"line":32},"end":{"line":32}}},"loc":{"start":{"line":32},"end":{"line":32}}}],"loc":{"start":{"line":31},"end":{"line":33}}},"alternate":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"labels","loc":{"start":{"line":35},"end":{"line":35}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":35},"end":{"line":35}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":35},"end":{"line":35}}},"property":{"type":"Identifier","name":"defaultLanguage"},"loc":{"start":{"line":35},"end":{"line":35}}}],"loc":{"start":{"line":35},"end":{"line":35}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":35},"end":{"line":35}}},"arguments":[{"type":"Identifier","name":"strName","loc":{"start":{"line":35},"end":{"line":35}}}],"loc":{"start":{"line":35},"end":{"line":35}}},"loc":{"start":{"line":35},"end":{"line":35}}}],"loc":{"start":{"line":34},"end":{"line":36}}},"loc":{"start":{"line":31},"end":{"line":36}}}],"loc":{"start":{"line":30},"end":{"line":37}}},"code":"\npublic static String get(String strName) {\n    if (labels.containsKey(WebGoatI18N.currentLanguage)) {\n        return labels.get(WebGoatI18N.currentLanguage).getString(strName);\n    } else {\n        return labels.get(WebGoatI18N.defaultLanguage).getString(strName);\n    }\n}","loc":{"start":{"line":30},"end":{"line":37}}}],"loc":{"start":{"line":9},"end":{"line":41}}}],"loc":{"start":{"line":1},"end":{"line":41}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/util/WebGoatI18N.java"}