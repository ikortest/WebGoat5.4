{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"BitSet"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"ThreadWatcher"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"myInterrupted","vartype":{"type":"Identifier","name":"BitSet","loc":{"start":{"line":41},"end":{"line":41}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"BitSet","loc":{"start":{"line":41},"end":{"line":41}}},"loc":{"start":{"line":41},"end":{"line":41}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"myProcess","vartype":{"type":"Identifier","name":"Process","loc":{"start":{"line":43},"end":{"line":43}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"Process","loc":{"start":{"line":43},"end":{"line":43}}},"loc":{"start":{"line":43},"end":{"line":43}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"myTimeout","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"loc":{"start":{"line":45},"end":{"line":45}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[{"type":"Identifier","name":"p","vartype":{"type":"Identifier","name":"Process","loc":{"start":{"line":57},"end":{"line":57}}}},{"type":"Identifier","name":"interrupted","vartype":{"type":"Identifier","name":"BitSet","loc":{"start":{"line":57},"end":{"line":57}}}},{"type":"Identifier","name":"timeout","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"myProcess","loc":{"start":{"line":59},"end":{"line":59}}},"right":{"type":"Identifier","name":"p","loc":{"start":{"line":59},"end":{"line":59}}},"loc":{"start":{"line":59},"end":{"line":59}}},"loc":{"start":{"line":59},"end":{"line":59}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"myTimeout","loc":{"start":{"line":62},"end":{"line":62}}},"right":{"type":"Identifier","name":"timeout","loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"myInterrupted","loc":{"start":{"line":63},"end":{"line":63}}},"right":{"type":"Identifier","name":"interrupted","loc":{"start":{"line":63},"end":{"line":63}}},"loc":{"start":{"line":63},"end":{"line":63}}},"loc":{"start":{"line":63},"end":{"line":63}}}],"loc":{"start":{"line":58},"end":{"line":64}}},"code":"\npublic \u003cinit\u003e(Process p, BitSet interrupted, int timeout) {\n    myProcess \u003d p;\n    myTimeout \u003d timeout;\n    myInterrupted \u003d interrupted;\n}","loc":{"start":{"line":57},"end":{"line":64}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"interrupt"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"myInterrupted","loc":{"start":{"line":75},"end":{"line":75}}},"property":{"type":"Identifier","name":"set"},"loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"myProcess","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"destroy"},"loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":74},"end":{"line":86}}},"code":"\npublic void interrupt() {\n    myInterrupted.set(0);\n    myProcess.destroy();\n}","loc":{"start":{"line":73},"end":{"line":86}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"run"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"InterruptedException","loc":{"start":{"line":96},"end":{"line":96}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":97},"end":{"line":99}}},"loc":{"start":{"line":96},"end":{"line":99}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Thread","loc":{"start":{"line":95},"end":{"line":95}}},"property":{"type":"Identifier","name":"sleep"},"loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[{"type":"Identifier","name":"myTimeout","loc":{"start":{"line":95},"end":{"line":95}}}],"loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":95},"end":{"line":95}}}],"loc":{"start":{"line":94},"end":{"line":96}}},"loc":{"start":{"line":93},"end":{"line":99}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"interrupt","loc":{"start":{"line":101},"end":{"line":101}}},"arguments":[],"loc":{"start":{"line":101},"end":{"line":101}}},"loc":{"start":{"line":101},"end":{"line":101}}}],"loc":{"start":{"line":92},"end":{"line":102}}},"code":"\npublic void run() {\n    try {\n        Thread.sleep(myTimeout);\n    } catch (InterruptedException e) {\n    }\n    interrupt();\n}","loc":{"start":{"line":91},"end":{"line":102}}}],"loc":{"start":{"line":37},"end":{"line":103}}}],"loc":{"start":{"line":2},"end":{"line":103}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/util/ThreadWatcher.java"}