{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"BufferedReader"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"PrintWriter"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"InputStreamReader"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"net"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"UnknownHostException"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"net"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"Socket"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"Filter"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"FilterChain"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"FilterConfig"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"ServletException"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"ServletRequest"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"ServletResponse"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"RequestDispatcher"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Interceptor"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"OSG_SERVER_NAME","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":56},"end":{"line":56}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":56},"end":{"line":56}}},"init":{"type":"Literal","value":"OSGServerName","raw":"OSGServerName"},"loc":{"start":{"line":56},"end":{"line":56}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"OSG_SERVER_PORT","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}},"init":{"type":"Literal","value":"OSGServerPort","raw":"OSGServerPort"},"loc":{"start":{"line":58},"end":{"line":58}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"destroy"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":65},"end":{"line":68}}},"code":"\npublic void destroy() {\n}","loc":{"start":{"line":64},"end":{"line":68}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doFilter"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"ServletRequest","loc":{"start":{"line":70},"end":{"line":70}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"ServletResponse","loc":{"start":{"line":70},"end":{"line":70}}}},{"type":"Identifier","name":"chain","vartype":{"type":"Identifier","name":"FilterChain","loc":{"start":{"line":70},"end":{"line":70}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":70},"end":{"line":70}}},{"type":"Identifier","name":"ServletException","loc":{"start":{"line":71},"end":{"line":71}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"req","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":74},"end":{"line":74}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":74},"end":{"line":74}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":74},"end":{"line":74}}},"expression":{"type":"Identifier","name":"request","loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"osgSocket","vartype":{"type":"Identifier","name":"Socket","loc":{"start":{"line":76},"end":{"line":76}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Socket","loc":{"start":{"line":76},"end":{"line":76}}},"init":{"type":"Literal"},"loc":{"start":{"line":76},"end":{"line":76}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"out","vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":77},"end":{"line":77}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":77},"end":{"line":77}}},"init":{"type":"Literal"},"loc":{"start":{"line":77},"end":{"line":77}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"in","vartype":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":78},"end":{"line":78}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":78},"end":{"line":78}}},"init":{"type":"Literal"},"loc":{"start":{"line":78},"end":{"line":78}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"osgServerName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":79},"end":{"line":79}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":79},"end":{"line":79}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req","loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[],"loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"getServletContext"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[],"loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"getInitParameter"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"Identifier","name":"OSG_SERVER_NAME","loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"osgServerPort","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":80},"end":{"line":80}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":80},"end":{"line":80}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req","loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[],"loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"getServletContext"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[],"loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"getInitParameter"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"Identifier","name":"OSG_SERVER_PORT","loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},{"type":"TryStatement","finalizer":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"out","loc":{"start":{"line":110},"end":{"line":110}}},"right":{"type":"Literal"},"loc":{"start":{"line":110},"end":{"line":110}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"out","loc":{"start":{"line":112},"end":{"line":112}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":112},"end":{"line":112}}},"arguments":[],"loc":{"start":{"line":112},"end":{"line":112}}},"loc":{"start":{"line":112},"end":{"line":112}}}],"loc":{"start":{"line":111},"end":{"line":113}}},"loc":{"start":{"line":110},"end":{"line":113}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"in","loc":{"start":{"line":114},"end":{"line":114}}},"right":{"type":"Literal"},"loc":{"start":{"line":114},"end":{"line":114}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"in","loc":{"start":{"line":116},"end":{"line":116}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[],"loc":{"start":{"line":116},"end":{"line":116}}},"loc":{"start":{"line":116},"end":{"line":116}}}],"loc":{"start":{"line":115},"end":{"line":117}}},"loc":{"start":{"line":114},"end":{"line":117}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"osgSocket","loc":{"start":{"line":118},"end":{"line":118}}},"right":{"type":"Literal"},"loc":{"start":{"line":118},"end":{"line":118}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"osgSocket","loc":{"start":{"line":120},"end":{"line":120}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[],"loc":{"start":{"line":120},"end":{"line":120}}},"loc":{"start":{"line":120},"end":{"line":120}}}],"loc":{"start":{"line":119},"end":{"line":121}}},"loc":{"start":{"line":118},"end":{"line":121}}}],"loc":{"start":{"line":109},"end":{"line":122}}},"handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"UnknownHostException","loc":{"start":{"line":101},"end":{"line":101}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[],"loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}}],"loc":{"start":{"line":102},"end":{"line":105}}},"loc":{"start":{"line":101},"end":{"line":105}}},{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"IOException","loc":{"start":{"line":105},"end":{"line":105}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":107},"end":{"line":107}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":107},"end":{"line":107}}},"arguments":[],"loc":{"start":{"line":107},"end":{"line":107}}},"loc":{"start":{"line":107},"end":{"line":107}}}],"loc":{"start":{"line":106},"end":{"line":108}}},"loc":{"start":{"line":105},"end":{"line":108}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"osgServerName","loc":{"start":{"line":85},"end":{"line":85}}},"right":{"type":"Literal"},"loc":{"start":{"line":85},"end":{"line":85}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"osgServerName","loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":85},"end":{"line":85}}},"arguments":[],"loc":{"start":{"line":85},"end":{"line":85}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":85},"end":{"line":85}}},"loc":{"start":{"line":85},"end":{"line":85}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"osgServerPort","loc":{"start":{"line":85},"end":{"line":85}}},"right":{"type":"Literal"},"loc":{"start":{"line":85},"end":{"line":85}}},"loc":{"start":{"line":85},"end":{"line":85}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"osgServerPort","loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[],"loc":{"start":{"line":86},"end":{"line":86}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":86},"end":{"line":86}}},"loc":{"start":{"line":85},"end":{"line":86}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"osgSocket","loc":{"start":{"line":88},"end":{"line":88}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Socket","loc":{"start":{"line":88},"end":{"line":88}}},"arguments":[{"type":"Identifier","name":"osgServerName","loc":{"start":{"line":88},"end":{"line":88}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Integer","loc":{"start":{"line":88},"end":{"line":88}}},"property":{"type":"Identifier","name":"parseInt"},"loc":{"start":{"line":88},"end":{"line":88}}},"arguments":[{"type":"Identifier","name":"osgServerPort","loc":{"start":{"line":88},"end":{"line":88}}}],"loc":{"start":{"line":88},"end":{"line":88}}}],"loc":{"start":{"line":88},"end":{"line":88}}},"loc":{"start":{"line":88},"end":{"line":88}}},"loc":{"start":{"line":88},"end":{"line":88}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"osgSocket","loc":{"start":{"line":89},"end":{"line":89}}},"right":{"type":"Literal"},"loc":{"start":{"line":89},"end":{"line":89}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"out","loc":{"start":{"line":91},"end":{"line":91}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"osgSocket","loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"getOutputStream"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":91},"end":{"line":91}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"in","loc":{"start":{"line":92},"end":{"line":92}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"InputStreamReader","loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"osgSocket","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"getInputStream"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[],"loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":90},"end":{"line":98}}},"loc":{"start":{"line":89},"end":{"line":98}}}],"loc":{"start":{"line":87},"end":{"line":99}}},"loc":{"start":{"line":85},"end":{"line":99}}}],"loc":{"start":{"line":83},"end":{"line":101}}},"loc":{"start":{"line":82},"end":{"line":122}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"url","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":124},"end":{"line":124}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":124},"end":{"line":124}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req","loc":{"start":{"line":124},"end":{"line":124}}},"property":{"type":"Identifier","name":"getRequestURL"},"loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[],"loc":{"start":{"line":124},"end":{"line":124}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[],"loc":{"start":{"line":124},"end":{"line":124}}},"loc":{"start":{"line":124},"end":{"line":124}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"disp","vartype":{"type":"Identifier","name":"RequestDispatcher","loc":{"start":{"line":126},"end":{"line":126}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"RequestDispatcher","loc":{"start":{"line":126},"end":{"line":126}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req","loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"getRequestDispatcher"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"url","loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"url","loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"lastIndexOf"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req","loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"getContextPath"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[],"loc":{"start":{"line":126},"end":{"line":126}}},"right":{"type":"Literal","value":"/","raw":"/"},"loc":{"start":{"line":126},"end":{"line":126}}}],"loc":{"start":{"line":126},"end":{"line":126}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"req","loc":{"start":{"line":127},"end":{"line":127}}},"property":{"type":"Identifier","name":"getContextPath"},"loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[],"loc":{"start":{"line":127},"end":{"line":127}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[],"loc":{"start":{"line":127},"end":{"line":127}}},"loc":{"start":{"line":126},"end":{"line":127}}}],"loc":{"start":{"line":126},"end":{"line":127}}}],"loc":{"start":{"line":126},"end":{"line":127}}},"loc":{"start":{"line":126},"end":{"line":127}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"disp","loc":{"start":{"line":129},"end":{"line":129}}},"property":{"type":"Identifier","name":"forward"},"loc":{"start":{"line":129},"end":{"line":129}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":129},"end":{"line":129}}},{"type":"Identifier","name":"response","loc":{"start":{"line":129},"end":{"line":129}}}],"loc":{"start":{"line":129},"end":{"line":129}}},"loc":{"start":{"line":129},"end":{"line":129}}}],"loc":{"start":{"line":72},"end":{"line":131}}},"code":"\npublic void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n    HttpServletRequest req \u003d (HttpServletRequest)request;\n    Socket osgSocket \u003d null;\n    PrintWriter out \u003d null;\n    BufferedReader in \u003d null;\n    String osgServerName \u003d req.getSession().getServletContext().getInitParameter(OSG_SERVER_NAME);\n    String osgServerPort \u003d req.getSession().getServletContext().getInitParameter(OSG_SERVER_PORT);\n    try {\n        if (osgServerName !\u003d null \u0026\u0026 osgServerName.length() !\u003d 0 \u0026\u0026 osgServerPort !\u003d null \u0026\u0026 osgServerPort.length() !\u003d 0) {\n            osgSocket \u003d new Socket(osgServerName, Integer.parseInt(osgServerPort));\n            if (osgSocket !\u003d null) {\n                out \u003d new PrintWriter(osgSocket.getOutputStream(), true);\n                in \u003d new BufferedReader(new InputStreamReader(osgSocket.getInputStream()));\n            }\n        }\n    } catch (UnknownHostException e) {\n        e.printStackTrace();\n    } catch (IOException e) {\n        e.printStackTrace();\n    } finally {\n        if (out !\u003d null) {\n            out.close();\n        }\n        if (in !\u003d null) {\n            in.close();\n        }\n        if (osgSocket !\u003d null) {\n            osgSocket.close();\n        }\n    }\n    String url \u003d req.getRequestURL().toString();\n    RequestDispatcher disp \u003d req.getRequestDispatcher(url.substring(url.lastIndexOf(req.getContextPath() + \"/\") + req.getContextPath().length()));\n    disp.forward(request, response);\n}","loc":{"start":{"line":70},"end":{"line":131}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"init"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"arg0","vartype":{"type":"Identifier","name":"FilterConfig","loc":{"start":{"line":137},"end":{"line":137}}}}],"thrown":[{"type":"Identifier","name":"ServletException","loc":{"start":{"line":137},"end":{"line":137}}}],"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":138},"end":{"line":141}}},"code":"\npublic void init(FilterConfig arg0) throws ServletException {\n}","loc":{"start":{"line":137},"end":{"line":141}}}],"loc":{"start":{"line":53},"end":{"line":143}}}],"loc":{"start":{"line":5},"end":{"line":143}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/util/Interceptor.java"}