{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"SQLException"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"CreateDB"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"DatabaseUtilities"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"LessonTracker"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"RandomLessonTracker"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"RandomLessonAdapter"},"modifiers":{"type":"Modifiers","modifiers":["public","abstract"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":13},"end":{"line":13}}},"definitions":[{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getStages"},"modifiers":{"type":"Modifiers","modifiers":["public","abstract"],"annotations":[]},"restype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":16},"end":{"line":16}}}},"typarams":[],"params":[],"thrown":[],"code":"\npublic abstract String[] getStages();","loc":{"start":{"line":16},"end":{"line":16}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setStage"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":18},"end":{"line":18}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":20},"end":{"line":20}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":20},"end":{"line":20}}}],"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":20},"end":{"line":20}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":20},"end":{"line":20}}}],"loc":{"start":{"line":20},"end":{"line":20}}},"loc":{"start":{"line":20},"end":{"line":20}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"sqle","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":29},"end":{"line":29}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":31},"end":{"line":31}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":31},"end":{"line":31}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":31},"end":{"line":31}}},"arguments":[{"type":"Literal","value":"Error refreshing the database!","raw":"Error refreshing the database!"}],"loc":{"start":{"line":31},"end":{"line":31}}},"loc":{"start":{"line":31},"end":{"line":31}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqle","loc":{"start":{"line":32},"end":{"line":32}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":32},"end":{"line":32}}},"arguments":[],"loc":{"start":{"line":32},"end":{"line":32}}},"loc":{"start":{"line":32},"end":{"line":32}}}],"loc":{"start":{"line":30},"end":{"line":33}}},"loc":{"start":{"line":29},"end":{"line":33}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":23},"end":{"line":23}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":23},"end":{"line":23}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":23},"end":{"line":23}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":23},"end":{"line":23}}}],"loc":{"start":{"line":23},"end":{"line":23}}},"loc":{"start":{"line":23},"end":{"line":23}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"db","vartype":{"type":"Identifier","name":"CreateDB","loc":{"start":{"line":25},"end":{"line":25}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"CreateDB","loc":{"start":{"line":25},"end":{"line":25}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"CreateDB","loc":{"start":{"line":25},"end":{"line":25}}},"arguments":[],"loc":{"start":{"line":25},"end":{"line":25}}},"loc":{"start":{"line":25},"end":{"line":25}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"db","loc":{"start":{"line":26},"end":{"line":26}}},"property":{"type":"Identifier","name":"makeDB"},"loc":{"start":{"line":26},"end":{"line":26}}},"arguments":[{"type":"Identifier","name":"connection","loc":{"start":{"line":26},"end":{"line":26}}}],"loc":{"start":{"line":26},"end":{"line":26}}},"loc":{"start":{"line":26},"end":{"line":26}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":27},"end":{"line":27}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":27},"end":{"line":27}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":27},"end":{"line":27}}},"arguments":[{"type":"Literal","value":"Successfully refreshed the database.","raw":"Successfully refreshed the database."}],"loc":{"start":{"line":27},"end":{"line":27}}},"loc":{"start":{"line":27},"end":{"line":27}}}],"loc":{"start":{"line":22},"end":{"line":29}}},"loc":{"start":{"line":21},"end":{"line":33}}}],"loc":{"start":{"line":19},"end":{"line":34}}},"code":"\npublic void setStage(WebSession s, String stage) {\n    getLessonTracker(s).setStage(stage);\n    try {\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        CreateDB db \u003d new CreateDB();\n        db.makeDB(connection);\n        System.out.println(\"Successfully refreshed the database.\");\n    } catch (SQLException sqle) {\n        System.out.println(\"Error refreshing the database!\");\n        sqle.printStackTrace();\n    }\n}","loc":{"start":{"line":18},"end":{"line":34}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getStage"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":36},"end":{"line":36}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":36},"end":{"line":36}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":38},"end":{"line":38}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":38},"end":{"line":38}}}],"loc":{"start":{"line":38},"end":{"line":38}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":38},"end":{"line":38}}},"arguments":[],"loc":{"start":{"line":38},"end":{"line":38}}},"loc":{"start":{"line":38},"end":{"line":38}}}],"loc":{"start":{"line":37},"end":{"line":39}}},"code":"\npublic String getStage(WebSession s) {\n    return getLessonTracker(s).getStage();\n}","loc":{"start":{"line":36},"end":{"line":39}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setStageComplete"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":41},"end":{"line":41}}}},{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":41},"end":{"line":41}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lt","vartype":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":43},"end":{"line":43}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":43},"end":{"line":43}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":43},"end":{"line":43}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":43},"end":{"line":43}}}],"loc":{"start":{"line":43},"end":{"line":43}}},"loc":{"start":{"line":43},"end":{"line":43}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lt","loc":{"start":{"line":44},"end":{"line":44}}},"property":{"type":"Identifier","name":"setStageComplete"},"loc":{"start":{"line":44},"end":{"line":44}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":44},"end":{"line":44}}},{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":44},"end":{"line":44}}},"loc":{"start":{"line":44},"end":{"line":44}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lt","loc":{"start":{"line":45},"end":{"line":45}}},"property":{"type":"Identifier","name":"getCompleted"},"loc":{"start":{"line":45},"end":{"line":45}}},"arguments":[],"loc":{"start":{"line":45},"end":{"line":45}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":47},"end":{"line":47}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":47},"end":{"line":47}}},"arguments":[{"type":"Literal","value":"Congratulations, you have completed this lab","raw":"Congratulations, you have completed this lab"}],"loc":{"start":{"line":47},"end":{"line":47}}},"loc":{"start":{"line":47},"end":{"line":47}}}],"loc":{"start":{"line":46},"end":{"line":48}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":51},"end":{"line":51}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":51},"end":{"line":51}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"You have completed Stage ","raw":"You have completed Stage "},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lt","loc":{"start":{"line":51},"end":{"line":51}}},"property":{"type":"Identifier","name":"getStageNumber"},"loc":{"start":{"line":51},"end":{"line":51}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":51},"end":{"line":51}}}],"loc":{"start":{"line":51},"end":{"line":51}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":51},"end":{"line":51}}},"loc":{"start":{"line":51},"end":{"line":51}}},"right":{"type":"Literal","value":": ","raw":": "},"loc":{"start":{"line":51},"end":{"line":51}}},"right":{"type":"Identifier","name":"stage","loc":{"start":{"line":51},"end":{"line":51}}},"loc":{"start":{"line":51},"end":{"line":51}}},"right":{"type":"Literal","value":".","raw":"."},"loc":{"start":{"line":51},"end":{"line":51}}}],"loc":{"start":{"line":51},"end":{"line":51}}},"loc":{"start":{"line":51},"end":{"line":51}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"stage","loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lt","loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[],"loc":{"start":{"line":52},"end":{"line":52}}}],"loc":{"start":{"line":52},"end":{"line":52}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":52},"end":{"line":52}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":53},"end":{"line":53}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":53},"end":{"line":53}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":" Welcome to Stage ","raw":" Welcome to Stage "},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lt","loc":{"start":{"line":53},"end":{"line":53}}},"property":{"type":"Identifier","name":"getStageNumber"},"loc":{"start":{"line":53},"end":{"line":53}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lt","loc":{"start":{"line":53},"end":{"line":53}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":53},"end":{"line":53}}},"arguments":[],"loc":{"start":{"line":53},"end":{"line":53}}}],"loc":{"start":{"line":53},"end":{"line":53}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":53},"end":{"line":53}}},"loc":{"start":{"line":53},"end":{"line":53}}},"right":{"type":"Literal","value":": ","raw":": "},"loc":{"start":{"line":53},"end":{"line":53}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lt","loc":{"start":{"line":53},"end":{"line":53}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":53},"end":{"line":53}}},"arguments":[],"loc":{"start":{"line":53},"end":{"line":53}}},"loc":{"start":{"line":53},"end":{"line":53}}}],"loc":{"start":{"line":53},"end":{"line":53}}},"loc":{"start":{"line":53},"end":{"line":53}}},"loc":{"start":{"line":52},"end":{"line":53}}}],"loc":{"start":{"line":50},"end":{"line":54}}},"loc":{"start":{"line":45},"end":{"line":54}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"sqle","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":63},"end":{"line":63}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":65},"end":{"line":65}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":65},"end":{"line":65}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":65},"end":{"line":65}}},"arguments":[{"type":"Literal","value":"Error refreshing the database!","raw":"Error refreshing the database!"}],"loc":{"start":{"line":65},"end":{"line":65}}},"loc":{"start":{"line":65},"end":{"line":65}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqle","loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[],"loc":{"start":{"line":66},"end":{"line":66}}},"loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":64},"end":{"line":67}}},"loc":{"start":{"line":63},"end":{"line":67}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":57},"end":{"line":57}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":57},"end":{"line":57}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":57},"end":{"line":57}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":57},"end":{"line":57}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":57},"end":{"line":57}}}],"loc":{"start":{"line":57},"end":{"line":57}}},"loc":{"start":{"line":57},"end":{"line":57}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"db","vartype":{"type":"Identifier","name":"CreateDB","loc":{"start":{"line":59},"end":{"line":59}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"CreateDB","loc":{"start":{"line":59},"end":{"line":59}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"CreateDB","loc":{"start":{"line":59},"end":{"line":59}}},"arguments":[],"loc":{"start":{"line":59},"end":{"line":59}}},"loc":{"start":{"line":59},"end":{"line":59}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"db","loc":{"start":{"line":60},"end":{"line":60}}},"property":{"type":"Identifier","name":"makeDB"},"loc":{"start":{"line":60},"end":{"line":60}}},"arguments":[{"type":"Identifier","name":"connection","loc":{"start":{"line":60},"end":{"line":60}}}],"loc":{"start":{"line":60},"end":{"line":60}}},"loc":{"start":{"line":60},"end":{"line":60}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":61},"end":{"line":61}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":61},"end":{"line":61}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":61},"end":{"line":61}}},"arguments":[{"type":"Literal","value":"Successfully refreshed the database.","raw":"Successfully refreshed the database."}],"loc":{"start":{"line":61},"end":{"line":61}}},"loc":{"start":{"line":61},"end":{"line":61}}}],"loc":{"start":{"line":56},"end":{"line":63}}},"loc":{"start":{"line":55},"end":{"line":67}}}],"loc":{"start":{"line":42},"end":{"line":68}}},"code":"\npublic void setStageComplete(WebSession s, String stage) {\n    RandomLessonTracker lt \u003d getLessonTracker(s);\n    lt.setStageComplete(stage, true);\n    if (lt.getCompleted()) {\n        s.setMessage(\"Congratulations, you have completed this lab\");\n    } else {\n        s.setMessage(\"You have completed Stage \" + (lt.getStageNumber(stage) + 1) + \": \" + stage + \".\");\n        if (!stage.equals(lt.getStage())) s.setMessage(\" Welcome to Stage \" + (lt.getStageNumber(lt.getStage()) + 1) + \": \" + lt.getStage());\n    }\n    try {\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        CreateDB db \u003d new CreateDB();\n        db.makeDB(connection);\n        System.out.println(\"Successfully refreshed the database.\");\n    } catch (SQLException sqle) {\n        System.out.println(\"Error refreshing the database!\");\n        sqle.printStackTrace();\n    }\n}","loc":{"start":{"line":41},"end":{"line":68}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"isStageComplete"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":70},"end":{"line":70}}}},{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":70},"end":{"line":70}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"hasCompleted"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":71},"end":{"line":73}}},"code":"\npublic boolean isStageComplete(WebSession s, String stage) {\n    return getLessonTracker(s).hasCompleted(stage);\n}","loc":{"start":{"line":70},"end":{"line":73}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessonTracker"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":76},"end":{"line":76}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":76},"end":{"line":76}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"TypeCast","clazz":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":78},"end":{"line":78}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":77},"end":{"line":79}}},"code":"\n@Override()\npublic RandomLessonTracker getLessonTracker(WebSession s) {\n    return (RandomLessonTracker)super.getLessonTracker(s);\n}","loc":{"start":{"line":75},"end":{"line":79}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessonTracker"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":81},"end":{"line":81}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":82},"end":{"line":82}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":82},"end":{"line":82}}}},{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":82},"end":{"line":82}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"TypeCast","clazz":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":84},"end":{"line":84}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":84},"end":{"line":84}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":84},"end":{"line":84}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":84},"end":{"line":84}}},{"type":"Identifier","name":"lesson","loc":{"start":{"line":84},"end":{"line":84}}}],"loc":{"start":{"line":84},"end":{"line":84}}},"loc":{"start":{"line":84},"end":{"line":84}}},"loc":{"start":{"line":84},"end":{"line":84}}}],"loc":{"start":{"line":83},"end":{"line":85}}},"code":"\n@Override()\npublic RandomLessonTracker getLessonTracker(WebSession s, AbstractLesson lesson) {\n    return (RandomLessonTracker)super.getLessonTracker(s, lesson);\n}","loc":{"start":{"line":81},"end":{"line":85}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessonTracker"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":88},"end":{"line":88}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":88},"end":{"line":88}}}},{"type":"Identifier","name":"userNameOverride","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":88},"end":{"line":88}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"TypeCast","clazz":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":90},"end":{"line":90}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":90},"end":{"line":90}}},{"type":"Identifier","name":"userNameOverride","loc":{"start":{"line":90},"end":{"line":90}}}],"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":90},"end":{"line":90}}}],"loc":{"start":{"line":89},"end":{"line":91}}},"code":"\n@Override()\npublic RandomLessonTracker getLessonTracker(WebSession s, String userNameOverride) {\n    return (RandomLessonTracker)super.getLessonTracker(s, userNameOverride);\n}","loc":{"start":{"line":87},"end":{"line":91}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createLessonTracker"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"LessonTracker","loc":{"start":{"line":94},"end":{"line":94}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"RandomLessonTracker","loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStages","loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[],"loc":{"start":{"line":96},"end":{"line":96}}}],"loc":{"start":{"line":96},"end":{"line":96}}},"loc":{"start":{"line":96},"end":{"line":96}}}],"loc":{"start":{"line":95},"end":{"line":97}}},"code":"\n@Override()\npublic LessonTracker createLessonTracker() {\n    return new RandomLessonTracker(getStages());\n}","loc":{"start":{"line":93},"end":{"line":97}}}],"loc":{"start":{"line":13},"end":{"line":99}}}],"loc":{"start":{"line":2},"end":{"line":99}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/RandomLessonAdapter.java"}