{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"DBSQLInjection"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"DeleteProfile"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"EditProfile"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"FindProfile"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"LessonAction"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ListStaff"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"Logout"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"SearchStaff"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"UpdateProfile"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"ViewProfile"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"ParameterNotFoundException"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"UnauthenticatedException"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"UnauthorizedException"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"ValidationException"},"loc":{"start":{"line":21},"end":{"line":21}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":22},"end":{"line":22}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"DBSQLInjection"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":52},"end":{"line":52}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":54},"end":{"line":54}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":54},"end":{"line":54}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":54},"end":{"line":54}}},"arguments":[{"type":"Literal","value":75,"raw":75}],"loc":{"start":{"line":54},"end":{"line":54}}},"loc":{"start":{"line":54},"end":{"line":54}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"PRIZE_EMPLOYEE_ID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":112,"raw":112},"loc":{"start":{"line":56},"end":{"line":56}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"PRIZE_EMPLOYEE_NAME","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}},"init":{"type":"Literal","value":"Neville Bartholomew","raw":"Neville Bartholomew"},"loc":{"start":{"line":58},"end":{"line":58}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE1","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}},"init":{"type":"Literal","value":"String SQL Injection","raw":"String SQL Injection"},"loc":{"start":{"line":60},"end":{"line":60}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE2","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":62},"end":{"line":62}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":62},"end":{"line":62}}},"init":{"type":"Literal","value":"Block SQL Injection using Bind Variables","raw":"Block SQL Injection using Bind Variables"},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"registerActions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"className","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":64},"end":{"line":64}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ListStaff","loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":66},"end":{"line":66}}},{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":66},"end":{"line":66}}},"loc":{"start":{"line":66},"end":{"line":66}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"SearchStaff","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":67},"end":{"line":67}}},{"type":"Identifier","name":"SEARCHSTAFF_ACTION","loc":{"start":{"line":67},"end":{"line":67}}}],"loc":{"start":{"line":67},"end":{"line":67}}}],"loc":{"start":{"line":67},"end":{"line":67}}},"loc":{"start":{"line":67},"end":{"line":67}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ViewProfile","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":68},"end":{"line":68}}},{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":69},"end":{"line":69}}},{"type":"Identifier","name":"EDITPROFILE_ACTION","loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":69},"end":{"line":69}}},"loc":{"start":{"line":69},"end":{"line":69}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":70},"end":{"line":70}}},{"type":"Identifier","name":"CREATEPROFILE_ACTION","loc":{"start":{"line":70},"end":{"line":70}}}],"loc":{"start":{"line":70},"end":{"line":70}}}],"loc":{"start":{"line":70},"end":{"line":70}}},"loc":{"start":{"line":70},"end":{"line":70}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Login","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":73},"end":{"line":73}}},{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":73},"end":{"line":73}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Logout","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":74},"end":{"line":74}}},{"type":"Identifier","name":"LOGOUT_ACTION","loc":{"start":{"line":74},"end":{"line":74}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"FindProfile","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":75},"end":{"line":75}}},{"type":"Identifier","name":"FINDPROFILE_ACTION","loc":{"start":{"line":75},"end":{"line":75}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":76},"end":{"line":76}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UpdateProfile","loc":{"start":{"line":76},"end":{"line":76}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":76},"end":{"line":76}}},{"type":"Identifier","name":"UPDATEPROFILE_ACTION","loc":{"start":{"line":76},"end":{"line":76}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":76},"end":{"line":76}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":76},"end":{"line":76}}},"loc":{"start":{"line":76},"end":{"line":76}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":77},"end":{"line":77}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"DeleteProfile","loc":{"start":{"line":77},"end":{"line":77}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":77},"end":{"line":77}}},{"type":"Identifier","name":"DELETEPROFILE_ACTION","loc":{"start":{"line":77},"end":{"line":77}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":77},"end":{"line":77}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":77},"end":{"line":77}}}],"loc":{"start":{"line":77},"end":{"line":77}}}],"loc":{"start":{"line":77},"end":{"line":77}}}],"loc":{"start":{"line":77},"end":{"line":77}}},"loc":{"start":{"line":77},"end":{"line":77}}}],"loc":{"start":{"line":65},"end":{"line":78}}},"code":"\npublic void registerActions(String className) {\n    registerAction(new ListStaff(this, className, LISTSTAFF_ACTION));\n    registerAction(new SearchStaff(this, className, SEARCHSTAFF_ACTION));\n    registerAction(new ViewProfile(this, className, VIEWPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, EDITPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, CREATEPROFILE_ACTION));\n    registerAction(new Login(this, className, LOGIN_ACTION, getAction(LISTSTAFF_ACTION)));\n    registerAction(new Logout(this, className, LOGOUT_ACTION, getAction(LOGIN_ACTION)));\n    registerAction(new FindProfile(this, className, FINDPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new UpdateProfile(this, className, UPDATEPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new DeleteProfile(this, className, DELETEPROFILE_ACTION, getAction(LISTSTAFF_ACTION)));\n}","loc":{"start":{"line":64},"end":{"line":78}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":85},"end":{"line":85}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"INJECTION"},"loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":87},"end":{"line":87}}}],"loc":{"start":{"line":86},"end":{"line":88}}},"code":"\npublic Category getDefaultCategory() {\n    return Category.INJECTION;\n}","loc":{"start":{"line":85},"end":{"line":88}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":95},"end":{"line":95}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":95},"end":{"line":95}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":97},"end":{"line":97}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":97},"end":{"line":97}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[],"loc":{"start":{"line":97},"end":{"line":97}}},"loc":{"start":{"line":97},"end":{"line":97}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":98},"end":{"line":98}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[{"type":"Literal","value":"The application is taking your input and inserting it at the end of a pre-formed SQL command.","raw":"The application is taking your input and inserting it at the end of a pre-formed SQL command."}],"loc":{"start":{"line":98},"end":{"line":98}}},"loc":{"start":{"line":98},"end":{"line":98}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":99},"end":{"line":100}}},"arguments":[{"type":"Literal","value":"This is the code for the query being built and issued by WebGoat:\u003cbr\u003e\u003cbr\u003e stmt  :\u003d \u0027SELECT USERID FROM EMPLOYEE WHERE USERID \u003d \u0027 || v_id || \u0027 AND PASSWORD \u003d \u0027\u0027\u0027 || v_password || \u0027\u0027\u0027\u0027;\u003cbr\u003eEXECUTE IMMEDIATE stmt INTO v_userid;","raw":"This is the code for the query being built and issued by WebGoat:\u003cbr\u003e\u003cbr\u003e stmt  :\u003d \u0027SELECT USERID FROM EMPLOYEE WHERE USERID \u003d \u0027 || v_id || \u0027 AND PASSWORD \u003d \u0027\u0027\u0027 || v_password || \u0027\u0027\u0027\u0027;\u003cbr\u003eEXECUTE IMMEDIATE stmt INTO v_userid;"}],"loc":{"start":{"line":99},"end":{"line":102}}},"loc":{"start":{"line":99},"end":{"line":102}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":103},"end":{"line":104}}},"arguments":[{"type":"Literal","value":"Compound SQL statements can be made by joining multiple tests with keywords like AND and OR.  Remember: You need to end up with a SQL statement that only returns one row, since we are using an INTO clause","raw":"Compound SQL statements can be made by joining multiple tests with keywords like AND and OR.  Remember: You need to end up with a SQL statement that only returns one row, since we are using an INTO clause"}],"loc":{"start":{"line":103},"end":{"line":105}}},"loc":{"start":{"line":103},"end":{"line":105}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[{"type":"Literal","value":"You may need to use WebScarab to remove a field length limit to fit your attack.","raw":"You may need to use WebScarab to remove a field length limit to fit your attack."}],"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Literal","value":"Try entering a password of [ \u0027 OR userid\u003d112 OR password\u003d\u0027 ].","raw":"Try entering a password of [ \u0027 OR userid\u003d112 OR password\u003d\u0027 ]."}],"loc":{"start":{"line":109},"end":{"line":109}}},"loc":{"start":{"line":109},"end":{"line":109}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":112},"end":{"line":112}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":112},"end":{"line":112}}},"arguments":[{"type":"Literal","value":"Change the Stored procedure to use bind variables.","raw":"Change the Stored procedure to use bind variables."}],"loc":{"start":{"line":112},"end":{"line":112}}},"loc":{"start":{"line":112},"end":{"line":112}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":114},"end":{"line":114}}},"loc":{"start":{"line":114},"end":{"line":114}}}],"loc":{"start":{"line":96},"end":{"line":115}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"The application is taking your input and inserting it at the end of a pre-formed SQL command.\");\n    hints.add(\"This is the code for the query being built and issued by WebGoat:\u003cbr\u003e\u003cbr\u003e stmt  :\u003d \\\u0027SELECT USERID FROM EMPLOYEE WHERE USERID \u003d \\\u0027 || v_id || \\\u0027 AND PASSWORD \u003d \\\u0027\\\u0027\\\u0027 || v_password || \\\u0027\\\u0027\\\u0027\\\u0027;\u003cbr\u003eEXECUTE IMMEDIATE stmt INTO v_userid;\");\n    hints.add(\"Compound SQL statements can be made by joining multiple tests with keywords like AND and OR.  Remember: You need to end up with a SQL statement that only returns one row, since we are using an INTO clause\");\n    hints.add(\"You may need to use WebScarab to remove a field length limit to fit your attack.\");\n    hints.add(\"Try entering a password of [ \\\u0027 OR userid\u003d112 OR password\u003d\\\u0027 ].\");\n    hints.add(\"Change the Stored procedure to use bind variables.\");\n    return hints;\n}","loc":{"start":{"line":95},"end":{"line":115}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getStages"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[]}]},"restype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":118},"end":{"line":118}}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[],"loc":{"start":{"line":120},"end":{"line":120}}},"property":{"type":"Identifier","name":"isCodingExercises"},"loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[],"loc":{"start":{"line":120},"end":{"line":120}}},"consequent":{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":120},"end":{"line":120}}},{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":120},"end":{"line":120}}}],"loc":{"start":{"line":120},"end":{"line":120}}},"loc":{"start":{"line":120},"end":{"line":120}}},"loc":{"start":{"line":120},"end":{"line":120}}},{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":121},"end":{"line":121}}}],"loc":{"start":{"line":121},"end":{"line":121}}},"loc":{"start":{"line":121},"end":{"line":121}}}],"loc":{"start":{"line":119},"end":{"line":122}}},"code":"\n@Override()\npublic String[] getStages() {\n    if (getWebgoatContext().isCodingExercises()) return new String[]{STAGE1, STAGE2};\n    return new String[]{STAGE1};\n}","loc":{"start":{"line":117},"end":{"line":122}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":129},"end":{"line":129}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":129},"end":{"line":129}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":131},"end":{"line":131}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":131},"end":{"line":131}}},"init":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":131},"end":{"line":131}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":133},"end":{"line":133}}}],"loc":{"start":{"line":133},"end":{"line":133}}},"property":{"type":"Identifier","name":"getCompleted"},"loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[],"loc":{"start":{"line":133},"end":{"line":133}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":133},"end":{"line":133}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":135},"end":{"line":135}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":135},"end":{"line":135}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":135},"end":{"line":135}}}],"loc":{"start":{"line":135},"end":{"line":135}}},"loc":{"start":{"line":135},"end":{"line":135}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":136},"end":{"line":136}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":136},"end":{"line":136}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":136},"end":{"line":136}}}],"loc":{"start":{"line":136},"end":{"line":136}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":138},"end":{"line":138}}},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Stage 1: Use String SQL Injection to bypass authentication. ","raw":"Stage 1: Use String SQL Injection to bypass authentication. "},"right":{"type":"Literal","value":"The goal here is to login as the user ","raw":"The goal here is to login as the user "},"loc":{"start":{"line":138},"end":{"line":139}}},"right":{"type":"Identifier","name":"PRIZE_EMPLOYEE_NAME","loc":{"start":{"line":139},"end":{"line":139}}},"loc":{"start":{"line":138},"end":{"line":139}}},"right":{"type":"Literal","value":", who is in the Admin group.  ","raw":", who is in the Admin group.  "},"loc":{"start":{"line":138},"end":{"line":140}}},"right":{"type":"Literal","value":"You do not have the password, but the form is SQL injectable. ","raw":"You do not have the password, but the form is SQL injectable. "},"loc":{"start":{"line":138},"end":{"line":141}}},"right":{"type":"Literal","value":"View the EMPLOYEE_LOGIN stored procedure and see if you can ","raw":"View the EMPLOYEE_LOGIN stored procedure and see if you can "},"loc":{"start":{"line":138},"end":{"line":142}}},"right":{"type":"Literal","value":"determine why the exploit exists.","raw":"determine why the exploit exists."},"loc":{"start":{"line":138},"end":{"line":143}}},"loc":{"start":{"line":138},"end":{"line":143}}},"loc":{"start":{"line":138},"end":{"line":143}}}],"loc":{"start":{"line":137},"end":{"line":144}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":145},"end":{"line":145}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":145},"end":{"line":145}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":145},"end":{"line":145}}}],"loc":{"start":{"line":145},"end":{"line":145}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":147},"end":{"line":147}}},"right":{"type":"Literal","value":"Stage 2: Use bind variables.\u003cbr\u003eUsing the Squirrel SQL Client, update the EMPLOYEE_LOGIN stored procedure in the database to use bind variables, rather than string concatenation. Repeat the SQL Injection attack. Verify that the attack is no longer effective.","raw":"Stage 2: Use bind variables.\u003cbr\u003eUsing the Squirrel SQL Client, update the EMPLOYEE_LOGIN stored procedure in the database to use bind variables, rather than string concatenation. Repeat the SQL Injection attack. Verify that the attack is no longer effective."},"loc":{"start":{"line":147},"end":{"line":150}}},"loc":{"start":{"line":147},"end":{"line":150}}}],"loc":{"start":{"line":146},"end":{"line":151}}},"loc":{"start":{"line":145},"end":{"line":151}}},"loc":{"start":{"line":136},"end":{"line":151}}}],"loc":{"start":{"line":134},"end":{"line":152}}},"loc":{"start":{"line":133},"end":{"line":152}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":130},"end":{"line":155}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"\";\n    if (!getLessonTracker(s).getCompleted()) {\n        String stage \u003d getStage(s);\n        if (STAGE1.equals(stage)) {\n            instructions \u003d \"Stage 1: Use String SQL Injection to bypass authentication. \" + \"The goal here is to login as the user \" + PRIZE_EMPLOYEE_NAME + \", who is in the Admin group.  \" + \"You do not have the password, but the form is SQL injectable. \" + \"View the EMPLOYEE_LOGIN stored procedure and see if you can \" + \"determine why the exploit exists.\";\n        } else if (STAGE2.equals(stage)) {\n            instructions \u003d \"Stage 2: Use bind variables.\u003cbr\u003eUsing the Squirrel SQL Client, update the EMPLOYEE_LOGIN stored procedure in the database to use bind variables, rather than string concatenation. Repeat the SQL Injection attack. Verify that the attack is no longer effective.\";\n        }\n    }\n    return instructions;\n}","loc":{"start":{"line":129},"end":{"line":155}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"handleRequest"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":157},"end":{"line":157}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"getLessonSession"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":159},"end":{"line":159}}},"right":{"type":"Literal"},"loc":{"start":{"line":159},"end":{"line":159}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"openLessonSession"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":159},"end":{"line":159}}},"loc":{"start":{"line":159},"end":{"line":159}}},"loc":{"start":{"line":159},"end":{"line":159}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"requestedActionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":161},"end":{"line":161}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":161},"end":{"line":161}}},"init":{"type":"Literal"},"loc":{"start":{"line":161},"end":{"line":161}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":165},"end":{"line":165}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":168},"end":{"line":168}}},"right":{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":168},"end":{"line":168}}},"loc":{"start":{"line":168},"end":{"line":168}}},"loc":{"start":{"line":168},"end":{"line":168}}}],"loc":{"start":{"line":166},"end":{"line":169}}},"loc":{"start":{"line":165},"end":{"line":169}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":164},"end":{"line":164}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[],"loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"Literal","value":"action","raw":"action"}],"loc":{"start":{"line":164},"end":{"line":164}}},"loc":{"start":{"line":164},"end":{"line":164}}},"loc":{"start":{"line":164},"end":{"line":164}}}],"loc":{"start":{"line":163},"end":{"line":165}}},"loc":{"start":{"line":162},"end":{"line":169}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":171},"end":{"line":171}}},"right":{"type":"Literal"},"loc":{"start":{"line":171},"end":{"line":171}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":188},"end":{"line":188}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pnfe","loc":{"start":{"line":191},"end":{"line":191}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":191},"end":{"line":191}}},"arguments":[],"loc":{"start":{"line":191},"end":{"line":191}}},"loc":{"start":{"line":191},"end":{"line":191}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":192},"end":{"line":192}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":192},"end":{"line":192}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":192},"end":{"line":192}}}],"loc":{"start":{"line":192},"end":{"line":192}}},"loc":{"start":{"line":192},"end":{"line":192}}}],"loc":{"start":{"line":189},"end":{"line":193}}},"loc":{"start":{"line":188},"end":{"line":193}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ve","vartype":{"type":"Identifier","name":"ValidationException","loc":{"start":{"line":193},"end":{"line":193}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ve","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[],"loc":{"start":{"line":196},"end":{"line":196}}},"loc":{"start":{"line":196},"end":{"line":196}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":197},"end":{"line":197}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":197},"end":{"line":197}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":197},"end":{"line":197}}}],"loc":{"start":{"line":197},"end":{"line":197}}},"loc":{"start":{"line":197},"end":{"line":197}}}],"loc":{"start":{"line":194},"end":{"line":198}}},"loc":{"start":{"line":193},"end":{"line":198}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue","vartype":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":198},"end":{"line":198}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":200},"end":{"line":200}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":200},"end":{"line":200}}},"arguments":[{"type":"Literal","value":"Login failed","raw":"Login failed"}],"loc":{"start":{"line":200},"end":{"line":200}}},"loc":{"start":{"line":200},"end":{"line":200}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue","loc":{"start":{"line":202},"end":{"line":202}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":202},"end":{"line":202}}},"arguments":[],"loc":{"start":{"line":202},"end":{"line":202}}},"loc":{"start":{"line":202},"end":{"line":202}}}],"loc":{"start":{"line":199},"end":{"line":203}}},"loc":{"start":{"line":198},"end":{"line":203}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue2","vartype":{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":203},"end":{"line":203}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":205},"end":{"line":205}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":205},"end":{"line":205}}},"arguments":[{"type":"Literal","value":"You are not authorized to perform this function","raw":"You are not authorized to perform this function"}],"loc":{"start":{"line":205},"end":{"line":205}}},"loc":{"start":{"line":205},"end":{"line":205}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue2","loc":{"start":{"line":207},"end":{"line":207}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":207},"end":{"line":207}}},"arguments":[],"loc":{"start":{"line":207},"end":{"line":207}}},"loc":{"start":{"line":207},"end":{"line":207}}}],"loc":{"start":{"line":204},"end":{"line":208}}},"loc":{"start":{"line":203},"end":{"line":208}}},{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":208},"end":{"line":208}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":212},"end":{"line":212}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":212},"end":{"line":212}}},"arguments":[],"loc":{"start":{"line":212},"end":{"line":212}}},"loc":{"start":{"line":212},"end":{"line":212}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":213},"end":{"line":213}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":213},"end":{"line":213}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":213},"end":{"line":213}}}],"loc":{"start":{"line":213},"end":{"line":213}}},"loc":{"start":{"line":213},"end":{"line":213}}}],"loc":{"start":{"line":209},"end":{"line":214}}},"loc":{"start":{"line":208},"end":{"line":214}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"action","vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":175},"end":{"line":175}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":175},"end":{"line":175}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":175},"end":{"line":175}}},"arguments":[{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":175},"end":{"line":175}}}],"loc":{"start":{"line":175},"end":{"line":175}}},"loc":{"start":{"line":175},"end":{"line":175}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"action","loc":{"start":{"line":176},"end":{"line":176}}},"right":{"type":"Literal"},"loc":{"start":{"line":176},"end":{"line":176}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"requiresAuthentication"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[],"loc":{"start":{"line":180},"end":{"line":180}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":180},"end":{"line":180}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"isAuthenticated"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":180},"end":{"line":180}}}],"loc":{"start":{"line":180},"end":{"line":180}}},"loc":{"start":{"line":180},"end":{"line":180}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":181},"end":{"line":184}}},"loc":{"start":{"line":180},"end":{"line":184}}}],"loc":{"start":{"line":177},"end":{"line":185}}},"alternate":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":187},"end":{"line":187}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":187},"end":{"line":187}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":187},"end":{"line":187}}}],"loc":{"start":{"line":187},"end":{"line":187}}},"loc":{"start":{"line":187},"end":{"line":187}}},"loc":{"start":{"line":176},"end":{"line":187}}}],"loc":{"start":{"line":174},"end":{"line":188}}},"loc":{"start":{"line":173},"end":{"line":214}}}],"loc":{"start":{"line":172},"end":{"line":215}}},"loc":{"start":{"line":171},"end":{"line":215}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setContent","loc":{"start":{"line":218},"end":{"line":218}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":218},"end":{"line":218}}},"arguments":[],"loc":{"start":{"line":218},"end":{"line":218}}}],"loc":{"start":{"line":218},"end":{"line":218}}},"loc":{"start":{"line":218},"end":{"line":218}}}],"loc":{"start":{"line":158},"end":{"line":219}}},"code":"\npublic void handleRequest(WebSession s) {\n    if (s.getLessonSession(this) \u003d\u003d null) s.openLessonSession(this);\n    String requestedActionName \u003d null;\n    try {\n        requestedActionName \u003d s.getParser().getStringParameter(\"action\");\n    } catch (ParameterNotFoundException pnfe) {\n        requestedActionName \u003d LOGIN_ACTION;\n    }\n    if (requestedActionName !\u003d null) {\n        try {\n            LessonAction action \u003d getAction(requestedActionName);\n            if (action !\u003d null) {\n                if (!action.requiresAuthentication() || action.isAuthenticated(s)) {\n                    action.handleRequest(s);\n                }\n            } else setCurrentAction(s, ERROR_ACTION);\n        } catch (ParameterNotFoundException pnfe) {\n            pnfe.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (ValidationException ve) {\n            ve.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (UnauthenticatedException ue) {\n            s.setMessage(\"Login failed\");\n            ue.printStackTrace();\n        } catch (UnauthorizedException ue2) {\n            s.setMessage(\"You are not authorized to perform this function\");\n            ue2.printStackTrace();\n        } catch (Exception e) {\n            e.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        }\n    }\n    setContent(new ElementContainer());\n}","loc":{"start":{"line":157},"end":{"line":219}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":221},"end":{"line":221}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":223},"end":{"line":223}}},"loc":{"start":{"line":223},"end":{"line":223}}}],"loc":{"start":{"line":222},"end":{"line":224}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":221},"end":{"line":224}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":231},"end":{"line":231}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"LAB: DB SQL Injection","raw":"LAB: DB SQL Injection"},"loc":{"start":{"line":233},"end":{"line":233}}}],"loc":{"start":{"line":232},"end":{"line":234}}},"code":"\npublic String getTitle() {\n    return \"LAB: DB SQL Injection\";\n}","loc":{"start":{"line":231},"end":{"line":234}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultHidden"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":236},"end":{"line":236}}},"arguments":[]}]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"driver","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":239},"end":{"line":239}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":239},"end":{"line":239}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":239},"end":{"line":239}}},"arguments":[],"loc":{"start":{"line":239},"end":{"line":239}}},"property":{"type":"Identifier","name":"getDatabaseDriver"},"loc":{"start":{"line":239},"end":{"line":239}}},"arguments":[],"loc":{"start":{"line":239},"end":{"line":239}}},"loc":{"start":{"line":239},"end":{"line":239}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hidden","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"argument":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"driver","loc":{"start":{"line":240},"end":{"line":240}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":240},"end":{"line":240}}},"arguments":[{"type":"Literal","value":"oracle","raw":"oracle"}],"loc":{"start":{"line":240},"end":{"line":240}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"driver","loc":{"start":{"line":240},"end":{"line":240}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":240},"end":{"line":240}}},"arguments":[{"type":"Literal","value":"jtds","raw":"jtds"}],"loc":{"start":{"line":240},"end":{"line":240}}},"loc":{"start":{"line":240},"end":{"line":240}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":240},"end":{"line":240}}},"loc":{"start":{"line":240},"end":{"line":240}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hidden","loc":{"start":{"line":241},"end":{"line":241}}},"loc":{"start":{"line":241},"end":{"line":241}}}],"loc":{"start":{"line":238},"end":{"line":242}}},"code":"\n@Override()\nprotected boolean getDefaultHidden() {\n    String driver \u003d getWebgoatContext().getDatabaseDriver();\n    boolean hidden \u003d !(driver.contains(\"oracle\") || driver.contains(\"jtds\"));\n    return hidden;\n}","loc":{"start":{"line":236},"end":{"line":242}}}],"loc":{"start":{"line":52},"end":{"line":244}}}],"loc":{"start":{"line":2},"end":{"line":244}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/DBSQLInjection/DBSQLInjection.java"}