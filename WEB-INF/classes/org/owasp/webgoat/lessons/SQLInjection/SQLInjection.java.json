{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"SQLInjection"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"BufferedReader"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"FileReader"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"DeleteProfile"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"EditProfile"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"FindProfile"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"LessonAction"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"Logout"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"SearchStaff"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"UpdateProfile"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"ParameterNotFoundException"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"UnauthenticatedException"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"UnauthorizedException"},"loc":{"start":{"line":21},"end":{"line":21}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"ValidationException"},"loc":{"start":{"line":22},"end":{"line":22}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":23},"end":{"line":23}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"SQLInjection"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":53},"end":{"line":53}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":55},"end":{"line":55}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":55},"end":{"line":55}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":55},"end":{"line":55}}},"arguments":[{"type":"Literal","value":75,"raw":75}],"loc":{"start":{"line":55},"end":{"line":55}}},"loc":{"start":{"line":55},"end":{"line":55}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"PRIZE_EMPLOYEE_ID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":112,"raw":112},"loc":{"start":{"line":57},"end":{"line":57}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"PRIZE_EMPLOYEE_NAME","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}},"init":{"type":"Literal","value":"Neville Bartholomew","raw":"Neville Bartholomew"},"loc":{"start":{"line":59},"end":{"line":59}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE1","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}},"init":{"type":"Literal","value":"String SQL Injection","raw":"String SQL Injection"},"loc":{"start":{"line":61},"end":{"line":61}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE2","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":63},"end":{"line":63}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":63},"end":{"line":63}}},"init":{"type":"Literal","value":"Parameterized Query #1","raw":"Parameterized Query #1"},"loc":{"start":{"line":63},"end":{"line":63}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE3","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":65},"end":{"line":65}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":65},"end":{"line":65}}},"init":{"type":"Literal","value":"Numeric SQL Injection","raw":"Numeric SQL Injection"},"loc":{"start":{"line":65},"end":{"line":65}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE4","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":67},"end":{"line":67}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":67},"end":{"line":67}}},"init":{"type":"Literal","value":"Parameterized Query #2","raw":"Parameterized Query #2"},"loc":{"start":{"line":67},"end":{"line":67}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"registerActions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"className","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":69},"end":{"line":69}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ListStaff","loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":71},"end":{"line":71}}},{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":71},"end":{"line":71}}}],"loc":{"start":{"line":71},"end":{"line":71}}}],"loc":{"start":{"line":71},"end":{"line":71}}},"loc":{"start":{"line":71},"end":{"line":71}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"SearchStaff","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":72},"end":{"line":72}}},{"type":"Identifier","name":"SEARCHSTAFF_ACTION","loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ViewProfile","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":73},"end":{"line":73}}},{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":74},"end":{"line":74}}},{"type":"Identifier","name":"EDITPROFILE_ACTION","loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":75},"end":{"line":75}}},{"type":"Identifier","name":"CREATEPROFILE_ACTION","loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Login","loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":78},"end":{"line":78}}},{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":78},"end":{"line":78}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Logout","loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":79},"end":{"line":79}}},{"type":"Identifier","name":"LOGOUT_ACTION","loc":{"start":{"line":79},"end":{"line":79}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"FindProfile","loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":80},"end":{"line":80}}},{"type":"Identifier","name":"FINDPROFILE_ACTION","loc":{"start":{"line":80},"end":{"line":80}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":81},"end":{"line":81}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UpdateProfile","loc":{"start":{"line":81},"end":{"line":81}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":81},"end":{"line":81}}},{"type":"Identifier","name":"UPDATEPROFILE_ACTION","loc":{"start":{"line":81},"end":{"line":81}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":81},"end":{"line":81}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":81},"end":{"line":81}}}],"loc":{"start":{"line":81},"end":{"line":81}}}],"loc":{"start":{"line":81},"end":{"line":81}}}],"loc":{"start":{"line":81},"end":{"line":81}}},"loc":{"start":{"line":81},"end":{"line":81}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"DeleteProfile","loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":82},"end":{"line":82}}},{"type":"Identifier","name":"DELETEPROFILE_ACTION","loc":{"start":{"line":82},"end":{"line":82}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":70},"end":{"line":83}}},"code":"\npublic void registerActions(String className) {\n    registerAction(new ListStaff(this, className, LISTSTAFF_ACTION));\n    registerAction(new SearchStaff(this, className, SEARCHSTAFF_ACTION));\n    registerAction(new ViewProfile(this, className, VIEWPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, EDITPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, CREATEPROFILE_ACTION));\n    registerAction(new Login(this, className, LOGIN_ACTION, getAction(LISTSTAFF_ACTION)));\n    registerAction(new Logout(this, className, LOGOUT_ACTION, getAction(LOGIN_ACTION)));\n    registerAction(new FindProfile(this, className, FINDPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new UpdateProfile(this, className, UPDATEPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new DeleteProfile(this, className, DELETEPROFILE_ACTION, getAction(LISTSTAFF_ACTION)));\n}","loc":{"start":{"line":69},"end":{"line":83}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":90},"end":{"line":90}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"INJECTION"},"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":91},"end":{"line":93}}},"code":"\npublic Category getDefaultCategory() {\n    return Category.INJECTION;\n}","loc":{"start":{"line":90},"end":{"line":93}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":100},"end":{"line":100}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":100},"end":{"line":100}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":102},"end":{"line":102}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":102},"end":{"line":102}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":102},"end":{"line":102}}},"arguments":[],"loc":{"start":{"line":102},"end":{"line":102}}},"loc":{"start":{"line":102},"end":{"line":102}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[{"type":"Literal","value":"The application is taking your input and inserting it at the end of a pre-formed SQL command.","raw":"The application is taking your input and inserting it at the end of a pre-formed SQL command."}],"loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[{"type":"Literal","value":"This is the code for the query being built and issued by WebGoat:\u003cbr\u003e\u003cbr\u003e \"SELECT * FROM employee WHERE userid \u003d \" + userId + \" and password \u003d \" + password","raw":"This is the code for the query being built and issued by WebGoat:\u003cbr\u003e\u003cbr\u003e \"SELECT * FROM employee WHERE userid \u003d \" + userId + \" and password \u003d \" + password"}],"loc":{"start":{"line":104},"end":{"line":105}}},"loc":{"start":{"line":104},"end":{"line":105}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":106},"end":{"line":106}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":106},"end":{"line":106}}},"arguments":[{"type":"Literal","value":"Compound SQL statements can be made by joining multiple tests with keywords like AND and OR.  Try appending a SQL statement that always resolves to true","raw":"Compound SQL statements can be made by joining multiple tests with keywords like AND and OR.  Try appending a SQL statement that always resolves to true"}],"loc":{"start":{"line":106},"end":{"line":107}}},"loc":{"start":{"line":106},"end":{"line":107}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":110},"end":{"line":110}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":110},"end":{"line":110}}},"arguments":[{"type":"Literal","value":"You may need to use WebScarab to remove a field length limit to fit your attack.","raw":"You may need to use WebScarab to remove a field length limit to fit your attack."}],"loc":{"start":{"line":110},"end":{"line":110}}},"loc":{"start":{"line":110},"end":{"line":110}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":111},"end":{"line":111}}},"arguments":[{"type":"Literal","value":"Try entering a password of [ smith\u0027 OR \u00271\u0027 \u003d \u00271 ].","raw":"Try entering a password of [ smith\u0027 OR \u00271\u0027 \u003d \u00271 ]."}],"loc":{"start":{"line":111},"end":{"line":111}}},"loc":{"start":{"line":111},"end":{"line":111}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":114},"end":{"line":114}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":114},"end":{"line":115}}},"arguments":[{"type":"Literal","value":"Many of WebGoat\u0027s database queries are already parameterized.  Search the project for PreparedStatement.","raw":"Many of WebGoat\u0027s database queries are already parameterized.  Search the project for PreparedStatement."}],"loc":{"start":{"line":114},"end":{"line":115}}},"loc":{"start":{"line":114},"end":{"line":115}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":118},"end":{"line":118}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[{"type":"Literal","value":"Try entering an employee_id of [ 101 or 1\u003d1 order by salary desc ].","raw":"Try entering an employee_id of [ 101 or 1\u003d1 order by salary desc ]."}],"loc":{"start":{"line":118},"end":{"line":118}}},"loc":{"start":{"line":118},"end":{"line":118}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":122},"end":{"line":122}}},"loc":{"start":{"line":122},"end":{"line":122}}}],"loc":{"start":{"line":101},"end":{"line":123}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"The application is taking your input and inserting it at the end of a pre-formed SQL command.\");\n    hints.add(\"This is the code for the query being built and issued by WebGoat:\u003cbr\u003e\u003cbr\u003e \\\"SELECT * FROM employee WHERE userid \u003d \\\" + userId + \\\" and password \u003d \\\" + password\");\n    hints.add(\"Compound SQL statements can be made by joining multiple tests with keywords like AND and OR.  Try appending a SQL statement that always resolves to true\");\n    hints.add(\"You may need to use WebScarab to remove a field length limit to fit your attack.\");\n    hints.add(\"Try entering a password of [ smith\\\u0027 OR \\\u00271\\\u0027 \u003d \\\u00271 ].\");\n    hints.add(\"Many of WebGoat\\\u0027s database queries are already parameterized.  Search the project for PreparedStatement.\");\n    hints.add(\"Try entering an employee_id of [ 101 or 1\u003d1 order by salary desc ].\");\n    return hints;\n}","loc":{"start":{"line":100},"end":{"line":123}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getStages"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[]}]},"restype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":126},"end":{"line":126}}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[],"loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"isCodingExercises"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[],"loc":{"start":{"line":128},"end":{"line":128}}},"consequent":{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":128},"end":{"line":128}}},{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":128},"end":{"line":128}}},{"type":"Identifier","name":"STAGE3","loc":{"start":{"line":128},"end":{"line":128}}},{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}},{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":129},"end":{"line":129}}},{"type":"Identifier","name":"STAGE3","loc":{"start":{"line":129},"end":{"line":129}}}],"loc":{"start":{"line":129},"end":{"line":129}}},"loc":{"start":{"line":129},"end":{"line":129}}}],"loc":{"start":{"line":127},"end":{"line":130}}},"code":"\n@Override()\npublic String[] getStages() {\n    if (getWebgoatContext().isCodingExercises()) return new String[]{STAGE1, STAGE2, STAGE3, STAGE4};\n    return new String[]{STAGE1, STAGE3};\n}","loc":{"start":{"line":125},"end":{"line":130}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":137},"end":{"line":137}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":137},"end":{"line":137}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":139},"end":{"line":139}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":139},"end":{"line":139}}},"init":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":139},"end":{"line":139}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":141},"end":{"line":141}}}],"loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"getCompleted"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[],"loc":{"start":{"line":141},"end":{"line":141}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":141},"end":{"line":141}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":143},"end":{"line":143}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":143},"end":{"line":143}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":144},"end":{"line":144}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":144},"end":{"line":144}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":144},"end":{"line":144}}}],"loc":{"start":{"line":144},"end":{"line":144}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":146},"end":{"line":146}}},"right":{"type":"Literal","value":"Stage 1: Use String SQL Injection to bypass authentication. Use SQL injection to log in as the boss (\u0027Neville\u0027) without using the correct password.  Verify that Neville\u0027s profile can be viewed and that all functions are available (including Search, Create, and Delete).","raw":"Stage 1: Use String SQL Injection to bypass authentication. Use SQL injection to log in as the boss (\u0027Neville\u0027) without using the correct password.  Verify that Neville\u0027s profile can be viewed and that all functions are available (including Search, Create, and Delete)."},"loc":{"start":{"line":146},"end":{"line":148}}},"loc":{"start":{"line":146},"end":{"line":148}}}],"loc":{"start":{"line":145},"end":{"line":149}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":150},"end":{"line":150}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":150},"end":{"line":150}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":152},"end":{"line":152}}},"right":{"type":"Literal","value":"Stage 2: Block SQL Injection using a Parameterized Query.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr\u003e\u003cbr\u003eImplement a fix to block SQL injection into the fields in question on the Login page. Repeat stage 1.  Verify that the attack is no longer effective.","raw":"Stage 2: Block SQL Injection using a Parameterized Query.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr\u003e\u003cbr\u003eImplement a fix to block SQL injection into the fields in question on the Login page. Repeat stage 1.  Verify that the attack is no longer effective."},"loc":{"start":{"line":152},"end":{"line":155}}},"loc":{"start":{"line":152},"end":{"line":155}}}],"loc":{"start":{"line":151},"end":{"line":156}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE3","loc":{"start":{"line":157},"end":{"line":157}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":157},"end":{"line":157}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":157},"end":{"line":157}}}],"loc":{"start":{"line":157},"end":{"line":157}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":159},"end":{"line":159}}},"right":{"type":"Literal","value":"Stage 3: Execute SQL Injection to bypass authorization.\u003cbr\u003eAs regular employee \u0027Larry\u0027, use SQL injection into a parameter of the View function (from the List Staff page) to view the profile of the boss (\u0027Neville\u0027).","raw":"Stage 3: Execute SQL Injection to bypass authorization.\u003cbr\u003eAs regular employee \u0027Larry\u0027, use SQL injection into a parameter of the View function (from the List Staff page) to view the profile of the boss (\u0027Neville\u0027)."},"loc":{"start":{"line":159},"end":{"line":161}}},"loc":{"start":{"line":159},"end":{"line":161}}}],"loc":{"start":{"line":158},"end":{"line":162}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":163},"end":{"line":163}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":163},"end":{"line":163}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":163},"end":{"line":163}}}],"loc":{"start":{"line":163},"end":{"line":163}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":165},"end":{"line":165}}},"right":{"type":"Literal","value":"Stage 4: Block SQL Injection using a Parameterized Query.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr\u003e\u003cbr\u003eImplement a fix to block SQL injection into the relevant parameter. Repeat stage 3.  Verify that access to Neville\u0027s profile is properly blocked.","raw":"Stage 4: Block SQL Injection using a Parameterized Query.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr\u003e\u003cbr\u003eImplement a fix to block SQL injection into the relevant parameter. Repeat stage 3.  Verify that access to Neville\u0027s profile is properly blocked."},"loc":{"start":{"line":165},"end":{"line":168}}},"loc":{"start":{"line":165},"end":{"line":168}}}],"loc":{"start":{"line":164},"end":{"line":169}}},"loc":{"start":{"line":163},"end":{"line":169}}},"loc":{"start":{"line":157},"end":{"line":169}}},"loc":{"start":{"line":150},"end":{"line":169}}},"loc":{"start":{"line":144},"end":{"line":169}}}],"loc":{"start":{"line":142},"end":{"line":170}}},"loc":{"start":{"line":141},"end":{"line":170}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":172},"end":{"line":172}}},"loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":138},"end":{"line":173}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"\";\n    if (!getLessonTracker(s).getCompleted()) {\n        String stage \u003d getStage(s);\n        if (STAGE1.equals(stage)) {\n            instructions \u003d \"Stage 1: Use String SQL Injection to bypass authentication. Use SQL injection to log in as the boss (\\\u0027Neville\\\u0027) without using the correct password.  Verify that Neville\\\u0027s profile can be viewed and that all functions are available (including Search, Create, and Delete).\";\n        } else if (STAGE2.equals(stage)) {\n            instructions \u003d \"Stage 2: Block SQL Injection using a Parameterized Query.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr\u003e\u003cbr\u003eImplement a fix to block SQL injection into the fields in question on the Login page. Repeat stage 1.  Verify that the attack is no longer effective.\";\n        } else if (STAGE3.equals(stage)) {\n            instructions \u003d \"Stage 3: Execute SQL Injection to bypass authorization.\u003cbr\u003eAs regular employee \\\u0027Larry\\\u0027, use SQL injection into a parameter of the View function (from the List Staff page) to view the profile of the boss (\\\u0027Neville\\\u0027).\";\n        } else if (STAGE4.equals(stage)) {\n            instructions \u003d \"Stage 4: Block SQL Injection using a Parameterized Query.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr\u003e\u003cbr\u003eImplement a fix to block SQL injection into the relevant parameter. Repeat stage 3.  Verify that access to Neville\\\u0027s profile is properly blocked.\";\n        }\n    }\n    return instructions;\n}","loc":{"start":{"line":137},"end":{"line":173}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"handleRequest"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":175},"end":{"line":175}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"getLessonSession"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":177},"end":{"line":177}}},"right":{"type":"Literal"},"loc":{"start":{"line":177},"end":{"line":177}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"openLessonSession"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"requestedActionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":179},"end":{"line":179}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":179},"end":{"line":179}}},"init":{"type":"Literal"},"loc":{"start":{"line":179},"end":{"line":179}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":183},"end":{"line":183}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":186},"end":{"line":186}}},"right":{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":186},"end":{"line":186}}},"loc":{"start":{"line":186},"end":{"line":186}}},"loc":{"start":{"line":186},"end":{"line":186}}}],"loc":{"start":{"line":184},"end":{"line":187}}},"loc":{"start":{"line":183},"end":{"line":187}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":182},"end":{"line":182}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[],"loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[{"type":"Literal","value":"action","raw":"action"}],"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":181},"end":{"line":183}}},"loc":{"start":{"line":180},"end":{"line":187}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":189},"end":{"line":189}}},"right":{"type":"Literal"},"loc":{"start":{"line":189},"end":{"line":189}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":206},"end":{"line":206}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pnfe","loc":{"start":{"line":209},"end":{"line":209}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":209},"end":{"line":209}}},"arguments":[],"loc":{"start":{"line":209},"end":{"line":209}}},"loc":{"start":{"line":209},"end":{"line":209}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":210},"end":{"line":210}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":210},"end":{"line":210}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":210},"end":{"line":210}}}],"loc":{"start":{"line":210},"end":{"line":210}}},"loc":{"start":{"line":210},"end":{"line":210}}}],"loc":{"start":{"line":207},"end":{"line":211}}},"loc":{"start":{"line":206},"end":{"line":211}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ve","vartype":{"type":"Identifier","name":"ValidationException","loc":{"start":{"line":211},"end":{"line":211}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ve","loc":{"start":{"line":214},"end":{"line":214}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":214},"end":{"line":214}}},"arguments":[],"loc":{"start":{"line":214},"end":{"line":214}}},"loc":{"start":{"line":214},"end":{"line":214}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":215},"end":{"line":215}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":215},"end":{"line":215}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":215},"end":{"line":215}}}],"loc":{"start":{"line":215},"end":{"line":215}}},"loc":{"start":{"line":215},"end":{"line":215}}}],"loc":{"start":{"line":212},"end":{"line":216}}},"loc":{"start":{"line":211},"end":{"line":216}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue","vartype":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":216},"end":{"line":216}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":218},"end":{"line":218}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":218},"end":{"line":218}}},"arguments":[{"type":"Literal","value":"Login failed","raw":"Login failed"}],"loc":{"start":{"line":218},"end":{"line":218}}},"loc":{"start":{"line":218},"end":{"line":218}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue","loc":{"start":{"line":220},"end":{"line":220}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":220},"end":{"line":220}}},"arguments":[],"loc":{"start":{"line":220},"end":{"line":220}}},"loc":{"start":{"line":220},"end":{"line":220}}}],"loc":{"start":{"line":217},"end":{"line":221}}},"loc":{"start":{"line":216},"end":{"line":221}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue2","vartype":{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":221},"end":{"line":221}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":223},"end":{"line":223}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":223},"end":{"line":223}}},"arguments":[{"type":"Literal","value":"You are not authorized to perform this function","raw":"You are not authorized to perform this function"}],"loc":{"start":{"line":223},"end":{"line":223}}},"loc":{"start":{"line":223},"end":{"line":223}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue2","loc":{"start":{"line":225},"end":{"line":225}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":225},"end":{"line":225}}},"arguments":[],"loc":{"start":{"line":225},"end":{"line":225}}},"loc":{"start":{"line":225},"end":{"line":225}}}],"loc":{"start":{"line":222},"end":{"line":226}}},"loc":{"start":{"line":221},"end":{"line":226}}},{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":226},"end":{"line":226}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":230},"end":{"line":230}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":230},"end":{"line":230}}},"arguments":[],"loc":{"start":{"line":230},"end":{"line":230}}},"loc":{"start":{"line":230},"end":{"line":230}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":231},"end":{"line":231}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":231},"end":{"line":231}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":231},"end":{"line":231}}}],"loc":{"start":{"line":231},"end":{"line":231}}},"loc":{"start":{"line":231},"end":{"line":231}}}],"loc":{"start":{"line":227},"end":{"line":232}}},"loc":{"start":{"line":226},"end":{"line":232}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"action","vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":193},"end":{"line":193}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":193},"end":{"line":193}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":193},"end":{"line":193}}},"arguments":[{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":193},"end":{"line":193}}}],"loc":{"start":{"line":193},"end":{"line":193}}},"loc":{"start":{"line":193},"end":{"line":193}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"action","loc":{"start":{"line":194},"end":{"line":194}}},"right":{"type":"Literal"},"loc":{"start":{"line":194},"end":{"line":194}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"requiresAuthentication"},"loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[],"loc":{"start":{"line":198},"end":{"line":198}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":198},"end":{"line":198}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"isAuthenticated"},"loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":198},"end":{"line":198}}}],"loc":{"start":{"line":198},"end":{"line":198}}},"loc":{"start":{"line":198},"end":{"line":198}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":200},"end":{"line":200}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":200},"end":{"line":200}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":200},"end":{"line":200}}}],"loc":{"start":{"line":200},"end":{"line":200}}},"loc":{"start":{"line":200},"end":{"line":200}}}],"loc":{"start":{"line":199},"end":{"line":202}}},"loc":{"start":{"line":198},"end":{"line":202}}}],"loc":{"start":{"line":195},"end":{"line":203}}},"alternate":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":205},"end":{"line":205}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":205},"end":{"line":205}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":205},"end":{"line":205}}}],"loc":{"start":{"line":205},"end":{"line":205}}},"loc":{"start":{"line":205},"end":{"line":205}}},"loc":{"start":{"line":194},"end":{"line":205}}}],"loc":{"start":{"line":192},"end":{"line":206}}},"loc":{"start":{"line":191},"end":{"line":232}}}],"loc":{"start":{"line":190},"end":{"line":233}}},"loc":{"start":{"line":189},"end":{"line":233}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setContent","loc":{"start":{"line":236},"end":{"line":236}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":236},"end":{"line":236}}},"arguments":[],"loc":{"start":{"line":236},"end":{"line":236}}}],"loc":{"start":{"line":236},"end":{"line":236}}},"loc":{"start":{"line":236},"end":{"line":236}}}],"loc":{"start":{"line":176},"end":{"line":237}}},"code":"\npublic void handleRequest(WebSession s) {\n    if (s.getLessonSession(this) \u003d\u003d null) s.openLessonSession(this);\n    String requestedActionName \u003d null;\n    try {\n        requestedActionName \u003d s.getParser().getStringParameter(\"action\");\n    } catch (ParameterNotFoundException pnfe) {\n        requestedActionName \u003d LOGIN_ACTION;\n    }\n    if (requestedActionName !\u003d null) {\n        try {\n            LessonAction action \u003d getAction(requestedActionName);\n            if (action !\u003d null) {\n                if (!action.requiresAuthentication() || action.isAuthenticated(s)) {\n                    action.handleRequest(s);\n                }\n            } else setCurrentAction(s, ERROR_ACTION);\n        } catch (ParameterNotFoundException pnfe) {\n            pnfe.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (ValidationException ve) {\n            ve.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (UnauthenticatedException ue) {\n            s.setMessage(\"Login failed\");\n            ue.printStackTrace();\n        } catch (UnauthorizedException ue2) {\n            s.setMessage(\"You are not authorized to perform this function\");\n            ue2.printStackTrace();\n        } catch (Exception e) {\n            e.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        }\n    }\n    setContent(new ElementContainer());\n}","loc":{"start":{"line":175},"end":{"line":237}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":239},"end":{"line":239}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":241},"end":{"line":241}}},"loc":{"start":{"line":241},"end":{"line":241}}}],"loc":{"start":{"line":240},"end":{"line":242}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":239},"end":{"line":242}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":249},"end":{"line":249}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"LAB: SQL Injection","raw":"LAB: SQL Injection"},"loc":{"start":{"line":251},"end":{"line":251}}}],"loc":{"start":{"line":250},"end":{"line":252}}},"code":"\npublic String getTitle() {\n    return \"LAB: SQL Injection\";\n}","loc":{"start":{"line":249},"end":{"line":252}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSolution"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":254},"end":{"line":254}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":255},"end":{"line":255}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":255},"end":{"line":255}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"src","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":257},"end":{"line":257}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":257},"end":{"line":257}}},"init":{"type":"Literal"},"loc":{"start":{"line":257},"end":{"line":257}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"IOException","loc":{"start":{"line":263},"end":{"line":263}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":265},"end":{"line":265}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":265},"end":{"line":265}}},"arguments":[{"type":"Literal","value":"Could not find the solution file","raw":"Could not find the solution file"}],"loc":{"start":{"line":265},"end":{"line":265}}},"loc":{"start":{"line":265},"end":{"line":265}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"src","loc":{"start":{"line":266},"end":{"line":266}}},"right":{"type":"Literal","value":"Could not find the solution file","raw":"Could not find the solution file"},"loc":{"start":{"line":266},"end":{"line":266}}},"loc":{"start":{"line":266},"end":{"line":266}}}],"loc":{"start":{"line":264},"end":{"line":267}}},"loc":{"start":{"line":263},"end":{"line":267}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"src","loc":{"start":{"line":261},"end":{"line":261}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"readFromFile","loc":{"start":{"line":261},"end":{"line":261}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":261},"end":{"line":261}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"FileReader","loc":{"start":{"line":261},"end":{"line":261}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":261},"end":{"line":261}}},"property":{"type":"Identifier","name":"getWebResource"},"loc":{"start":{"line":261},"end":{"line":261}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonSolutionFileName","loc":{"start":{"line":261},"end":{"line":261}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":261},"end":{"line":261}}}],"loc":{"start":{"line":261},"end":{"line":261}}}],"loc":{"start":{"line":261},"end":{"line":261}}}],"loc":{"start":{"line":261},"end":{"line":261}}}],"loc":{"start":{"line":261},"end":{"line":261}}},{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":261},"end":{"line":262}}},"loc":{"start":{"line":261},"end":{"line":262}}},"loc":{"start":{"line":261},"end":{"line":262}}}],"loc":{"start":{"line":260},"end":{"line":263}}},"loc":{"start":{"line":259},"end":{"line":267}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"src","loc":{"start":{"line":268},"end":{"line":268}}},"loc":{"start":{"line":268},"end":{"line":268}}}],"loc":{"start":{"line":256},"end":{"line":269}}},"code":"\n@Override()\npublic String getSolution(WebSession s) {\n    String src \u003d null;\n    try {\n        src \u003d readFromFile(new BufferedReader(new FileReader(s.getWebResource(getLessonSolutionFileName(s)))), false);\n    } catch (IOException e) {\n        s.setMessage(\"Could not find the solution file\");\n        src \u003d (\"Could not find the solution file\");\n    }\n    return src;\n}","loc":{"start":{"line":254},"end":{"line":269}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessonSolutionFileName"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":271},"end":{"line":271}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":271},"end":{"line":271}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"solutionFileName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":273},"end":{"line":273}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":273},"end":{"line":273}}},"init":{"type":"Literal"},"loc":{"start":{"line":273},"end":{"line":273}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":274},"end":{"line":274}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":274},"end":{"line":274}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":274},"end":{"line":274}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":274},"end":{"line":274}}}],"loc":{"start":{"line":274},"end":{"line":274}}},"loc":{"start":{"line":274},"end":{"line":274}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"solutionFileName","loc":{"start":{"line":275},"end":{"line":275}}},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"/lesson_solutions/Lab SQL Injection/Lab ","raw":"/lesson_solutions/Lab SQL Injection/Lab "},"right":{"type":"Identifier","name":"stage","loc":{"start":{"line":275},"end":{"line":275}}},"loc":{"start":{"line":275},"end":{"line":275}}},"right":{"type":"Literal","value":".html","raw":".html"},"loc":{"start":{"line":275},"end":{"line":275}}},"loc":{"start":{"line":275},"end":{"line":275}}},"loc":{"start":{"line":275},"end":{"line":275}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"solutionFileName","loc":{"start":{"line":276},"end":{"line":276}}},"loc":{"start":{"line":276},"end":{"line":276}}}],"loc":{"start":{"line":272},"end":{"line":277}}},"code":"\npublic String getLessonSolutionFileName(WebSession s) {\n    String solutionFileName \u003d null;\n    String stage \u003d getStage(s);\n    solutionFileName \u003d \"/lesson_solutions/Lab SQL Injection/Lab \" + stage + \".html\";\n    return solutionFileName;\n}","loc":{"start":{"line":271},"end":{"line":277}}}],"loc":{"start":{"line":53},"end":{"line":278}}}],"loc":{"start":{"line":2},"end":{"line":278}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/SQLInjection/SQLInjection.java"}