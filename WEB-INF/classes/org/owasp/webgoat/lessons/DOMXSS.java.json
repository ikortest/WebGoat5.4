{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"BufferedReader"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"FileReader"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"StringElement"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"A"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"BR"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"H1"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"IMG"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"Input"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"Script"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"DOMXSS"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"SequentialLessonAdapter","loc":{"start":{"line":22},"end":{"line":22}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ASPECT_LOGO","vartype":{"type":"Identifier","name":"A","loc":{"start":{"line":25},"end":{"line":25}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"A","loc":{"start":{"line":25},"end":{"line":25}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"A","loc":{"start":{"line":25},"end":{"line":25}}},"arguments":[],"loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"setHref"},"loc":{"start":{"line":25},"end":{"line":25}}},"arguments":[{"type":"Literal","value":"http://www.aspectsecurity.com","raw":"http://www.aspectsecurity.com"}],"loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":25},"end":{"line":26}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"IMG","loc":{"start":{"line":27},"end":{"line":27}}},"arguments":[{"type":"Literal","value":"images/logos/aspect.jpg","raw":"images/logos/aspect.jpg"}],"loc":{"start":{"line":27},"end":{"line":27}}},"property":{"type":"Identifier","name":"setAlt"},"loc":{"start":{"line":27},"end":{"line":27}}},"arguments":[{"type":"Literal","value":"Aspect Security","raw":"Aspect Security"}],"loc":{"start":{"line":27},"end":{"line":27}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":27},"end":{"line":27}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":27},"end":{"line":27}}},"property":{"type":"Identifier","name":"setHspace"},"loc":{"start":{"line":27},"end":{"line":27}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":27},"end":{"line":27}}},"property":{"type":"Identifier","name":"setVspace"},"loc":{"start":{"line":27},"end":{"line":28}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":27},"end":{"line":28}}}],"loc":{"start":{"line":25},"end":{"line":28}}},"loc":{"start":{"line":25},"end":{"line":28}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"PERSON","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":30},"end":{"line":30}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":30},"end":{"line":30}}},"init":{"type":"Literal","value":"person","raw":"person"},"loc":{"start":{"line":30},"end":{"line":30}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":39},"end":{"line":39}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":39},"end":{"line":39}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":41},"end":{"line":41}}},"property":{"type":"Identifier","name":"createStagedContent"},"loc":{"start":{"line":41},"end":{"line":41}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":41},"end":{"line":41}}}],"loc":{"start":{"line":41},"end":{"line":41}}},"loc":{"start":{"line":41},"end":{"line":41}}}],"loc":{"start":{"line":40},"end":{"line":42}}},"code":"\nprotected Element createContent(WebSession s) {\n    return super.createStagedContent(s);\n}","loc":{"start":{"line":39},"end":{"line":42}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doStage1"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":44},"end":{"line":44}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":44},"end":{"line":44}}}}],"thrown":[{"type":"Identifier","name":"Exception","loc":{"start":{"line":44},"end":{"line":44}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":46},"end":{"line":46}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":46},"end":{"line":46}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":46},"end":{"line":46}}},"arguments":[],"loc":{"start":{"line":46},"end":{"line":46}}},"loc":{"start":{"line":46},"end":{"line":46}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"attackString","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":48},"end":{"line":48}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":48},"end":{"line":48}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":48},"end":{"line":48}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":48},"end":{"line":48}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":48},"end":{"line":48}}},"arguments":[],"loc":{"start":{"line":48},"end":{"line":48}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":48},"end":{"line":48}}},"arguments":[{"type":"Identifier","name":"PERSON","loc":{"start":{"line":48},"end":{"line":48}}},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":48},"end":{"line":48}}}],"loc":{"start":{"line":48},"end":{"line":48}}},"loc":{"start":{"line":48},"end":{"line":48}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":50},"end":{"line":50}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":50},"end":{"line":50}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"mainContent","loc":{"start":{"line":50},"end":{"line":50}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":50},"end":{"line":50}}}],"loc":{"start":{"line":50},"end":{"line":50}}}],"loc":{"start":{"line":50},"end":{"line":50}}},"loc":{"start":{"line":50},"end":{"line":50}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[],"loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[],"loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[{"type":"Literal","value":"img","raw":"img"}],"loc":{"start":{"line":52},"end":{"line":52}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":52},"end":{"line":52}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":53},"end":{"line":53}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":53},"end":{"line":53}}},"arguments":[],"loc":{"start":{"line":53},"end":{"line":53}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":53},"end":{"line":53}}},"arguments":[],"loc":{"start":{"line":53},"end":{"line":53}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":53},"end":{"line":53}}},"arguments":[{"type":"Literal","value":"images/logos/owasp.jpg","raw":"images/logos/owasp.jpg"}],"loc":{"start":{"line":53},"end":{"line":53}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":53},"end":{"line":53}}},"loc":{"start":{"line":52},"end":{"line":53}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":55},"end":{"line":55}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":55},"end":{"line":55}}}],"loc":{"start":{"line":55},"end":{"line":55}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":55},"end":{"line":55}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":55},"end":{"line":55}}},"loc":{"start":{"line":55},"end":{"line":55}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":56},"end":{"line":56}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":56},"end":{"line":56}}},"arguments":[{"type":"Literal","value":"Stage 1 completed. ","raw":"Stage 1 completed. "}],"loc":{"start":{"line":56},"end":{"line":56}}},"loc":{"start":{"line":56},"end":{"line":56}}}],"loc":{"start":{"line":54},"end":{"line":57}}},"loc":{"start":{"line":52},"end":{"line":57}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":59},"end":{"line":59}}},"loc":{"start":{"line":59},"end":{"line":59}}}],"loc":{"start":{"line":45},"end":{"line":60}}},"code":"\nprotected Element doStage1(WebSession s) throws Exception {\n    ElementContainer ec \u003d new ElementContainer();\n    StringBuffer attackString \u003d new StringBuffer(s.getParser().getStringParameter(PERSON, \"\"));\n    ec.addElement(mainContent(s));\n    if (attackString.toString().toLowerCase().indexOf(\"img\") !\u003d -1 \u0026\u0026 attackString.toString().toLowerCase().indexOf(\"images/logos/owasp.jpg\") !\u003d -1) {\n        getLessonTracker(s).setStage(2);\n        s.setMessage(\"Stage 1 completed. \");\n    }\n    return (ec);\n}","loc":{"start":{"line":44},"end":{"line":60}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doStage2"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":62},"end":{"line":62}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":62},"end":{"line":62}}}}],"thrown":[{"type":"Identifier","name":"Exception","loc":{"start":{"line":62},"end":{"line":62}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":64},"end":{"line":64}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":64},"end":{"line":64}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":64},"end":{"line":64}}},"arguments":[],"loc":{"start":{"line":64},"end":{"line":64}}},"loc":{"start":{"line":64},"end":{"line":64}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"attackString","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":66},"end":{"line":66}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":66},"end":{"line":66}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[],"loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"Identifier","name":"PERSON","loc":{"start":{"line":66},"end":{"line":66}}},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":66},"end":{"line":66}}},"loc":{"start":{"line":66},"end":{"line":66}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":68},"end":{"line":68}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"mainContent","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":70},"end":{"line":70}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[],"loc":{"start":{"line":70},"end":{"line":70}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[],"loc":{"start":{"line":70},"end":{"line":70}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[{"type":"Literal","value":"img","raw":"img"}],"loc":{"start":{"line":70},"end":{"line":70}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":70},"end":{"line":70}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":71},"end":{"line":71}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[],"loc":{"start":{"line":71},"end":{"line":71}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[],"loc":{"start":{"line":71},"end":{"line":71}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[{"type":"Literal","value":"onerror","raw":"onerror"}],"loc":{"start":{"line":71},"end":{"line":71}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":71},"end":{"line":71}}},"loc":{"start":{"line":70},"end":{"line":71}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[],"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[],"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Literal","value":"alert","raw":"alert"}],"loc":{"start":{"line":72},"end":{"line":72}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":70},"end":{"line":72}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"Literal","value":3,"raw":3}],"loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":75},"end":{"line":75}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"Literal","value":"Stage 2 completed. ","raw":"Stage 2 completed. "}],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":73},"end":{"line":76}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"Literal","value":"Only \u0026lt;img onerror...  attacks are recognized for success criteria","raw":"Only \u0026lt;img onerror...  attacks are recognized for success criteria"}],"loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":78},"end":{"line":80}}},"loc":{"start":{"line":70},"end":{"line":80}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":63},"end":{"line":83}}},"code":"\nprotected Element doStage2(WebSession s) throws Exception {\n    ElementContainer ec \u003d new ElementContainer();\n    StringBuffer attackString \u003d new StringBuffer(s.getParser().getStringParameter(PERSON, \"\"));\n    ec.addElement(mainContent(s));\n    if (attackString.toString().toLowerCase().indexOf(\"img\") !\u003d -1 \u0026\u0026 attackString.toString().toLowerCase().indexOf(\"onerror\") !\u003d -1 \u0026\u0026 attackString.toString().toLowerCase().indexOf(\"alert\") !\u003d -1) {\n        getLessonTracker(s).setStage(3);\n        s.setMessage(\"Stage 2 completed. \");\n    } else {\n        s.setMessage(\"Only \u0026lt;img onerror...  attacks are recognized for success criteria\");\n    }\n    return (ec);\n}","loc":{"start":{"line":62},"end":{"line":83}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doStage3"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":85},"end":{"line":85}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":85},"end":{"line":85}}}}],"thrown":[{"type":"Identifier","name":"Exception","loc":{"start":{"line":85},"end":{"line":85}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":87},"end":{"line":87}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":87},"end":{"line":87}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":87},"end":{"line":87}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"attackString","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":89},"end":{"line":89}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":89},"end":{"line":89}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[],"loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"Identifier","name":"PERSON","loc":{"start":{"line":89},"end":{"line":89}}},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":89},"end":{"line":89}}}],"loc":{"start":{"line":89},"end":{"line":89}}},"loc":{"start":{"line":89},"end":{"line":89}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"mainContent","loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":91},"end":{"line":91}}}],"loc":{"start":{"line":91},"end":{"line":91}}}],"loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":91},"end":{"line":91}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"Literal","value":"iframe","raw":"iframe"}],"loc":{"start":{"line":93},"end":{"line":93}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":93},"end":{"line":93}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[{"type":"Literal","value":"javascript:alert","raw":"javascript:alert"}],"loc":{"start":{"line":94},"end":{"line":94}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":94},"end":{"line":94}}},"loc":{"start":{"line":93},"end":{"line":94}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":96},"end":{"line":96}}}],"loc":{"start":{"line":96},"end":{"line":96}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[{"type":"Literal","value":4,"raw":4}],"loc":{"start":{"line":96},"end":{"line":96}}},"loc":{"start":{"line":96},"end":{"line":96}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":97},"end":{"line":97}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[{"type":"Literal","value":"Stage 3 completed.","raw":"Stage 3 completed."}],"loc":{"start":{"line":97},"end":{"line":97}}},"loc":{"start":{"line":97},"end":{"line":97}}}],"loc":{"start":{"line":95},"end":{"line":98}}},"alternate":{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":98},"end":{"line":98}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[],"loc":{"start":{"line":98},"end":{"line":98}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[],"loc":{"start":{"line":98},"end":{"line":98}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[{"type":"Literal","value":"iframe","raw":"iframe"}],"loc":{"start":{"line":98},"end":{"line":98}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":98},"end":{"line":98}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[{"type":"Literal","value":"onload","raw":"onload"}],"loc":{"start":{"line":99},"end":{"line":99}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":98},"end":{"line":99}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[],"loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[],"loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"Literal","value":"alert","raw":"alert"}],"loc":{"start":{"line":100},"end":{"line":100}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":100},"end":{"line":100}}},"loc":{"start":{"line":98},"end":{"line":100}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":102},"end":{"line":102}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":102},"end":{"line":102}}}],"loc":{"start":{"line":102},"end":{"line":102}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":102},"end":{"line":102}}},"arguments":[{"type":"Literal","value":3,"raw":3}],"loc":{"start":{"line":102},"end":{"line":102}}},"loc":{"start":{"line":102},"end":{"line":102}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[{"type":"Literal","value":"Stage 3 completed. ","raw":"Stage 3 completed. "}],"loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}}],"loc":{"start":{"line":101},"end":{"line":104}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":107},"end":{"line":107}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":107},"end":{"line":107}}},"arguments":[{"type":"Literal","value":"Only \u0026lt;iframe javascript/onload...  attacks are recognized for success criteria","raw":"Only \u0026lt;iframe javascript/onload...  attacks are recognized for success criteria"}],"loc":{"start":{"line":107},"end":{"line":107}}},"loc":{"start":{"line":107},"end":{"line":107}}}],"loc":{"start":{"line":106},"end":{"line":108}}},"loc":{"start":{"line":98},"end":{"line":108}}},"loc":{"start":{"line":93},"end":{"line":108}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":109},"end":{"line":109}}},"loc":{"start":{"line":109},"end":{"line":109}}}],"loc":{"start":{"line":86},"end":{"line":110}}},"code":"\nprotected Element doStage3(WebSession s) throws Exception {\n    ElementContainer ec \u003d new ElementContainer();\n    StringBuffer attackString \u003d new StringBuffer(s.getParser().getStringParameter(PERSON, \"\"));\n    ec.addElement(mainContent(s));\n    if (attackString.toString().toLowerCase().indexOf(\"iframe\") !\u003d -1 \u0026\u0026 attackString.toString().toLowerCase().indexOf(\"javascript:alert\") !\u003d -1) {\n        getLessonTracker(s).setStage(4);\n        s.setMessage(\"Stage 3 completed.\");\n    } else if (attackString.toString().toLowerCase().indexOf(\"iframe\") !\u003d -1 \u0026\u0026 attackString.toString().toLowerCase().indexOf(\"onload\") !\u003d -1 \u0026\u0026 attackString.toString().toLowerCase().indexOf(\"alert\") !\u003d -1) {\n        getLessonTracker(s).setStage(3);\n        s.setMessage(\"Stage 3 completed. \");\n    } else {\n        s.setMessage(\"Only \u0026lt;iframe javascript/onload...  attacks are recognized for success criteria\");\n    }\n    return (ec);\n}","loc":{"start":{"line":85},"end":{"line":110}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doStage4"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":112},"end":{"line":112}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":112},"end":{"line":112}}}}],"thrown":[{"type":"Identifier","name":"Exception","loc":{"start":{"line":112},"end":{"line":112}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":114},"end":{"line":114}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":114},"end":{"line":114}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[],"loc":{"start":{"line":114},"end":{"line":114}}},"loc":{"start":{"line":114},"end":{"line":114}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"attackString","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":116},"end":{"line":116}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":116},"end":{"line":116}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":116},"end":{"line":116}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[],"loc":{"start":{"line":116},"end":{"line":116}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"Identifier","name":"PERSON","loc":{"start":{"line":116},"end":{"line":116}}},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":116},"end":{"line":116}}}],"loc":{"start":{"line":116},"end":{"line":116}}},"loc":{"start":{"line":116},"end":{"line":116}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":118},"end":{"line":118}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"mainContent","loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":118},"end":{"line":118}}}],"loc":{"start":{"line":118},"end":{"line":118}}}],"loc":{"start":{"line":118},"end":{"line":118}}},"loc":{"start":{"line":118},"end":{"line":118}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":120},"end":{"line":120}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[],"loc":{"start":{"line":120},"end":{"line":120}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[],"loc":{"start":{"line":120},"end":{"line":120}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[{"type":"Literal","value":"please enter your password:","raw":"please enter your password:"}],"loc":{"start":{"line":120},"end":{"line":120}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":120},"end":{"line":120}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":121},"end":{"line":121}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":121},"end":{"line":121}}},"arguments":[],"loc":{"start":{"line":121},"end":{"line":121}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":121},"end":{"line":121}}},"arguments":[],"loc":{"start":{"line":121},"end":{"line":121}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":121},"end":{"line":121}}},"arguments":[{"type":"Literal","value":"javascript:alert","raw":"javascript:alert"}],"loc":{"start":{"line":121},"end":{"line":121}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":121},"end":{"line":121}}},"loc":{"start":{"line":120},"end":{"line":121}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":123},"end":{"line":123}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":123},"end":{"line":123}}}],"loc":{"start":{"line":123},"end":{"line":123}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":123},"end":{"line":123}}},"arguments":[{"type":"Literal","value":5,"raw":5}],"loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":124},"end":{"line":124}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[{"type":"Literal","value":"Stage 4 completed.","raw":"Stage 4 completed."}],"loc":{"start":{"line":124},"end":{"line":124}}},"loc":{"start":{"line":124},"end":{"line":124}}}],"loc":{"start":{"line":122},"end":{"line":125}}},"loc":{"start":{"line":120},"end":{"line":125}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":127},"end":{"line":127}}},"loc":{"start":{"line":127},"end":{"line":127}}}],"loc":{"start":{"line":113},"end":{"line":128}}},"code":"\nprotected Element doStage4(WebSession s) throws Exception {\n    ElementContainer ec \u003d new ElementContainer();\n    StringBuffer attackString \u003d new StringBuffer(s.getParser().getStringParameter(PERSON, \"\"));\n    ec.addElement(mainContent(s));\n    if (attackString.toString().toLowerCase().indexOf(\"please enter your password:\") !\u003d -1 \u0026\u0026 attackString.toString().toLowerCase().indexOf(\"javascript:alert\") !\u003d -1) {\n        getLessonTracker(s).setStage(5);\n        s.setMessage(\"Stage 4 completed.\");\n    }\n    return (ec);\n}","loc":{"start":{"line":112},"end":{"line":128}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doStage5"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":130},"end":{"line":130}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":130},"end":{"line":130}}}}],"thrown":[{"type":"Identifier","name":"Exception","loc":{"start":{"line":130},"end":{"line":130}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":132},"end":{"line":132}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":132},"end":{"line":132}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":132},"end":{"line":132}}},"arguments":[],"loc":{"start":{"line":132},"end":{"line":132}}},"loc":{"start":{"line":132},"end":{"line":132}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":134},"end":{"line":134}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":134},"end":{"line":134}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"mainContent","loc":{"start":{"line":134},"end":{"line":134}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":134},"end":{"line":134}}}],"loc":{"start":{"line":134},"end":{"line":134}}}],"loc":{"start":{"line":134},"end":{"line":134}}},"loc":{"start":{"line":134},"end":{"line":134}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"file","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":141},"end":{"line":141}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":141},"end":{"line":141}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"getWebResource"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[{"type":"Literal","value":"javascript/DOMXSS.js","raw":"javascript/DOMXSS.js"}],"loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"content","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":142},"end":{"line":142}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":142},"end":{"line":142}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getFileContent","loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"Identifier","name":"file","loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"content","loc":{"start":{"line":144},"end":{"line":144}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":144},"end":{"line":144}}},"arguments":[{"type":"Literal","value":"escapeHTML(name)","raw":"escapeHTML(name)"}],"loc":{"start":{"line":144},"end":{"line":144}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":144},"end":{"line":144}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":146},"end":{"line":146}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":146},"end":{"line":146}}}],"loc":{"start":{"line":146},"end":{"line":146}}},"loc":{"start":{"line":146},"end":{"line":146}}}],"loc":{"start":{"line":145},"end":{"line":147}}},"loc":{"start":{"line":144},"end":{"line":147}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":149},"end":{"line":149}}},"loc":{"start":{"line":149},"end":{"line":149}}}],"loc":{"start":{"line":131},"end":{"line":150}}},"code":"\nprotected Element doStage5(WebSession s) throws Exception {\n    ElementContainer ec \u003d new ElementContainer();\n    ec.addElement(mainContent(s));\n    String file \u003d s.getWebResource(\"javascript/DOMXSS.js\");\n    String content \u003d getFileContent(file);\n    if (content.indexOf(\"escapeHTML(name)\") !\u003d -1) {\n        makeSuccess(s);\n    }\n    return ec;\n}","loc":{"start":{"line":130},"end":{"line":150}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"mainContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":152},"end":{"line":152}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":152},"end":{"line":152}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"attackString","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":154},"end":{"line":154}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":154},"end":{"line":154}}},"init":{"type":"Literal"},"loc":{"start":{"line":154},"end":{"line":154}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":156},"end":{"line":156}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":156},"end":{"line":156}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":156},"end":{"line":156}}},"arguments":[],"loc":{"start":{"line":156},"end":{"line":156}}},"loc":{"start":{"line":156},"end":{"line":156}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":178},"end":{"line":178}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[],"loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[],"loc":{"start":{"line":180},"end":{"line":180}}},"loc":{"start":{"line":180},"end":{"line":180}}}],"loc":{"start":{"line":180},"end":{"line":180}}},"loc":{"start":{"line":180},"end":{"line":180}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[],"loc":{"start":{"line":181},"end":{"line":181}}},"loc":{"start":{"line":181},"end":{"line":181}}}],"loc":{"start":{"line":179},"end":{"line":182}}},"loc":{"start":{"line":178},"end":{"line":182}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":160},"end":{"line":160}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Script","loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[],"loc":{"start":{"line":160},"end":{"line":160}}},"property":{"type":"Identifier","name":"setSrc"},"loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Literal","value":"javascript/DOMXSS.js","raw":"javascript/DOMXSS.js"}],"loc":{"start":{"line":160},"end":{"line":160}}}],"loc":{"start":{"line":160},"end":{"line":160}}},"loc":{"start":{"line":160},"end":{"line":160}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Script","loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[],"loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"setSrc"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"Literal","value":"javascript/escape.js","raw":"javascript/escape.js"}],"loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"H1","loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[],"loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"setID"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"Literal","value":"greeting","raw":"greeting"}],"loc":{"start":{"line":164},"end":{"line":164}}}],"loc":{"start":{"line":164},"end":{"line":164}}},"loc":{"start":{"line":164},"end":{"line":164}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":166},"end":{"line":166}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":166},"end":{"line":166}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":166},"end":{"line":166}}},"arguments":[{"type":"Literal","value":"Enter your name: ","raw":"Enter your name: "}],"loc":{"start":{"line":166},"end":{"line":166}}}],"loc":{"start":{"line":166},"end":{"line":166}}},"loc":{"start":{"line":166},"end":{"line":166}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"attackString","loc":{"start":{"line":168},"end":{"line":168}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":168},"end":{"line":168}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":168},"end":{"line":168}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":168},"end":{"line":168}}},"arguments":[],"loc":{"start":{"line":168},"end":{"line":168}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":168},"end":{"line":168}}},"arguments":[{"type":"Identifier","name":"PERSON","loc":{"start":{"line":168},"end":{"line":168}}},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":168},"end":{"line":168}}}],"loc":{"start":{"line":168},"end":{"line":168}}},"loc":{"start":{"line":168},"end":{"line":168}}},"loc":{"start":{"line":168},"end":{"line":168}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"input","vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":170},"end":{"line":170}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":170},"end":{"line":170}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Input","loc":{"start":{"line":170},"end":{"line":170}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Input","loc":{"start":{"line":170},"end":{"line":170}}},"property":{"type":"Identifier","name":"TEXT"},"loc":{"start":{"line":170},"end":{"line":170}}},{"type":"Identifier","name":"PERSON","loc":{"start":{"line":170},"end":{"line":170}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"attackString","loc":{"start":{"line":170},"end":{"line":170}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":170},"end":{"line":170}}},"arguments":[],"loc":{"start":{"line":170},"end":{"line":170}}}],"loc":{"start":{"line":170},"end":{"line":170}}},"loc":{"start":{"line":170},"end":{"line":170}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"input","loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"setOnKeyUp"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"displayGreeting(","raw":"displayGreeting("},"right":{"type":"Identifier","name":"PERSON","loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}},"right":{"type":"Literal","value":".value)","raw":".value)"},"loc":{"start":{"line":171},"end":{"line":171}}}],"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":172},"end":{"line":172}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":172},"end":{"line":172}}},"arguments":[{"type":"Identifier","name":"input","loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":172},"end":{"line":172}}},"loc":{"start":{"line":172},"end":{"line":172}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":173},"end":{"line":173}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":173},"end":{"line":173}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":173},"end":{"line":173}}},"arguments":[],"loc":{"start":{"line":173},"end":{"line":173}}}],"loc":{"start":{"line":173},"end":{"line":173}}},"loc":{"start":{"line":173},"end":{"line":173}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":174},"end":{"line":174}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":174},"end":{"line":174}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":174},"end":{"line":174}}},"arguments":[],"loc":{"start":{"line":174},"end":{"line":174}}}],"loc":{"start":{"line":174},"end":{"line":174}}},"loc":{"start":{"line":174},"end":{"line":174}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"b","vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":176},"end":{"line":176}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":176},"end":{"line":176}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":176},"end":{"line":176}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":176},"end":{"line":176}}},"arguments":[{"type":"Literal","value":"Submit Solution","raw":"Submit Solution"}],"loc":{"start":{"line":176},"end":{"line":176}}},"loc":{"start":{"line":176},"end":{"line":176}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[{"type":"Identifier","name":"b","loc":{"start":{"line":177},"end":{"line":177}}}],"loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}}],"loc":{"start":{"line":158},"end":{"line":178}}},"loc":{"start":{"line":157},"end":{"line":182}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":183},"end":{"line":183}}},"loc":{"start":{"line":183},"end":{"line":183}}}],"loc":{"start":{"line":153},"end":{"line":185}}},"code":"\nprotected ElementContainer mainContent(WebSession s) {\n    StringBuffer attackString \u003d null;\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        ec.addElement(new Script().setSrc(\"javascript/DOMXSS.js\"));\n        ec.addElement(new Script().setSrc(\"javascript/escape.js\"));\n        ec.addElement(new H1().setID(\"greeting\"));\n        ec.addElement(new StringElement(\"Enter your name: \"));\n        attackString \u003d new StringBuffer(s.getParser().getStringParameter(PERSON, \"\"));\n        Input input \u003d new Input(Input.TEXT, PERSON, attackString.toString());\n        input.setOnKeyUp(\"displayGreeting(\" + PERSON + \".value)\");\n        ec.addElement(input);\n        ec.addElement(new BR());\n        ec.addElement(new BR());\n        Element b \u003d ECSFactory.makeButton(\"Submit Solution\");\n        ec.addElement(b);\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return ec;\n}","loc":{"start":{"line":152},"end":{"line":185}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":192},"end":{"line":192}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":192},"end":{"line":192}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":194},"end":{"line":194}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":194},"end":{"line":194}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":194},"end":{"line":194}}},"arguments":[],"loc":{"start":{"line":194},"end":{"line":194}}},"loc":{"start":{"line":194},"end":{"line":194}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"Literal","value":"Stage 1: Try entering the following: \u0026lt;IMG SRC\u003d\"images/logos/owasp.jpg\"/\u0026gt;","raw":"Stage 1: Try entering the following: \u0026lt;IMG SRC\u003d\"images/logos/owasp.jpg\"/\u0026gt;"}],"loc":{"start":{"line":196},"end":{"line":196}}},"loc":{"start":{"line":196},"end":{"line":196}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[{"type":"Literal","value":"Stage 2: Try entering the following: \u0026lt;img src\u003dx onerror\u003d;;alert(\u0027XSS\u0027) /\u0026gt;","raw":"Stage 2: Try entering the following: \u0026lt;img src\u003dx onerror\u003d;;alert(\u0027XSS\u0027) /\u0026gt;"}],"loc":{"start":{"line":198},"end":{"line":198}}},"loc":{"start":{"line":198},"end":{"line":198}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":200},"end":{"line":200}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":200},"end":{"line":200}}},"arguments":[{"type":"Literal","value":"Stage 3: Try entering the following: \u0026lt;IFRAME SRC\u003d\"javascript:alert(\u0027XSS\u0027);\"\u0026gt;\u0026lt;/IFRAME\u0026gt;","raw":"Stage 3: Try entering the following: \u0026lt;IFRAME SRC\u003d\"javascript:alert(\u0027XSS\u0027);\"\u0026gt;\u0026lt;/IFRAME\u0026gt;"}],"loc":{"start":{"line":200},"end":{"line":201}}},"loc":{"start":{"line":200},"end":{"line":201}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":203},"end":{"line":203}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":203},"end":{"line":204}}},"arguments":[{"type":"Literal","value":"Stage 4: Try entering the following: Please enter your password:\u0026lt;BR\u0026gt;\u0026lt;input type \u003d \"password\" name\u003d\"pass\"/\u0026gt;\u0026lt;button onClick\u003d\"javascript:alert(\u0027I have your password: \u0027 + pass.value);\"\u0026gt;Submit\u0026lt;/button\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;","raw":"Stage 4: Try entering the following: Please enter your password:\u0026lt;BR\u0026gt;\u0026lt;input type \u003d \"password\" name\u003d\"pass\"/\u0026gt;\u0026lt;button onClick\u003d\"javascript:alert(\u0027I have your password: \u0027 + pass.value);\"\u0026gt;Submit\u0026lt;/button\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;"}],"loc":{"start":{"line":203},"end":{"line":206}}},"loc":{"start":{"line":203},"end":{"line":206}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":208},"end":{"line":208}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":208},"end":{"line":209}}},"arguments":[{"type":"Literal","value":"Stage 5: You will find the JavaScripts in tomcat\\webapps\\WebGoat\\javascript (Standart Version) or in WebContent\\javascript (Developer Version).","raw":"Stage 5: You will find the JavaScripts in tomcat\\webapps\\WebGoat\\javascript (Standart Version) or in WebContent\\javascript (Developer Version)."}],"loc":{"start":{"line":208},"end":{"line":209}}},"loc":{"start":{"line":208},"end":{"line":209}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":224},"end":{"line":224}}},"loc":{"start":{"line":224},"end":{"line":224}}}],"loc":{"start":{"line":193},"end":{"line":225}}},"code":"\npublic List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"Stage 1: Try entering the following: \u0026lt;IMG SRC\u003d\\\"images/logos/owasp.jpg\\\"/\u0026gt;\");\n    hints.add(\"Stage 2: Try entering the following: \u0026lt;img src\u003dx onerror\u003d;;alert(\\\u0027XSS\\\u0027) /\u0026gt;\");\n    hints.add(\"Stage 3: Try entering the following: \u0026lt;IFRAME SRC\u003d\\\"javascript:alert(\\\u0027XSS\\\u0027);\\\"\u0026gt;\u0026lt;/IFRAME\u0026gt;\");\n    hints.add(\"Stage 4: Try entering the following: Please enter your password:\u0026lt;BR\u0026gt;\u0026lt;input type \u003d \\\"password\\\" name\u003d\\\"pass\\\"/\u0026gt;\u0026lt;button onClick\u003d\\\"javascript:alert(\\\u0027I have your password: \\\u0027 + pass.value);\\\"\u0026gt;Submit\u0026lt;/button\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\");\n    hints.add(\"Stage 5: You will find the JavaScripts in tomcat\\\\webapps\\\\WebGoat\\\\javascript (Standart Version) or in WebContent\\\\javascript (Developer Version).\");\n    return hints;\n}","loc":{"start":{"line":192},"end":{"line":225}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":232},"end":{"line":232}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":232},"end":{"line":232}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":232},"end":{"line":232}}},"arguments":[{"type":"Literal","value":10,"raw":10}],"loc":{"start":{"line":232},"end":{"line":232}}},"loc":{"start":{"line":232},"end":{"line":232}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":234},"end":{"line":234}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":236},"end":{"line":236}}},"loc":{"start":{"line":236},"end":{"line":236}}}],"loc":{"start":{"line":235},"end":{"line":237}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":234},"end":{"line":237}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":239},"end":{"line":239}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":241},"end":{"line":241}}},"property":{"type":"Identifier","name":"AJAX_SECURITY"},"loc":{"start":{"line":241},"end":{"line":241}}},"loc":{"start":{"line":241},"end":{"line":241}}}],"loc":{"start":{"line":240},"end":{"line":242}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.AJAX_SECURITY;\n}","loc":{"start":{"line":239},"end":{"line":242}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":249},"end":{"line":249}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"LAB: DOM-Based cross-site scripting","raw":"LAB: DOM-Based cross-site scripting"},"loc":{"start":{"line":251},"end":{"line":251}}}],"loc":{"start":{"line":250},"end":{"line":252}}},"code":"\npublic String getTitle() {\n    return (\"LAB: DOM-Based cross-site scripting\");\n}","loc":{"start":{"line":249},"end":{"line":252}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":254},"end":{"line":254}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":254},"end":{"line":254}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":256},"end":{"line":256}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":256},"end":{"line":256}}},"init":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":256},"end":{"line":256}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":258},"end":{"line":258}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":258},"end":{"line":258}}}],"loc":{"start":{"line":258},"end":{"line":258}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":258},"end":{"line":258}}},"arguments":[],"loc":{"start":{"line":258},"end":{"line":258}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":258},"end":{"line":258}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":260},"end":{"line":260}}},"right":{"type":"Literal","value":"STAGE 1:\tFor this exercise, your mission is to deface this website using the image at the following location: \u003ca href \u003d \u0027/WebGoat/images/logos/owasp.jpg\u0027\u003eOWASP IMAGE\u003c/a\u003e","raw":"STAGE 1:\tFor this exercise, your mission is to deface this website using the image at the following location: \u003ca href \u003d \u0027/WebGoat/images/logos/owasp.jpg\u0027\u003eOWASP IMAGE\u003c/a\u003e"},"loc":{"start":{"line":260},"end":{"line":260}}},"loc":{"start":{"line":260},"end":{"line":260}}}],"loc":{"start":{"line":259},"end":{"line":261}}},"alternate":{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":262},"end":{"line":262}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":262},"end":{"line":262}}}],"loc":{"start":{"line":262},"end":{"line":262}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":262},"end":{"line":262}}},"arguments":[],"loc":{"start":{"line":262},"end":{"line":262}}},"right":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":262},"end":{"line":262}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":264},"end":{"line":264}}},"right":{"type":"Literal","value":"STAGE 2:\tNow, try to create a JavaScript alert using the image tag","raw":"STAGE 2:\tNow, try to create a JavaScript alert using the image tag"},"loc":{"start":{"line":264},"end":{"line":264}}},"loc":{"start":{"line":264},"end":{"line":264}}}],"loc":{"start":{"line":263},"end":{"line":265}}},"alternate":{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":266},"end":{"line":266}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":266},"end":{"line":266}}}],"loc":{"start":{"line":266},"end":{"line":266}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":266},"end":{"line":266}}},"arguments":[],"loc":{"start":{"line":266},"end":{"line":266}}},"right":{"type":"Literal","value":3,"raw":3},"loc":{"start":{"line":266},"end":{"line":266}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":268},"end":{"line":268}}},"right":{"type":"Literal","value":"STAGE 3:\tNext, try to create a JavaScript alert using the IFRAME tag.","raw":"STAGE 3:\tNext, try to create a JavaScript alert using the IFRAME tag."},"loc":{"start":{"line":268},"end":{"line":268}}},"loc":{"start":{"line":268},"end":{"line":268}}}],"loc":{"start":{"line":267},"end":{"line":269}}},"alternate":{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":270},"end":{"line":270}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":270},"end":{"line":270}}}],"loc":{"start":{"line":270},"end":{"line":270}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":270},"end":{"line":270}}},"arguments":[],"loc":{"start":{"line":270},"end":{"line":270}}},"right":{"type":"Literal","value":4,"raw":4},"loc":{"start":{"line":270},"end":{"line":270}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":272},"end":{"line":272}}},"right":{"type":"Literal","value":"STAGE 4:\tUse the following to create a fake login form:\u003cbr\u003e\u003cbr\u003ePlease enter your password:\u0026lt;BR\u0026gt;\u0026lt;input type \u003d \"password\" name\u003d\"pass\"/\u0026gt;\u0026lt;button onClick\u003d\"javascript:alert(\u0027I have your password: \u0027 + pass.value);\"\u0026gt;Submit\u0026lt;/button\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;","raw":"STAGE 4:\tUse the following to create a fake login form:\u003cbr\u003e\u003cbr\u003ePlease enter your password:\u0026lt;BR\u0026gt;\u0026lt;input type \u003d \"password\" name\u003d\"pass\"/\u0026gt;\u0026lt;button onClick\u003d\"javascript:alert(\u0027I have your password: \u0027 + pass.value);\"\u0026gt;Submit\u0026lt;/button\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;"},"loc":{"start":{"line":272},"end":{"line":274}}},"loc":{"start":{"line":272},"end":{"line":274}}}],"loc":{"start":{"line":271},"end":{"line":275}}},"alternate":{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":276},"end":{"line":276}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":276},"end":{"line":276}}}],"loc":{"start":{"line":276},"end":{"line":276}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":276},"end":{"line":276}}},"arguments":[],"loc":{"start":{"line":276},"end":{"line":276}}},"right":{"type":"Literal","value":5,"raw":5},"loc":{"start":{"line":276},"end":{"line":276}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":278},"end":{"line":278}}},"right":{"type":"Literal","value":"STAGE 5:\tPerform client-side HTML entity encoding to mitigate the DOM XSS vulnerability. A utility method is provided for you in escape.js.","raw":"STAGE 5:\tPerform client-side HTML entity encoding to mitigate the DOM XSS vulnerability. A utility method is provided for you in escape.js."},"loc":{"start":{"line":278},"end":{"line":278}}},"loc":{"start":{"line":278},"end":{"line":278}}}],"loc":{"start":{"line":277},"end":{"line":279}}},"loc":{"start":{"line":276},"end":{"line":279}}},"loc":{"start":{"line":270},"end":{"line":279}}},"loc":{"start":{"line":266},"end":{"line":279}}},"loc":{"start":{"line":262},"end":{"line":279}}},"loc":{"start":{"line":258},"end":{"line":279}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":280},"end":{"line":280}}},"loc":{"start":{"line":280},"end":{"line":280}}}],"loc":{"start":{"line":255},"end":{"line":281}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"\";\n    if (getLessonTracker(s).getStage() \u003d\u003d 1) {\n        instructions \u003d \"STAGE 1:\\tFor this exercise, your mission is to deface this website using the image at the following location: \u003ca href \u003d \\\u0027/WebGoat/images/logos/owasp.jpg\\\u0027\u003eOWASP IMAGE\u003c/a\u003e\";\n    } else if (getLessonTracker(s).getStage() \u003d\u003d 2) {\n        instructions \u003d \"STAGE 2:\\tNow, try to create a JavaScript alert using the image tag\";\n    } else if (getLessonTracker(s).getStage() \u003d\u003d 3) {\n        instructions \u003d \"STAGE 3:\\tNext, try to create a JavaScript alert using the IFRAME tag.\";\n    } else if (getLessonTracker(s).getStage() \u003d\u003d 4) {\n        instructions \u003d \"STAGE 4:\\tUse the following to create a fake login form:\u003cbr\u003e\u003cbr\u003ePlease enter your password:\u0026lt;BR\u0026gt;\u0026lt;input type \u003d \\\"password\\\" name\u003d\\\"pass\\\"/\u0026gt;\u0026lt;button onClick\u003d\\\"javascript:alert(\\\u0027I have your password: \\\u0027 + pass.value);\\\"\u0026gt;Submit\u0026lt;/button\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\u0026lt;BR\u0026gt;\";\n    } else if (getLessonTracker(s).getStage() \u003d\u003d 5) {\n        instructions \u003d \"STAGE 5:\\tPerform client-side HTML entity encoding to mitigate the DOM XSS vulnerability. A utility method is provided for you in escape.js.\";\n    }\n    return (instructions);\n}","loc":{"start":{"line":254},"end":{"line":281}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getFileContent"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":283},"end":{"line":283}}},"typarams":[],"params":[{"type":"Identifier","name":"content","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":283},"end":{"line":283}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"is","vartype":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":285},"end":{"line":285}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":285},"end":{"line":285}}},"init":{"type":"Literal"},"loc":{"start":{"line":285},"end":{"line":285}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"sb","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":286},"end":{"line":286}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":286},"end":{"line":286}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":286},"end":{"line":286}}},"arguments":[],"loc":{"start":{"line":286},"end":{"line":286}}},"loc":{"start":{"line":286},"end":{"line":286}}},{"type":"TryStatement","finalizer":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"is","loc":{"start":{"line":302},"end":{"line":302}}},"right":{"type":"Literal"},"loc":{"start":{"line":302},"end":{"line":302}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"ioe","vartype":{"type":"Identifier","name":"IOException","loc":{"start":{"line":307},"end":{"line":307}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":308},"end":{"line":310}}},"loc":{"start":{"line":307},"end":{"line":310}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"is","loc":{"start":{"line":306},"end":{"line":306}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":306},"end":{"line":306}}},"arguments":[],"loc":{"start":{"line":306},"end":{"line":306}}},"loc":{"start":{"line":306},"end":{"line":306}}}],"loc":{"start":{"line":305},"end":{"line":307}}},"loc":{"start":{"line":304},"end":{"line":310}}}],"loc":{"start":{"line":303},"end":{"line":311}}},"loc":{"start":{"line":302},"end":{"line":311}}}],"loc":{"start":{"line":301},"end":{"line":312}}},"handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":297},"end":{"line":297}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":299},"end":{"line":299}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":299},"end":{"line":299}}},"arguments":[],"loc":{"start":{"line":299},"end":{"line":299}}},"loc":{"start":{"line":299},"end":{"line":299}}}],"loc":{"start":{"line":298},"end":{"line":300}}},"loc":{"start":{"line":297},"end":{"line":300}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"is","loc":{"start":{"line":290},"end":{"line":290}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":290},"end":{"line":290}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"FileReader","loc":{"start":{"line":290},"end":{"line":290}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":290},"end":{"line":290}}},"arguments":[{"type":"Identifier","name":"content","loc":{"start":{"line":290},"end":{"line":290}}}],"loc":{"start":{"line":290},"end":{"line":290}}}],"loc":{"start":{"line":290},"end":{"line":290}}}],"loc":{"start":{"line":290},"end":{"line":290}}},"loc":{"start":{"line":290},"end":{"line":290}}},"loc":{"start":{"line":290},"end":{"line":290}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":291},"end":{"line":291}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":291},"end":{"line":291}}},"init":{"type":"Literal"},"loc":{"start":{"line":291},"end":{"line":291}}},{"type":"WhileStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"s","loc":{"start":{"line":293},"end":{"line":293}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"is","loc":{"start":{"line":293},"end":{"line":293}}},"property":{"type":"Identifier","name":"readLine"},"loc":{"start":{"line":293},"end":{"line":293}}},"arguments":[],"loc":{"start":{"line":293},"end":{"line":293}}},"loc":{"start":{"line":293},"end":{"line":293}}},"right":{"type":"Literal"},"loc":{"start":{"line":293},"end":{"line":293}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sb","loc":{"start":{"line":295},"end":{"line":295}}},"property":{"type":"Identifier","name":"append"},"loc":{"start":{"line":295},"end":{"line":295}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":295},"end":{"line":295}}}],"loc":{"start":{"line":295},"end":{"line":295}}},"loc":{"start":{"line":295},"end":{"line":295}}}],"loc":{"start":{"line":294},"end":{"line":296}}},"loc":{"start":{"line":293},"end":{"line":296}}}],"loc":{"start":{"line":289},"end":{"line":297}}},"loc":{"start":{"line":288},"end":{"line":312}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sb","loc":{"start":{"line":314},"end":{"line":314}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":314},"end":{"line":314}}},"arguments":[],"loc":{"start":{"line":314},"end":{"line":314}}},"loc":{"start":{"line":314},"end":{"line":314}}}],"loc":{"start":{"line":284},"end":{"line":315}}},"code":"\nprivate String getFileContent(String content) {\n    BufferedReader is \u003d null;\n    StringBuffer sb \u003d new StringBuffer();\n    try {\n        is \u003d new BufferedReader(new FileReader(new File(content)));\n        String s \u003d null;\n        while ((s \u003d is.readLine()) !\u003d null) {\n            sb.append(s);\n        }\n    } catch (Exception e) {\n        e.printStackTrace();\n    } finally {\n        if (is !\u003d null) {\n            try {\n                is.close();\n            } catch (IOException ioe) {\n            }\n        }\n    }\n    return sb.toString();\n}","loc":{"start":{"line":283},"end":{"line":315}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getCredits"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":317},"end":{"line":317}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":319},"end":{"line":319}}},"property":{"type":"Identifier","name":"getCustomCredits"},"loc":{"start":{"line":319},"end":{"line":319}}},"arguments":[{"type":"Literal","value":"","raw":""},{"type":"Identifier","name":"ASPECT_LOGO","loc":{"start":{"line":319},"end":{"line":319}}}],"loc":{"start":{"line":319},"end":{"line":319}}},"loc":{"start":{"line":319},"end":{"line":319}}}],"loc":{"start":{"line":318},"end":{"line":320}}},"code":"\npublic Element getCredits() {\n    return super.getCustomCredits(\"\", ASPECT_LOGO);\n}","loc":{"start":{"line":317},"end":{"line":320}}}],"loc":{"start":{"line":22},"end":{"line":321}}}],"loc":{"start":{"line":2},"end":{"line":321}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/DOMXSS.java"}