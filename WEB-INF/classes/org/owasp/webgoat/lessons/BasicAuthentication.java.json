{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"StringElement"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"Input"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"P"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"TD"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"TR"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"Table"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ECSFactory"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"WebGoatI18N"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"BasicAuthentication"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"SequentialLessonAdapter","loc":{"start":{"line":49},"end":{"line":49}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"EMPTY_STRING","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":51},"end":{"line":51}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":51},"end":{"line":51}}},"init":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":51},"end":{"line":51}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"WEBGOAT_BASIC","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":53},"end":{"line":53}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":53},"end":{"line":53}}},"init":{"type":"Literal","value":"webgoat_basic","raw":"webgoat_basic"},"loc":{"start":{"line":53},"end":{"line":53}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"AUTHORIZATION","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}},"init":{"type":"Literal","value":"Authorization","raw":"Authorization"},"loc":{"start":{"line":55},"end":{"line":55}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ORIGINAL_AUTH","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}},"init":{"type":"Literal","value":"Original_Auth","raw":"Original_Auth"},"loc":{"start":{"line":57},"end":{"line":57}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ORIGINAL_USER","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}},"init":{"type":"Literal","value":"Original.user","raw":"Original.user"},"loc":{"start":{"line":59},"end":{"line":59}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"BASIC","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}},"init":{"type":"Literal","value":"basic","raw":"basic"},"loc":{"start":{"line":61},"end":{"line":61}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"JSESSIONID","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":63},"end":{"line":63}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":63},"end":{"line":63}}},"init":{"type":"Literal","value":"JSESSIONID","raw":"JSESSIONID"},"loc":{"start":{"line":63},"end":{"line":63}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"HEADER_NAME","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":65},"end":{"line":65}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":65},"end":{"line":65}}},"init":{"type":"Literal","value":"header","raw":"header"},"loc":{"start":{"line":65},"end":{"line":65}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"HEADER_VALUE","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":67},"end":{"line":67}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":67},"end":{"line":67}}},"init":{"type":"Literal","value":"value","raw":"value"},"loc":{"start":{"line":67},"end":{"line":67}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":76},"end":{"line":76}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":76},"end":{"line":76}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"createStagedContent"},"loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":77},"end":{"line":79}}},"code":"\nprotected Element createContent(WebSession s) {\n    return super.createStagedContent(s);\n}","loc":{"start":{"line":76},"end":{"line":79}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doStage1"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":81},"end":{"line":81}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":81},"end":{"line":81}}}}],"thrown":[{"type":"Identifier","name":"Exception","loc":{"start":{"line":81},"end":{"line":81}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":83},"end":{"line":83}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":83},"end":{"line":83}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[],"loc":{"start":{"line":83},"end":{"line":83}}},"loc":{"start":{"line":83},"end":{"line":83}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"headerName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":85},"end":{"line":85}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":85},"end":{"line":85}}},"init":{"type":"Literal"},"loc":{"start":{"line":85},"end":{"line":85}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"headerValue","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":86},"end":{"line":86}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":86},"end":{"line":86}}},"init":{"type":"Literal"},"loc":{"start":{"line":86},"end":{"line":86}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":139},"end":{"line":139}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[],"loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[],"loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}}],"loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":142},"end":{"line":142}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":140},"end":{"line":143}}},"loc":{"start":{"line":139},"end":{"line":143}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"headerName","loc":{"start":{"line":89},"end":{"line":89}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"String","loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[],"loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"Identifier","name":"HEADER_NAME","loc":{"start":{"line":89},"end":{"line":89}}},{"type":"Identifier","name":"EMPTY_STRING","loc":{"start":{"line":89},"end":{"line":89}}}],"loc":{"start":{"line":89},"end":{"line":89}}}],"loc":{"start":{"line":89},"end":{"line":89}}},"loc":{"start":{"line":89},"end":{"line":89}}},"loc":{"start":{"line":89},"end":{"line":89}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"headerValue","loc":{"start":{"line":90},"end":{"line":90}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"String","loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[],"loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[{"type":"Identifier","name":"HEADER_VALUE","loc":{"start":{"line":90},"end":{"line":90}}},{"type":"Identifier","name":"EMPTY_STRING","loc":{"start":{"line":90},"end":{"line":90}}}],"loc":{"start":{"line":90},"end":{"line":90}}}],"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":90},"end":{"line":90}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerName","loc":{"start":{"line":95},"end":{"line":95}}},"property":{"type":"Identifier","name":"equalsIgnoreCase"},"loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[{"type":"Identifier","name":"AUTHORIZATION","loc":{"start":{"line":95},"end":{"line":95}}}],"loc":{"start":{"line":95},"end":{"line":95}}},"right":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerValue","loc":{"start":{"line":96},"end":{"line":96}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[{"type":"Literal","value":"guest:guest","raw":"guest:guest"}],"loc":{"start":{"line":96},"end":{"line":96}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerValue","loc":{"start":{"line":96},"end":{"line":96}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[{"type":"Literal","value":"webgoat:webgoat","raw":"webgoat:webgoat"}],"loc":{"start":{"line":96},"end":{"line":96}}},"loc":{"start":{"line":96},"end":{"line":96}}},"loc":{"start":{"line":95},"end":{"line":96}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":98},"end":{"line":98}}}],"loc":{"start":{"line":98},"end":{"line":98}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":98},"end":{"line":98}}},"loc":{"start":{"line":98},"end":{"line":98}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"doStage2","loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":99},"end":{"line":99}}}],"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}}],"loc":{"start":{"line":97},"end":{"line":100}}},"alternate":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"GREATER_THAN","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerName","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[],"loc":{"start":{"line":103},"end":{"line":103}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":103},"end":{"line":103}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerName","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"equalsIgnoreCase"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[{"type":"Identifier","name":"AUTHORIZATION","loc":{"start":{"line":103},"end":{"line":103}}}],"loc":{"start":{"line":103},"end":{"line":103}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Literal","value":"BasicAuthHeaderNameIncorrect","raw":"BasicAuthHeaderNameIncorrect"}],"loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":104},"end":{"line":106}}},"loc":{"start":{"line":103},"end":{"line":106}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"GREATER_THAN","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerValue","loc":{"start":{"line":107},"end":{"line":107}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":107},"end":{"line":107}}},"arguments":[],"loc":{"start":{"line":107},"end":{"line":107}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":107},"end":{"line":107}}},"right":{"argument":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerValue","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[{"type":"Literal","value":"guest:guest","raw":"guest:guest"}],"loc":{"start":{"line":108},"end":{"line":108}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerValue","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[{"type":"Literal","value":"webgoat:webgoat","raw":"webgoat:webgoat"}],"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":107},"end":{"line":108}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":110},"end":{"line":110}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":110},"end":{"line":110}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":110},"end":{"line":110}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":110},"end":{"line":110}}},"arguments":[{"type":"Literal","value":"BasicAuthHeaderValueIncorrect","raw":"BasicAuthHeaderValueIncorrect"}],"loc":{"start":{"line":110},"end":{"line":110}}}],"loc":{"start":{"line":110},"end":{"line":110}}},"loc":{"start":{"line":110},"end":{"line":110}}}],"loc":{"start":{"line":109},"end":{"line":112}}},"loc":{"start":{"line":107},"end":{"line":112}}}],"loc":{"start":{"line":102},"end":{"line":113}}},"loc":{"start":{"line":95},"end":{"line":113}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":116},"end":{"line":116}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":116},"end":{"line":116}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Table","loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":116},"end":{"line":116}}},"property":{"type":"Identifier","name":"setCellSpacing"},"loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":116},"end":{"line":116}}},"property":{"type":"Identifier","name":"setCellPadding"},"loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":116},"end":{"line":116}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":116},"end":{"line":116}}},"loc":{"start":{"line":116},"end":{"line":116}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":117},"end":{"line":117}}},"property":{"type":"Identifier","name":"isColor"},"loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[],"loc":{"start":{"line":117},"end":{"line":117}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":119},"end":{"line":119}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":119},"end":{"line":119}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":118},"end":{"line":120}}},"loc":{"start":{"line":117},"end":{"line":120}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"row1","vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":122},"end":{"line":122}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":122},"end":{"line":122}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":122},"end":{"line":122}}},"arguments":[],"loc":{"start":{"line":122},"end":{"line":122}}},"loc":{"start":{"line":122},"end":{"line":122}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"row2","vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":123},"end":{"line":123}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":123},"end":{"line":123}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":123},"end":{"line":123}}},"arguments":[],"loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"row1","loc":{"start":{"line":124},"end":{"line":124}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":124},"end":{"line":124}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationWhatIsNameOfHeader","raw":"BasicAuthenticationWhatIsNameOfHeader"}],"loc":{"start":{"line":124},"end":{"line":124}}}],"loc":{"start":{"line":124},"end":{"line":124}}}],"loc":{"start":{"line":124},"end":{"line":124}}}],"loc":{"start":{"line":124},"end":{"line":124}}},"loc":{"start":{"line":124},"end":{"line":124}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"row2","loc":{"start":{"line":125},"end":{"line":125}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":125},"end":{"line":125}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationWhatIsDecodedValueOfHeader","raw":"BasicAuthenticationWhatIsDecodedValueOfHeader"}],"loc":{"start":{"line":125},"end":{"line":125}}}],"loc":{"start":{"line":125},"end":{"line":125}}}],"loc":{"start":{"line":125},"end":{"line":125}}}],"loc":{"start":{"line":125},"end":{"line":125}}},"loc":{"start":{"line":125},"end":{"line":125}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"row1","loc":{"start":{"line":127},"end":{"line":127}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Input","loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Input","loc":{"start":{"line":127},"end":{"line":127}}},"property":{"type":"Identifier","name":"TEXT"},"loc":{"start":{"line":127},"end":{"line":127}}},{"type":"Identifier","name":"HEADER_NAME","loc":{"start":{"line":127},"end":{"line":127}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerName","loc":{"start":{"line":127},"end":{"line":127}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[],"loc":{"start":{"line":127},"end":{"line":127}}}],"loc":{"start":{"line":127},"end":{"line":127}}}],"loc":{"start":{"line":127},"end":{"line":127}}}],"loc":{"start":{"line":127},"end":{"line":127}}},"loc":{"start":{"line":127},"end":{"line":127}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"row2","loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Input","loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Input","loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"TEXT"},"loc":{"start":{"line":128},"end":{"line":128}}},{"type":"Identifier","name":"HEADER_VALUE","loc":{"start":{"line":128},"end":{"line":128}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"headerValue","loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[],"loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":130},"end":{"line":130}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":130},"end":{"line":130}}},"arguments":[{"type":"Identifier","name":"row1","loc":{"start":{"line":130},"end":{"line":130}}}],"loc":{"start":{"line":130},"end":{"line":130}}},"loc":{"start":{"line":130},"end":{"line":130}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":131},"end":{"line":131}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":131},"end":{"line":131}}},"arguments":[{"type":"Identifier","name":"row2","loc":{"start":{"line":131},"end":{"line":131}}}],"loc":{"start":{"line":131},"end":{"line":131}}},"loc":{"start":{"line":131},"end":{"line":131}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":133},"end":{"line":133}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[{"type":"Identifier","name":"t","loc":{"start":{"line":133},"end":{"line":133}}}],"loc":{"start":{"line":133},"end":{"line":133}}},"loc":{"start":{"line":133},"end":{"line":133}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":134},"end":{"line":134}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":134},"end":{"line":134}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"P","loc":{"start":{"line":134},"end":{"line":134}}},"arguments":[],"loc":{"start":{"line":134},"end":{"line":134}}}],"loc":{"start":{"line":134},"end":{"line":134}}},"loc":{"start":{"line":134},"end":{"line":134}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"b","vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":136},"end":{"line":136}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":136},"end":{"line":136}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":136},"end":{"line":136}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":136},"end":{"line":136}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":136},"end":{"line":136}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":136},"end":{"line":136}}},"arguments":[{"type":"Literal","value":"Submit","raw":"Submit"}],"loc":{"start":{"line":136},"end":{"line":136}}}],"loc":{"start":{"line":136},"end":{"line":136}}},"loc":{"start":{"line":136},"end":{"line":136}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":137},"end":{"line":137}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":137},"end":{"line":137}}},"arguments":[{"type":"Identifier","name":"b","loc":{"start":{"line":137},"end":{"line":137}}}],"loc":{"start":{"line":137},"end":{"line":137}}},"loc":{"start":{"line":137},"end":{"line":137}}}],"loc":{"start":{"line":88},"end":{"line":139}}},"loc":{"start":{"line":87},"end":{"line":143}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":145},"end":{"line":145}}},"loc":{"start":{"line":145},"end":{"line":145}}}],"loc":{"start":{"line":82},"end":{"line":146}}},"code":"\nprotected Element doStage1(WebSession s) throws Exception {\n    ElementContainer ec \u003d new ElementContainer();\n    String headerName \u003d null;\n    String headerValue \u003d null;\n    try {\n        headerName \u003d new String(s.getParser().getStringParameter(HEADER_NAME, EMPTY_STRING));\n        headerValue \u003d new String(s.getParser().getStringParameter(HEADER_VALUE, EMPTY_STRING));\n        if (headerName.equalsIgnoreCase(AUTHORIZATION) \u0026\u0026 (headerValue.equals(\"guest:guest\") || headerValue.equals(\"webgoat:webgoat\"))) {\n            getLessonTracker(s).setStage(2);\n            return doStage2(s);\n        } else {\n            if (headerName.length() \u003e 0 \u0026\u0026 !headerName.equalsIgnoreCase(AUTHORIZATION)) {\n                s.setMessage(WebGoatI18N.get(\"BasicAuthHeaderNameIncorrect\"));\n            }\n            if (headerValue.length() \u003e 0 \u0026\u0026 !(headerValue.equals(\"guest:guest\") || headerValue.equals(\"webgoat:webgoat\"))) {\n                s.setMessage(WebGoatI18N.get(\"BasicAuthHeaderValueIncorrect\"));\n            }\n        }\n        Table t \u003d new Table(0).setCellSpacing(0).setCellPadding(0).setBorder(0);\n        if (s.isColor()) {\n            t.setBorder(1);\n        }\n        TR row1 \u003d new TR();\n        TR row2 \u003d new TR();\n        row1.addElement(new TD(new StringElement(WebGoatI18N.get(\"BasicAuthenticationWhatIsNameOfHeader\"))));\n        row2.addElement(new TD(new StringElement(WebGoatI18N.get(\"BasicAuthenticationWhatIsDecodedValueOfHeader\"))));\n        row1.addElement(new TD(new Input(Input.TEXT, HEADER_NAME, headerName.toString())));\n        row2.addElement(new TD(new Input(Input.TEXT, HEADER_VALUE, headerValue.toString())));\n        t.addElement(row1);\n        t.addElement(row2);\n        ec.addElement(t);\n        ec.addElement(new P());\n        Element b \u003d ECSFactory.makeButton(WebGoatI18N.get(\"Submit\"));\n        ec.addElement(b);\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":81},"end":{"line":146}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doStage2"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":148},"end":{"line":148}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":148},"end":{"line":148}}}}],"thrown":[{"type":"Identifier","name":"Exception","loc":{"start":{"line":148},"end":{"line":148}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":150},"end":{"line":150}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":150},"end":{"line":150}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[],"loc":{"start":{"line":150},"end":{"line":150}}},"loc":{"start":{"line":150},"end":{"line":150}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":215},"end":{"line":215}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[{"type":"Literal","value":"ErrorGenerating","raw":"ErrorGenerating"}],"loc":{"start":{"line":217},"end":{"line":217}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[],"loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[],"loc":{"start":{"line":217},"end":{"line":217}}},"loc":{"start":{"line":217},"end":{"line":217}}}],"loc":{"start":{"line":217},"end":{"line":217}}},"loc":{"start":{"line":217},"end":{"line":217}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":218},"end":{"line":218}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":218},"end":{"line":218}}},"arguments":[],"loc":{"start":{"line":218},"end":{"line":218}}},"loc":{"start":{"line":218},"end":{"line":218}}}],"loc":{"start":{"line":216},"end":{"line":219}}},"loc":{"start":{"line":215},"end":{"line":219}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[],"loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"isUserInRole"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"Identifier","name":"WEBGOAT_BASIC","loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"originalUser","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":156},"end":{"line":156}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":156},"end":{"line":156}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":156},"end":{"line":156}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":156},"end":{"line":156}}}],"loc":{"start":{"line":156},"end":{"line":156}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":156},"end":{"line":156}}},"arguments":[],"loc":{"start":{"line":156},"end":{"line":156}}},"property":{"type":"Identifier","name":"getProperty"},"loc":{"start":{"line":156},"end":{"line":157}}},"arguments":[{"type":"Identifier","name":"ORIGINAL_USER","loc":{"start":{"line":157},"end":{"line":157}}},{"type":"Identifier","name":"EMPTY_STRING","loc":{"start":{"line":157},"end":{"line":157}}}],"loc":{"start":{"line":156},"end":{"line":157}}},"loc":{"start":{"line":156},"end":{"line":157}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":158},"end":{"line":158}}},{"type":"Identifier","name":"originalUser","loc":{"start":{"line":158},"end":{"line":158}}}],"loc":{"start":{"line":158},"end":{"line":158}}},"property":{"type":"Identifier","name":"setCompleted"},"loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":159},"end":{"line":159}}},{"type":"Identifier","name":"originalUser","loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":159},"end":{"line":159}}},"loc":{"start":{"line":159},"end":{"line":159}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":160},"end":{"line":160}}},{"type":"Identifier","name":"originalUser","loc":{"start":{"line":160},"end":{"line":160}}}],"loc":{"start":{"line":160},"end":{"line":160}}},"property":{"type":"Identifier","name":"store"},"loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":160},"end":{"line":160}}},{"type":"ThisExpression"}],"loc":{"start":{"line":160},"end":{"line":160}}},"loc":{"start":{"line":160},"end":{"line":160}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":161},"end":{"line":161}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":161},"end":{"line":161}}}],"loc":{"start":{"line":161},"end":{"line":161}}},"loc":{"start":{"line":161},"end":{"line":161}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"Literal","value":"BasicAuthenticiationGreenStars1","raw":"BasicAuthenticiationGreenStars1"}],"loc":{"start":{"line":162},"end":{"line":162}}},"right":{"type":"Identifier","name":"originalUser","loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationGreenStars2","raw":"BasicAuthenticationGreenStars2"}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":163},"end":{"line":163}}},"loc":{"start":{"line":163},"end":{"line":163}}}],"loc":{"start":{"line":155},"end":{"line":164}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"originalAuth","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":169},"end":{"line":169}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":169},"end":{"line":169}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":169},"end":{"line":169}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":169},"end":{"line":169}}}],"loc":{"start":{"line":169},"end":{"line":169}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":169},"end":{"line":169}}},"arguments":[],"loc":{"start":{"line":169},"end":{"line":169}}},"property":{"type":"Identifier","name":"getProperty"},"loc":{"start":{"line":169},"end":{"line":170}}},"arguments":[{"type":"Identifier","name":"ORIGINAL_AUTH","loc":{"start":{"line":170},"end":{"line":170}}},{"type":"Identifier","name":"EMPTY_STRING","loc":{"start":{"line":170},"end":{"line":170}}}],"loc":{"start":{"line":169},"end":{"line":170}}},"loc":{"start":{"line":169},"end":{"line":170}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"originalSessionId","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":171},"end":{"line":171}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":171},"end":{"line":171}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":171},"end":{"line":171}}}],"loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[],"loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"getProperty"},"loc":{"start":{"line":171},"end":{"line":172}}},"arguments":[{"type":"Identifier","name":"JSESSIONID","loc":{"start":{"line":172},"end":{"line":172}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":172},"end":{"line":172}}},"property":{"type":"Identifier","name":"getCookie"},"loc":{"start":{"line":172},"end":{"line":172}}},"arguments":[{"type":"Identifier","name":"JSESSIONID","loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":171},"end":{"line":172}}},"loc":{"start":{"line":171},"end":{"line":172}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"originalSessionId","loc":{"start":{"line":175},"end":{"line":175}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":175},"end":{"line":175}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":175},"end":{"line":175}}},"property":{"type":"Identifier","name":"getCookie"},"loc":{"start":{"line":175},"end":{"line":175}}},"arguments":[{"type":"Identifier","name":"JSESSIONID","loc":{"start":{"line":175},"end":{"line":175}}}],"loc":{"start":{"line":175},"end":{"line":175}}}],"loc":{"start":{"line":175},"end":{"line":175}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":181},"end":{"line":181}}}],"loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[],"loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Identifier","name":"setProperty"},"loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[{"type":"Identifier","name":"JSESSIONID","loc":{"start":{"line":181},"end":{"line":181}}},{"type":"Identifier","name":"originalSessionId","loc":{"start":{"line":181},"end":{"line":181}}}],"loc":{"start":{"line":181},"end":{"line":181}}},"loc":{"start":{"line":181},"end":{"line":181}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[],"loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"setProperty"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[{"type":"Identifier","name":"ORIGINAL_AUTH","loc":{"start":{"line":182},"end":{"line":182}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"getHeader"},"loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[{"type":"Identifier","name":"AUTHORIZATION","loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":183},"end":{"line":183}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":183},"end":{"line":183}}},{"type":"Identifier","name":"BASIC","loc":{"start":{"line":183},"end":{"line":183}}}],"loc":{"start":{"line":183},"end":{"line":183}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":183},"end":{"line":183}}},"arguments":[],"loc":{"start":{"line":183},"end":{"line":183}}},"property":{"type":"Identifier","name":"setProperty"},"loc":{"start":{"line":183},"end":{"line":183}}},"arguments":[{"type":"Identifier","name":"ORIGINAL_USER","loc":{"start":{"line":183},"end":{"line":183}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":183},"end":{"line":183}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":183},"end":{"line":183}}},"arguments":[],"loc":{"start":{"line":183},"end":{"line":183}}}],"loc":{"start":{"line":183},"end":{"line":183}}},"loc":{"start":{"line":183},"end":{"line":183}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":184},"end":{"line":184}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":184},"end":{"line":184}}},{"type":"Identifier","name":"BASIC","loc":{"start":{"line":184},"end":{"line":184}}}],"loc":{"start":{"line":184},"end":{"line":184}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":184},"end":{"line":184}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":184},"end":{"line":184}}},"loc":{"start":{"line":184},"end":{"line":184}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":185},"end":{"line":185}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":185},"end":{"line":185}}},{"type":"Identifier","name":"BASIC","loc":{"start":{"line":185},"end":{"line":185}}}],"loc":{"start":{"line":185},"end":{"line":185}}},"property":{"type":"Identifier","name":"store"},"loc":{"start":{"line":185},"end":{"line":185}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":185},"end":{"line":185}}},{"type":"ThisExpression"},{"type":"Identifier","name":"BASIC","loc":{"start":{"line":185},"end":{"line":185}}}],"loc":{"start":{"line":185},"end":{"line":185}}},"loc":{"start":{"line":185},"end":{"line":185}}}],"loc":{"start":{"line":176},"end":{"line":186}}},"loc":{"start":{"line":175},"end":{"line":186}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":188},"end":{"line":188}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":188},"end":{"line":188}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":188},"end":{"line":188}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":188},"end":{"line":188}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationStage1Completed","raw":"BasicAuthenticationStage1Completed"}],"loc":{"start":{"line":188},"end":{"line":188}}}],"loc":{"start":{"line":188},"end":{"line":188}}},"loc":{"start":{"line":188},"end":{"line":188}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"originalAuth","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":193},"end":{"line":193}}},"arguments":[{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":193},"end":{"line":193}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":193},"end":{"line":193}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"originalAuth","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":193},"end":{"line":193}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Identifier","name":"getHeader"},"loc":{"start":{"line":193},"end":{"line":193}}},"arguments":[{"type":"Identifier","name":"AUTHORIZATION","loc":{"start":{"line":193},"end":{"line":193}}}],"loc":{"start":{"line":193},"end":{"line":193}}}],"loc":{"start":{"line":193},"end":{"line":193}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":193},"end":{"line":193}}},"loc":{"start":{"line":193},"end":{"line":193}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":195},"end":{"line":195}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":195},"end":{"line":196}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationAlmostThere1","raw":"BasicAuthenticationAlmostThere1"}],"loc":{"start":{"line":196},"end":{"line":196}}},"right":{"type":"Identifier","name":"AUTHORIZATION","loc":{"start":{"line":197},"end":{"line":197}}},"loc":{"start":{"line":196},"end":{"line":197}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationAlmostThere2","raw":"BasicAuthenticationAlmostThere2"}],"loc":{"start":{"line":198},"end":{"line":198}}},"loc":{"start":{"line":196},"end":{"line":198}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":199},"end":{"line":199}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":199},"end":{"line":199}}},"arguments":[],"loc":{"start":{"line":199},"end":{"line":199}}},"loc":{"start":{"line":196},"end":{"line":199}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":200},"end":{"line":200}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":200},"end":{"line":200}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationAlmostThere3","raw":"BasicAuthenticationAlmostThere3"}],"loc":{"start":{"line":200},"end":{"line":200}}},"loc":{"start":{"line":196},"end":{"line":200}}}],"loc":{"start":{"line":195},"end":{"line":200}}},"loc":{"start":{"line":195},"end":{"line":200}}}],"loc":{"start":{"line":194},"end":{"line":201}}},"alternate":{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"originalSessionId","loc":{"start":{"line":202},"end":{"line":202}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":202},"end":{"line":202}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":202},"end":{"line":202}}},"property":{"type":"Identifier","name":"getCookie"},"loc":{"start":{"line":202},"end":{"line":202}}},"arguments":[{"type":"Identifier","name":"JSESSIONID","loc":{"start":{"line":202},"end":{"line":202}}}],"loc":{"start":{"line":202},"end":{"line":202}}}],"loc":{"start":{"line":202},"end":{"line":202}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":202},"end":{"line":202}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":204},"end":{"line":204}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":204},"end":{"line":205}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":205},"end":{"line":205}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":205},"end":{"line":205}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationReallyClose","raw":"BasicAuthenticationReallyClose"}],"loc":{"start":{"line":205},"end":{"line":205}}}],"loc":{"start":{"line":204},"end":{"line":205}}},"loc":{"start":{"line":204},"end":{"line":205}}}],"loc":{"start":{"line":203},"end":{"line":207}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":210},"end":{"line":210}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":210},"end":{"line":210}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":210},"end":{"line":210}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":210},"end":{"line":210}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationUseTheHints","raw":"BasicAuthenticationUseTheHints"}],"loc":{"start":{"line":210},"end":{"line":210}}}],"loc":{"start":{"line":210},"end":{"line":210}}},"loc":{"start":{"line":210},"end":{"line":210}}}],"loc":{"start":{"line":209},"end":{"line":211}}},"loc":{"start":{"line":202},"end":{"line":211}}},"loc":{"start":{"line":193},"end":{"line":211}}}],"loc":{"start":{"line":166},"end":{"line":213}}},"loc":{"start":{"line":154},"end":{"line":213}}}],"loc":{"start":{"line":153},"end":{"line":215}}},"loc":{"start":{"line":152},"end":{"line":219}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":221},"end":{"line":221}}},"loc":{"start":{"line":221},"end":{"line":221}}}],"loc":{"start":{"line":149},"end":{"line":222}}},"code":"\nprotected Element doStage2(WebSession s) throws Exception {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        if (s.getRequest().isUserInRole(WEBGOAT_BASIC)) {\n            String originalUser \u003d getLessonTracker(s).getLessonProperties().getProperty(ORIGINAL_USER, EMPTY_STRING);\n            getLessonTracker(s, originalUser).setCompleted(true);\n            getLessonTracker(s, originalUser).setStage(1);\n            getLessonTracker(s, originalUser).store(s, this);\n            makeSuccess(s);\n            s.setMessage(WebGoatI18N.get(\"BasicAuthenticiationGreenStars1\") + originalUser + WebGoatI18N.get(\"BasicAuthenticationGreenStars2\"));\n            return ec;\n        } else {\n            String originalAuth \u003d getLessonTracker(s).getLessonProperties().getProperty(ORIGINAL_AUTH, EMPTY_STRING);\n            String originalSessionId \u003d getLessonTracker(s).getLessonProperties().getProperty(JSESSIONID, s.getCookie(JSESSIONID));\n            if (originalSessionId.equals(s.getCookie(JSESSIONID))) {\n                getLessonTracker(s).getLessonProperties().setProperty(JSESSIONID, originalSessionId);\n                getLessonTracker(s).getLessonProperties().setProperty(ORIGINAL_AUTH, s.getHeader(AUTHORIZATION));\n                getLessonTracker(s, BASIC).getLessonProperties().setProperty(ORIGINAL_USER, s.getUserName());\n                getLessonTracker(s, BASIC).setStage(2);\n                getLessonTracker(s, BASIC).store(s, this, BASIC);\n            }\n            s.setMessage(WebGoatI18N.get(\"BasicAuthenticationStage1Completed\"));\n            if (!originalAuth.equals(\"\") \u0026\u0026 !originalAuth.equals(s.getHeader(AUTHORIZATION))) {\n                ec.addElement(WebGoatI18N.get(\"BasicAuthenticationAlmostThere1\") + AUTHORIZATION + WebGoatI18N.get(\"BasicAuthenticationAlmostThere2\") + s.getUserName() + WebGoatI18N.get(\"BasicAuthenticationAlmostThere3\"));\n            } else if (!originalSessionId.equals(s.getCookie(JSESSIONID))) {\n                ec.addElement(WebGoatI18N.get(\"BasicAuthenticationReallyClose\"));\n            } else {\n                ec.addElement(WebGoatI18N.get(\"BasicAuthenticationUseTheHints\"));\n            }\n        }\n    } catch (Exception e) {\n        s.setMessage(WebGoatI18N.get(\"ErrorGenerating\") + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":148},"end":{"line":222}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":229},"end":{"line":229}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":232},"end":{"line":232}}},"property":{"type":"Identifier","name":"AUTHENTICATION"},"loc":{"start":{"line":232},"end":{"line":232}}},"loc":{"start":{"line":232},"end":{"line":232}}}],"loc":{"start":{"line":230},"end":{"line":233}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.AUTHENTICATION;\n}","loc":{"start":{"line":229},"end":{"line":233}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":240},"end":{"line":240}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":240},"end":{"line":240}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":242},"end":{"line":242}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":242},"end":{"line":242}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":242},"end":{"line":242}}},"arguments":[],"loc":{"start":{"line":242},"end":{"line":242}}},"loc":{"start":{"line":242},"end":{"line":242}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":248},"end":{"line":248}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":248},"end":{"line":248}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":248},"end":{"line":248}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":248},"end":{"line":248}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint1","raw":"BasicAuthenticationHint1"}],"loc":{"start":{"line":248},"end":{"line":248}}}],"loc":{"start":{"line":248},"end":{"line":248}}},"loc":{"start":{"line":248},"end":{"line":248}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":249},"end":{"line":249}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":249},"end":{"line":249}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":249},"end":{"line":249}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":249},"end":{"line":249}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint2","raw":"BasicAuthenticationHint2"}],"loc":{"start":{"line":249},"end":{"line":249}}}],"loc":{"start":{"line":249},"end":{"line":249}}},"loc":{"start":{"line":249},"end":{"line":249}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":250},"end":{"line":250}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":250},"end":{"line":250}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":250},"end":{"line":250}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":250},"end":{"line":250}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint3","raw":"BasicAuthenticationHint3"}],"loc":{"start":{"line":250},"end":{"line":250}}}],"loc":{"start":{"line":250},"end":{"line":250}}},"loc":{"start":{"line":250},"end":{"line":250}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":251},"end":{"line":251}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":251},"end":{"line":251}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":251},"end":{"line":251}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":251},"end":{"line":251}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint4","raw":"BasicAuthenticationHint4"}],"loc":{"start":{"line":251},"end":{"line":251}}}],"loc":{"start":{"line":251},"end":{"line":251}}},"loc":{"start":{"line":251},"end":{"line":251}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":255},"end":{"line":255}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":255},"end":{"line":255}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":255},"end":{"line":255}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":255},"end":{"line":255}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint5","raw":"BasicAuthenticationHint5"}],"loc":{"start":{"line":255},"end":{"line":255}}}],"loc":{"start":{"line":255},"end":{"line":255}}},"loc":{"start":{"line":255},"end":{"line":255}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":256},"end":{"line":256}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":256},"end":{"line":256}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":256},"end":{"line":256}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":256},"end":{"line":256}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint6","raw":"BasicAuthenticationHint6"}],"loc":{"start":{"line":256},"end":{"line":256}}}],"loc":{"start":{"line":256},"end":{"line":256}}},"loc":{"start":{"line":256},"end":{"line":256}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":257},"end":{"line":257}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":257},"end":{"line":257}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":257},"end":{"line":257}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":257},"end":{"line":257}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint7","raw":"BasicAuthenticationHint7"}],"loc":{"start":{"line":257},"end":{"line":257}}}],"loc":{"start":{"line":257},"end":{"line":257}}},"loc":{"start":{"line":257},"end":{"line":257}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":258},"end":{"line":258}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":258},"end":{"line":258}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":258},"end":{"line":258}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":258},"end":{"line":258}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint8","raw":"BasicAuthenticationHint8"}],"loc":{"start":{"line":258},"end":{"line":258}}}],"loc":{"start":{"line":258},"end":{"line":258}}},"loc":{"start":{"line":258},"end":{"line":258}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":259},"end":{"line":259}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":259},"end":{"line":259}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":259},"end":{"line":259}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":259},"end":{"line":259}}},"arguments":[{"type":"Literal","value":"BasicAuthenticationHint9","raw":"BasicAuthenticationHint9"}],"loc":{"start":{"line":259},"end":{"line":259}}}],"loc":{"start":{"line":259},"end":{"line":259}}},"loc":{"start":{"line":259},"end":{"line":259}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":264},"end":{"line":264}}},"loc":{"start":{"line":264},"end":{"line":264}}}],"loc":{"start":{"line":241},"end":{"line":265}}},"code":"\npublic List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint1\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint2\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint3\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint4\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint5\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint6\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint7\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint8\"));\n    hints.add(WebGoatI18N.get(\"BasicAuthenticationHint9\"));\n    return hints;\n}","loc":{"start":{"line":240},"end":{"line":265}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":267},"end":{"line":267}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":267},"end":{"line":267}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":267},"end":{"line":267}}},"arguments":[{"type":"Literal","value":100,"raw":100}],"loc":{"start":{"line":267},"end":{"line":267}}},"loc":{"start":{"line":267},"end":{"line":267}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":269},"end":{"line":269}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":271},"end":{"line":271}}},"loc":{"start":{"line":271},"end":{"line":271}}}],"loc":{"start":{"line":270},"end":{"line":272}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":269},"end":{"line":272}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":279},"end":{"line":279}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Basic Authentication","raw":"Basic Authentication"},"loc":{"start":{"line":281},"end":{"line":281}}}],"loc":{"start":{"line":280},"end":{"line":282}}},"code":"\npublic String getTitle() {\n    return (\"Basic Authentication\");\n}","loc":{"start":{"line":279},"end":{"line":282}}}],"loc":{"start":{"line":49},"end":{"line":284}}}],"loc":{"start":{"line":2},"end":{"line":284}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/BasicAuthentication.java"}