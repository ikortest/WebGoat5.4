{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":1},"end":{"line":1}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":1},"end":{"line":1}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":1},"end":{"line":1}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":1},"end":{"line":1}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":3},"end":{"line":3}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":3},"end":{"line":3}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":3},"end":{"line":3}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"SQLException"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"Form"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"H1"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"Input"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"P"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"A"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"IMG"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"DatabaseUtilities"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"ECSFactory"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":21},"end":{"line":21}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"commons"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"fileupload"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":23},"end":{"line":23}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"commons"},"loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"fileupload"},"loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"disk"},"loc":{"start":{"line":24},"end":{"line":24}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":24},"end":{"line":24}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"commons"},"loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"fileupload"},"loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":25},"end":{"line":25}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"MaliciousFileExecution"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":59},"end":{"line":59}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"MANDIANT_LOGO","vartype":{"type":"Identifier","name":"A","loc":{"start":{"line":62},"end":{"line":62}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"A","loc":{"start":{"line":62},"end":{"line":62}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"A","loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[],"loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"setHref"},"loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[{"type":"Literal","value":"http://www.mandiant.com","raw":"http://www.mandiant.com"}],"loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"IMG","loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[{"type":"Literal","value":"images/logos/mandiant.png","raw":"images/logos/mandiant.png"}],"loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"setAlt"},"loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[{"type":"Literal","value":"MANDIANT","raw":"MANDIANT"}],"loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"setHspace"},"loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":62},"end":{"line":62}}},"property":{"type":"Identifier","name":"setVspace"},"loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":62},"end":{"line":62}}}],"loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploads_and_target_parent_directory","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":66},"end":{"line":66}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":66},"end":{"line":66}}},"init":{"type":"Literal"},"loc":{"start":{"line":66},"end":{"line":66}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"UPLOADS_RELATIVE_PATH","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":68},"end":{"line":68}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":68},"end":{"line":68}}},"init":{"type":"Literal","value":"uploads","raw":"uploads"},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"TARGET_RELATIVE_PATH","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":73},"end":{"line":73}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":73},"end":{"line":73}}},"init":{"type":"Literal","value":"mfe_target","raw":"mfe_target"},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"fill_uploads_and_target_parent_directory"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":78},"end":{"line":78}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":80},"end":{"line":80}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"getContext"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[],"loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"getRealPath"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"File","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":82},"end":{"line":82}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":83},"end":{"line":83}}},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":83},"end":{"line":83}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"File","loc":{"start":{"line":84},"end":{"line":84}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":84},"end":{"line":84}}},"loc":{"start":{"line":83},"end":{"line":84}}},"loc":{"start":{"line":83},"end":{"line":84}}},"loc":{"start":{"line":83},"end":{"line":84}}}],"loc":{"start":{"line":82},"end":{"line":85}}},"loc":{"start":{"line":82},"end":{"line":85}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"uploads_and_target_parent_directory set to \u003d ","raw":"uploads_and_target_parent_directory set to \u003d "},"right":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":86},"end":{"line":87}}}],"loc":{"start":{"line":86},"end":{"line":87}}},"loc":{"start":{"line":86},"end":{"line":87}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploads_dir","vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":90},"end":{"line":90}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":90},"end":{"line":90}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":90},"end":{"line":90}}},"right":{"type":"Identifier","name":"UPLOADS_RELATIVE_PATH","loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":90},"end":{"line":91}}}],"loc":{"start":{"line":90},"end":{"line":91}}},"loc":{"start":{"line":90},"end":{"line":91}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"uploads_dir","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"mkdir"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[],"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"target_dir","vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":94},"end":{"line":94}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":94},"end":{"line":94}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":94},"end":{"line":94}}},"right":{"type":"Identifier","name":"TARGET_RELATIVE_PATH","loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":94},"end":{"line":95}}}],"loc":{"start":{"line":94},"end":{"line":95}}},"loc":{"start":{"line":94},"end":{"line":95}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"target_dir","loc":{"start":{"line":96},"end":{"line":96}}},"property":{"type":"Identifier","name":"mkdir"},"loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[],"loc":{"start":{"line":96},"end":{"line":96}}},"loc":{"start":{"line":96},"end":{"line":96}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userfile","vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":100},"end":{"line":100}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":100},"end":{"line":100}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":100},"end":{"line":100}}},"right":{"type":"Identifier","name":"TARGET_RELATIVE_PATH","loc":{"start":{"line":101},"end":{"line":101}}},"loc":{"start":{"line":100},"end":{"line":101}}},"right":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":101},"end":{"line":101}}},"loc":{"start":{"line":100},"end":{"line":101}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":102},"end":{"line":102}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":102},"end":{"line":102}}},"arguments":[],"loc":{"start":{"line":102},"end":{"line":102}}},"loc":{"start":{"line":100},"end":{"line":102}}},"right":{"type":"Literal","value":".txt","raw":".txt"},"loc":{"start":{"line":100},"end":{"line":102}}}],"loc":{"start":{"line":100},"end":{"line":102}}},"loc":{"start":{"line":100},"end":{"line":102}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userfile","loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"delete"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":78},"end":{"line":106}}},"code":"\nprivate void fill_uploads_and_target_parent_directory(WebSession s) {\n    uploads_and_target_parent_directory \u003d s.getContext().getRealPath(\"/\");\n    if (!uploads_and_target_parent_directory.endsWith(File.separator)) {\n        uploads_and_target_parent_directory \u003d uploads_and_target_parent_directory + File.separator;\n    }\n    System.out.println(\"uploads_and_target_parent_directory set to \u003d \" + uploads_and_target_parent_directory);\n    File uploads_dir \u003d new File(uploads_and_target_parent_directory + UPLOADS_RELATIVE_PATH);\n    uploads_dir.mkdir();\n    File target_dir \u003d new File(uploads_and_target_parent_directory + TARGET_RELATIVE_PATH);\n    target_dir.mkdir();\n    File userfile \u003d new File(uploads_and_target_parent_directory + TARGET_RELATIVE_PATH + java.io.File.separator + s.getUserName() + \".txt\");\n    userfile.delete();\n}","loc":{"start":{"line":78},"end":{"line":106}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":115},"end":{"line":115}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":115},"end":{"line":115}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":118},"end":{"line":118}}},"right":{"type":"Literal"},"loc":{"start":{"line":118},"end":{"line":118}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"fill_uploads_and_target_parent_directory","loc":{"start":{"line":119},"end":{"line":119}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":118},"end":{"line":120}}},"loc":{"start":{"line":118},"end":{"line":120}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":123},"end":{"line":123}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":123},"end":{"line":123}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":123},"end":{"line":123}}},"arguments":[],"loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":175},"end":{"line":175}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[],"loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[],"loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}}],"loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":178},"end":{"line":178}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":178},"end":{"line":178}}},"arguments":[],"loc":{"start":{"line":178},"end":{"line":178}}},"loc":{"start":{"line":178},"end":{"line":178}}}],"loc":{"start":{"line":176},"end":{"line":179}}},"loc":{"start":{"line":175},"end":{"line":179}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userfile","vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":130},"end":{"line":130}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":130},"end":{"line":130}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":130},"end":{"line":130}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":130},"end":{"line":130}}},"right":{"type":"Identifier","name":"TARGET_RELATIVE_PATH","loc":{"start":{"line":131},"end":{"line":131}}},"loc":{"start":{"line":130},"end":{"line":131}}},"right":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":131},"end":{"line":131}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":131},"end":{"line":131}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":131},"end":{"line":131}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":131},"end":{"line":131}}},"loc":{"start":{"line":130},"end":{"line":131}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":132},"end":{"line":132}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":132},"end":{"line":132}}},"arguments":[],"loc":{"start":{"line":132},"end":{"line":132}}},"loc":{"start":{"line":130},"end":{"line":132}}},"right":{"type":"Literal","value":".txt","raw":".txt"},"loc":{"start":{"line":130},"end":{"line":132}}}],"loc":{"start":{"line":130},"end":{"line":132}}},"loc":{"start":{"line":130},"end":{"line":132}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userfile","loc":{"start":{"line":134},"end":{"line":134}}},"property":{"type":"Identifier","name":"exists"},"loc":{"start":{"line":134},"end":{"line":134}}},"arguments":[],"loc":{"start":{"line":134},"end":{"line":134}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":135},"end":{"line":135}}}],"loc":{"start":{"line":135},"end":{"line":135}}},"loc":{"start":{"line":135},"end":{"line":135}}}],"loc":{"start":{"line":134},"end":{"line":136}}},"loc":{"start":{"line":134},"end":{"line":136}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":138},"end":{"line":138}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":138},"end":{"line":138}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":138},"end":{"line":138}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":138},"end":{"line":138}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":138},"end":{"line":138}}}],"loc":{"start":{"line":138},"end":{"line":138}}},"loc":{"start":{"line":138},"end":{"line":138}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":140},"end":{"line":140}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":140},"end":{"line":140}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"H1","loc":{"start":{"line":140},"end":{"line":140}}},"arguments":[],"loc":{"start":{"line":140},"end":{"line":140}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":140},"end":{"line":140}}},"arguments":[{"type":"Literal","value":"WebGoat Image Storage","raw":"WebGoat Image Storage"}],"loc":{"start":{"line":140},"end":{"line":140}}}],"loc":{"start":{"line":140},"end":{"line":140}}},"loc":{"start":{"line":140},"end":{"line":140}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":143},"end":{"line":143}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"P","loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[],"loc":{"start":{"line":143},"end":{"line":143}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[{"type":"Literal","value":"Your current image:","raw":"Your current image:"}],"loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"image_query","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":145},"end":{"line":145}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":145},"end":{"line":145}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"SELECT image_relative_url FROM mfe_images WHERE user_name \u003d \u0027","raw":"SELECT image_relative_url FROM mfe_images WHERE user_name \u003d \u0027"},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":146},"end":{"line":146}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":146},"end":{"line":146}}},"arguments":[],"loc":{"start":{"line":146},"end":{"line":146}}},"loc":{"start":{"line":145},"end":{"line":146}}},"right":{"type":"Literal","value":"\u0027","raw":"\u0027"},"loc":{"start":{"line":145},"end":{"line":146}}},"loc":{"start":{"line":145},"end":{"line":146}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"image_statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":148},"end":{"line":148}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":148},"end":{"line":148}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":148},"end":{"line":148}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":149},"end":{"line":149}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":149},"end":{"line":149}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":149},"end":{"line":149}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":149},"end":{"line":149}}}],"loc":{"start":{"line":148},"end":{"line":149}}},"loc":{"start":{"line":148},"end":{"line":149}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"image_results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":150},"end":{"line":150}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":150},"end":{"line":150}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"image_statement","loc":{"start":{"line":150},"end":{"line":150}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[{"type":"Identifier","name":"image_query","loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":150},"end":{"line":150}}},"loc":{"start":{"line":150},"end":{"line":150}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"image_results","loc":{"start":{"line":152},"end":{"line":152}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":152},"end":{"line":152}}},"arguments":[],"loc":{"start":{"line":152},"end":{"line":152}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":152},"end":{"line":152}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"P","loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[],"loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"Literal","value":"No image uploaded","raw":"No image uploaded"}],"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"Literal","value":"No image uploaded","raw":"No image uploaded"}],"loc":{"start":{"line":155},"end":{"line":155}}},"loc":{"start":{"line":155},"end":{"line":155}}}],"loc":{"start":{"line":152},"end":{"line":156}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"image_url","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":158},"end":{"line":158}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":158},"end":{"line":158}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"image_results","loc":{"start":{"line":158},"end":{"line":158}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":160},"end":{"line":160}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"IMG","loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Identifier","name":"image_url","loc":{"start":{"line":160},"end":{"line":160}}}],"loc":{"start":{"line":160},"end":{"line":160}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":160},"end":{"line":160}}},"property":{"type":"Identifier","name":"setHspace"},"loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":160},"end":{"line":160}}},"property":{"type":"Identifier","name":"setVspace"},"loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":160},"end":{"line":160}}}],"loc":{"start":{"line":160},"end":{"line":160}}},"loc":{"start":{"line":160},"end":{"line":160}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Found image named: ","raw":"Found image named: "},"right":{"type":"Identifier","name":"image_url","loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":156},"end":{"line":164}}},"loc":{"start":{"line":152},"end":{"line":164}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":166},"end":{"line":166}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":166},"end":{"line":166}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"P","loc":{"start":{"line":166},"end":{"line":166}}},"arguments":[],"loc":{"start":{"line":166},"end":{"line":166}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":166},"end":{"line":166}}},"arguments":[{"type":"Literal","value":"Upload a new image:","raw":"Upload a new image:"}],"loc":{"start":{"line":166},"end":{"line":166}}}],"loc":{"start":{"line":166},"end":{"line":166}}},"loc":{"start":{"line":166},"end":{"line":166}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"input","vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":168},"end":{"line":168}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":168},"end":{"line":168}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Input","loc":{"start":{"line":168},"end":{"line":168}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Input","loc":{"start":{"line":168},"end":{"line":168}}},"property":{"type":"Identifier","name":"FILE"},"loc":{"start":{"line":168},"end":{"line":168}}},{"type":"Literal","value":"myfile","raw":"myfile"},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":168},"end":{"line":168}}},"loc":{"start":{"line":168},"end":{"line":168}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":169},"end":{"line":169}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":169},"end":{"line":169}}},"arguments":[{"type":"Identifier","name":"input","loc":{"start":{"line":169},"end":{"line":169}}}],"loc":{"start":{"line":169},"end":{"line":169}}},"loc":{"start":{"line":169},"end":{"line":169}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"b","vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":171},"end":{"line":171}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":171},"end":{"line":171}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[{"type":"Literal","value":"Start Upload","raw":"Start Upload"}],"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":172},"end":{"line":172}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":172},"end":{"line":172}}},"arguments":[{"type":"Identifier","name":"b","loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":172},"end":{"line":172}}},"loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":126},"end":{"line":174}}},"loc":{"start":{"line":125},"end":{"line":179}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":181},"end":{"line":181}}},"loc":{"start":{"line":181},"end":{"line":181}}}],"loc":{"start":{"line":116},"end":{"line":182}}},"code":"\nprotected Element createContent(WebSession s) {\n    if (uploads_and_target_parent_directory \u003d\u003d null) {\n        fill_uploads_and_target_parent_directory(s);\n    }\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        File userfile \u003d new File(uploads_and_target_parent_directory + TARGET_RELATIVE_PATH + java.io.File.separator + s.getUserName() + \".txt\");\n        if (userfile.exists()) {\n            makeSuccess(s);\n        }\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        ec.addElement(new H1().addElement(\"WebGoat Image Storage\"));\n        ec.addElement(new P().addElement(\"Your current image:\"));\n        String image_query \u003d \"SELECT image_relative_url FROM mfe_images WHERE user_name \u003d \\\u0027\" + s.getUserName() + \"\\\u0027\";\n        Statement image_statement \u003d connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n        ResultSet image_results \u003d image_statement.executeQuery(image_query);\n        if (image_results.next() \u003d\u003d false) {\n            ec.addElement(new P().addElement(\"No image uploaded\"));\n            System.out.println(\"No image uploaded\");\n        } else {\n            String image_url \u003d image_results.getString(1);\n            ec.addElement(new IMG(image_url).setBorder(0).setHspace(0).setVspace(0));\n            System.out.println(\"Found image named: \" + image_url);\n        }\n        ec.addElement(new P().addElement(\"Upload a new image:\"));\n        Input input \u003d new Input(Input.FILE, \"myfile\", \"\");\n        ec.addElement(input);\n        Element b \u003d ECSFactory.makeButton(\"Start Upload\");\n        ec.addElement(b);\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":115},"end":{"line":182}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":189},"end":{"line":189}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":191},"end":{"line":191}}},"property":{"type":"Identifier","name":"MALICIOUS_EXECUTION"},"loc":{"start":{"line":191},"end":{"line":191}}},"loc":{"start":{"line":191},"end":{"line":191}}}],"loc":{"start":{"line":190},"end":{"line":192}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.MALICIOUS_EXECUTION;\n}","loc":{"start":{"line":189},"end":{"line":192}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getCredits"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":199},"end":{"line":199}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":201},"end":{"line":201}}},"property":{"type":"Identifier","name":"getCustomCredits"},"loc":{"start":{"line":201},"end":{"line":201}}},"arguments":[{"type":"Literal","value":"Created by Chuck Willis\u0026nbsp;","raw":"Created by Chuck Willis\u0026nbsp;"},{"type":"Identifier","name":"MANDIANT_LOGO","loc":{"start":{"line":201},"end":{"line":201}}}],"loc":{"start":{"line":201},"end":{"line":201}}},"loc":{"start":{"line":201},"end":{"line":201}}}],"loc":{"start":{"line":200},"end":{"line":202}}},"code":"\npublic Element getCredits() {\n    return super.getCustomCredits(\"Created by Chuck Willis\u0026nbsp;\", MANDIANT_LOGO);\n}","loc":{"start":{"line":199},"end":{"line":202}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":209},"end":{"line":209}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":209},"end":{"line":209}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":211},"end":{"line":211}}},"right":{"type":"Literal"},"loc":{"start":{"line":211},"end":{"line":211}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"fill_uploads_and_target_parent_directory","loc":{"start":{"line":212},"end":{"line":212}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":212},"end":{"line":212}}}],"loc":{"start":{"line":212},"end":{"line":212}}},"loc":{"start":{"line":212},"end":{"line":212}}}],"loc":{"start":{"line":211},"end":{"line":213}}},"loc":{"start":{"line":211},"end":{"line":213}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"target_filename","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":215},"end":{"line":215}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":215},"end":{"line":215}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":215},"end":{"line":215}}},"right":{"type":"Identifier","name":"TARGET_RELATIVE_PATH","loc":{"start":{"line":216},"end":{"line":216}}},"loc":{"start":{"line":215},"end":{"line":216}}},"right":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":217},"end":{"line":217}}},"loc":{"start":{"line":215},"end":{"line":217}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":218},"end":{"line":218}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":218},"end":{"line":218}}},"arguments":[],"loc":{"start":{"line":218},"end":{"line":218}}},"loc":{"start":{"line":215},"end":{"line":218}}},"right":{"type":"Literal","value":".txt","raw":".txt"},"loc":{"start":{"line":215},"end":{"line":218}}},"loc":{"start":{"line":215},"end":{"line":218}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":220},"end":{"line":220}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":220},"end":{"line":220}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":220},"end":{"line":220}}},"arguments":[],"loc":{"start":{"line":220},"end":{"line":220}}},"loc":{"start":{"line":220},"end":{"line":220}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":222},"end":{"line":222}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":222},"end":{"line":222}}},"arguments":[{"type":"Literal","value":"Where are uploaded images stored?  Can you browse to them directly?","raw":"Where are uploaded images stored?  Can you browse to them directly?"}],"loc":{"start":{"line":222},"end":{"line":222}}},"loc":{"start":{"line":222},"end":{"line":222}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":224},"end":{"line":224}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":224},"end":{"line":224}}},"arguments":[{"type":"Literal","value":"What type of file can you upload to a J2EE server that will be executed when you browse to it?","raw":"What type of file can you upload to a J2EE server that will be executed when you browse to it?"}],"loc":{"start":{"line":224},"end":{"line":224}}},"loc":{"start":{"line":224},"end":{"line":224}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":226},"end":{"line":226}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[{"type":"Literal","value":"You want to upload a .jsp file that creates an instance of the class java.io.File  and calls the createNewFile() method of that instance.","raw":"You want to upload a .jsp file that creates an instance of the class java.io.File  and calls the createNewFile() method of that instance."}],"loc":{"start":{"line":226},"end":{"line":227}}},"loc":{"start":{"line":226},"end":{"line":227}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":229},"end":{"line":229}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":229},"end":{"line":229}}},"arguments":[{"type":"Literal","value":"Below are some helpful links...\u003cbr\u003e\u003cbr\u003eHere is a page with an example of a simple .jsp file using a Scriptlet:\u003cbr\u003e\u003ca href\u003d\"http://www.jsptut.com/Scriptlets.jsp\"\u003ehttp://www.jsptut.com/Scriptlets.jsp\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eHere is an page with an example of using createNewFile():\u003cbr\u003e\u003ca href\u003d\"http://www.roseindia.net/java/example/java/io/CreateFile.shtml\"\u003ehttp://www.roseindia.net/java/example/java/io/CreateFile.shtml\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eHere is the API specification for java.io.File:\u003cbr\u003e\u003ca href\u003d\"http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html\"\u003ehttp://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html\u003c/a\u003e","raw":"Below are some helpful links...\u003cbr\u003e\u003cbr\u003eHere is a page with an example of a simple .jsp file using a Scriptlet:\u003cbr\u003e\u003ca href\u003d\"http://www.jsptut.com/Scriptlets.jsp\"\u003ehttp://www.jsptut.com/Scriptlets.jsp\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eHere is an page with an example of using createNewFile():\u003cbr\u003e\u003ca href\u003d\"http://www.roseindia.net/java/example/java/io/CreateFile.shtml\"\u003ehttp://www.roseindia.net/java/example/java/io/CreateFile.shtml\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eHere is the API specification for java.io.File:\u003cbr\u003e\u003ca href\u003d\"http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html\"\u003ehttp://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html\u003c/a\u003e"}],"loc":{"start":{"line":229},"end":{"line":239}}},"loc":{"start":{"line":229},"end":{"line":239}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":241},"end":{"line":241}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":241},"end":{"line":242}}},"arguments":[{"type":"Literal","value":"Here is an example .jsp file, modify it to use java.io.File and its createNewFile() method:\u003cbr\u003e\u003cbr\u003e\u0026lt;HTML\u0026gt;\u003cbr\u003e\u0026lt;%\u003cbr\u003ejava.lang.String hello \u003d new java.lang.String(\"Hello World!\");\u003cbr\u003eSystem.out.println(hello);\u003cbr\u003e%\u0026gt;\u003cbr\u003e\u0026lt;/HTML\u0026gt;\u003cbr\u003e\u003cbr\u003eNOTE: executing this file will print \"Hello World!\" to the Tomcat Console, not to your client browser","raw":"Here is an example .jsp file, modify it to use java.io.File and its createNewFile() method:\u003cbr\u003e\u003cbr\u003e\u0026lt;HTML\u0026gt;\u003cbr\u003e\u0026lt;%\u003cbr\u003ejava.lang.String hello \u003d new java.lang.String(\"Hello World!\");\u003cbr\u003eSystem.out.println(hello);\u003cbr\u003e%\u0026gt;\u003cbr\u003e\u0026lt;/HTML\u0026gt;\u003cbr\u003e\u003cbr\u003eNOTE: executing this file will print \"Hello World!\" to the Tomcat Console, not to your client browser"}],"loc":{"start":{"line":241},"end":{"line":250}}},"loc":{"start":{"line":241},"end":{"line":250}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":253},"end":{"line":253}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":253},"end":{"line":254}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"SOLUTION:\u003cbr\u003e\u003cbr\u003eUpload a file with a .jsp extension and this content:","raw":"SOLUTION:\u003cbr\u003e\u003cbr\u003eUpload a file with a .jsp extension and this content:"},"right":{"type":"Literal","value":"\u003cbr\u003e\u003cbr\u003e\u0026lt;HTML\u0026gt;","raw":"\u003cbr\u003e\u003cbr\u003e\u0026lt;HTML\u0026gt;"},"loc":{"start":{"line":254},"end":{"line":255}}},"right":{"type":"Literal","value":"\u003cbr\u003e\u0026lt;%","raw":"\u003cbr\u003e\u0026lt;%"},"loc":{"start":{"line":254},"end":{"line":256}}},"right":{"type":"Literal","value":"\u003cbr\u003ejava.io.File file \u003d new java.io.File(\"","raw":"\u003cbr\u003ejava.io.File file \u003d new java.io.File(\""},"loc":{"start":{"line":254},"end":{"line":257}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"target_filename","loc":{"start":{"line":258},"end":{"line":258}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":258},"end":{"line":258}}},"arguments":[{"type":"Literal","value":"\\\\","raw":"\\\\"},{"type":"Literal","value":"\\\\\\\\","raw":"\\\\\\\\"}],"loc":{"start":{"line":258},"end":{"line":258}}},"loc":{"start":{"line":254},"end":{"line":258}}},"right":{"type":"Literal","value":"\");","raw":"\");"},"loc":{"start":{"line":254},"end":{"line":260}}},"right":{"type":"Literal","value":"\u003cbr\u003efile.createNewFile();","raw":"\u003cbr\u003efile.createNewFile();"},"loc":{"start":{"line":254},"end":{"line":261}}},"right":{"type":"Literal","value":"\u003cbr\u003e%\u0026gt;","raw":"\u003cbr\u003e%\u0026gt;"},"loc":{"start":{"line":254},"end":{"line":262}}},"right":{"type":"Literal","value":"\u003cbr\u003e\u0026lt;/HTML\u0026gt;","raw":"\u003cbr\u003e\u0026lt;/HTML\u0026gt;"},"loc":{"start":{"line":254},"end":{"line":263}}},"right":{"type":"Literal","value":"\u003cbr\u003e\u003cbr\u003eAfter you have uploaded your jsp file, you can get the system to execute it by opening it in your browser at the URL below (or by just refreshing this page):","raw":"\u003cbr\u003e\u003cbr\u003eAfter you have uploaded your jsp file, you can get the system to execute it by opening it in your browser at the URL below (or by just refreshing this page):"},"loc":{"start":{"line":254},"end":{"line":264}}},"right":{"type":"Literal","value":"\u003cbr\u003e\u003cbr\u003ehttp://webgoat_ip:port/WebGoat/","raw":"\u003cbr\u003e\u003cbr\u003ehttp://webgoat_ip:port/WebGoat/"},"loc":{"start":{"line":254},"end":{"line":265}}},"right":{"type":"Identifier","name":"UPLOADS_RELATIVE_PATH","loc":{"start":{"line":265},"end":{"line":265}}},"loc":{"start":{"line":254},"end":{"line":265}}},"right":{"type":"Literal","value":"/yourfilename.jsp","raw":"/yourfilename.jsp"},"loc":{"start":{"line":254},"end":{"line":265}}}],"loc":{"start":{"line":253},"end":{"line":266}}},"loc":{"start":{"line":253},"end":{"line":266}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":268},"end":{"line":268}}},"loc":{"start":{"line":268},"end":{"line":268}}}],"loc":{"start":{"line":210},"end":{"line":269}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    if (uploads_and_target_parent_directory \u003d\u003d null) {\n        fill_uploads_and_target_parent_directory(s);\n    }\n    String target_filename \u003d uploads_and_target_parent_directory + TARGET_RELATIVE_PATH + java.io.File.separator + s.getUserName() + \".txt\";\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"Where are uploaded images stored?  Can you browse to them directly?\");\n    hints.add(\"What type of file can you upload to a J2EE server that will be executed when you browse to it?\");\n    hints.add(\"You want to upload a .jsp file that creates an instance of the class java.io.File  and calls the createNewFile() method of that instance.\");\n    hints.add(\"Below are some helpful links...\u003cbr\u003e\u003cbr\u003eHere is a page with an example of a simple .jsp file using a Scriptlet:\u003cbr\u003e\u003ca href\u003d\\\"http://www.jsptut.com/Scriptlets.jsp\\\"\u003ehttp://www.jsptut.com/Scriptlets.jsp\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eHere is an page with an example of using createNewFile():\u003cbr\u003e\u003ca href\u003d\\\"http://www.roseindia.net/java/example/java/io/CreateFile.shtml\\\"\u003ehttp://www.roseindia.net/java/example/java/io/CreateFile.shtml\u003c/a\u003e\u003cbr\u003e\u003cbr\u003eHere is the API specification for java.io.File:\u003cbr\u003e\u003ca href\u003d\\\"http://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html\\\"\u003ehttp://java.sun.com/j2se/1.5.0/docs/api/java/io/File.html\u003c/a\u003e\");\n    hints.add(\"Here is an example .jsp file, modify it to use java.io.File and its createNewFile() method:\u003cbr\u003e\u003cbr\u003e\u0026lt;HTML\u0026gt;\u003cbr\u003e\u0026lt;%\u003cbr\u003ejava.lang.String hello \u003d new java.lang.String(\\\"Hello World!\\\");\u003cbr\u003eSystem.out.println(hello);\u003cbr\u003e%\u0026gt;\u003cbr\u003e\u0026lt;/HTML\u0026gt;\u003cbr\u003e\u003cbr\u003eNOTE: executing this file will print \\\"Hello World!\\\" to the Tomcat Console, not to your client browser\");\n    hints.add(\"SOLUTION:\u003cbr\u003e\u003cbr\u003eUpload a file with a .jsp extension and this content:\" + \"\u003cbr\u003e\u003cbr\u003e\u0026lt;HTML\u0026gt;\" + \"\u003cbr\u003e\u0026lt;%\" + \"\u003cbr\u003ejava.io.File file \u003d new java.io.File(\\\"\" + target_filename.replaceAll(\"\\\\\\\\\", \"\\\\\\\\\\\\\\\\\") + \"\\\");\" + \"\u003cbr\u003efile.createNewFile();\" + \"\u003cbr\u003e%\u0026gt;\" + \"\u003cbr\u003e\u0026lt;/HTML\u0026gt;\" + \"\u003cbr\u003e\u003cbr\u003eAfter you have uploaded your jsp file, you can get the system to execute it by opening it in your browser at the URL below (or by just refreshing this page):\" + \"\u003cbr\u003e\u003cbr\u003ehttp://webgoat_ip:port/WebGoat/\" + UPLOADS_RELATIVE_PATH + \"/yourfilename.jsp\");\n    return hints;\n}","loc":{"start":{"line":209},"end":{"line":269}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"restartLesson"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":274},"end":{"line":274}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":277},"end":{"line":277}}},"right":{"type":"Literal"},"loc":{"start":{"line":277},"end":{"line":277}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"fill_uploads_and_target_parent_directory","loc":{"start":{"line":278},"end":{"line":278}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":278},"end":{"line":278}}}],"loc":{"start":{"line":278},"end":{"line":278}}},"loc":{"start":{"line":278},"end":{"line":278}}}],"loc":{"start":{"line":277},"end":{"line":279}}},"loc":{"start":{"line":277},"end":{"line":279}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":281},"end":{"line":281}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":281},"end":{"line":281}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":281},"end":{"line":281}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Restarting Malicious File Execution lesson for user ","raw":"Restarting Malicious File Execution lesson for user "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":281},"end":{"line":281}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":281},"end":{"line":281}}},"arguments":[],"loc":{"start":{"line":281},"end":{"line":281}}},"loc":{"start":{"line":281},"end":{"line":281}}}],"loc":{"start":{"line":281},"end":{"line":281}}},"loc":{"start":{"line":281},"end":{"line":281}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userfile","vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":284},"end":{"line":284}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":284},"end":{"line":284}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":284},"end":{"line":284}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":284},"end":{"line":284}}},"right":{"type":"Identifier","name":"TARGET_RELATIVE_PATH","loc":{"start":{"line":285},"end":{"line":285}}},"loc":{"start":{"line":284},"end":{"line":285}}},"right":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":286},"end":{"line":286}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":286},"end":{"line":286}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":286},"end":{"line":286}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":286},"end":{"line":286}}},"loc":{"start":{"line":284},"end":{"line":286}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":287},"end":{"line":287}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":287},"end":{"line":287}}},"arguments":[],"loc":{"start":{"line":287},"end":{"line":287}}},"loc":{"start":{"line":284},"end":{"line":287}}},"right":{"type":"Literal","value":".txt","raw":".txt"},"loc":{"start":{"line":284},"end":{"line":287}}}],"loc":{"start":{"line":284},"end":{"line":287}}},"loc":{"start":{"line":284},"end":{"line":287}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"userfile","loc":{"start":{"line":289},"end":{"line":289}}},"property":{"type":"Identifier","name":"delete"},"loc":{"start":{"line":289},"end":{"line":289}}},"arguments":[],"loc":{"start":{"line":289},"end":{"line":289}}},"loc":{"start":{"line":289},"end":{"line":289}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":304},"end":{"line":304}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":306},"end":{"line":306}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":306},"end":{"line":306}}},"arguments":[],"loc":{"start":{"line":306},"end":{"line":306}}},"loc":{"start":{"line":306},"end":{"line":306}}}],"loc":{"start":{"line":304},"end":{"line":307}}},"loc":{"start":{"line":304},"end":{"line":307}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":295},"end":{"line":295}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":295},"end":{"line":295}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":295},"end":{"line":295}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":295},"end":{"line":295}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":295},"end":{"line":295}}}],"loc":{"start":{"line":295},"end":{"line":295}}},"loc":{"start":{"line":295},"end":{"line":295}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":297},"end":{"line":297}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":297},"end":{"line":297}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":297},"end":{"line":297}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":297},"end":{"line":297}}},"arguments":[],"loc":{"start":{"line":297},"end":{"line":297}}},"loc":{"start":{"line":297},"end":{"line":297}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"deleteuserrow","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":299},"end":{"line":299}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":299},"end":{"line":299}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"DELETE from mfe_images WHERE user_name \u003d \u0027","raw":"DELETE from mfe_images WHERE user_name \u003d \u0027"},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":300},"end":{"line":300}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":300},"end":{"line":300}}},"arguments":[],"loc":{"start":{"line":300},"end":{"line":300}}},"loc":{"start":{"line":299},"end":{"line":300}}},"right":{"type":"Literal","value":"\u0027;","raw":"\u0027;"},"loc":{"start":{"line":299},"end":{"line":300}}},"loc":{"start":{"line":299},"end":{"line":300}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":302},"end":{"line":302}}},"property":{"type":"Identifier","name":"executeUpdate"},"loc":{"start":{"line":302},"end":{"line":302}}},"arguments":[{"type":"Identifier","name":"deleteuserrow","loc":{"start":{"line":302},"end":{"line":302}}}],"loc":{"start":{"line":302},"end":{"line":302}}},"loc":{"start":{"line":302},"end":{"line":302}}}],"loc":{"start":{"line":294},"end":{"line":304}}},"loc":{"start":{"line":294},"end":{"line":307}}}],"loc":{"start":{"line":275},"end":{"line":309}}},"code":"\npublic void restartLesson(WebSession s) {\n    if (uploads_and_target_parent_directory \u003d\u003d null) {\n        fill_uploads_and_target_parent_directory(s);\n    }\n    System.out.println(\"Restarting Malicious File Execution lesson for user \" + s.getUserName());\n    File userfile \u003d new File(uploads_and_target_parent_directory + TARGET_RELATIVE_PATH + java.io.File.separator + s.getUserName() + \".txt\");\n    userfile.delete();\n    try {\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        Statement statement \u003d connection.createStatement();\n        String deleteuserrow \u003d \"DELETE from mfe_images WHERE user_name \u003d \\\u0027\" + s.getUserName() + \"\\\u0027;\";\n        statement.executeUpdate(deleteuserrow);\n    } catch (SQLException e) {\n        e.printStackTrace();\n    }\n}","loc":{"start":{"line":274},"end":{"line":309}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":355},"end":{"line":355}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":355},"end":{"line":355}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":357},"end":{"line":357}}},"right":{"type":"Literal"},"loc":{"start":{"line":357},"end":{"line":357}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"fill_uploads_and_target_parent_directory","loc":{"start":{"line":358},"end":{"line":358}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":358},"end":{"line":358}}}],"loc":{"start":{"line":358},"end":{"line":358}}},"loc":{"start":{"line":358},"end":{"line":358}}}],"loc":{"start":{"line":357},"end":{"line":359}}},"loc":{"start":{"line":357},"end":{"line":359}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":361},"end":{"line":361}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":361},"end":{"line":361}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"The form below allows you to upload an image which will be displayed on this page.  ","raw":"The form below allows you to upload an image which will be displayed on this page.  "},"right":{"type":"Literal","value":"Features like this are often found on web based discussion boards and social networking sites.  ","raw":"Features like this are often found on web based discussion boards and social networking sites.  "},"loc":{"start":{"line":361},"end":{"line":362}}},"right":{"type":"Literal","value":"This feature is vulnerable to Malicious File Execution.","raw":"This feature is vulnerable to Malicious File Execution."},"loc":{"start":{"line":361},"end":{"line":363}}},"right":{"type":"Literal","value":"\u003cbr\u003e\u003cbr\u003eIn order to pass this lesson, upload and run a malicious file.  In order to prove that your file can execute,","raw":"\u003cbr\u003e\u003cbr\u003eIn order to pass this lesson, upload and run a malicious file.  In order to prove that your file can execute,"},"loc":{"start":{"line":361},"end":{"line":364}}},"right":{"type":"Literal","value":" it should create another file named:\u003cbr\u003e\u003cbr\u003e ","raw":" it should create another file named:\u003cbr\u003e\u003cbr\u003e "},"loc":{"start":{"line":361},"end":{"line":365}}},"right":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":366},"end":{"line":366}}},"loc":{"start":{"line":361},"end":{"line":366}}},"right":{"type":"Identifier","name":"TARGET_RELATIVE_PATH","loc":{"start":{"line":367},"end":{"line":367}}},"loc":{"start":{"line":361},"end":{"line":367}}},"right":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":368},"end":{"line":368}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":368},"end":{"line":368}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":368},"end":{"line":368}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":368},"end":{"line":368}}},"loc":{"start":{"line":361},"end":{"line":368}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":369},"end":{"line":369}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":369},"end":{"line":369}}},"arguments":[],"loc":{"start":{"line":369},"end":{"line":369}}},"loc":{"start":{"line":361},"end":{"line":369}}},"right":{"type":"Literal","value":".txt","raw":".txt"},"loc":{"start":{"line":361},"end":{"line":369}}},"right":{"type":"Literal","value":"\u003cbr\u003e\u003cbr\u003eOnce you have created this file, you will pass the lesson.","raw":"\u003cbr\u003e\u003cbr\u003eOnce you have created this file, you will pass the lesson."},"loc":{"start":{"line":361},"end":{"line":370}}},"loc":{"start":{"line":361},"end":{"line":370}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":372},"end":{"line":372}}},"loc":{"start":{"line":372},"end":{"line":372}}}],"loc":{"start":{"line":356},"end":{"line":373}}},"code":"\npublic String getInstructions(WebSession s) {\n    if (uploads_and_target_parent_directory \u003d\u003d null) {\n        fill_uploads_and_target_parent_directory(s);\n    }\n    String instructions \u003d \"The form below allows you to upload an image which will be displayed on this page.  \" + \"Features like this are often found on web based discussion boards and social networking sites.  \" + \"This feature is vulnerable to Malicious File Execution.\" + \"\u003cbr\u003e\u003cbr\u003eIn order to pass this lesson, upload and run a malicious file.  In order to prove that your file can execute,\" + \" it should create another file named:\u003cbr\u003e\u003cbr\u003e \" + uploads_and_target_parent_directory + TARGET_RELATIVE_PATH + java.io.File.separator + s.getUserName() + \".txt\" + \"\u003cbr\u003e\u003cbr\u003eOnce you have created this file, you will pass the lesson.\";\n    return (instructions);\n}","loc":{"start":{"line":355},"end":{"line":373}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":375},"end":{"line":375}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":375},"end":{"line":375}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":375},"end":{"line":375}}},"arguments":[{"type":"Literal","value":75,"raw":75}],"loc":{"start":{"line":375},"end":{"line":375}}},"loc":{"start":{"line":375},"end":{"line":375}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":377},"end":{"line":377}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":379},"end":{"line":379}}},"loc":{"start":{"line":379},"end":{"line":379}}}],"loc":{"start":{"line":378},"end":{"line":380}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":377},"end":{"line":380}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":387},"end":{"line":387}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Malicious File Execution","raw":"Malicious File Execution"},"loc":{"start":{"line":389},"end":{"line":389}}}],"loc":{"start":{"line":388},"end":{"line":390}}},"code":"\npublic String getTitle() {\n    return (\"Malicious File Execution\");\n}","loc":{"start":{"line":387},"end":{"line":390}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"handleRequest"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":398},"end":{"line":398}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":401},"end":{"line":401}}},"right":{"type":"Literal"},"loc":{"start":{"line":401},"end":{"line":401}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"fill_uploads_and_target_parent_directory","loc":{"start":{"line":402},"end":{"line":402}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":402},"end":{"line":402}}}],"loc":{"start":{"line":402},"end":{"line":402}}},"loc":{"start":{"line":402},"end":{"line":402}}}],"loc":{"start":{"line":401},"end":{"line":403}}},"loc":{"start":{"line":401},"end":{"line":403}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":495},"end":{"line":495}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":497},"end":{"line":497}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":497},"end":{"line":497}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":497},"end":{"line":497}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Exception caught: ","raw":"Exception caught: "},"right":{"type":"Identifier","name":"e","loc":{"start":{"line":497},"end":{"line":497}}},"loc":{"start":{"line":497},"end":{"line":497}}}],"loc":{"start":{"line":497},"end":{"line":497}}},"loc":{"start":{"line":497},"end":{"line":497}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":498},"end":{"line":498}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":498},"end":{"line":498}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":498},"end":{"line":498}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":498},"end":{"line":498}}}],"loc":{"start":{"line":498},"end":{"line":498}}},"loc":{"start":{"line":498},"end":{"line":498}}}],"loc":{"start":{"line":496},"end":{"line":499}}},"loc":{"start":{"line":495},"end":{"line":499}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ServletFileUpload","loc":{"start":{"line":409},"end":{"line":409}}},"property":{"type":"Identifier","name":"isMultipartContent"},"loc":{"start":{"line":409},"end":{"line":409}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":409},"end":{"line":409}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":409},"end":{"line":409}}},"arguments":[],"loc":{"start":{"line":409},"end":{"line":409}}}],"loc":{"start":{"line":409},"end":{"line":409}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"factory","vartype":{"type":"Identifier","name":"DiskFileItemFactory","loc":{"start":{"line":413},"end":{"line":413}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"DiskFileItemFactory","loc":{"start":{"line":413},"end":{"line":413}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"DiskFileItemFactory","loc":{"start":{"line":413},"end":{"line":413}}},"arguments":[],"loc":{"start":{"line":413},"end":{"line":413}}},"loc":{"start":{"line":413},"end":{"line":413}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"factory","loc":{"start":{"line":414},"end":{"line":414}}},"property":{"type":"Identifier","name":"setSizeThreshold"},"loc":{"start":{"line":414},"end":{"line":414}}},"arguments":[{"type":"Literal","value":500000,"raw":500000}],"loc":{"start":{"line":414},"end":{"line":414}}},"loc":{"start":{"line":414},"end":{"line":414}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"upload","vartype":{"type":"Identifier","name":"ServletFileUpload","loc":{"start":{"line":418},"end":{"line":418}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ServletFileUpload","loc":{"start":{"line":418},"end":{"line":418}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ServletFileUpload","loc":{"start":{"line":418},"end":{"line":418}}},"arguments":[{"type":"Identifier","name":"factory","loc":{"start":{"line":418},"end":{"line":418}}}],"loc":{"start":{"line":418},"end":{"line":418}}},"loc":{"start":{"line":418},"end":{"line":418}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"items","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":421},"end":{"line":421}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":421},"end":{"line":421}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"upload","loc":{"start":{"line":421},"end":{"line":421}}},"property":{"type":"Identifier","name":"parseRequest"},"loc":{"start":{"line":421},"end":{"line":421}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":421},"end":{"line":421}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":421},"end":{"line":421}}},"arguments":[],"loc":{"start":{"line":421},"end":{"line":421}}}],"loc":{"start":{"line":421},"end":{"line":421}}},"loc":{"start":{"line":421},"end":{"line":421}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"iter","vartype":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":424},"end":{"line":424}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":424},"end":{"line":424}}},"property":{"type":"Identifier","name":"Iterator"},"loc":{"start":{"line":424},"end":{"line":424}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":424},"end":{"line":424}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":424},"end":{"line":424}}},"property":{"type":"Identifier","name":"Iterator"},"loc":{"start":{"line":424},"end":{"line":424}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"items","loc":{"start":{"line":424},"end":{"line":424}}},"property":{"type":"Identifier","name":"iterator"},"loc":{"start":{"line":424},"end":{"line":424}}},"arguments":[],"loc":{"start":{"line":424},"end":{"line":424}}},"loc":{"start":{"line":424},"end":{"line":424}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":425},"end":{"line":425}}},"property":{"type":"Identifier","name":"hasNext"},"loc":{"start":{"line":425},"end":{"line":425}}},"arguments":[],"loc":{"start":{"line":425},"end":{"line":425}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"item","vartype":{"type":"Identifier","name":"FileItem","loc":{"start":{"line":426},"end":{"line":426}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"FileItem","loc":{"start":{"line":426},"end":{"line":426}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"FileItem","loc":{"start":{"line":426},"end":{"line":426}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"iter","loc":{"start":{"line":426},"end":{"line":426}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":426},"end":{"line":426}}},"arguments":[],"loc":{"start":{"line":426},"end":{"line":426}}},"loc":{"start":{"line":426},"end":{"line":426}}},"loc":{"start":{"line":426},"end":{"line":426}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"item","loc":{"start":{"line":428},"end":{"line":428}}},"property":{"type":"Identifier","name":"isFormField"},"loc":{"start":{"line":428},"end":{"line":428}}},"arguments":[],"loc":{"start":{"line":428},"end":{"line":428}}},"consequent":{"type":"BlockStatement","body":[],"loc":{"start":{"line":428},"end":{"line":432}}},"alternate":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"item","loc":{"start":{"line":435},"end":{"line":435}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":435},"end":{"line":435}}},"arguments":[],"loc":{"start":{"line":435},"end":{"line":435}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":435},"end":{"line":435}}},"arguments":[{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":435},"end":{"line":435}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"item","loc":{"start":{"line":435},"end":{"line":435}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":435},"end":{"line":435}}},"arguments":[],"loc":{"start":{"line":435},"end":{"line":435}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":435},"end":{"line":435}}},"arguments":[{"type":"Literal","value":"\\","raw":"\\"}],"loc":{"start":{"line":435},"end":{"line":435}}},"loc":{"start":{"line":435},"end":{"line":435}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":436},"end":{"line":436}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":436},"end":{"line":436}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":436},"end":{"line":436}}},"arguments":[{"type":"Literal","value":"Uploaded file contains a / or \\ (i.e. attempted directory traversal).  Not storing file.","raw":"Uploaded file contains a / or \\ (i.e. attempted directory traversal).  Not storing file."}],"loc":{"start":{"line":436},"end":{"line":436}}},"loc":{"start":{"line":436},"end":{"line":436}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":439},"end":{"line":439}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":439},"end":{"line":439}}},"arguments":[{"type":"Literal","value":"Directory traversal not allowed.  Nice try though.","raw":"Directory traversal not allowed.  Nice try though."}],"loc":{"start":{"line":439},"end":{"line":439}}},"loc":{"start":{"line":439},"end":{"line":439}}}],"loc":{"start":{"line":435},"end":{"line":441}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploaded_file_path","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":444},"end":{"line":444}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":444},"end":{"line":444}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"uploads_and_target_parent_directory","loc":{"start":{"line":444},"end":{"line":444}}},"right":{"type":"Identifier","name":"UPLOADS_RELATIVE_PATH","loc":{"start":{"line":445},"end":{"line":445}}},"loc":{"start":{"line":444},"end":{"line":445}}},"right":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":446},"end":{"line":446}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":446},"end":{"line":446}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":446},"end":{"line":446}}},"property":{"type":"Identifier","name":"separator"},"loc":{"start":{"line":446},"end":{"line":446}}},"loc":{"start":{"line":444},"end":{"line":446}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"item","loc":{"start":{"line":447},"end":{"line":447}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":447},"end":{"line":447}}},"arguments":[],"loc":{"start":{"line":447},"end":{"line":447}}},"loc":{"start":{"line":444},"end":{"line":447}}},"loc":{"start":{"line":444},"end":{"line":447}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"uploadedFile","vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":448},"end":{"line":448}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":448},"end":{"line":448}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":448},"end":{"line":448}}},"arguments":[{"type":"Identifier","name":"uploaded_file_path","loc":{"start":{"line":448},"end":{"line":448}}}],"loc":{"start":{"line":448},"end":{"line":448}}},"loc":{"start":{"line":448},"end":{"line":448}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"item","loc":{"start":{"line":449},"end":{"line":449}}},"property":{"type":"Identifier","name":"write"},"loc":{"start":{"line":449},"end":{"line":449}}},"arguments":[{"type":"Identifier","name":"uploadedFile","loc":{"start":{"line":449},"end":{"line":449}}}],"loc":{"start":{"line":449},"end":{"line":449}}},"loc":{"start":{"line":449},"end":{"line":449}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":450},"end":{"line":450}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":450},"end":{"line":450}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":450},"end":{"line":450}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Stored file:\n","raw":"Stored file:\n"},"right":{"type":"Identifier","name":"uploaded_file_path","loc":{"start":{"line":450},"end":{"line":450}}},"loc":{"start":{"line":450},"end":{"line":450}}}],"loc":{"start":{"line":450},"end":{"line":450}}},"loc":{"start":{"line":450},"end":{"line":450}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":453},"end":{"line":453}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":453},"end":{"line":453}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":453},"end":{"line":453}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":453},"end":{"line":453}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":453},"end":{"line":453}}}],"loc":{"start":{"line":453},"end":{"line":453}}},"loc":{"start":{"line":453},"end":{"line":453}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":455},"end":{"line":455}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":455},"end":{"line":455}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":455},"end":{"line":455}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":455},"end":{"line":455}}},"arguments":[],"loc":{"start":{"line":455},"end":{"line":455}}},"loc":{"start":{"line":455},"end":{"line":455}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"updateData1","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":458},"end":{"line":458}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":458},"end":{"line":458}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"UPDATE mfe_images SET image_relative_url\u003d\u0027","raw":"UPDATE mfe_images SET image_relative_url\u003d\u0027"},"right":{"type":"Identifier","name":"UPLOADS_RELATIVE_PATH","loc":{"start":{"line":458},"end":{"line":458}}},"loc":{"start":{"line":458},"end":{"line":458}}},"right":{"type":"Literal","value":"/","raw":"/"},"loc":{"start":{"line":458},"end":{"line":458}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"item","loc":{"start":{"line":459},"end":{"line":459}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":459},"end":{"line":459}}},"arguments":[],"loc":{"start":{"line":459},"end":{"line":459}}},"loc":{"start":{"line":458},"end":{"line":459}}},"right":{"type":"Literal","value":"\u0027 WHERE user_name \u003d \u0027","raw":"\u0027 WHERE user_name \u003d \u0027"},"loc":{"start":{"line":458},"end":{"line":459}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":460},"end":{"line":460}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":460},"end":{"line":460}}},"arguments":[],"loc":{"start":{"line":460},"end":{"line":460}}},"loc":{"start":{"line":458},"end":{"line":460}}},"right":{"type":"Literal","value":"\u0027;","raw":"\u0027;"},"loc":{"start":{"line":458},"end":{"line":460}}},"loc":{"start":{"line":458},"end":{"line":460}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":462},"end":{"line":462}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":462},"end":{"line":462}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":462},"end":{"line":462}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Updating row:\n","raw":"Updating row:\n"},"right":{"type":"Identifier","name":"updateData1","loc":{"start":{"line":462},"end":{"line":462}}},"loc":{"start":{"line":462},"end":{"line":462}}}],"loc":{"start":{"line":462},"end":{"line":462}}},"loc":{"start":{"line":462},"end":{"line":462}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":463},"end":{"line":463}}},"property":{"type":"Identifier","name":"executeUpdate"},"loc":{"start":{"line":463},"end":{"line":463}}},"arguments":[{"type":"Identifier","name":"updateData1","loc":{"start":{"line":463},"end":{"line":463}}}],"loc":{"start":{"line":463},"end":{"line":463}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":463},"end":{"line":463}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"insertData1","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":466},"end":{"line":466}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":466},"end":{"line":466}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"INSERT INTO mfe_images VALUES (\u0027","raw":"INSERT INTO mfe_images VALUES (\u0027"},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":467},"end":{"line":467}}},"property":{"type":"Identifier","name":"getUserName"},"loc":{"start":{"line":467},"end":{"line":467}}},"arguments":[],"loc":{"start":{"line":467},"end":{"line":467}}},"loc":{"start":{"line":466},"end":{"line":467}}},"right":{"type":"Literal","value":"\u0027,\u0027","raw":"\u0027,\u0027"},"loc":{"start":{"line":466},"end":{"line":467}}},"right":{"type":"Identifier","name":"UPLOADS_RELATIVE_PATH","loc":{"start":{"line":467},"end":{"line":467}}},"loc":{"start":{"line":466},"end":{"line":467}}},"right":{"type":"Literal","value":"/","raw":"/"},"loc":{"start":{"line":466},"end":{"line":467}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"item","loc":{"start":{"line":468},"end":{"line":468}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":468},"end":{"line":468}}},"arguments":[],"loc":{"start":{"line":468},"end":{"line":468}}},"loc":{"start":{"line":466},"end":{"line":468}}},"right":{"type":"Literal","value":"\u0027)","raw":"\u0027)"},"loc":{"start":{"line":466},"end":{"line":468}}},"loc":{"start":{"line":466},"end":{"line":468}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":470},"end":{"line":470}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":470},"end":{"line":470}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":470},"end":{"line":470}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Inserting row:\n","raw":"Inserting row:\n"},"right":{"type":"Identifier","name":"insertData1","loc":{"start":{"line":470},"end":{"line":470}}},"loc":{"start":{"line":470},"end":{"line":470}}}],"loc":{"start":{"line":470},"end":{"line":470}}},"loc":{"start":{"line":470},"end":{"line":470}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":471},"end":{"line":471}}},"property":{"type":"Identifier","name":"executeUpdate"},"loc":{"start":{"line":471},"end":{"line":471}}},"arguments":[{"type":"Identifier","name":"insertData1","loc":{"start":{"line":471},"end":{"line":471}}}],"loc":{"start":{"line":471},"end":{"line":471}}},"loc":{"start":{"line":471},"end":{"line":471}}}],"loc":{"start":{"line":463},"end":{"line":473}}},"loc":{"start":{"line":463},"end":{"line":473}}}],"loc":{"start":{"line":441},"end":{"line":474}}},"loc":{"start":{"line":435},"end":{"line":474}}}],"loc":{"start":{"line":432},"end":{"line":476}}},"loc":{"start":{"line":428},"end":{"line":476}}}],"loc":{"start":{"line":425},"end":{"line":477}}},"loc":{"start":{"line":425},"end":{"line":477}}}],"loc":{"start":{"line":409},"end":{"line":479}}},"loc":{"start":{"line":409},"end":{"line":479}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"form","vartype":{"type":"Identifier","name":"Form","loc":{"start":{"line":488},"end":{"line":488}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Form","loc":{"start":{"line":488},"end":{"line":488}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Form","loc":{"start":{"line":488},"end":{"line":488}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getFormAction","loc":{"start":{"line":488},"end":{"line":488}}},"arguments":[],"loc":{"start":{"line":488},"end":{"line":488}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"Form","loc":{"start":{"line":488},"end":{"line":488}}},"property":{"type":"Identifier","name":"POST"},"loc":{"start":{"line":488},"end":{"line":488}}}],"loc":{"start":{"line":488},"end":{"line":488}}},"property":{"type":"Identifier","name":"setName"},"loc":{"start":{"line":488},"end":{"line":488}}},"arguments":[{"type":"Literal","value":"form","raw":"form"}],"loc":{"start":{"line":488},"end":{"line":488}}},"property":{"type":"Identifier","name":"setEncType"},"loc":{"start":{"line":488},"end":{"line":489}}},"arguments":[{"type":"Literal","value":"multipart/form-data","raw":"multipart/form-data"}],"loc":{"start":{"line":488},"end":{"line":489}}},"loc":{"start":{"line":488},"end":{"line":489}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"form","loc":{"start":{"line":491},"end":{"line":491}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":491},"end":{"line":491}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"createContent","loc":{"start":{"line":491},"end":{"line":491}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":491},"end":{"line":491}}}],"loc":{"start":{"line":491},"end":{"line":491}}}],"loc":{"start":{"line":491},"end":{"line":491}}},"loc":{"start":{"line":491},"end":{"line":491}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setContent","loc":{"start":{"line":493},"end":{"line":493}}},"arguments":[{"type":"Identifier","name":"form","loc":{"start":{"line":493},"end":{"line":493}}}],"loc":{"start":{"line":493},"end":{"line":493}}},"loc":{"start":{"line":493},"end":{"line":493}}}],"loc":{"start":{"line":408},"end":{"line":494}}},"loc":{"start":{"line":407},"end":{"line":499}}}],"loc":{"start":{"line":399},"end":{"line":500}}},"code":"\npublic void handleRequest(WebSession s) {\n    if (uploads_and_target_parent_directory \u003d\u003d null) {\n        fill_uploads_and_target_parent_directory(s);\n    }\n    try {\n        if (ServletFileUpload.isMultipartContent(s.getRequest())) {\n            DiskFileItemFactory factory \u003d new DiskFileItemFactory();\n            factory.setSizeThreshold(500000);\n            ServletFileUpload upload \u003d new ServletFileUpload(factory);\n            List items \u003d upload.parseRequest(s.getRequest());\n            java.util.Iterator iter \u003d items.iterator();\n            while (iter.hasNext()) {\n                FileItem item \u003d (FileItem)iter.next();\n                if (item.isFormField()) {\n                } else {\n                    if (item.getName().contains(\"/\") || item.getName().contains(\"\\\\\")) {\n                        System.out.println(\"Uploaded file contains a / or \\\\ (i.e. attempted directory traversal).  Not storing file.\");\n                        s.setMessage(\"Directory traversal not allowed.  Nice try though.\");\n                    } else {\n                        String uploaded_file_path \u003d uploads_and_target_parent_directory + UPLOADS_RELATIVE_PATH + java.io.File.separator + item.getName();\n                        File uploadedFile \u003d new File(uploaded_file_path);\n                        item.write(uploadedFile);\n                        System.out.println(\"Stored file:\\n\" + uploaded_file_path);\n                        Connection connection \u003d DatabaseUtilities.getConnection(s);\n                        Statement statement \u003d connection.createStatement();\n                        String updateData1 \u003d \"UPDATE mfe_images SET image_relative_url\u003d\\\u0027\" + UPLOADS_RELATIVE_PATH + \"/\" + item.getName() + \"\\\u0027 WHERE user_name \u003d \\\u0027\" + s.getUserName() + \"\\\u0027;\";\n                        System.out.println(\"Updating row:\\n\" + updateData1);\n                        if (statement.executeUpdate(updateData1) \u003d\u003d 0) {\n                            String insertData1 \u003d \"INSERT INTO mfe_images VALUES (\\\u0027\" + s.getUserName() + \"\\\u0027,\\\u0027\" + UPLOADS_RELATIVE_PATH + \"/\" + item.getName() + \"\\\u0027)\";\n                            System.out.println(\"Inserting row:\\n\" + insertData1);\n                            statement.executeUpdate(insertData1);\n                        }\n                    }\n                }\n            }\n        }\n        Form form \u003d new Form(getFormAction(), Form.POST).setName(\"form\").setEncType(\"multipart/form-data\");\n        form.addElement(createContent(s));\n        setContent(form);\n    } catch (Exception e) {\n        System.out.println(\"Exception caught: \" + e);\n        e.printStackTrace(System.out);\n    }\n}","loc":{"start":{"line":398},"end":{"line":500}}}],"loc":{"start":{"line":59},"end":{"line":501}}}],"loc":{"start":{"line":1},"end":{"line":501}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/MaliciousFileExecution.java"}