{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"PreparedStatement"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"SQLException"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"RoleBasedAccessControl"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"RoleBasedAccessControl"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ParameterNotFoundException"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"UnauthenticatedException"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"UnauthorizedException"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ValidationException"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"DefaultLessonAction"},"modifiers":{"type":"Modifiers","modifiers":["public","abstract"],"annotations":[]},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lessonName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":46},"end":{"line":46}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":46},"end":{"line":46}}},"loc":{"start":{"line":46},"end":{"line":46}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"actionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":47},"end":{"line":47}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":47},"end":{"line":47}}},"loc":{"start":{"line":47},"end":{"line":47}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":49},"end":{"line":49}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":49},"end":{"line":49}}},"loc":{"start":{"line":49},"end":{"line":49}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":51},"end":{"line":51}}}},{"type":"Identifier","name":"lessonName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":51},"end":{"line":51}}}},{"type":"Identifier","name":"actionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":51},"end":{"line":51}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"lesson"},"loc":{"start":{"line":53},"end":{"line":53}}},"right":{"type":"Identifier","name":"lesson","loc":{"start":{"line":53},"end":{"line":53}}},"loc":{"start":{"line":53},"end":{"line":53}}},"loc":{"start":{"line":53},"end":{"line":53}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"lessonName"},"loc":{"start":{"line":54},"end":{"line":54}}},"right":{"type":"Identifier","name":"lessonName","loc":{"start":{"line":54},"end":{"line":54}}},"loc":{"start":{"line":54},"end":{"line":54}}},"loc":{"start":{"line":54},"end":{"line":54}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"actionName"},"loc":{"start":{"line":55},"end":{"line":55}}},"right":{"type":"Identifier","name":"actionName","loc":{"start":{"line":55},"end":{"line":55}}},"loc":{"start":{"line":55},"end":{"line":55}}},"loc":{"start":{"line":55},"end":{"line":55}}}],"loc":{"start":{"line":52},"end":{"line":56}}},"code":"\npublic \u003cinit\u003e(GoatHillsFinancial lesson, String lessonName, String actionName) {\n    this.lesson \u003d lesson;\n    this.lessonName \u003d lessonName;\n    this.actionName \u003d actionName;\n}","loc":{"start":{"line":51},"end":{"line":56}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"handleRequest"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":58},"end":{"line":58}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":58},"end":{"line":58}}},{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":58},"end":{"line":58}}},{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":59},"end":{"line":59}}},{"type":"Identifier","name":"ValidationException","loc":{"start":{"line":59},"end":{"line":59}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLesson","loc":{"start":{"line":61},"end":{"line":61}}},"arguments":[],"loc":{"start":{"line":61},"end":{"line":61}}},"property":{"type":"Identifier","name":"setCurrentAction"},"loc":{"start":{"line":61},"end":{"line":61}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":61},"end":{"line":61}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getActionName","loc":{"start":{"line":61},"end":{"line":61}}},"arguments":[],"loc":{"start":{"line":61},"end":{"line":61}}}],"loc":{"start":{"line":61},"end":{"line":61}}},"loc":{"start":{"line":61},"end":{"line":61}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"isAuthenticated","loc":{"start":{"line":63},"end":{"line":63}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":63},"end":{"line":63}}}],"loc":{"start":{"line":63},"end":{"line":63}}},"consequent":{"type":"BlockStatement","body":[],"loc":{"start":{"line":64},"end":{"line":65}}},"alternate":{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[],"loc":{"start":{"line":67},"end":{"line":67}}},"loc":{"start":{"line":67},"end":{"line":67}}},"loc":{"start":{"line":63},"end":{"line":67}}}],"loc":{"start":{"line":60},"end":{"line":68}}},"code":"\npublic void handleRequest(WebSession s) throws ParameterNotFoundException, UnauthenticatedException, UnauthorizedException, ValidationException {\n    getLesson().setCurrentAction(s, getActionName());\n    if (isAuthenticated(s)) {\n    } else throw new UnauthenticatedException();\n}","loc":{"start":{"line":58},"end":{"line":68}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getNextPage"},"modifiers":{"type":"Modifiers","modifiers":["public","abstract"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":70},"end":{"line":70}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":70},"end":{"line":70}}}}],"thrown":[],"code":"\npublic abstract String getNextPage(WebSession s);","loc":{"start":{"line":70},"end":{"line":70}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLesson"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":72},"end":{"line":72}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"lesson","loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":73},"end":{"line":75}}},"code":"\npublic GoatHillsFinancial getLesson() {\n    return lesson;\n}","loc":{"start":{"line":72},"end":{"line":75}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessonName"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":77},"end":{"line":77}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"lessonName","loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":78},"end":{"line":80}}},"code":"\npublic String getLessonName() {\n    return lessonName;\n}","loc":{"start":{"line":77},"end":{"line":80}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getActionName"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":82},"end":{"line":82}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"actionName","loc":{"start":{"line":84},"end":{"line":84}}},"loc":{"start":{"line":84},"end":{"line":84}}}],"loc":{"start":{"line":83},"end":{"line":85}}},"code":"\npublic String getActionName() {\n    return actionName;\n}","loc":{"start":{"line":82},"end":{"line":85}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setSessionAttribute"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":87},"end":{"line":87}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":87},"end":{"line":87}}}},{"type":"Identifier","name":"value","vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":87},"end":{"line":87}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[],"loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[],"loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":89},"end":{"line":89}}},{"type":"Identifier","name":"value","loc":{"start":{"line":89},"end":{"line":89}}}],"loc":{"start":{"line":89},"end":{"line":89}}},"loc":{"start":{"line":89},"end":{"line":89}}}],"loc":{"start":{"line":88},"end":{"line":90}}},"code":"\npublic void setSessionAttribute(WebSession s, String name, Object value) {\n    s.getRequest().getSession().setAttribute(name, value);\n}","loc":{"start":{"line":87},"end":{"line":90}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setRequestAttribute"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":92},"end":{"line":92}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":92},"end":{"line":92}}}},{"type":"Identifier","name":"value","vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":92},"end":{"line":92}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"setAttribute"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":94},"end":{"line":94}}},{"type":"Identifier","name":"value","loc":{"start":{"line":94},"end":{"line":94}}}],"loc":{"start":{"line":94},"end":{"line":94}}},"loc":{"start":{"line":94},"end":{"line":94}}}],"loc":{"start":{"line":93},"end":{"line":95}}},"code":"\npublic void setRequestAttribute(WebSession s, String name, Object value) {\n    s.getRequest().setAttribute(name, value);\n}","loc":{"start":{"line":92},"end":{"line":95}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"removeSessionAttribute"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":97},"end":{"line":97}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":97},"end":{"line":97}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"removeAttribute"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":99},"end":{"line":99}}}],"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}}],"loc":{"start":{"line":98},"end":{"line":100}}},"code":"\npublic void removeSessionAttribute(WebSession s, String name) {\n    s.getRequest().getSession().removeAttribute(name);\n}","loc":{"start":{"line":97},"end":{"line":100}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSessionAttribute"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":102},"end":{"line":102}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":102},"end":{"line":102}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":102},"end":{"line":102}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":102},"end":{"line":102}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":104},"end":{"line":104}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":104},"end":{"line":104}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":104},"end":{"line":104}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"value","loc":{"start":{"line":105},"end":{"line":105}}},"right":{"type":"Literal"},"loc":{"start":{"line":105},"end":{"line":105}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[],"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"value","loc":{"start":{"line":107},"end":{"line":107}}},"loc":{"start":{"line":107},"end":{"line":107}}}],"loc":{"start":{"line":103},"end":{"line":108}}},"code":"\nprotected String getSessionAttribute(WebSession s, String name) throws ParameterNotFoundException {\n    String value \u003d (String)s.getRequest().getSession().getAttribute(name);\n    if (value \u003d\u003d null) {\n        throw new ParameterNotFoundException();\n    }\n    return value;\n}","loc":{"start":{"line":102},"end":{"line":108}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getBooleanSessionAttribute"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":110},"end":{"line":110}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":110},"end":{"line":110}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":110},"end":{"line":110}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":112},"end":{"line":112}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"attribute","vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":114},"end":{"line":114}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Object","loc":{"start":{"line":114},"end":{"line":114}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":114},"end":{"line":114}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[],"loc":{"start":{"line":114},"end":{"line":114}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[],"loc":{"start":{"line":114},"end":{"line":114}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":114},"end":{"line":114}}}],"loc":{"start":{"line":114},"end":{"line":114}}},"loc":{"start":{"line":114},"end":{"line":114}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"attribute","loc":{"start":{"line":115},"end":{"line":115}}},"right":{"type":"Literal"},"loc":{"start":{"line":115},"end":{"line":115}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[],"loc":{"start":{"line":117},"end":{"line":117}}},"loc":{"start":{"line":117},"end":{"line":117}}}],"loc":{"start":{"line":116},"end":{"line":118}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":125},"end":{"line":125}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"TypeCast","clazz":{"type":"Identifier","name":"Boolean","loc":{"start":{"line":125},"end":{"line":125}}},"expression":{"type":"Identifier","name":"attribute","loc":{"start":{"line":125},"end":{"line":125}}},"loc":{"start":{"line":125},"end":{"line":125}}},"property":{"type":"Identifier","name":"booleanValue"},"loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[],"loc":{"start":{"line":125},"end":{"line":125}}},"loc":{"start":{"line":125},"end":{"line":125}}},"loc":{"start":{"line":125},"end":{"line":125}}}],"loc":{"start":{"line":120},"end":{"line":126}}},"loc":{"start":{"line":115},"end":{"line":126}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"value","loc":{"start":{"line":127},"end":{"line":127}}},"loc":{"start":{"line":127},"end":{"line":127}}}],"loc":{"start":{"line":111},"end":{"line":128}}},"code":"\nprotected boolean getBooleanSessionAttribute(WebSession s, String name) throws ParameterNotFoundException {\n    boolean value \u003d false;\n    Object attribute \u003d s.getRequest().getSession().getAttribute(name);\n    if (attribute \u003d\u003d null) {\n        throw new ParameterNotFoundException();\n    } else {\n        value \u003d ((Boolean)attribute).booleanValue();\n    }\n    return value;\n}","loc":{"start":{"line":110},"end":{"line":128}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getIntSessionAttribute"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":130},"end":{"line":130}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":130},"end":{"line":130}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":130},"end":{"line":130}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":132},"end":{"line":132}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ss","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":133},"end":{"line":133}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":133},"end":{"line":133}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":133},"end":{"line":133}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":133},"end":{"line":133}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[],"loc":{"start":{"line":133},"end":{"line":133}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[],"loc":{"start":{"line":133},"end":{"line":133}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":133},"end":{"line":133}}}],"loc":{"start":{"line":133},"end":{"line":133}}},"loc":{"start":{"line":133},"end":{"line":133}}},"loc":{"start":{"line":133},"end":{"line":133}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"ss","loc":{"start":{"line":134},"end":{"line":134}}},"right":{"type":"Literal"},"loc":{"start":{"line":134},"end":{"line":134}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":136},"end":{"line":136}}},"arguments":[],"loc":{"start":{"line":136},"end":{"line":136}}},"loc":{"start":{"line":136},"end":{"line":136}}}],"loc":{"start":{"line":135},"end":{"line":137}}},"alternate":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"nfe","vartype":{"type":"Identifier","name":"NumberFormatException","loc":{"start":{"line":143},"end":{"line":143}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":144},"end":{"line":145}}},"loc":{"start":{"line":143},"end":{"line":145}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":142},"end":{"line":142}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Integer","loc":{"start":{"line":142},"end":{"line":142}}},"property":{"type":"Identifier","name":"parseInt"},"loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"Identifier","name":"ss","loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":141},"end":{"line":143}}},"loc":{"start":{"line":140},"end":{"line":145}}}],"loc":{"start":{"line":139},"end":{"line":146}}},"loc":{"start":{"line":134},"end":{"line":146}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"value","loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}}],"loc":{"start":{"line":131},"end":{"line":149}}},"code":"\nprotected int getIntSessionAttribute(WebSession s, String name) throws ParameterNotFoundException {\n    int value \u003d -1;\n    String ss \u003d (String)s.getRequest().getSession().getAttribute(name);\n    if (ss \u003d\u003d null) {\n        throw new ParameterNotFoundException();\n    } else {\n        try {\n            value \u003d Integer.parseInt(ss);\n        } catch (NumberFormatException nfe) {\n        }\n    }\n    return value;\n}","loc":{"start":{"line":130},"end":{"line":149}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRequestAttribute"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":151},"end":{"line":151}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":151},"end":{"line":151}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":151},"end":{"line":151}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":151},"end":{"line":151}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":153},"end":{"line":153}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":153},"end":{"line":153}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":153},"end":{"line":153}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":153},"end":{"line":153}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":153},"end":{"line":153}}},"arguments":[],"loc":{"start":{"line":153},"end":{"line":153}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":153},"end":{"line":153}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":153},"end":{"line":153}}}],"loc":{"start":{"line":153},"end":{"line":153}}},"loc":{"start":{"line":153},"end":{"line":153}}},"loc":{"start":{"line":153},"end":{"line":153}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"value","loc":{"start":{"line":154},"end":{"line":154}}},"right":{"type":"Literal"},"loc":{"start":{"line":154},"end":{"line":154}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"value","loc":{"start":{"line":156},"end":{"line":156}}},"loc":{"start":{"line":156},"end":{"line":156}}}],"loc":{"start":{"line":152},"end":{"line":157}}},"code":"\nprotected String getRequestAttribute(WebSession s, String name) throws ParameterNotFoundException {\n    String value \u003d (String)s.getRequest().getAttribute(name);\n    if (value \u003d\u003d null) {\n        throw new ParameterNotFoundException();\n    }\n    return value;\n}","loc":{"start":{"line":151},"end":{"line":157}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getIntRequestAttribute"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":159},"end":{"line":159}}}},{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":159},"end":{"line":159}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":159},"end":{"line":159}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"value","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":161},"end":{"line":161}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ss","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":162},"end":{"line":162}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":162},"end":{"line":162}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":162},"end":{"line":162}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[],"loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"Identifier","name":"name","loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"ss","loc":{"start":{"line":163},"end":{"line":163}}},"right":{"type":"Literal"},"loc":{"start":{"line":163},"end":{"line":163}}},"consequent":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":165},"end":{"line":165}}},"arguments":[],"loc":{"start":{"line":165},"end":{"line":165}}},"loc":{"start":{"line":165},"end":{"line":165}}}],"loc":{"start":{"line":164},"end":{"line":166}}},"alternate":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"nfe","vartype":{"type":"Identifier","name":"NumberFormatException","loc":{"start":{"line":172},"end":{"line":172}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":173},"end":{"line":174}}},"loc":{"start":{"line":172},"end":{"line":174}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"value","loc":{"start":{"line":171},"end":{"line":171}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Integer","loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"parseInt"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[{"type":"Identifier","name":"ss","loc":{"start":{"line":171},"end":{"line":171}}}],"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}}],"loc":{"start":{"line":170},"end":{"line":172}}},"loc":{"start":{"line":169},"end":{"line":174}}}],"loc":{"start":{"line":168},"end":{"line":175}}},"loc":{"start":{"line":163},"end":{"line":175}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"value","loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}}],"loc":{"start":{"line":160},"end":{"line":178}}},"code":"\nprotected int getIntRequestAttribute(WebSession s, String name) throws ParameterNotFoundException {\n    int value \u003d -1;\n    String ss \u003d (String)s.getRequest().getAttribute(name);\n    if (ss \u003d\u003d null) {\n        throw new ParameterNotFoundException();\n    } else {\n        try {\n            value \u003d Integer.parseInt(ss);\n        } catch (NumberFormatException nfe) {\n        }\n    }\n    return value;\n}","loc":{"start":{"line":159},"end":{"line":178}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getUserId"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":180},"end":{"line":180}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":180},"end":{"line":180}}}],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getIntSessionAttribute","loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":182},"end":{"line":182}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonName","loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[],"loc":{"start":{"line":182},"end":{"line":182}}},"right":{"type":"Literal","value":".","raw":"."},"loc":{"start":{"line":182},"end":{"line":182}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":182},"end":{"line":182}}},"property":{"type":"Identifier","name":"USER_ID"},"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}}],"loc":{"start":{"line":181},"end":{"line":183}}},"code":"\npublic int getUserId(WebSession s) throws ParameterNotFoundException {\n    return getIntSessionAttribute(s, getLessonName() + \".\" + RoleBasedAccessControl.USER_ID);\n}","loc":{"start":{"line":180},"end":{"line":183}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getUserName"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":185},"end":{"line":185}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":185},"end":{"line":185}}}}],"thrown":[{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":185},"end":{"line":185}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"name","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":187},"end":{"line":187}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":187},"end":{"line":187}}},"init":{"type":"Literal"},"loc":{"start":{"line":187},"end":{"line":187}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"employeeId","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getUserId","loc":{"start":{"line":189},"end":{"line":189}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":189},"end":{"line":189}}}],"loc":{"start":{"line":189},"end":{"line":189}}},"loc":{"start":{"line":189},"end":{"line":189}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":205},"end":{"line":205}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":207},"end":{"line":207}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":207},"end":{"line":207}}},"arguments":[{"type":"Literal","value":"Error getting user name","raw":"Error getting user name"}],"loc":{"start":{"line":207},"end":{"line":207}}},"loc":{"start":{"line":207},"end":{"line":207}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":208},"end":{"line":208}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":208},"end":{"line":208}}},"arguments":[],"loc":{"start":{"line":208},"end":{"line":208}}},"loc":{"start":{"line":208},"end":{"line":208}}}],"loc":{"start":{"line":206},"end":{"line":209}}},"loc":{"start":{"line":205},"end":{"line":209}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"query","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":192},"end":{"line":192}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":192},"end":{"line":192}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"SELECT first_name FROM employee WHERE userid \u003d ","raw":"SELECT first_name FROM employee WHERE userid \u003d "},"right":{"type":"Identifier","name":"employeeId","loc":{"start":{"line":192},"end":{"line":192}}},"loc":{"start":{"line":192},"end":{"line":192}}},"loc":{"start":{"line":192},"end":{"line":192}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"sqle","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":200},"end":{"line":200}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":202},"end":{"line":202}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":202},"end":{"line":202}}},"arguments":[{"type":"Literal","value":"Error getting user name","raw":"Error getting user name"}],"loc":{"start":{"line":202},"end":{"line":202}}},"loc":{"start":{"line":202},"end":{"line":202}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqle","loc":{"start":{"line":203},"end":{"line":203}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":203},"end":{"line":203}}},"arguments":[],"loc":{"start":{"line":203},"end":{"line":203}}},"loc":{"start":{"line":203},"end":{"line":203}}}],"loc":{"start":{"line":201},"end":{"line":204}}},"loc":{"start":{"line":200},"end":{"line":204}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"answer_statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":196},"end":{"line":196}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":196},"end":{"line":196}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":196},"end":{"line":196}}}],"loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":196},"end":{"line":197}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":197},"end":{"line":197}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":197},"end":{"line":197}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":197},"end":{"line":197}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":197},"end":{"line":197}}}],"loc":{"start":{"line":196},"end":{"line":197}}},"loc":{"start":{"line":196},"end":{"line":197}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"answer_results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":198},"end":{"line":198}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":198},"end":{"line":198}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_statement","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[{"type":"Identifier","name":"query","loc":{"start":{"line":198},"end":{"line":198}}}],"loc":{"start":{"line":198},"end":{"line":198}}},"loc":{"start":{"line":198},"end":{"line":198}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_results","loc":{"start":{"line":199},"end":{"line":199}}},"property":{"type":"Identifier","name":"next"},"loc":{"start":{"line":199},"end":{"line":199}}},"arguments":[],"loc":{"start":{"line":199},"end":{"line":199}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"name","loc":{"start":{"line":199},"end":{"line":199}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_results","loc":{"start":{"line":199},"end":{"line":199}}},"property":{"type":"Identifier","name":"getString"},"loc":{"start":{"line":199},"end":{"line":199}}},"arguments":[{"type":"Literal","value":"first_name","raw":"first_name"}],"loc":{"start":{"line":199},"end":{"line":199}}},"loc":{"start":{"line":199},"end":{"line":199}}},"loc":{"start":{"line":199},"end":{"line":199}}},"loc":{"start":{"line":199},"end":{"line":199}}}],"loc":{"start":{"line":195},"end":{"line":200}}},"loc":{"start":{"line":194},"end":{"line":204}}}],"loc":{"start":{"line":191},"end":{"line":205}}},"loc":{"start":{"line":190},"end":{"line":209}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"name","loc":{"start":{"line":211},"end":{"line":211}}},"loc":{"start":{"line":211},"end":{"line":211}}}],"loc":{"start":{"line":186},"end":{"line":212}}},"code":"\npublic String getUserName(WebSession s) throws ParameterNotFoundException {\n    String name \u003d null;\n    int employeeId \u003d getUserId(s);\n    try {\n        String query \u003d \"SELECT first_name FROM employee WHERE userid \u003d \" + employeeId;\n        try {\n            Statement answer_statement \u003d WebSession.getConnection(s).createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n            ResultSet answer_results \u003d answer_statement.executeQuery(query);\n            if (answer_results.next()) name \u003d answer_results.getString(\"first_name\");\n        } catch (SQLException sqle) {\n            s.setMessage(\"Error getting user name\");\n            sqle.printStackTrace();\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error getting user name\");\n        e.printStackTrace();\n    }\n    return name;\n}","loc":{"start":{"line":185},"end":{"line":212}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"requiresAuthentication"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":217},"end":{"line":217}}}],"loc":{"start":{"line":215},"end":{"line":218}}},"code":"\npublic boolean requiresAuthentication() {\n    return true;\n}","loc":{"start":{"line":214},"end":{"line":218}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"isAuthenticated"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":220},"end":{"line":220}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"authenticated","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":222},"end":{"line":222}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":227},"end":{"line":227}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":228},"end":{"line":229}}},"loc":{"start":{"line":227},"end":{"line":229}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"authenticated","loc":{"start":{"line":226},"end":{"line":226}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getBooleanSessionAttribute","loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":226},"end":{"line":226}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonName","loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[],"loc":{"start":{"line":226},"end":{"line":226}}},"right":{"type":"Literal","value":".isAuthenticated","raw":".isAuthenticated"},"loc":{"start":{"line":226},"end":{"line":226}}}],"loc":{"start":{"line":226},"end":{"line":226}}},"loc":{"start":{"line":226},"end":{"line":226}}},"loc":{"start":{"line":226},"end":{"line":226}}}],"loc":{"start":{"line":225},"end":{"line":227}}},"loc":{"start":{"line":224},"end":{"line":229}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"authenticated","loc":{"start":{"line":231},"end":{"line":231}}},"loc":{"start":{"line":231},"end":{"line":231}}}],"loc":{"start":{"line":221},"end":{"line":232}}},"code":"\npublic boolean isAuthenticated(WebSession s) {\n    boolean authenticated \u003d false;\n    try {\n        authenticated \u003d getBooleanSessionAttribute(s, getLessonName() + \".isAuthenticated\");\n    } catch (ParameterNotFoundException e) {\n    }\n    return authenticated;\n}","loc":{"start":{"line":220},"end":{"line":232}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"isAuthorized"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":234},"end":{"line":234}}}},{"type":"Identifier","name":"employeeId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"functionId","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":234},"end":{"line":234}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"employer_id","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":236},"end":{"line":236}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":236},"end":{"line":236}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":236},"end":{"line":236}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":236},"end":{"line":236}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":236},"end":{"line":236}}},"arguments":[],"loc":{"start":{"line":236},"end":{"line":236}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":236},"end":{"line":236}}},"arguments":[],"loc":{"start":{"line":236},"end":{"line":236}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":236},"end":{"line":237}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonName","loc":{"start":{"line":237},"end":{"line":237}}},"arguments":[],"loc":{"start":{"line":237},"end":{"line":237}}},"right":{"type":"Literal","value":".","raw":"."},"loc":{"start":{"line":237},"end":{"line":237}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":237},"end":{"line":237}}},"property":{"type":"Identifier","name":"USER_ID"},"loc":{"start":{"line":237},"end":{"line":237}}},"loc":{"start":{"line":237},"end":{"line":237}}}],"loc":{"start":{"line":236},"end":{"line":237}}},"loc":{"start":{"line":236},"end":{"line":237}}},"loc":{"start":{"line":236},"end":{"line":237}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"authorized","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":241},"end":{"line":241}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":268},"end":{"line":268}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":270},"end":{"line":270}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":270},"end":{"line":270}}},"arguments":[{"type":"Literal","value":"Error authorizing","raw":"Error authorizing"}],"loc":{"start":{"line":270},"end":{"line":270}}},"loc":{"start":{"line":270},"end":{"line":270}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":271},"end":{"line":271}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":271},"end":{"line":271}}},"arguments":[],"loc":{"start":{"line":271},"end":{"line":271}}},"loc":{"start":{"line":271},"end":{"line":271}}}],"loc":{"start":{"line":269},"end":{"line":272}}},"loc":{"start":{"line":268},"end":{"line":272}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"query","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":245},"end":{"line":245}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":245},"end":{"line":245}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"SELECT * FROM auth WHERE auth.role in (SELECT roles.role FROM roles WHERE userid \u003d ","raw":"SELECT * FROM auth WHERE auth.role in (SELECT roles.role FROM roles WHERE userid \u003d "},"right":{"type":"Identifier","name":"employeeId","loc":{"start":{"line":246},"end":{"line":246}}},"loc":{"start":{"line":245},"end":{"line":246}}},"right":{"type":"Literal","value":") and functionid \u003d \u0027","raw":") and functionid \u003d \u0027"},"loc":{"start":{"line":245},"end":{"line":246}}},"right":{"type":"Identifier","name":"functionId","loc":{"start":{"line":246},"end":{"line":246}}},"loc":{"start":{"line":245},"end":{"line":246}}},"right":{"type":"Literal","value":"\u0027","raw":"\u0027"},"loc":{"start":{"line":245},"end":{"line":246}}},"loc":{"start":{"line":245},"end":{"line":246}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"sqle","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":263},"end":{"line":263}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":265},"end":{"line":265}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":265},"end":{"line":265}}},"arguments":[{"type":"Literal","value":"Error authorizing","raw":"Error authorizing"}],"loc":{"start":{"line":265},"end":{"line":265}}},"loc":{"start":{"line":265},"end":{"line":265}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqle","loc":{"start":{"line":266},"end":{"line":266}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":266},"end":{"line":266}}},"arguments":[],"loc":{"start":{"line":266},"end":{"line":266}}},"loc":{"start":{"line":266},"end":{"line":266}}}],"loc":{"start":{"line":264},"end":{"line":267}}},"loc":{"start":{"line":263},"end":{"line":267}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"answer_statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":250},"end":{"line":250}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":250},"end":{"line":250}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":250},"end":{"line":250}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":250},"end":{"line":250}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":250},"end":{"line":250}}}],"loc":{"start":{"line":250},"end":{"line":250}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":250},"end":{"line":251}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":251},"end":{"line":251}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":251},"end":{"line":251}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":251},"end":{"line":251}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":251},"end":{"line":251}}}],"loc":{"start":{"line":250},"end":{"line":251}}},"loc":{"start":{"line":250},"end":{"line":251}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"answer_results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":252},"end":{"line":252}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":252},"end":{"line":252}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_statement","loc":{"start":{"line":252},"end":{"line":252}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":252},"end":{"line":252}}},"arguments":[{"type":"Identifier","name":"query","loc":{"start":{"line":252},"end":{"line":252}}}],"loc":{"start":{"line":252},"end":{"line":252}}},"loc":{"start":{"line":252},"end":{"line":252}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"authorized","loc":{"start":{"line":253},"end":{"line":253}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_results","loc":{"start":{"line":253},"end":{"line":253}}},"property":{"type":"Identifier","name":"first"},"loc":{"start":{"line":253},"end":{"line":253}}},"arguments":[],"loc":{"start":{"line":253},"end":{"line":253}}},"loc":{"start":{"line":253},"end":{"line":253}}},"loc":{"start":{"line":253},"end":{"line":253}}},{"type":"IfStatement","test":{"type":"Identifier","name":"authorized","loc":{"start":{"line":259},"end":{"line":259}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"authorized","loc":{"start":{"line":261},"end":{"line":261}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"isAuthorizedForEmployee","loc":{"start":{"line":261},"end":{"line":261}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":261},"end":{"line":261}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Integer","loc":{"start":{"line":261},"end":{"line":261}}},"property":{"type":"Identifier","name":"parseInt"},"loc":{"start":{"line":261},"end":{"line":261}}},"arguments":[{"type":"Identifier","name":"employer_id","loc":{"start":{"line":261},"end":{"line":261}}}],"loc":{"start":{"line":261},"end":{"line":261}}},{"type":"Identifier","name":"employeeId","loc":{"start":{"line":261},"end":{"line":261}}}],"loc":{"start":{"line":261},"end":{"line":261}}},"loc":{"start":{"line":261},"end":{"line":261}}},"loc":{"start":{"line":261},"end":{"line":261}}}],"loc":{"start":{"line":260},"end":{"line":262}}},"loc":{"start":{"line":259},"end":{"line":262}}}],"loc":{"start":{"line":249},"end":{"line":263}}},"loc":{"start":{"line":248},"end":{"line":267}}}],"loc":{"start":{"line":244},"end":{"line":268}}},"loc":{"start":{"line":243},"end":{"line":272}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"authorized","loc":{"start":{"line":275},"end":{"line":275}}},"loc":{"start":{"line":275},"end":{"line":275}}}],"loc":{"start":{"line":235},"end":{"line":276}}},"code":"\npublic boolean isAuthorized(WebSession s, int employeeId, String functionId) {\n    String employer_id \u003d (String)s.getRequest().getSession().getAttribute(getLessonName() + \".\" + RoleBasedAccessControl.USER_ID);\n    boolean authorized \u003d false;\n    try {\n        String query \u003d \"SELECT * FROM auth WHERE auth.role in (SELECT roles.role FROM roles WHERE userid \u003d \" + employeeId + \") and functionid \u003d \\\u0027\" + functionId + \"\\\u0027\";\n        try {\n            Statement answer_statement \u003d WebSession.getConnection(s).createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n            ResultSet answer_results \u003d answer_statement.executeQuery(query);\n            authorized \u003d answer_results.first();\n            if (authorized) {\n                authorized \u003d isAuthorizedForEmployee(s, Integer.parseInt(employer_id), employeeId);\n            }\n        } catch (SQLException sqle) {\n            s.setMessage(\"Error authorizing\");\n            sqle.printStackTrace();\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error authorizing\");\n        e.printStackTrace();\n    }\n    return authorized;\n}","loc":{"start":{"line":234},"end":{"line":276}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"isAuthorizedForEmployee"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":278},"end":{"line":278}}}},{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"employeeId","vartype":{"type":"PrimitiveType"}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"authorized","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":281},"end":{"line":281}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":301},"end":{"line":301}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":303},"end":{"line":303}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":303},"end":{"line":303}}},"arguments":[{"type":"Literal","value":"Error authorizing","raw":"Error authorizing"}],"loc":{"start":{"line":303},"end":{"line":303}}},"loc":{"start":{"line":303},"end":{"line":303}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":304},"end":{"line":304}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":304},"end":{"line":304}}},"arguments":[],"loc":{"start":{"line":304},"end":{"line":304}}},"loc":{"start":{"line":304},"end":{"line":304}}}],"loc":{"start":{"line":302},"end":{"line":305}}},"loc":{"start":{"line":301},"end":{"line":305}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"query","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":285},"end":{"line":285}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":285},"end":{"line":285}}},"init":{"type":"Literal","value":"SELECT * FROM ownership WHERE employer_id \u003d ? AND employee_id \u003d ?","raw":"SELECT * FROM ownership WHERE employer_id \u003d ? AND employee_id \u003d ?"},"loc":{"start":{"line":285},"end":{"line":285}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"sqle","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":296},"end":{"line":296}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":298},"end":{"line":298}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":298},"end":{"line":298}}},"arguments":[{"type":"Literal","value":"Error authorizing","raw":"Error authorizing"}],"loc":{"start":{"line":298},"end":{"line":298}}},"loc":{"start":{"line":298},"end":{"line":298}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqle","loc":{"start":{"line":299},"end":{"line":299}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":299},"end":{"line":299}}},"arguments":[],"loc":{"start":{"line":299},"end":{"line":299}}},"loc":{"start":{"line":299},"end":{"line":299}}}],"loc":{"start":{"line":297},"end":{"line":300}}},"loc":{"start":{"line":296},"end":{"line":300}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"answer_statement","vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":290},"end":{"line":290}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PreparedStatement","loc":{"start":{"line":290},"end":{"line":290}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":290},"end":{"line":290}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":290},"end":{"line":290}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":290},"end":{"line":290}}}],"loc":{"start":{"line":290},"end":{"line":290}}},"property":{"type":"Identifier","name":"prepareStatement"},"loc":{"start":{"line":290},"end":{"line":291}}},"arguments":[{"type":"Identifier","name":"query","loc":{"start":{"line":291},"end":{"line":291}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":291},"end":{"line":291}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":291},"end":{"line":291}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":291},"end":{"line":291}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":291},"end":{"line":291}}}],"loc":{"start":{"line":290},"end":{"line":291}}},"loc":{"start":{"line":290},"end":{"line":291}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_statement","loc":{"start":{"line":292},"end":{"line":292}}},"property":{"type":"Identifier","name":"setInt"},"loc":{"start":{"line":292},"end":{"line":292}}},"arguments":[{"type":"Literal","value":1,"raw":1},{"type":"Identifier","name":"userId","loc":{"start":{"line":292},"end":{"line":292}}}],"loc":{"start":{"line":292},"end":{"line":292}}},"loc":{"start":{"line":292},"end":{"line":292}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_statement","loc":{"start":{"line":293},"end":{"line":293}}},"property":{"type":"Identifier","name":"setInt"},"loc":{"start":{"line":293},"end":{"line":293}}},"arguments":[{"type":"Literal","value":2,"raw":2},{"type":"Identifier","name":"employeeId","loc":{"start":{"line":293},"end":{"line":293}}}],"loc":{"start":{"line":293},"end":{"line":293}}},"loc":{"start":{"line":293},"end":{"line":293}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"answer_results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":294},"end":{"line":294}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":294},"end":{"line":294}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_statement","loc":{"start":{"line":294},"end":{"line":294}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":294},"end":{"line":294}}},"arguments":[],"loc":{"start":{"line":294},"end":{"line":294}}},"loc":{"start":{"line":294},"end":{"line":294}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"authorized","loc":{"start":{"line":295},"end":{"line":295}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"answer_results","loc":{"start":{"line":295},"end":{"line":295}}},"property":{"type":"Identifier","name":"first"},"loc":{"start":{"line":295},"end":{"line":295}}},"arguments":[],"loc":{"start":{"line":295},"end":{"line":295}}},"loc":{"start":{"line":295},"end":{"line":295}}},"loc":{"start":{"line":295},"end":{"line":295}}}],"loc":{"start":{"line":288},"end":{"line":296}}},"loc":{"start":{"line":287},"end":{"line":300}}}],"loc":{"start":{"line":284},"end":{"line":301}}},"loc":{"start":{"line":283},"end":{"line":305}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"authorized","loc":{"start":{"line":307},"end":{"line":307}}},"loc":{"start":{"line":307},"end":{"line":307}}}],"loc":{"start":{"line":279},"end":{"line":308}}},"code":"\npublic boolean isAuthorizedForEmployee(WebSession s, int userId, int employeeId) {\n    boolean authorized \u003d false;\n    try {\n        String query \u003d \"SELECT * FROM ownership WHERE employer_id \u003d ? AND employee_id \u003d ?\";\n        try {\n            PreparedStatement answer_statement \u003d WebSession.getConnection(s).prepareStatement(query, ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n            answer_statement.setInt(1, userId);\n            answer_statement.setInt(2, employeeId);\n            ResultSet answer_results \u003d answer_statement.executeQuery();\n            authorized \u003d answer_results.first();\n        } catch (SQLException sqle) {\n            s.setMessage(\"Error authorizing\");\n            sqle.printStackTrace();\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error authorizing\");\n        e.printStackTrace();\n    }\n    return authorized;\n}","loc":{"start":{"line":278},"end":{"line":308}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setStage"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":310},"end":{"line":310}}}},{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":310},"end":{"line":310}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLesson","loc":{"start":{"line":312},"end":{"line":312}}},"arguments":[],"loc":{"start":{"line":312},"end":{"line":312}}},"property":{"type":"Identifier","name":"setStage"},"loc":{"start":{"line":312},"end":{"line":312}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":312},"end":{"line":312}}},{"type":"Identifier","name":"stage","loc":{"start":{"line":312},"end":{"line":312}}}],"loc":{"start":{"line":312},"end":{"line":312}}},"loc":{"start":{"line":312},"end":{"line":312}}}],"loc":{"start":{"line":311},"end":{"line":313}}},"code":"\nprotected void setStage(WebSession s, String stage) {\n    getLesson().setStage(s, stage);\n}","loc":{"start":{"line":310},"end":{"line":313}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"setStageComplete"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":315},"end":{"line":315}}}},{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":315},"end":{"line":315}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLesson","loc":{"start":{"line":317},"end":{"line":317}}},"arguments":[],"loc":{"start":{"line":317},"end":{"line":317}}},"property":{"type":"Identifier","name":"setStageComplete"},"loc":{"start":{"line":317},"end":{"line":317}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":317},"end":{"line":317}}},{"type":"Identifier","name":"stage","loc":{"start":{"line":317},"end":{"line":317}}}],"loc":{"start":{"line":317},"end":{"line":317}}},"loc":{"start":{"line":317},"end":{"line":317}}}],"loc":{"start":{"line":316},"end":{"line":318}}},"code":"\nprotected void setStageComplete(WebSession s, String stage) {\n    getLesson().setStageComplete(s, stage);\n}","loc":{"start":{"line":315},"end":{"line":318}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getStage"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":320},"end":{"line":320}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":320},"end":{"line":320}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLesson","loc":{"start":{"line":322},"end":{"line":322}}},"arguments":[],"loc":{"start":{"line":322},"end":{"line":322}}},"property":{"type":"Identifier","name":"getStage"},"loc":{"start":{"line":322},"end":{"line":322}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":322},"end":{"line":322}}}],"loc":{"start":{"line":322},"end":{"line":322}}},"loc":{"start":{"line":322},"end":{"line":322}}}],"loc":{"start":{"line":321},"end":{"line":323}}},"code":"\nprotected String getStage(WebSession s) {\n    return getLesson().getStage(s);\n}","loc":{"start":{"line":320},"end":{"line":323}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"toString"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":325},"end":{"line":325}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getActionName","loc":{"start":{"line":327},"end":{"line":327}}},"arguments":[],"loc":{"start":{"line":327},"end":{"line":327}}},"loc":{"start":{"line":327},"end":{"line":327}}}],"loc":{"start":{"line":326},"end":{"line":328}}},"code":"\npublic String toString() {\n    return getActionName();\n}","loc":{"start":{"line":325},"end":{"line":328}}}],"loc":{"start":{"line":43},"end":{"line":330}}}],"loc":{"start":{"line":2},"end":{"line":330}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/GoatHillsFinancial/DefaultLessonAction.java"}