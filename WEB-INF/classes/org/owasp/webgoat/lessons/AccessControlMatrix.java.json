{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"A"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"IMG"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"TD"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"TR"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"Table"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ECSFactory"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"AccessControlMatrix"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":48},"end":{"line":48}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ASPECT_LOGO","vartype":{"type":"Identifier","name":"A","loc":{"start":{"line":50},"end":{"line":50}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"A","loc":{"start":{"line":50},"end":{"line":50}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"A","loc":{"start":{"line":50},"end":{"line":50}}},"arguments":[],"loc":{"start":{"line":50},"end":{"line":50}}},"property":{"type":"Identifier","name":"setHref"},"loc":{"start":{"line":50},"end":{"line":50}}},"arguments":[{"type":"Literal","value":"http://www.aspectsecurity.com","raw":"http://www.aspectsecurity.com"}],"loc":{"start":{"line":50},"end":{"line":50}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":50},"end":{"line":51}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"IMG","loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[{"type":"Literal","value":"images/logos/aspect.jpg","raw":"images/logos/aspect.jpg"}],"loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"setAlt"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[{"type":"Literal","value":"Aspect Security","raw":"Aspect Security"}],"loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"setHspace"},"loc":{"start":{"line":52},"end":{"line":52}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":52},"end":{"line":52}}},"property":{"type":"Identifier","name":"setVspace"},"loc":{"start":{"line":52},"end":{"line":53}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":52},"end":{"line":53}}}],"loc":{"start":{"line":50},"end":{"line":53}}},"loc":{"start":{"line":50},"end":{"line":53}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"RESOURCE","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}},"init":{"type":"Literal","value":"Resource","raw":"Resource"},"loc":{"start":{"line":55},"end":{"line":55}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"USER","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}},"init":{"type":"Literal","value":"User","raw":"User"},"loc":{"start":{"line":57},"end":{"line":57}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resources","vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}}},"init":{"type":"ArrayExpression","elements":[{"type":"Literal","value":"Public Share","raw":"Public Share"},{"type":"Literal","value":"Time Card Entry","raw":"Time Card Entry"},{"type":"Literal","value":"Performance Review","raw":"Performance Review"},{"type":"Literal","value":"Time Card Approval","raw":"Time Card Approval"},{"type":"Literal","value":"Site Manager","raw":"Site Manager"},{"type":"Literal","value":"Account Manager","raw":"Account Manager"}],"loc":{"start":{"line":59},"end":{"line":60}}},"loc":{"start":{"line":59},"end":{"line":60}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"roles","vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":62},"end":{"line":62}}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":62},"end":{"line":62}}}},"init":{"type":"ArrayExpression","elements":[{"type":"Literal","value":"Public","raw":"Public"},{"type":"Literal","value":"User","raw":"User"},{"type":"Literal","value":"Manager","raw":"Manager"},{"type":"Literal","value":"Admin","raw":"Admin"}],"loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"users","vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":64},"end":{"line":64}}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":64},"end":{"line":64}}}},"init":{"type":"ArrayExpression","elements":[{"type":"Literal","value":"Moe","raw":"Moe"},{"type":"Literal","value":"Larry","raw":"Larry"},{"type":"Literal","value":"Curly","raw":"Curly"},{"type":"Literal","value":"Shemp","raw":"Shemp"}],"loc":{"start":{"line":64},"end":{"line":64}}},"loc":{"start":{"line":64},"end":{"line":64}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":73},"end":{"line":73}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":73},"end":{"line":73}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":75},"end":{"line":75}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":75},"end":{"line":75}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":126},"end":{"line":126}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[],"loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[],"loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":129},"end":{"line":129}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":129},"end":{"line":129}}},"arguments":[],"loc":{"start":{"line":129},"end":{"line":129}}},"loc":{"start":{"line":129},"end":{"line":129}}}],"loc":{"start":{"line":127},"end":{"line":130}}},"loc":{"start":{"line":126},"end":{"line":130}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":79},"end":{"line":79}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":79},"end":{"line":79}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[],"loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"getRawParameter"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"Identifier","name":"USER","loc":{"start":{"line":79},"end":{"line":79}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"users","loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resource","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":80},"end":{"line":80}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":80},"end":{"line":80}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[],"loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"getRawParameter"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"Identifier","name":"RESOURCE","loc":{"start":{"line":80},"end":{"line":80}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"credentials","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":81},"end":{"line":81}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":81},"end":{"line":81}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getRoles","loc":{"start":{"line":81},"end":{"line":81}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":81},"end":{"line":81}}}],"loc":{"start":{"line":81},"end":{"line":81}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":81},"end":{"line":81}}},"arguments":[],"loc":{"start":{"line":81},"end":{"line":81}}},"loc":{"start":{"line":81},"end":{"line":81}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":83},"end":{"line":83}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Table","loc":{"start":{"line":83},"end":{"line":83}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Table","loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"setCellSpacing"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"setCellPadding"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"setWidth"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Literal","value":"90%","raw":"90%"}],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Literal","value":"center","raw":"center"}],"loc":{"start":{"line":83},"end":{"line":83}}},"loc":{"start":{"line":83},"end":{"line":83}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"isColor"},"loc":{"start":{"line":85},"end":{"line":85}}},"arguments":[],"loc":{"start":{"line":85},"end":{"line":85}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"setBorder"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":87},"end":{"line":87}}}],"loc":{"start":{"line":86},"end":{"line":88}}},"loc":{"start":{"line":85},"end":{"line":88}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"tr","vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":90},"end":{"line":90}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"TR","loc":{"start":{"line":90},"end":{"line":90}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[],"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":90},"end":{"line":90}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"Literal","value":"Change user:","raw":"Change user:"}],"loc":{"start":{"line":91},"end":{"line":91}}}],"loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":91},"end":{"line":91}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[],"loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"makePulldown"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"Identifier","name":"USER","loc":{"start":{"line":92},"end":{"line":92}}},{"type":"Identifier","name":"users","loc":{"start":{"line":92},"end":{"line":92}}},{"type":"Identifier","name":"user","loc":{"start":{"line":92},"end":{"line":92}}},{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":93},"end":{"line":93}}}],"loc":{"start":{"line":93},"end":{"line":93}}},"loc":{"start":{"line":93},"end":{"line":93}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"tr","loc":{"start":{"line":99},"end":{"line":99}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[],"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[],"loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"Literal","value":"Select resource: ","raw":"Select resource: "}],"loc":{"start":{"line":100},"end":{"line":100}}}],"loc":{"start":{"line":100},"end":{"line":100}}},"loc":{"start":{"line":100},"end":{"line":100}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":101},"end":{"line":101}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":101},"end":{"line":101}}},"arguments":[],"loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":101},"end":{"line":101}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"makePulldown"},"loc":{"start":{"line":101},"end":{"line":101}}},"arguments":[{"type":"Identifier","name":"RESOURCE","loc":{"start":{"line":101},"end":{"line":101}}},{"type":"Identifier","name":"resources","loc":{"start":{"line":101},"end":{"line":101}}},{"type":"Identifier","name":"resource","loc":{"start":{"line":101},"end":{"line":101}}},{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":101},"end":{"line":101}}}],"loc":{"start":{"line":101},"end":{"line":101}}}],"loc":{"start":{"line":101},"end":{"line":101}}},"loc":{"start":{"line":101},"end":{"line":101}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":102},"end":{"line":102}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":102},"end":{"line":102}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":102},"end":{"line":102}}}],"loc":{"start":{"line":102},"end":{"line":102}}},"loc":{"start":{"line":102},"end":{"line":102}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"tr","loc":{"start":{"line":104},"end":{"line":104}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Literal","value":"\u0026nbsp;","raw":"\u0026nbsp;"}],"loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"setColSpan"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Literal","value":"center","raw":"center"}],"loc":{"start":{"line":105},"end":{"line":105}}}],"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":106},"end":{"line":106}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":106},"end":{"line":106}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":106},"end":{"line":106}}}],"loc":{"start":{"line":106},"end":{"line":106}}},"loc":{"start":{"line":106},"end":{"line":106}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"tr","loc":{"start":{"line":108},"end":{"line":108}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TR","loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[],"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"tr","loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"TD","loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Literal","value":"Check Access","raw":"Check Access"}],"loc":{"start":{"line":109},"end":{"line":109}}}],"loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"setColSpan"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Literal","value":2,"raw":2}],"loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"setAlign"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Literal","value":"center","raw":"center"}],"loc":{"start":{"line":109},"end":{"line":109}}}],"loc":{"start":{"line":109},"end":{"line":109}}},"loc":{"start":{"line":109},"end":{"line":109}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":110},"end":{"line":110}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":110},"end":{"line":110}}},"arguments":[{"type":"Identifier","name":"tr","loc":{"start":{"line":110},"end":{"line":110}}}],"loc":{"start":{"line":110},"end":{"line":110}}},"loc":{"start":{"line":110},"end":{"line":110}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":111},"end":{"line":111}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":111},"end":{"line":111}}},"arguments":[{"type":"Identifier","name":"t","loc":{"start":{"line":111},"end":{"line":111}}}],"loc":{"start":{"line":111},"end":{"line":111}}},"loc":{"start":{"line":111},"end":{"line":111}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"isAllowed","loc":{"start":{"line":113},"end":{"line":113}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":113},"end":{"line":113}}},{"type":"Identifier","name":"resource","loc":{"start":{"line":113},"end":{"line":113}}}],"loc":{"start":{"line":113},"end":{"line":113}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getRoles","loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":115},"end":{"line":115}}}],"loc":{"start":{"line":115},"end":{"line":115}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[{"type":"Literal","value":"Admin","raw":"Admin"}],"loc":{"start":{"line":115},"end":{"line":115}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":115},"end":{"line":115}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"resource","loc":{"start":{"line":115},"end":{"line":115}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":115},"end":{"line":115}}},"arguments":[{"type":"Literal","value":"Account Manager","raw":"Account Manager"}],"loc":{"start":{"line":115},"end":{"line":115}}},"loc":{"start":{"line":115},"end":{"line":115}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":117},"end":{"line":117}}}],"loc":{"start":{"line":117},"end":{"line":117}}},"loc":{"start":{"line":117},"end":{"line":117}}}],"loc":{"start":{"line":116},"end":{"line":118}}},"loc":{"start":{"line":115},"end":{"line":118}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":119},"end":{"line":119}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":119},"end":{"line":119}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"User ","raw":"User "},"right":{"type":"Identifier","name":"user","loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}},"right":{"type":"Literal","value":" ","raw":" "},"loc":{"start":{"line":119},"end":{"line":119}}},"right":{"type":"Identifier","name":"credentials","loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}},"right":{"type":"Literal","value":" was allowed to access resource ","raw":" was allowed to access resource "},"loc":{"start":{"line":119},"end":{"line":119}}},"right":{"type":"Identifier","name":"resource","loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":114},"end":{"line":120}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":123},"end":{"line":123}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":123},"end":{"line":123}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"User ","raw":"User "},"right":{"type":"Identifier","name":"user","loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}},"right":{"type":"Literal","value":" ","raw":" "},"loc":{"start":{"line":123},"end":{"line":123}}},"right":{"type":"Identifier","name":"credentials","loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}},"right":{"type":"Literal","value":" did not have privilege to access resource ","raw":" did not have privilege to access resource "},"loc":{"start":{"line":123},"end":{"line":123}}},"right":{"type":"Identifier","name":"resource","loc":{"start":{"line":124},"end":{"line":124}}},"loc":{"start":{"line":123},"end":{"line":124}}}],"loc":{"start":{"line":123},"end":{"line":124}}},"loc":{"start":{"line":123},"end":{"line":124}}}],"loc":{"start":{"line":122},"end":{"line":125}}},"loc":{"start":{"line":113},"end":{"line":125}}}],"loc":{"start":{"line":78},"end":{"line":126}}},"loc":{"start":{"line":77},"end":{"line":130}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":132},"end":{"line":132}}},"loc":{"start":{"line":132},"end":{"line":132}}}],"loc":{"start":{"line":74},"end":{"line":133}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        String user \u003d s.getParser().getRawParameter(USER, users[0]);\n        String resource \u003d s.getParser().getRawParameter(RESOURCE, resources[0]);\n        String credentials \u003d getRoles(user).toString();\n        Table t \u003d new Table().setCellSpacing(0).setCellPadding(2).setBorder(0).setWidth(\"90%\").setAlign(\"center\");\n        if (s.isColor()) {\n            t.setBorder(1);\n        }\n        TR tr \u003d new TR();\n        tr.addElement(new TD().addElement(\"Change user:\"));\n        tr.addElement(new TD().addElement(ECSFactory.makePulldown(USER, users, user, 1)));\n        t.addElement(tr);\n        tr \u003d new TR();\n        tr.addElement(new TD().addElement(\"Select resource: \"));\n        tr.addElement(new TD().addElement(ECSFactory.makePulldown(RESOURCE, resources, resource, 1)));\n        t.addElement(tr);\n        tr \u003d new TR();\n        tr.addElement(new TD(\"\u0026nbsp;\").setColSpan(2).setAlign(\"center\"));\n        t.addElement(tr);\n        tr \u003d new TR();\n        tr.addElement(new TD(ECSFactory.makeButton(\"Check Access\")).setColSpan(2).setAlign(\"center\"));\n        t.addElement(tr);\n        ec.addElement(t);\n        if (isAllowed(user, resource)) {\n            if (!getRoles(user).contains(\"Admin\") \u0026\u0026 resource.equals(\"Account Manager\")) {\n                makeSuccess(s);\n            }\n            s.setMessage(\"User \" + user + \" \" + credentials + \" was allowed to access resource \" + resource);\n        } else {\n            s.setMessage(\"User \" + user + \" \" + credentials + \" did not have privilege to access resource \" + resource);\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":73},"end":{"line":133}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":141},"end":{"line":141}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":143},"end":{"line":143}}},"property":{"type":"Identifier","name":"ACCESS_CONTROL"},"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":142},"end":{"line":144}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.ACCESS_CONTROL;\n}","loc":{"start":{"line":141},"end":{"line":144}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":151},"end":{"line":151}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":151},"end":{"line":151}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":153},"end":{"line":153}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":153},"end":{"line":153}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":153},"end":{"line":153}}},"arguments":[],"loc":{"start":{"line":153},"end":{"line":153}}},"loc":{"start":{"line":153},"end":{"line":153}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"Literal","value":"Many sites attempt to restrict access to resources by role.","raw":"Many sites attempt to restrict access to resources by role."}],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"Literal","value":"Developers frequently make mistakes implementing this scheme.","raw":"Developers frequently make mistakes implementing this scheme."}],"loc":{"start":{"line":155},"end":{"line":155}}},"loc":{"start":{"line":155},"end":{"line":155}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":156},"end":{"line":156}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":156},"end":{"line":156}}},"arguments":[{"type":"Literal","value":"Attempt combinations of users, roles, and resources.","raw":"Attempt combinations of users, roles, and resources."}],"loc":{"start":{"line":156},"end":{"line":156}}},"loc":{"start":{"line":156},"end":{"line":156}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":157},"end":{"line":157}}},"loc":{"start":{"line":157},"end":{"line":157}}}],"loc":{"start":{"line":152},"end":{"line":158}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"Many sites attempt to restrict access to resources by role.\");\n    hints.add(\"Developers frequently make mistakes implementing this scheme.\");\n    hints.add(\"Attempt combinations of users, roles, and resources.\");\n    return hints;\n}","loc":{"start":{"line":151},"end":{"line":158}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":160},"end":{"line":160}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":160},"end":{"line":160}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":160},"end":{"line":160}}},"arguments":[{"type":"Literal","value":10,"raw":10}],"loc":{"start":{"line":160},"end":{"line":160}}},"loc":{"start":{"line":160},"end":{"line":160}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":162},"end":{"line":162}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":164},"end":{"line":164}}},"loc":{"start":{"line":164},"end":{"line":164}}}],"loc":{"start":{"line":163},"end":{"line":165}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":162},"end":{"line":165}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getResources"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":174},"end":{"line":174}}},"typarams":[],"params":[{"type":"Identifier","name":"rl","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":174},"end":{"line":174}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"list","vartype":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":177},"end":{"line":177}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":177},"end":{"line":177}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[],"loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"rl","loc":{"start":{"line":179},"end":{"line":179}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":179},"end":{"line":179}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":179},"end":{"line":179}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":179},"end":{"line":179}}}],"loc":{"start":{"line":179},"end":{"line":179}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":181},"end":{"line":181}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":181},"end":{"line":181}}}],"loc":{"start":{"line":181},"end":{"line":181}}},"loc":{"start":{"line":181},"end":{"line":181}}}],"loc":{"start":{"line":180},"end":{"line":182}}},"loc":{"start":{"line":179},"end":{"line":182}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"rl","loc":{"start":{"line":184},"end":{"line":184}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":184},"end":{"line":184}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":184},"end":{"line":184}}},"property":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":184},"end":{"line":184}}}],"loc":{"start":{"line":184},"end":{"line":184}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":186},"end":{"line":186}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":186},"end":{"line":186}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":186},"end":{"line":186}}},"property":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":186},"end":{"line":186}}}],"loc":{"start":{"line":186},"end":{"line":186}}},"loc":{"start":{"line":186},"end":{"line":186}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":187},"end":{"line":187}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":187},"end":{"line":187}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":187},"end":{"line":187}}},"property":{"type":"Literal","value":5,"raw":5},"loc":{"start":{"line":187},"end":{"line":187}}}],"loc":{"start":{"line":187},"end":{"line":187}}},"loc":{"start":{"line":187},"end":{"line":187}}}],"loc":{"start":{"line":185},"end":{"line":188}}},"loc":{"start":{"line":184},"end":{"line":188}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"rl","loc":{"start":{"line":190},"end":{"line":190}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":190},"end":{"line":190}}},"property":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":190},"end":{"line":190}}}],"loc":{"start":{"line":190},"end":{"line":190}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":192},"end":{"line":192}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":192},"end":{"line":192}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":192},"end":{"line":192}}},"property":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":192},"end":{"line":192}}}],"loc":{"start":{"line":192},"end":{"line":192}}},"loc":{"start":{"line":192},"end":{"line":192}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":193},"end":{"line":193}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":193},"end":{"line":193}}},"property":{"type":"Literal","value":3,"raw":3},"loc":{"start":{"line":193},"end":{"line":193}}}],"loc":{"start":{"line":193},"end":{"line":193}}},"loc":{"start":{"line":193},"end":{"line":193}}}],"loc":{"start":{"line":191},"end":{"line":194}}},"loc":{"start":{"line":190},"end":{"line":194}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"rl","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Literal","value":3,"raw":3},"loc":{"start":{"line":196},"end":{"line":196}}}],"loc":{"start":{"line":196},"end":{"line":196}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":198},"end":{"line":198}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":198},"end":{"line":198}}},"property":{"type":"Literal","value":4,"raw":4},"loc":{"start":{"line":198},"end":{"line":198}}}],"loc":{"start":{"line":198},"end":{"line":198}}},"loc":{"start":{"line":198},"end":{"line":198}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":199},"end":{"line":199}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":199},"end":{"line":199}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":199},"end":{"line":199}}},"property":{"type":"Literal","value":5,"raw":5},"loc":{"start":{"line":199},"end":{"line":199}}}],"loc":{"start":{"line":199},"end":{"line":199}}},"loc":{"start":{"line":199},"end":{"line":199}}}],"loc":{"start":{"line":197},"end":{"line":200}}},"loc":{"start":{"line":196},"end":{"line":200}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"list","loc":{"start":{"line":202},"end":{"line":202}}},"loc":{"start":{"line":202},"end":{"line":202}}}],"loc":{"start":{"line":175},"end":{"line":203}}},"code":"\nprivate List getResources(List rl) {\n    ArrayList\u003cString\u003e list \u003d new ArrayList\u003cString\u003e();\n    if (rl.contains(roles[0])) {\n        list.add(resources[0]);\n    }\n    if (rl.contains(roles[1])) {\n        list.add(resources[1]);\n        list.add(resources[5]);\n    }\n    if (rl.contains(roles[2])) {\n        list.add(resources[2]);\n        list.add(resources[3]);\n    }\n    if (rl.contains(roles[3])) {\n        list.add(resources[4]);\n        list.add(resources[5]);\n    }\n    return list;\n}","loc":{"start":{"line":174},"end":{"line":203}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRoles"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":213},"end":{"line":213}}},"typarams":[],"params":[{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":213},"end":{"line":213}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"list","vartype":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":215},"end":{"line":215}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":215},"end":{"line":215}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":215},"end":{"line":215}}},"arguments":[],"loc":{"start":{"line":215},"end":{"line":215}}},"loc":{"start":{"line":215},"end":{"line":215}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"user","loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"users","loc":{"start":{"line":217},"end":{"line":217}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":217},"end":{"line":217}}}],"loc":{"start":{"line":217},"end":{"line":217}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":219},"end":{"line":219}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":219},"end":{"line":219}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":219},"end":{"line":219}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":219},"end":{"line":219}}}],"loc":{"start":{"line":219},"end":{"line":219}}},"loc":{"start":{"line":219},"end":{"line":219}}}],"loc":{"start":{"line":218},"end":{"line":220}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"user","loc":{"start":{"line":221},"end":{"line":221}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":221},"end":{"line":221}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"users","loc":{"start":{"line":221},"end":{"line":221}}},"property":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":221},"end":{"line":221}}}],"loc":{"start":{"line":221},"end":{"line":221}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":223},"end":{"line":223}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":223},"end":{"line":223}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":223},"end":{"line":223}}},"property":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":223},"end":{"line":223}}}],"loc":{"start":{"line":223},"end":{"line":223}}},"loc":{"start":{"line":223},"end":{"line":223}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":224},"end":{"line":224}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":224},"end":{"line":224}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":224},"end":{"line":224}}},"property":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":224},"end":{"line":224}}}],"loc":{"start":{"line":224},"end":{"line":224}}},"loc":{"start":{"line":224},"end":{"line":224}}}],"loc":{"start":{"line":222},"end":{"line":225}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"user","loc":{"start":{"line":226},"end":{"line":226}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"users","loc":{"start":{"line":226},"end":{"line":226}}},"property":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":226},"end":{"line":226}}}],"loc":{"start":{"line":226},"end":{"line":226}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":228},"end":{"line":228}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":228},"end":{"line":228}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":228},"end":{"line":228}}},"property":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":228},"end":{"line":228}}}],"loc":{"start":{"line":228},"end":{"line":228}}},"loc":{"start":{"line":228},"end":{"line":228}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":229},"end":{"line":229}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":229},"end":{"line":229}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":229},"end":{"line":229}}},"property":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":229},"end":{"line":229}}}],"loc":{"start":{"line":229},"end":{"line":229}}},"loc":{"start":{"line":229},"end":{"line":229}}}],"loc":{"start":{"line":227},"end":{"line":230}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"user","loc":{"start":{"line":231},"end":{"line":231}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":231},"end":{"line":231}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"users","loc":{"start":{"line":231},"end":{"line":231}}},"property":{"type":"Literal","value":3,"raw":3},"loc":{"start":{"line":231},"end":{"line":231}}}],"loc":{"start":{"line":231},"end":{"line":231}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"list","loc":{"start":{"line":233},"end":{"line":233}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":233},"end":{"line":233}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"roles","loc":{"start":{"line":233},"end":{"line":233}}},"property":{"type":"Literal","value":3,"raw":3},"loc":{"start":{"line":233},"end":{"line":233}}}],"loc":{"start":{"line":233},"end":{"line":233}}},"loc":{"start":{"line":233},"end":{"line":233}}}],"loc":{"start":{"line":232},"end":{"line":234}}},"loc":{"start":{"line":231},"end":{"line":234}}},"loc":{"start":{"line":226},"end":{"line":234}}},"loc":{"start":{"line":221},"end":{"line":234}}},"loc":{"start":{"line":217},"end":{"line":234}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"list","loc":{"start":{"line":236},"end":{"line":236}}},"loc":{"start":{"line":236},"end":{"line":236}}}],"loc":{"start":{"line":214},"end":{"line":237}}},"code":"\nprivate List getRoles(String user) {\n    ArrayList\u003cString\u003e list \u003d new ArrayList\u003cString\u003e();\n    if (user.equals(users[0])) {\n        list.add(roles[0]);\n    } else if (user.equals(users[1])) {\n        list.add(roles[1]);\n        list.add(roles[2]);\n    } else if (user.equals(users[2])) {\n        list.add(roles[0]);\n        list.add(roles[2]);\n    } else if (user.equals(users[3])) {\n        list.add(roles[3]);\n    }\n    return list;\n}","loc":{"start":{"line":213},"end":{"line":237}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":245},"end":{"line":245}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Using an Access Control Matrix","raw":"Using an Access Control Matrix"},"loc":{"start":{"line":247},"end":{"line":247}}}],"loc":{"start":{"line":246},"end":{"line":248}}},"code":"\npublic String getTitle() {\n    return (\"Using an Access Control Matrix\");\n}","loc":{"start":{"line":245},"end":{"line":248}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"isAllowed"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"user","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":265},"end":{"line":265}}}},{"type":"Identifier","name":"resource","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":265},"end":{"line":265}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"roles","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":267},"end":{"line":267}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":267},"end":{"line":267}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getRoles","loc":{"start":{"line":267},"end":{"line":267}}},"arguments":[{"type":"Identifier","name":"user","loc":{"start":{"line":267},"end":{"line":267}}}],"loc":{"start":{"line":267},"end":{"line":267}}},"loc":{"start":{"line":267},"end":{"line":267}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resources","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":268},"end":{"line":268}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":268},"end":{"line":268}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getResources","loc":{"start":{"line":268},"end":{"line":268}}},"arguments":[{"type":"Identifier","name":"roles","loc":{"start":{"line":268},"end":{"line":268}}}],"loc":{"start":{"line":268},"end":{"line":268}}},"loc":{"start":{"line":268},"end":{"line":268}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"resources","loc":{"start":{"line":269},"end":{"line":269}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":269},"end":{"line":269}}},"arguments":[{"type":"Identifier","name":"resource","loc":{"start":{"line":269},"end":{"line":269}}}],"loc":{"start":{"line":269},"end":{"line":269}}},"loc":{"start":{"line":269},"end":{"line":269}}}],"loc":{"start":{"line":266},"end":{"line":270}}},"code":"\nprivate boolean isAllowed(String user, String resource) {\n    List roles \u003d getRoles(user);\n    List resources \u003d getResources(roles);\n    return (resources.contains(resource));\n}","loc":{"start":{"line":265},"end":{"line":270}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getCredits"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":272},"end":{"line":272}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"super","loc":{"start":{"line":274},"end":{"line":274}}},"property":{"type":"Identifier","name":"getCustomCredits"},"loc":{"start":{"line":274},"end":{"line":274}}},"arguments":[{"type":"Literal","value":"","raw":""},{"type":"Identifier","name":"ASPECT_LOGO","loc":{"start":{"line":274},"end":{"line":274}}}],"loc":{"start":{"line":274},"end":{"line":274}}},"loc":{"start":{"line":274},"end":{"line":274}}}],"loc":{"start":{"line":273},"end":{"line":275}}},"code":"\npublic Element getCredits() {\n    return super.getCustomCredits(\"\", ASPECT_LOGO);\n}","loc":{"start":{"line":272},"end":{"line":275}}}],"loc":{"start":{"line":48},"end":{"line":276}}}],"loc":{"start":{"line":2},"end":{"line":276}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/AccessControlMatrix.java"}