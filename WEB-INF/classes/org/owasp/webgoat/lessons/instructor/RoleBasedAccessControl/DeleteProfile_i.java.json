{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"instructor"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"RoleBasedAccessControl"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"SQLException"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"LessonAction"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"RoleBasedAccessControl"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"DeleteProfile"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"RoleBasedAccessControl"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"RoleBasedAccessControl"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"UnauthorizedException"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"DeleteProfile_i"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"DeleteProfile","loc":{"start":{"line":15},"end":{"line":15}}},"definitions":[{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"\u003cinit\u003e"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"typarams":[],"params":[{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Identifier","name":"lessonName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Identifier","name":"actionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Identifier","name":"chainedAction","vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":18},"end":{"line":18}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"super","loc":{"start":{"line":20},"end":{"line":20}}},"arguments":[{"type":"Identifier","name":"lesson","loc":{"start":{"line":20},"end":{"line":20}}},{"type":"Identifier","name":"lessonName","loc":{"start":{"line":20},"end":{"line":20}}},{"type":"Identifier","name":"actionName","loc":{"start":{"line":20},"end":{"line":20}}},{"type":"Identifier","name":"chainedAction","loc":{"start":{"line":20},"end":{"line":20}}}],"loc":{"start":{"line":20},"end":{"line":20}}},"loc":{"start":{"line":20},"end":{"line":20}}}],"loc":{"start":{"line":19},"end":{"line":21}}},"code":"\npublic \u003cinit\u003e(GoatHillsFinancial lesson, String lessonName, String actionName, LessonAction chainedAction) {\n    super(lesson, lessonName, actionName, chainedAction);\n}","loc":{"start":{"line":18},"end":{"line":21}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doDeleteEmployeeProfile"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":23},"end":{"line":23}}}},{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},{"type":"Identifier","name":"employeeId","vartype":{"type":"PrimitiveType"}}],"thrown":[{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":23},"end":{"line":23}}}],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"isAuthorizedInLesson"},"loc":{"start":{"line":25},"end":{"line":25}}},"arguments":[{"type":"Identifier","name":"userId","loc":{"start":{"line":25},"end":{"line":25}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":25},"end":{"line":25}}},"property":{"type":"Identifier","name":"DELETEPROFILE_ACTION"},"loc":{"start":{"line":25},"end":{"line":25}}}],"loc":{"start":{"line":25},"end":{"line":25}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":41},"end":{"line":41}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":43},"end":{"line":43}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":43},"end":{"line":43}}},"arguments":[{"type":"Literal","value":"Error deleting employee profile","raw":"Error deleting employee profile"}],"loc":{"start":{"line":43},"end":{"line":43}}},"loc":{"start":{"line":43},"end":{"line":43}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":44},"end":{"line":44}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":44},"end":{"line":44}}},"arguments":[],"loc":{"start":{"line":44},"end":{"line":44}}},"loc":{"start":{"line":44},"end":{"line":44}}}],"loc":{"start":{"line":42},"end":{"line":45}}},"loc":{"start":{"line":41},"end":{"line":45}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"query","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":29},"end":{"line":29}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":29},"end":{"line":29}}},"init":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"DELETE FROM employee WHERE userid \u003d ","raw":"DELETE FROM employee WHERE userid \u003d "},"right":{"type":"Identifier","name":"employeeId","loc":{"start":{"line":29},"end":{"line":29}}},"loc":{"start":{"line":29},"end":{"line":29}}},"loc":{"start":{"line":29},"end":{"line":29}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"sqle","vartype":{"type":"Identifier","name":"SQLException","loc":{"start":{"line":36},"end":{"line":36}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":38},"end":{"line":38}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":38},"end":{"line":38}}},"arguments":[{"type":"Literal","value":"Error deleting employee profile","raw":"Error deleting employee profile"}],"loc":{"start":{"line":38},"end":{"line":38}}},"loc":{"start":{"line":38},"end":{"line":38}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqle","loc":{"start":{"line":39},"end":{"line":39}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":39},"end":{"line":39}}},"arguments":[],"loc":{"start":{"line":39},"end":{"line":39}}},"loc":{"start":{"line":39},"end":{"line":39}}}],"loc":{"start":{"line":37},"end":{"line":40}}},"loc":{"start":{"line":36},"end":{"line":40}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":33},"end":{"line":33}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":33},"end":{"line":33}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":33},"end":{"line":33}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":33},"end":{"line":33}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":33},"end":{"line":33}}}],"loc":{"start":{"line":33},"end":{"line":33}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":33},"end":{"line":34}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":34},"end":{"line":34}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":34},"end":{"line":34}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":34},"end":{"line":34}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":34},"end":{"line":34}}}],"loc":{"start":{"line":33},"end":{"line":34}}},"loc":{"start":{"line":33},"end":{"line":34}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":35},"end":{"line":35}}},"property":{"type":"Identifier","name":"executeUpdate"},"loc":{"start":{"line":35},"end":{"line":35}}},"arguments":[{"type":"Identifier","name":"query","loc":{"start":{"line":35},"end":{"line":35}}}],"loc":{"start":{"line":35},"end":{"line":35}}},"loc":{"start":{"line":35},"end":{"line":35}}}],"loc":{"start":{"line":32},"end":{"line":36}}},"loc":{"start":{"line":31},"end":{"line":40}}}],"loc":{"start":{"line":28},"end":{"line":41}}},"loc":{"start":{"line":27},"end":{"line":45}}}],"loc":{"start":{"line":26},"end":{"line":46}}},"alternate":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":49},"end":{"line":49}}},"arguments":[],"loc":{"start":{"line":49},"end":{"line":49}}},"loc":{"start":{"line":49},"end":{"line":49}}}],"loc":{"start":{"line":48},"end":{"line":50}}},"loc":{"start":{"line":25},"end":{"line":50}}}],"loc":{"start":{"line":24},"end":{"line":51}}},"code":"\npublic void doDeleteEmployeeProfile(WebSession s, int userId, int employeeId) throws UnauthorizedException {\n    if (s.isAuthorizedInLesson(userId, RoleBasedAccessControl.DELETEPROFILE_ACTION)) {\n        try {\n            String query \u003d \"DELETE FROM employee WHERE userid \u003d \" + employeeId;\n            try {\n                Statement statement \u003d WebSession.getConnection(s).createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n                statement.executeUpdate(query);\n            } catch (SQLException sqle) {\n                s.setMessage(\"Error deleting employee profile\");\n                sqle.printStackTrace();\n            }\n        } catch (Exception e) {\n            s.setMessage(\"Error deleting employee profile\");\n            e.printStackTrace();\n        }\n    } else {\n        throw new UnauthorizedException();\n    }\n}","loc":{"start":{"line":23},"end":{"line":51}}}],"loc":{"start":{"line":15},"end":{"line":53}}}],"loc":{"start":{"line":2},"end":{"line":53}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/instructor/RoleBasedAccessControl/DeleteProfile_i.java"}