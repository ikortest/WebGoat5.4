{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"File"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"Arrays"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"StringTokenizer"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"StringElement"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"BR"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"HR"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"P"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"ECSFactory"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"Exec"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"ExecResults"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"WebGoatI18N"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"CommandInjection"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":52},"end":{"line":52}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"HELP_FILE","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":54},"end":{"line":54}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":54},"end":{"line":54}}},"init":{"type":"Literal","value":"HelpFile","raw":"HelpFile"},"loc":{"start":{"line":54},"end":{"line":54}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"osName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":56},"end":{"line":56}}}},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":56},"end":{"line":56}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":56},"end":{"line":56}}},"property":{"type":"Identifier","name":"getProperty"},"loc":{"start":{"line":56},"end":{"line":56}}},"arguments":[{"type":"Literal","value":"os.name","raw":"os.name"}],"loc":{"start":{"line":56},"end":{"line":56}}},"loc":{"start":{"line":56},"end":{"line":56}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":65},"end":{"line":65}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":65},"end":{"line":65}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":67},"end":{"line":67}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":67},"end":{"line":67}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[],"loc":{"start":{"line":67},"end":{"line":67}}},"loc":{"start":{"line":67},"end":{"line":67}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"illegalCommand","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[],"loc":{"start":{"line":68},"end":{"line":68}}},"property":{"type":"Identifier","name":"isDefuseOSCommands"},"loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":169},"end":{"line":169}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[],"loc":{"start":{"line":171},"end":{"line":171}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":171},"end":{"line":171}}},"arguments":[],"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}}],"loc":{"start":{"line":171},"end":{"line":171}}},"loc":{"start":{"line":171},"end":{"line":171}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":172},"end":{"line":172}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":172},"end":{"line":172}}},"arguments":[],"loc":{"start":{"line":172},"end":{"line":172}}},"loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":170},"end":{"line":173}}},"loc":{"start":{"line":169},"end":{"line":173}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"helpFile","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":71},"end":{"line":71}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":71},"end":{"line":71}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":71},"end":{"line":71}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[],"loc":{"start":{"line":71},"end":{"line":71}}},"property":{"type":"Identifier","name":"getRawParameter"},"loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[{"type":"Identifier","name":"HELP_FILE","loc":{"start":{"line":71},"end":{"line":71}}},{"type":"Literal","value":"BasicAuthentication.help","raw":"BasicAuthentication.help"}],"loc":{"start":{"line":71},"end":{"line":71}}},"loc":{"start":{"line":71},"end":{"line":71}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[],"loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"isDefuseOSCommands"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[],"loc":{"start":{"line":72},"end":{"line":72}}},"right":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":73},"end":{"line":73}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"Literal","value":38,"raw":38}],"loc":{"start":{"line":73},"end":{"line":73}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":73},"end":{"line":73}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":73},"end":{"line":73}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"Literal","value":59,"raw":59}],"loc":{"start":{"line":73},"end":{"line":73}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":72},"end":{"line":73}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"index","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":75},"end":{"line":75}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"Literal","value":38,"raw":38}],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"index","loc":{"start":{"line":76},"end":{"line":76}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":76},"end":{"line":76}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"index","loc":{"start":{"line":78},"end":{"line":78}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"Literal","value":59,"raw":59}],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":77},"end":{"line":79}}},"loc":{"start":{"line":76},"end":{"line":79}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"index","loc":{"start":{"line":80},"end":{"line":80}}},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"index","loc":{"start":{"line":80},"end":{"line":80}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"helpFileLen","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"BinaryExpression","operator":"MINUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":81},"end":{"line":81}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":81},"end":{"line":81}}},"arguments":[],"loc":{"start":{"line":81},"end":{"line":81}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":81},"end":{"line":81}}},"loc":{"start":{"line":81},"end":{"line":81}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"Literal","value":"Command","raw":"Command"}],"loc":{"start":{"line":82},"end":{"line":82}}},"right":{"type":"Literal","value":" \u003d [","raw":" \u003d ["},"loc":{"start":{"line":82},"end":{"line":82}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":82},"end":{"line":82}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[],"loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[],"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}},"right":{"type":"Literal","value":"]","raw":"]"},"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"osName","loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Literal","value":"Windows","raw":"Windows"}],"loc":{"start":{"line":83},"end":{"line":83}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":83},"end":{"line":83}}},"right":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":83},"end":{"line":83}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":83},"end":{"line":83}}}],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":83},"end":{"line":83}}},"arguments":[],"loc":{"start":{"line":83},"end":{"line":83}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":83},"end":{"line":84}}},"arguments":[{"type":"Literal","value":"netstat -a","raw":"netstat -a"}],"loc":{"start":{"line":83},"end":{"line":84}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":85},"end":{"line":85}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":85},"end":{"line":85}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":85},"end":{"line":85}}}],"loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":85},"end":{"line":85}}},"arguments":[],"loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":85},"end":{"line":85}}},"arguments":[],"loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":85},"end":{"line":85}}},"arguments":[{"type":"Literal","value":"dir","raw":"dir"}],"loc":{"start":{"line":85},"end":{"line":85}}},"loc":{"start":{"line":83},"end":{"line":85}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":86},"end":{"line":86}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":86},"end":{"line":86}}}],"loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[],"loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[],"loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[{"type":"Literal","value":"ls","raw":"ls"}],"loc":{"start":{"line":86},"end":{"line":86}}},"loc":{"start":{"line":83},"end":{"line":86}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":87},"end":{"line":87}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":87},"end":{"line":87}}}],"loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[{"type":"Literal","value":"ifconfig","raw":"ifconfig"}],"loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":83},"end":{"line":87}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":87},"end":{"line":88}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":88},"end":{"line":88}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":88},"end":{"line":88}}}],"loc":{"start":{"line":87},"end":{"line":88}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":87},"end":{"line":88}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":88}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":87},"end":{"line":88}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":88}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":87},"end":{"line":88}}},"arguments":[{"type":"Literal","value":"ipconfig","raw":"ipconfig"}],"loc":{"start":{"line":87},"end":{"line":88}}},"loc":{"start":{"line":83},"end":{"line":88}}},"loc":{"start":{"line":83},"end":{"line":88}}},"right":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":89},"end":{"line":89}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":89},"end":{"line":89}}}],"loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[],"loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[],"loc":{"start":{"line":89},"end":{"line":89}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":89},"end":{"line":89}}},"arguments":[{"type":"Literal","value":"netstat -a #","raw":"netstat -a #"}],"loc":{"start":{"line":89},"end":{"line":89}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":90},"end":{"line":90}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":90},"end":{"line":90}}}],"loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[],"loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[],"loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":90},"end":{"line":90}}},"arguments":[{"type":"Literal","value":"dir #","raw":"dir #"}],"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":89},"end":{"line":90}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":91},"end":{"line":91}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":91},"end":{"line":91}}}],"loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[],"loc":{"start":{"line":91},"end":{"line":91}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":91},"end":{"line":91}}},"arguments":[{"type":"Literal","value":"ls #","raw":"ls #"}],"loc":{"start":{"line":91},"end":{"line":91}}},"loc":{"start":{"line":89},"end":{"line":91}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":92},"end":{"line":92}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[],"loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[],"loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"Literal","value":"ls -l #","raw":"ls -l #"}],"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":89},"end":{"line":92}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":93},"end":{"line":93}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":93},"end":{"line":93}}}],"loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":93},"end":{"line":93}}},"arguments":[{"type":"Literal","value":"ifconfig #","raw":"ifconfig #"}],"loc":{"start":{"line":93},"end":{"line":93}}},"loc":{"start":{"line":89},"end":{"line":93}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":93},"end":{"line":93}}},"property":{"type":"Identifier","name":"substring"},"loc":{"start":{"line":93},"end":{"line":94}}},"arguments":[{"type":"Identifier","name":"index","loc":{"start":{"line":94},"end":{"line":94}}},{"type":"Identifier","name":"helpFileLen","loc":{"start":{"line":94},"end":{"line":94}}}],"loc":{"start":{"line":93},"end":{"line":94}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":93},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":94}}},"property":{"type":"Identifier","name":"toLowerCase"},"loc":{"start":{"line":93},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":93},"end":{"line":94}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":93},"end":{"line":94}}},"arguments":[{"type":"Literal","value":"ipconfig #","raw":"ipconfig #"}],"loc":{"start":{"line":93},"end":{"line":94}}},"loc":{"start":{"line":89},"end":{"line":94}}},"loc":{"start":{"line":83},"end":{"line":94}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"illegalCommand","loc":{"start":{"line":96},"end":{"line":96}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":96},"end":{"line":96}}},"loc":{"start":{"line":96},"end":{"line":96}}}],"loc":{"start":{"line":95},"end":{"line":97}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[{"type":"Literal","value":"CommandInjectionRightTrack1","raw":"CommandInjectionRightTrack1"}],"loc":{"start":{"line":100},"end":{"line":100}}}],"loc":{"start":{"line":100},"end":{"line":100}}},"loc":{"start":{"line":100},"end":{"line":100}}}],"loc":{"start":{"line":99},"end":{"line":102}}},"loc":{"start":{"line":83},"end":{"line":102}}}],"loc":{"start":{"line":74},"end":{"line":103}}},"loc":{"start":{"line":72},"end":{"line":103}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[],"loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"isDefuseOSCommands"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[],"loc":{"start":{"line":105},"end":{"line":105}}},"right":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Literal","value":38,"raw":38}],"loc":{"start":{"line":105},"end":{"line":105}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}},"right":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Literal","value":59,"raw":59}],"loc":{"start":{"line":105},"end":{"line":105}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"GREATER_THAN","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":107},"end":{"line":107}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":107},"end":{"line":107}}},"arguments":[],"loc":{"start":{"line":107},"end":{"line":107}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":107},"end":{"line":107}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"LESS_THAN_EQUAL","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"upDirCount","loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Identifier","name":"helpFile","loc":{"start":{"line":109},"end":{"line":109}}}],"loc":{"start":{"line":109},"end":{"line":109}}},"right":{"type":"Literal","value":3,"raw":3},"loc":{"start":{"line":109},"end":{"line":109}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":112},"end":{"line":112}}},"property":{"type":"Identifier","name":"getContext"},"loc":{"start":{"line":112},"end":{"line":112}}},"arguments":[],"loc":{"start":{"line":112},"end":{"line":112}}},"property":{"type":"Identifier","name":"getRealPath"},"loc":{"start":{"line":112},"end":{"line":112}}},"arguments":[{"type":"Literal","value":"/","raw":"/"}],"loc":{"start":{"line":112},"end":{"line":112}}},"loc":{"start":{"line":112},"end":{"line":112}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"illegalCommand","loc":{"start":{"line":113},"end":{"line":113}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":113},"end":{"line":113}}},"loc":{"start":{"line":113},"end":{"line":113}}}],"loc":{"start":{"line":110},"end":{"line":114}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":117},"end":{"line":117}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":117},"end":{"line":117}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":117},"end":{"line":117}}},"arguments":[{"type":"Literal","value":"CommandInjectionRightTrack2","raw":"CommandInjectionRightTrack2"}],"loc":{"start":{"line":117},"end":{"line":117}}}],"loc":{"start":{"line":117},"end":{"line":117}}},"loc":{"start":{"line":117},"end":{"line":117}}}],"loc":{"start":{"line":116},"end":{"line":118}}},"loc":{"start":{"line":109},"end":{"line":118}}}],"loc":{"start":{"line":108},"end":{"line":119}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"illegalCommand","loc":{"start":{"line":123},"end":{"line":123}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}}],"loc":{"start":{"line":121},"end":{"line":124}}},"loc":{"start":{"line":107},"end":{"line":124}}}],"loc":{"start":{"line":106},"end":{"line":125}}},"loc":{"start":{"line":105},"end":{"line":125}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"safeDir","vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":126},"end":{"line":126}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"File","loc":{"start":{"line":126},"end":{"line":126}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"getContext"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[],"loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"getRealPath"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"Literal","value":"/lesson_plans/English","raw":"/lesson_plans/English"}],"loc":{"start":{"line":126},"end":{"line":126}}}],"loc":{"start":{"line":126},"end":{"line":126}}},"loc":{"start":{"line":126},"end":{"line":126}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":128},"end":{"line":128}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":128},"end":{"line":128}}},"arguments":[{"type":"Literal","value":"YouAreCurrentlyViewing","raw":"YouAreCurrentlyViewing"}],"loc":{"start":{"line":128},"end":{"line":128}}},"right":{"type":"Literal","value":"\u003cb\u003e","raw":"\u003cb\u003e"},"loc":{"start":{"line":128},"end":{"line":128}}},"right":{"type":"ConditionalExpression","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":129},"end":{"line":129}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":129},"end":{"line":129}}},"arguments":[],"loc":{"start":{"line":129},"end":{"line":129}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":129},"end":{"line":129}}},"arguments":[],"loc":{"start":{"line":129},"end":{"line":129}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":129},"end":{"line":129}}},"alternate":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"\u0026lt;","raw":"\u0026lt;"},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":129},"end":{"line":129}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":129},"end":{"line":129}}},"arguments":[{"type":"Literal","value":"SelectFileFromListBelow","raw":"SelectFileFromListBelow"}],"loc":{"start":{"line":129},"end":{"line":129}}},"loc":{"start":{"line":129},"end":{"line":129}}},"right":{"type":"Literal","value":"\u0026gt;","raw":"\u0026gt;"},"loc":{"start":{"line":129},"end":{"line":129}}},"consequent":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":129},"end":{"line":129}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":129},"end":{"line":129}}},"arguments":[],"loc":{"start":{"line":129},"end":{"line":129}}},"loc":{"start":{"line":129},"end":{"line":129}}},"loc":{"start":{"line":128},"end":{"line":129}}},"right":{"type":"Literal","value":"\u003c/b\u003e","raw":"\u003c/b\u003e"},"loc":{"start":{"line":128},"end":{"line":130}}}],"loc":{"start":{"line":128},"end":{"line":130}}}],"loc":{"start":{"line":128},"end":{"line":130}}},"loc":{"start":{"line":128},"end":{"line":130}}},{"type":"IfStatement","test":{"argument":{"type":"Identifier","name":"illegalCommand","loc":{"start":{"line":132},"end":{"line":132}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":132},"end":{"line":132}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":134},"end":{"line":134}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":134},"end":{"line":134}}},"loc":{"start":{"line":134},"end":{"line":134}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"fileData","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":135},"end":{"line":135}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":135},"end":{"line":135}}},"init":{"type":"Literal"},"loc":{"start":{"line":135},"end":{"line":135}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":136},"end":{"line":136}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"helpFile","loc":{"start":{"line":136},"end":{"line":136}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":136},"end":{"line":136}}},"arguments":[{"type":"Literal","value":"\\.help","raw":"\\.help"},{"type":"Literal","value":"\\.html","raw":"\\.html"}],"loc":{"start":{"line":136},"end":{"line":136}}},"loc":{"start":{"line":136},"end":{"line":136}}},"loc":{"start":{"line":136},"end":{"line":136}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"osName","loc":{"start":{"line":138},"end":{"line":138}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":138},"end":{"line":138}}},"arguments":[{"type":"Literal","value":"Windows","raw":"Windows"}],"loc":{"start":{"line":138},"end":{"line":138}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":138},"end":{"line":138}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"results","loc":{"start":{"line":142},"end":{"line":142}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"exec","loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":142},"end":{"line":142}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"cmd.exe /c dir /b \"","raw":"cmd.exe /c dir /b \""},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"safeDir","loc":{"start":{"line":142},"end":{"line":142}}},"property":{"type":"Identifier","name":"getPath"},"loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},"right":{"type":"Literal","value":"\"","raw":"\""},"loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileData","loc":{"start":{"line":143},"end":{"line":143}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"exec","loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":143},"end":{"line":143}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"cmd.exe /c type \"","raw":"cmd.exe /c type \""},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[{"type":"Identifier","name":"safeDir","loc":{"start":{"line":143},"end":{"line":143}}},{"type":"Identifier","name":"helpFile","loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":143},"end":{"line":143}}},"property":{"type":"Identifier","name":"getPath"},"loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[],"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}},"right":{"type":"Literal","value":"\"","raw":"\""},"loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}},"loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":139},"end":{"line":145}}},"alternate":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"cmd1","vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":148},"end":{"line":148}}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":148},"end":{"line":148}}}},"init":{"type":"ArrayExpression","elements":[{"type":"Literal","value":"/bin/sh","raw":"/bin/sh"},{"type":"Literal","value":"-c","raw":"-c"},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"ls \"","raw":"ls \""},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"safeDir","loc":{"start":{"line":148},"end":{"line":148}}},"property":{"type":"Identifier","name":"getPath"},"loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[],"loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}},"right":{"type":"Literal","value":"\"","raw":"\""},"loc":{"start":{"line":148},"end":{"line":148}}}],"loc":{"start":{"line":148},"end":{"line":148}}},"loc":{"start":{"line":148},"end":{"line":148}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"results","loc":{"start":{"line":149},"end":{"line":149}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"exec","loc":{"start":{"line":149},"end":{"line":149}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":149},"end":{"line":149}}},{"type":"Identifier","name":"cmd1","loc":{"start":{"line":149},"end":{"line":149}}}],"loc":{"start":{"line":149},"end":{"line":149}}},"loc":{"start":{"line":149},"end":{"line":149}}},"loc":{"start":{"line":149},"end":{"line":149}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"cmd2","vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":150},"end":{"line":150}}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":150},"end":{"line":150}}}},"init":{"type":"ArrayExpression","elements":[{"type":"Literal","value":"/bin/sh","raw":"/bin/sh"},{"type":"Literal","value":"-c","raw":"-c"},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"cat \"","raw":"cat \""},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"File","loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[{"type":"Identifier","name":"safeDir","loc":{"start":{"line":150},"end":{"line":150}}},{"type":"Identifier","name":"helpFile","loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":150},"end":{"line":150}}},"property":{"type":"Identifier","name":"getPath"},"loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[],"loc":{"start":{"line":150},"end":{"line":150}}},"loc":{"start":{"line":150},"end":{"line":150}}},"right":{"type":"Literal","value":"\"","raw":"\""},"loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":150},"end":{"line":150}}},"loc":{"start":{"line":150},"end":{"line":150}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileData","loc":{"start":{"line":151},"end":{"line":151}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"exec","loc":{"start":{"line":151},"end":{"line":151}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":151},"end":{"line":151}}},{"type":"Identifier","name":"cmd2","loc":{"start":{"line":151},"end":{"line":151}}}],"loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}}],"loc":{"start":{"line":147},"end":{"line":152}}},"loc":{"start":{"line":138},"end":{"line":152}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"P","loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[],"loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":154},"end":{"line":154}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":154},"end":{"line":154}}},"arguments":[{"type":"Literal","value":"SelectLessonPlanToView","raw":"SelectLessonPlanToView"}],"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}}],"loc":{"start":{"line":154},"end":{"line":154}}},"loc":{"start":{"line":154},"end":{"line":154}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"makePulldown"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"Identifier","name":"HELP_FILE","loc":{"start":{"line":155},"end":{"line":155}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"parseResults","loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[{"type":"Literal","value":"(?s)\\.html","raw":"(?s)\\.html"},{"type":"Literal","value":"\\.help","raw":"\\.help"}],"loc":{"start":{"line":155},"end":{"line":156}}}],"loc":{"start":{"line":155},"end":{"line":156}}}],"loc":{"start":{"line":155},"end":{"line":156}}}],"loc":{"start":{"line":155},"end":{"line":156}}},"loc":{"start":{"line":155},"end":{"line":156}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"b","vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":158},"end":{"line":158}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":158},"end":{"line":158}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":158},"end":{"line":158}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":158},"end":{"line":158}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[{"type":"Literal","value":"View","raw":"View"}],"loc":{"start":{"line":158},"end":{"line":158}}}],"loc":{"start":{"line":158},"end":{"line":158}}},"loc":{"start":{"line":158},"end":{"line":158}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":159},"end":{"line":159}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":159},"end":{"line":159}}},"arguments":[{"type":"Identifier","name":"b","loc":{"start":{"line":159},"end":{"line":159}}}],"loc":{"start":{"line":159},"end":{"line":159}}},"loc":{"start":{"line":159},"end":{"line":159}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":161},"end":{"line":161}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":161},"end":{"line":161}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":161},"end":{"line":161}}},"arguments":[],"loc":{"start":{"line":161},"end":{"line":161}}}],"loc":{"start":{"line":161},"end":{"line":161}}},"loc":{"start":{"line":161},"end":{"line":161}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BR","loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[],"loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":163},"end":{"line":163}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":163},"end":{"line":163}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"HR","loc":{"start":{"line":163},"end":{"line":163}}},"arguments":[],"loc":{"start":{"line":163},"end":{"line":163}}},"property":{"type":"Identifier","name":"setWidth"},"loc":{"start":{"line":163},"end":{"line":163}}},"arguments":[{"type":"Literal","value":"90%","raw":"90%"}],"loc":{"start":{"line":163},"end":{"line":163}}}],"loc":{"start":{"line":163},"end":{"line":163}}},"loc":{"start":{"line":163},"end":{"line":163}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileData","loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"getProperty"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[{"type":"Literal","value":"line.separator","raw":"line.separator"}],"loc":{"start":{"line":164},"end":{"line":164}}},{"type":"Literal","value":"\u003cbr\u003e","raw":"\u003cbr\u003e"}],"loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":164},"end":{"line":165}}},"arguments":[{"type":"Literal","value":"(?s)\u003c!DOCTYPE.*/head\u003e","raw":"(?s)\u003c!DOCTYPE.*/head\u003e"},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":164},"end":{"line":165}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":164},"end":{"line":165}}},"arguments":[{"type":"Literal","value":"\u003cbr\u003e\u003cbr\u003e","raw":"\u003cbr\u003e\u003cbr\u003e"},{"type":"Literal","value":"\u003cbr\u003e","raw":"\u003cbr\u003e"}],"loc":{"start":{"line":164},"end":{"line":165}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":164},"end":{"line":166}}},"arguments":[{"type":"Literal","value":"\u003cbr\u003e\\s\u003cbr\u003e","raw":"\u003cbr\u003e\\s\u003cbr\u003e"},{"type":"Literal","value":"\u003cbr\u003e","raw":"\u003cbr\u003e"}],"loc":{"start":{"line":164},"end":{"line":166}}}],"loc":{"start":{"line":164},"end":{"line":166}}}],"loc":{"start":{"line":164},"end":{"line":166}}},"loc":{"start":{"line":164},"end":{"line":166}}}],"loc":{"start":{"line":133},"end":{"line":168}}},"loc":{"start":{"line":132},"end":{"line":168}}}],"loc":{"start":{"line":70},"end":{"line":169}}},"loc":{"start":{"line":69},"end":{"line":173}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":175},"end":{"line":175}}},"loc":{"start":{"line":175},"end":{"line":175}}}],"loc":{"start":{"line":66},"end":{"line":176}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    boolean illegalCommand \u003d getWebgoatContext().isDefuseOSCommands();\n    try {\n        String helpFile \u003d s.getParser().getRawParameter(HELP_FILE, \"BasicAuthentication.help\");\n        if (getWebgoatContext().isDefuseOSCommands() \u0026\u0026 (helpFile.indexOf(\u0027\u0026\u0027) !\u003d -1 || helpFile.indexOf(\u0027;\u0027) !\u003d -1)) {\n            int index \u003d helpFile.indexOf(\u0027\u0026\u0027);\n            if (index \u003d\u003d -1) {\n                index \u003d helpFile.indexOf(\u0027;\u0027);\n            }\n            index \u003d index + 1;\n            int helpFileLen \u003d helpFile.length() - 1;\n            System.out.println(WebGoatI18N.get(\"Command\") + \" \u003d [\" + helpFile.substring(index, helpFileLen).trim().toLowerCase() + \"]\");\n            if ((osName.indexOf(\"Windows\") !\u003d -1 \u0026\u0026 (helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"netstat -a\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"dir\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"ls\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"ifconfig\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"ipconfig\"))) || (helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"netstat -a #\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"dir #\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"ls #\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"ls -l #\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"ifconfig #\") || helpFile.substring(index, helpFileLen).trim().toLowerCase().equals(\"ipconfig #\"))) {\n                illegalCommand \u003d false;\n            } else {\n                s.setMessage(WebGoatI18N.get(\"CommandInjectionRightTrack1\"));\n            }\n        }\n        if (getWebgoatContext().isDefuseOSCommands() \u0026\u0026 helpFile.indexOf(\u0027\u0026\u0027) \u003d\u003d -1 \u0026\u0026 helpFile.indexOf(\u0027;\u0027) \u003d\u003d -1) {\n            if (helpFile.length() \u003e 0) {\n                if (upDirCount(helpFile) \u003c\u003d 3) {\n                    s.getContext().getRealPath(\"/\");\n                    illegalCommand \u003d false;\n                } else {\n                    s.setMessage(WebGoatI18N.get(\"CommandInjectionRightTrack2\"));\n                }\n            } else {\n                illegalCommand \u003d false;\n            }\n        }\n        File safeDir \u003d new File(s.getContext().getRealPath(\"/lesson_plans/English\"));\n        ec.addElement(new StringElement(WebGoatI18N.get(\"YouAreCurrentlyViewing\") + \"\u003cb\u003e\" + (helpFile.toString().length() \u003d\u003d 0 ? \"\u0026lt;\" + WebGoatI18N.get(\"SelectFileFromListBelow\") + \"\u0026gt;\" : helpFile.toString()) + \"\u003c/b\u003e\"));\n        if (!illegalCommand) {\n            String results;\n            String fileData \u003d null;\n            helpFile \u003d helpFile.replaceAll(\"\\\\.help\", \"\\\\.html\");\n            if (osName.indexOf(\"Windows\") !\u003d -1) {\n                results \u003d exec(s, \"cmd.exe /c dir /b \\\"\" + safeDir.getPath() + \"\\\"\");\n                fileData \u003d exec(s, \"cmd.exe /c type \\\"\" + new File(safeDir, helpFile).getPath() + \"\\\"\");\n            } else {\n                String[] cmd1 \u003d {\"/bin/sh\", \"-c\", \"ls \\\"\" + safeDir.getPath() + \"\\\"\"};\n                results \u003d exec(s, cmd1);\n                String[] cmd2 \u003d {\"/bin/sh\", \"-c\", \"cat \\\"\" + new File(safeDir, helpFile).getPath() + \"\\\"\"};\n                fileData \u003d exec(s, cmd2);\n            }\n            ec.addElement(new P().addElement(WebGoatI18N.get(\"SelectLessonPlanToView\")));\n            ec.addElement(ECSFactory.makePulldown(HELP_FILE, parseResults(results.replaceAll(\"(?s)\\\\.html\", \"\\\\.help\"))));\n            Element b \u003d ECSFactory.makeButton(WebGoatI18N.get(\"View\"));\n            ec.addElement(b);\n            ec.addElement(new BR());\n            ec.addElement(new BR());\n            ec.addElement(new HR().setWidth(\"90%\"));\n            ec.addElement(new StringElement(fileData.replaceAll(System.getProperty(\"line.separator\"), \"\u003cbr\u003e\").replaceAll(\"(?s)\u003c!DOCTYPE.*/head\u003e\", \"\").replaceAll(\"\u003cbr\u003e\u003cbr\u003e\", \"\u003cbr\u003e\").replaceAll(\"\u003cbr\u003e\\\\s\u003cbr\u003e\", \"\u003cbr\u003e\")));\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":65},"end":{"line":176}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"parseResults"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":178},"end":{"line":178}}},"typarams":[],"params":[{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":178},"end":{"line":178}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[{"type":"Literal","value":"(?s).*Output...\\s","raw":"(?s).*Output...\\s"},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":180},"end":{"line":180}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":180},"end":{"line":180}}},"arguments":[{"type":"Literal","value":"(?s)Returncode.*","raw":"(?s)Returncode.*"},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":180},"end":{"line":180}}},"loc":{"start":{"line":180},"end":{"line":180}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"st","vartype":{"type":"Identifier","name":"StringTokenizer","loc":{"start":{"line":181},"end":{"line":181}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringTokenizer","loc":{"start":{"line":181},"end":{"line":181}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringTokenizer","loc":{"start":{"line":181},"end":{"line":181}}},"arguments":[{"type":"Identifier","name":"results","loc":{"start":{"line":181},"end":{"line":181}}},{"type":"Literal","value":"\n","raw":"\n"}],"loc":{"start":{"line":181},"end":{"line":181}}},"loc":{"start":{"line":181},"end":{"line":181}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"modified","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":182},"end":{"line":182}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":182},"end":{"line":182}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":182},"end":{"line":182}}},"arguments":[],"loc":{"start":{"line":182},"end":{"line":182}}},"loc":{"start":{"line":182},"end":{"line":182}}},{"type":"WhileStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"st","loc":{"start":{"line":184},"end":{"line":184}}},"property":{"type":"Identifier","name":"hasMoreTokens"},"loc":{"start":{"line":184},"end":{"line":184}}},"arguments":[],"loc":{"start":{"line":184},"end":{"line":184}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":186},"end":{"line":186}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":186},"end":{"line":186}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":186},"end":{"line":186}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"st","loc":{"start":{"line":186},"end":{"line":186}}},"property":{"type":"Identifier","name":"nextToken"},"loc":{"start":{"line":186},"end":{"line":186}}},"arguments":[],"loc":{"start":{"line":186},"end":{"line":186}}},"property":{"type":"Identifier","name":"trim"},"loc":{"start":{"line":186},"end":{"line":186}}},"arguments":[],"loc":{"start":{"line":186},"end":{"line":186}}},"loc":{"start":{"line":186},"end":{"line":186}}},"loc":{"start":{"line":186},"end":{"line":186}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"GREATER_THAN","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":188},"end":{"line":188}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":188},"end":{"line":188}}},"arguments":[],"loc":{"start":{"line":188},"end":{"line":188}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":188},"end":{"line":188}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":188},"end":{"line":188}}},"property":{"type":"Identifier","name":"endsWith"},"loc":{"start":{"line":188},"end":{"line":188}}},"arguments":[{"type":"Literal","value":".help","raw":".help"}],"loc":{"start":{"line":188},"end":{"line":188}}},"loc":{"start":{"line":188},"end":{"line":188}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"modified","loc":{"start":{"line":190},"end":{"line":190}}},"property":{"type":"Identifier","name":"append"},"loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"s","loc":{"start":{"line":190},"end":{"line":190}}},"right":{"type":"Literal","value":"\n","raw":"\n"},"loc":{"start":{"line":190},"end":{"line":190}}}],"loc":{"start":{"line":190},"end":{"line":190}}},"loc":{"start":{"line":190},"end":{"line":190}}}],"loc":{"start":{"line":189},"end":{"line":191}}},"loc":{"start":{"line":188},"end":{"line":191}}}],"loc":{"start":{"line":185},"end":{"line":192}}},"loc":{"start":{"line":184},"end":{"line":192}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"modified","loc":{"start":{"line":194},"end":{"line":194}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":194},"end":{"line":194}}},"arguments":[],"loc":{"start":{"line":194},"end":{"line":194}}},"loc":{"start":{"line":194},"end":{"line":194}}}],"loc":{"start":{"line":179},"end":{"line":195}}},"code":"\nprivate String parseResults(String results) {\n    results.replaceAll(\"(?s).*Output...\\\\s\", \"\").replaceAll(\"(?s)Returncode.*\", \"\");\n    StringTokenizer st \u003d new StringTokenizer(results, \"\\n\");\n    StringBuffer modified \u003d new StringBuffer();\n    while (st.hasMoreTokens()) {\n        String s \u003d (String)st.nextToken().trim();\n        if (s.length() \u003e 0 \u0026\u0026 s.endsWith(\".help\")) {\n            modified.append(s + \"\\n\");\n        }\n    }\n    return modified.toString();\n}","loc":{"start":{"line":178},"end":{"line":195}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"upDirCount"},"modifiers":{"type":"Modifiers","modifiers":["public","static"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"fileName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":197},"end":{"line":197}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"count","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":199},"end":{"line":199}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"fileName","loc":{"start":{"line":203},"end":{"line":203}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":203},"end":{"line":203}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":203},"end":{"line":203}}},"arguments":[{"type":"Literal","value":"%2d","raw":"%2d"},{"type":"Literal","value":".","raw":"."}],"loc":{"start":{"line":203},"end":{"line":203}}},"loc":{"start":{"line":203},"end":{"line":203}}},"loc":{"start":{"line":203},"end":{"line":203}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"startIndex","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":204},"end":{"line":204}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":204},"end":{"line":204}}},"arguments":[{"type":"Literal","value":"..","raw":".."}],"loc":{"start":{"line":204},"end":{"line":204}}},"loc":{"start":{"line":204},"end":{"line":204}}},{"type":"WhileStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"startIndex","loc":{"start":{"line":205},"end":{"line":205}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":205},"end":{"line":205}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"argument":{"type":"Identifier","name":"count","loc":{"start":{"line":207},"end":{"line":207}}},"type":"UpdateExpression","operator":"++","prefix":false},"loc":{"start":{"line":207},"end":{"line":207}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"startIndex","loc":{"start":{"line":208},"end":{"line":208}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"fileName","loc":{"start":{"line":208},"end":{"line":208}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":208},"end":{"line":208}}},"arguments":[{"type":"Literal","value":"..","raw":".."},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Identifier","name":"startIndex","loc":{"start":{"line":208},"end":{"line":208}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":208},"end":{"line":208}}}],"loc":{"start":{"line":208},"end":{"line":208}}},"loc":{"start":{"line":208},"end":{"line":208}}},"loc":{"start":{"line":208},"end":{"line":208}}}],"loc":{"start":{"line":206},"end":{"line":209}}},"loc":{"start":{"line":205},"end":{"line":209}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"count","loc":{"start":{"line":210},"end":{"line":210}}},"loc":{"start":{"line":210},"end":{"line":210}}}],"loc":{"start":{"line":198},"end":{"line":211}}},"code":"\npublic static int upDirCount(String fileName) {\n    int count \u003d 0;\n    fileName \u003d fileName.replaceAll(\"%2d\", \".\");\n    int startIndex \u003d fileName.indexOf(\"..\");\n    while (startIndex !\u003d -1) {\n        count++;\n        startIndex \u003d fileName.indexOf(\"..\", startIndex + 1);\n    }\n    return count;\n}","loc":{"start":{"line":197},"end":{"line":211}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"exec"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":222},"end":{"line":222}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":222},"end":{"line":222}}}},{"type":"Identifier","name":"command","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":222},"end":{"line":222}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":224},"end":{"line":224}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":224},"end":{"line":224}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":224},"end":{"line":224}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Executing OS command: ","raw":"Executing OS command: "},"right":{"type":"Identifier","name":"command","loc":{"start":{"line":224},"end":{"line":224}}},"loc":{"start":{"line":224},"end":{"line":224}}}],"loc":{"start":{"line":224},"end":{"line":224}}},"loc":{"start":{"line":224},"end":{"line":224}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"er","vartype":{"type":"Identifier","name":"ExecResults","loc":{"start":{"line":225},"end":{"line":225}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ExecResults","loc":{"start":{"line":225},"end":{"line":225}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Exec","loc":{"start":{"line":225},"end":{"line":225}}},"property":{"type":"Identifier","name":"execSimple"},"loc":{"start":{"line":225},"end":{"line":225}}},"arguments":[{"type":"Identifier","name":"command","loc":{"start":{"line":225},"end":{"line":225}}}],"loc":{"start":{"line":225},"end":{"line":225}}},"loc":{"start":{"line":225},"end":{"line":225}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"command","loc":{"start":{"line":226},"end":{"line":226}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[{"type":"Literal","value":"\u0026","raw":"\u0026"}],"loc":{"start":{"line":226},"end":{"line":226}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":226},"end":{"line":226}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"command","loc":{"start":{"line":226},"end":{"line":226}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[{"type":"Literal","value":";","raw":";"}],"loc":{"start":{"line":226},"end":{"line":226}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":226},"end":{"line":226}}},"loc":{"start":{"line":226},"end":{"line":226}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"er","loc":{"start":{"line":226},"end":{"line":226}}},"property":{"type":"Identifier","name":"getError"},"loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[],"loc":{"start":{"line":226},"end":{"line":226}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":226},"end":{"line":226}}},"loc":{"start":{"line":226},"end":{"line":226}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":228},"end":{"line":228}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":228},"end":{"line":228}}}],"loc":{"start":{"line":228},"end":{"line":228}}},"loc":{"start":{"line":228},"end":{"line":228}}}],"loc":{"start":{"line":227},"end":{"line":229}}},"loc":{"start":{"line":226},"end":{"line":229}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"er","loc":{"start":{"line":231},"end":{"line":231}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":231},"end":{"line":231}}},"arguments":[],"loc":{"start":{"line":231},"end":{"line":231}}},"loc":{"start":{"line":231},"end":{"line":231}}}],"loc":{"start":{"line":223},"end":{"line":232}}},"code":"\nprivate String exec(WebSession s, String command) {\n    System.out.println(\"Executing OS command: \" + command);\n    ExecResults er \u003d Exec.execSimple(command);\n    if ((command.indexOf(\"\u0026\") !\u003d -1 || command.indexOf(\";\") !\u003d -1) \u0026\u0026 !er.getError()) {\n        makeSuccess(s);\n    }\n    return (er.toString());\n}","loc":{"start":{"line":222},"end":{"line":232}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"exec"},"modifiers":{"type":"Modifiers","modifiers":["private"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":243},"end":{"line":243}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":243},"end":{"line":243}}}},{"type":"Identifier","name":"command","vartype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":243},"end":{"line":243}}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"System","loc":{"start":{"line":245},"end":{"line":245}}},"property":{"type":"Identifier","name":"out"},"loc":{"start":{"line":245},"end":{"line":245}}},"property":{"type":"Identifier","name":"println"},"loc":{"start":{"line":245},"end":{"line":245}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Executing OS command: ","raw":"Executing OS command: "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Arrays","loc":{"start":{"line":245},"end":{"line":245}}},"property":{"type":"Identifier","name":"asList"},"loc":{"start":{"line":245},"end":{"line":245}}},"arguments":[{"type":"Identifier","name":"command","loc":{"start":{"line":245},"end":{"line":245}}}],"loc":{"start":{"line":245},"end":{"line":245}}},"loc":{"start":{"line":245},"end":{"line":245}}}],"loc":{"start":{"line":245},"end":{"line":245}}},"loc":{"start":{"line":245},"end":{"line":245}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"er","vartype":{"type":"Identifier","name":"ExecResults","loc":{"start":{"line":246},"end":{"line":246}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ExecResults","loc":{"start":{"line":246},"end":{"line":246}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Exec","loc":{"start":{"line":246},"end":{"line":246}}},"property":{"type":"Identifier","name":"execSimple"},"loc":{"start":{"line":246},"end":{"line":246}}},"arguments":[{"type":"Identifier","name":"command","loc":{"start":{"line":246},"end":{"line":246}}}],"loc":{"start":{"line":246},"end":{"line":246}}},"loc":{"start":{"line":246},"end":{"line":246}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"command","loc":{"start":{"line":248},"end":{"line":248}}},"property":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":248},"end":{"line":248}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":248},"end":{"line":248}}},"arguments":[{"type":"Literal","value":"\u0026","raw":"\u0026"}],"loc":{"start":{"line":248},"end":{"line":248}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":248},"end":{"line":248}}},"right":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"command","loc":{"start":{"line":248},"end":{"line":248}}},"property":{"type":"Literal","value":2,"raw":2},"loc":{"start":{"line":248},"end":{"line":248}}},"property":{"type":"Identifier","name":"indexOf"},"loc":{"start":{"line":248},"end":{"line":248}}},"arguments":[{"type":"Literal","value":";","raw":";"}],"loc":{"start":{"line":248},"end":{"line":248}}},"right":{"type":"Literal","value":-1,"raw":-1},"loc":{"start":{"line":248},"end":{"line":248}}},"loc":{"start":{"line":248},"end":{"line":248}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"er","loc":{"start":{"line":248},"end":{"line":248}}},"property":{"type":"Identifier","name":"getError"},"loc":{"start":{"line":248},"end":{"line":248}}},"arguments":[],"loc":{"start":{"line":248},"end":{"line":248}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":248},"end":{"line":248}}},"loc":{"start":{"line":248},"end":{"line":248}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":250},"end":{"line":250}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":250},"end":{"line":250}}}],"loc":{"start":{"line":250},"end":{"line":250}}},"loc":{"start":{"line":250},"end":{"line":250}}}],"loc":{"start":{"line":249},"end":{"line":251}}},"loc":{"start":{"line":248},"end":{"line":251}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"er","loc":{"start":{"line":253},"end":{"line":253}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":253},"end":{"line":253}}},"arguments":[],"loc":{"start":{"line":253},"end":{"line":253}}},"loc":{"start":{"line":253},"end":{"line":253}}}],"loc":{"start":{"line":244},"end":{"line":254}}},"code":"\nprivate String exec(WebSession s, String[] command) {\n    System.out.println(\"Executing OS command: \" + Arrays.asList(command));\n    ExecResults er \u003d Exec.execSimple(command);\n    if ((command[2].indexOf(\"\u0026\") !\u003d -1 || command[2].indexOf(\";\") !\u003d -1) \u0026\u0026 !er.getError()) {\n        makeSuccess(s);\n    }\n    return (er.toString());\n}","loc":{"start":{"line":243},"end":{"line":254}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":261},"end":{"line":261}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":263},"end":{"line":263}}},"property":{"type":"Identifier","name":"INJECTION"},"loc":{"start":{"line":263},"end":{"line":263}}},"loc":{"start":{"line":263},"end":{"line":263}}}],"loc":{"start":{"line":262},"end":{"line":264}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.INJECTION;\n}","loc":{"start":{"line":261},"end":{"line":264}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":271},"end":{"line":271}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":271},"end":{"line":271}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":273},"end":{"line":273}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":273},"end":{"line":273}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":273},"end":{"line":273}}},"arguments":[],"loc":{"start":{"line":273},"end":{"line":273}}},"loc":{"start":{"line":273},"end":{"line":273}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":274},"end":{"line":274}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":274},"end":{"line":274}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":274},"end":{"line":274}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":274},"end":{"line":274}}},"arguments":[{"type":"Literal","value":"CommandInjectionHint1","raw":"CommandInjectionHint1"}],"loc":{"start":{"line":274},"end":{"line":274}}}],"loc":{"start":{"line":274},"end":{"line":274}}},"loc":{"start":{"line":274},"end":{"line":274}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":275},"end":{"line":275}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":275},"end":{"line":275}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":275},"end":{"line":275}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":275},"end":{"line":275}}},"arguments":[{"type":"Literal","value":"CommandInjectionHint2","raw":"CommandInjectionHint2"}],"loc":{"start":{"line":275},"end":{"line":275}}}],"loc":{"start":{"line":275},"end":{"line":275}}},"loc":{"start":{"line":275},"end":{"line":275}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":276},"end":{"line":276}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":276},"end":{"line":276}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":276},"end":{"line":276}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":276},"end":{"line":276}}},"arguments":[{"type":"Literal","value":"CommandInjectionHint3","raw":"CommandInjectionHint3"}],"loc":{"start":{"line":276},"end":{"line":276}}}],"loc":{"start":{"line":276},"end":{"line":276}}},"loc":{"start":{"line":276},"end":{"line":276}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":277},"end":{"line":277}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":277},"end":{"line":277}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"WebGoatI18N","loc":{"start":{"line":277},"end":{"line":277}}},"property":{"type":"Identifier","name":"get"},"loc":{"start":{"line":277},"end":{"line":277}}},"arguments":[{"type":"Literal","value":"CommandInjectionHint4","raw":"CommandInjectionHint4"}],"loc":{"start":{"line":277},"end":{"line":277}}}],"loc":{"start":{"line":277},"end":{"line":277}}},"loc":{"start":{"line":277},"end":{"line":277}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":279},"end":{"line":279}}},"loc":{"start":{"line":279},"end":{"line":279}}}],"loc":{"start":{"line":272},"end":{"line":280}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(WebGoatI18N.get(\"CommandInjectionHint1\"));\n    hints.add(WebGoatI18N.get(\"CommandInjectionHint2\"));\n    hints.add(WebGoatI18N.get(\"CommandInjectionHint3\"));\n    hints.add(WebGoatI18N.get(\"CommandInjectionHint4\"));\n    return hints;\n}","loc":{"start":{"line":271},"end":{"line":280}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":283},"end":{"line":283}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":283},"end":{"line":283}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":283},"end":{"line":283}}},"arguments":[{"type":"Literal","value":40,"raw":40}],"loc":{"start":{"line":283},"end":{"line":283}}},"loc":{"start":{"line":283},"end":{"line":283}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":285},"end":{"line":285}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":287},"end":{"line":287}}},"loc":{"start":{"line":287},"end":{"line":287}}}],"loc":{"start":{"line":286},"end":{"line":288}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":285},"end":{"line":288}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":295},"end":{"line":295}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Command Injection","raw":"Command Injection"},"loc":{"start":{"line":297},"end":{"line":297}}}],"loc":{"start":{"line":296},"end":{"line":298}}},"code":"\npublic String getTitle() {\n    return \"Command Injection\";\n}","loc":{"start":{"line":295},"end":{"line":298}}}],"loc":{"start":{"line":52},"end":{"line":299}}}],"loc":{"start":{"line":2},"end":{"line":299}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/CommandInjection.java"}