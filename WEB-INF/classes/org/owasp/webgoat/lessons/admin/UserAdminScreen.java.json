{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"admin"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ResultSetMetaData"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"LessonAdapter"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"DatabaseUtilities"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"UserAdminScreen"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":46},"end":{"line":46}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"QUERY","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":49},"end":{"line":49}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":49},"end":{"line":49}}},"init":{"type":"Literal","value":"SELECT * FROM user_system_data","raw":"SELECT * FROM user_system_data"},"loc":{"start":{"line":49},"end":{"line":49}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":58},"end":{"line":58}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":58},"end":{"line":58}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":60},"end":{"line":60}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":60},"end":{"line":60}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":60},"end":{"line":60}}},"arguments":[],"loc":{"start":{"line":60},"end":{"line":60}}},"loc":{"start":{"line":60},"end":{"line":60}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":76},"end":{"line":76}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[],"loc":{"start":{"line":78},"end":{"line":78}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":79},"end":{"line":79}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[],"loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":77},"end":{"line":80}}},"loc":{"start":{"line":76},"end":{"line":80}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":64},"end":{"line":64}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":64},"end":{"line":64}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":64},"end":{"line":64}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":64},"end":{"line":64}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":64},"end":{"line":64}}}],"loc":{"start":{"line":64},"end":{"line":64}}},"loc":{"start":{"line":64},"end":{"line":64}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":66},"end":{"line":66}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":66},"end":{"line":66}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":66},"end":{"line":66}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":67},"end":{"line":67}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":67},"end":{"line":67}}}],"loc":{"start":{"line":66},"end":{"line":67}}},"loc":{"start":{"line":66},"end":{"line":67}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":68},"end":{"line":68}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":68},"end":{"line":68}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":68},"end":{"line":68}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"Identifier","name":"QUERY","loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"results","loc":{"start":{"line":70},"end":{"line":70}}},"right":{"type":"Literal"},"loc":{"start":{"line":70},"end":{"line":70}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resultsMetaData","vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":73},"end":{"line":73}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":73},"end":{"line":73}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":73},"end":{"line":73}}},"property":{"type":"Identifier","name":"getMetaData"},"loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[],"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":74},"end":{"line":74}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":74},"end":{"line":74}}},"property":{"type":"Identifier","name":"writeTable"},"loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"Identifier","name":"results","loc":{"start":{"line":74},"end":{"line":74}}},{"type":"Identifier","name":"resultsMetaData","loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":71},"end":{"line":75}}},"loc":{"start":{"line":70},"end":{"line":75}}}],"loc":{"start":{"line":63},"end":{"line":76}}},"loc":{"start":{"line":62},"end":{"line":80}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":59},"end":{"line":83}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        Statement statement \u003d connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n        ResultSet results \u003d statement.executeQuery(QUERY);\n        if (results !\u003d null) {\n            makeSuccess(s);\n            ResultSetMetaData resultsMetaData \u003d results.getMetaData();\n            ec.addElement(DatabaseUtilities.writeTable(results, resultsMetaData));\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":58},"end":{"line":83}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":90},"end":{"line":90}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":92},"end":{"line":92}}},"property":{"type":"Identifier","name":"ADMIN_FUNCTIONS"},"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":91},"end":{"line":93}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.ADMIN_FUNCTIONS;\n}","loc":{"start":{"line":90},"end":{"line":93}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":95},"end":{"line":95}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":95},"end":{"line":95}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[{"type":"Literal","value":1000,"raw":1000}],"loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":95},"end":{"line":95}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":97},"end":{"line":97}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}}],"loc":{"start":{"line":98},"end":{"line":100}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":97},"end":{"line":100}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRole"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":107},"end":{"line":107}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"HACKED_ADMIN_ROLE","loc":{"start":{"line":109},"end":{"line":109}}},"loc":{"start":{"line":109},"end":{"line":109}}}],"loc":{"start":{"line":108},"end":{"line":110}}},"code":"\npublic String getRole() {\n    return HACKED_ADMIN_ROLE;\n}","loc":{"start":{"line":107},"end":{"line":110}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":117},"end":{"line":117}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"User Information","raw":"User Information"},"loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":118},"end":{"line":120}}},"code":"\npublic String getTitle() {\n    return (\"User Information\");\n}","loc":{"start":{"line":117},"end":{"line":120}}}],"loc":{"start":{"line":46},"end":{"line":121}}}],"loc":{"start":{"line":2},"end":{"line":121}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/admin/UserAdminScreen.java"}