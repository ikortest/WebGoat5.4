{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"admin"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"Connection"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"ResultSet"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ResultSetMetaData"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"sql"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"Statement"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"Element"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"StringElement"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"html"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"Input"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"*"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"ViewDatabase"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"LessonAdapter","loc":{"start":{"line":48},"end":{"line":48}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"SQL","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":51},"end":{"line":51}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":51},"end":{"line":51}}},"init":{"type":"Literal","value":"sql","raw":"sql"},"loc":{"start":{"line":51},"end":{"line":51}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"createContent"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Element","loc":{"start":{"line":60},"end":{"line":60}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":60},"end":{"line":60}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"ec","vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":62},"end":{"line":62}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":62},"end":{"line":62}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":62},"end":{"line":62}}},"arguments":[],"loc":{"start":{"line":62},"end":{"line":62}}},"loc":{"start":{"line":62},"end":{"line":62}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":92},"end":{"line":92}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Error generating ","raw":"Error generating "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getClass"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"getName"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":94},"end":{"line":94}}},"loc":{"start":{"line":94},"end":{"line":94}}}],"loc":{"start":{"line":94},"end":{"line":94}}},"loc":{"start":{"line":94},"end":{"line":94}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":95},"end":{"line":95}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[],"loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":95},"end":{"line":95}}}],"loc":{"start":{"line":93},"end":{"line":96}}},"loc":{"start":{"line":92},"end":{"line":96}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":66},"end":{"line":66}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringElement","loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"Literal","value":"Enter a SQL statement: ","raw":"Enter a SQL statement: "}],"loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":66},"end":{"line":66}}},"loc":{"start":{"line":66},"end":{"line":66}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"sqlStatement","vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":68},"end":{"line":68}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":68},"end":{"line":68}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"StringBuffer","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":68},"end":{"line":68}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[],"loc":{"start":{"line":68},"end":{"line":68}}},"property":{"type":"Identifier","name":"getRawParameter"},"loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"Identifier","name":"SQL","loc":{"start":{"line":68},"end":{"line":68}}},{"type":"Literal","value":"","raw":""}],"loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"input","vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":69},"end":{"line":69}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Input","loc":{"start":{"line":69},"end":{"line":69}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Input","loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"Input","loc":{"start":{"line":69},"end":{"line":69}}},"property":{"type":"Identifier","name":"TEXT"},"loc":{"start":{"line":69},"end":{"line":69}}},{"type":"Identifier","name":"SQL","loc":{"start":{"line":69},"end":{"line":69}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqlStatement","loc":{"start":{"line":69},"end":{"line":69}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[],"loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":69},"end":{"line":69}}},"loc":{"start":{"line":69},"end":{"line":69}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":70},"end":{"line":70}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[{"type":"Identifier","name":"input","loc":{"start":{"line":70},"end":{"line":70}}}],"loc":{"start":{"line":70},"end":{"line":70}}},"loc":{"start":{"line":70},"end":{"line":70}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"b","vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":72},"end":{"line":72}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Element","loc":{"start":{"line":72},"end":{"line":72}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ECSFactory","loc":{"start":{"line":72},"end":{"line":72}}},"property":{"type":"Identifier","name":"makeButton"},"loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Literal","value":"Go!","raw":"Go!"}],"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":73},"end":{"line":73}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"Identifier","name":"b","loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"connection","vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":75},"end":{"line":75}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Connection","loc":{"start":{"line":75},"end":{"line":75}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":75},"end":{"line":75}}},"property":{"type":"Identifier","name":"getConnection"},"loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"GREATER_THAN","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqlStatement","loc":{"start":{"line":77},"end":{"line":77}}},"property":{"type":"Identifier","name":"length"},"loc":{"start":{"line":77},"end":{"line":77}}},"arguments":[],"loc":{"start":{"line":77},"end":{"line":77}}},"right":{"type":"Literal","value":0,"raw":0},"loc":{"start":{"line":77},"end":{"line":77}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"statement","vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":80},"end":{"line":80}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Statement","loc":{"start":{"line":80},"end":{"line":80}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"connection","loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"createStatement"},"loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":80},"end":{"line":80}}},"property":{"type":"Identifier","name":"TYPE_SCROLL_INSENSITIVE"},"loc":{"start":{"line":80},"end":{"line":80}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":81},"end":{"line":81}}},"property":{"type":"Identifier","name":"CONCUR_READ_ONLY"},"loc":{"start":{"line":81},"end":{"line":81}}}],"loc":{"start":{"line":80},"end":{"line":81}}},"loc":{"start":{"line":80},"end":{"line":81}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"results","vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":82},"end":{"line":82}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSet","loc":{"start":{"line":82},"end":{"line":82}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"statement","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"executeQuery"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"sqlStatement","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"toString"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[],"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"results","loc":{"start":{"line":84},"end":{"line":84}}},"right":{"type":"Literal"},"loc":{"start":{"line":84},"end":{"line":84}}},"right":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":84},"end":{"line":84}}},"property":{"type":"Identifier","name":"first"},"loc":{"start":{"line":84},"end":{"line":84}}},"arguments":[],"loc":{"start":{"line":84},"end":{"line":84}}},"right":{"type":"Literal","value":1,"raw":1},"loc":{"start":{"line":84},"end":{"line":84}}},"loc":{"start":{"line":84},"end":{"line":84}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"makeSuccess","loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":86},"end":{"line":86}}}],"loc":{"start":{"line":86},"end":{"line":86}}},"loc":{"start":{"line":86},"end":{"line":86}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"resultsMetaData","vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":87},"end":{"line":87}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"ResultSetMetaData","loc":{"start":{"line":87},"end":{"line":87}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"results","loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"getMetaData"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":87},"end":{"line":87}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ec","loc":{"start":{"line":88},"end":{"line":88}}},"property":{"type":"Identifier","name":"addElement"},"loc":{"start":{"line":88},"end":{"line":88}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"DatabaseUtilities","loc":{"start":{"line":88},"end":{"line":88}}},"property":{"type":"Identifier","name":"writeTable"},"loc":{"start":{"line":88},"end":{"line":88}}},"arguments":[{"type":"Identifier","name":"results","loc":{"start":{"line":88},"end":{"line":88}}},{"type":"Identifier","name":"resultsMetaData","loc":{"start":{"line":88},"end":{"line":88}}}],"loc":{"start":{"line":88},"end":{"line":88}}}],"loc":{"start":{"line":88},"end":{"line":88}}},"loc":{"start":{"line":88},"end":{"line":88}}}],"loc":{"start":{"line":85},"end":{"line":89}}},"loc":{"start":{"line":84},"end":{"line":89}}}],"loc":{"start":{"line":78},"end":{"line":91}}},"loc":{"start":{"line":77},"end":{"line":91}}}],"loc":{"start":{"line":65},"end":{"line":92}}},"loc":{"start":{"line":64},"end":{"line":96}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"ec","loc":{"start":{"line":98},"end":{"line":98}}},"loc":{"start":{"line":98},"end":{"line":98}}}],"loc":{"start":{"line":61},"end":{"line":99}}},"code":"\nprotected Element createContent(WebSession s) {\n    ElementContainer ec \u003d new ElementContainer();\n    try {\n        ec.addElement(new StringElement(\"Enter a SQL statement: \"));\n        StringBuffer sqlStatement \u003d new StringBuffer(s.getParser().getRawParameter(SQL, \"\"));\n        Input input \u003d new Input(Input.TEXT, SQL, sqlStatement.toString());\n        ec.addElement(input);\n        Element b \u003d ECSFactory.makeButton(\"Go!\");\n        ec.addElement(b);\n        Connection connection \u003d DatabaseUtilities.getConnection(s);\n        if (sqlStatement.length() \u003e 0) {\n            Statement statement \u003d connection.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);\n            ResultSet results \u003d statement.executeQuery(sqlStatement.toString());\n            if ((results !\u003d null) \u0026\u0026 (results.first() \u003d\u003d true)) {\n                makeSuccess(s);\n                ResultSetMetaData resultsMetaData \u003d results.getMetaData();\n                ec.addElement(DatabaseUtilities.writeTable(results, resultsMetaData));\n            }\n        }\n    } catch (Exception e) {\n        s.setMessage(\"Error generating \" + this.getClass().getName());\n        e.printStackTrace();\n    }\n    return (ec);\n}","loc":{"start":{"line":60},"end":{"line":99}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":106},"end":{"line":106}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"ADMIN_FUNCTIONS"},"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}}],"loc":{"start":{"line":107},"end":{"line":109}}},"code":"\nprotected Category getDefaultCategory() {\n    return Category.ADMIN_FUNCTIONS;\n}","loc":{"start":{"line":106},"end":{"line":109}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":111},"end":{"line":111}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":111},"end":{"line":111}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":111},"end":{"line":111}}},"arguments":[{"type":"Literal","value":1000,"raw":1000}],"loc":{"start":{"line":111},"end":{"line":111}}},"loc":{"start":{"line":111},"end":{"line":111}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":113},"end":{"line":113}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":115},"end":{"line":115}}},"loc":{"start":{"line":115},"end":{"line":115}}}],"loc":{"start":{"line":114},"end":{"line":116}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":113},"end":{"line":116}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":123},"end":{"line":123}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":123},"end":{"line":123}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":125},"end":{"line":125}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":125},"end":{"line":125}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[],"loc":{"start":{"line":125},"end":{"line":125}}},"loc":{"start":{"line":125},"end":{"line":125}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":126},"end":{"line":126}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":126},"end":{"line":126}}},"arguments":[{"type":"Literal","value":"There are no hints defined","raw":"There are no hints defined"}],"loc":{"start":{"line":126},"end":{"line":126}}},"loc":{"start":{"line":126},"end":{"line":126}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":124},"end":{"line":129}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"There are no hints defined\");\n    return hints;\n}","loc":{"start":{"line":123},"end":{"line":129}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":136},"end":{"line":136}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":136},"end":{"line":136}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":138},"end":{"line":138}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":138},"end":{"line":138}}},"init":{"type":"Literal","value":"Please post a message to to the WebGoat forum. Your messages will be available for everyone to read.","raw":"Please post a message to to the WebGoat forum. Your messages will be available for everyone to read."},"loc":{"start":{"line":138},"end":{"line":138}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":140},"end":{"line":140}}},"loc":{"start":{"line":140},"end":{"line":140}}}],"loc":{"start":{"line":137},"end":{"line":141}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"Please post a message to to the WebGoat forum. Your messages will be available for everyone to read.\";\n    return (instructions);\n}","loc":{"start":{"line":136},"end":{"line":141}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getRole"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":148},"end":{"line":148}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"HACKED_ADMIN_ROLE","loc":{"start":{"line":150},"end":{"line":150}}},"loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":149},"end":{"line":151}}},"code":"\npublic String getRole() {\n    return HACKED_ADMIN_ROLE;\n}","loc":{"start":{"line":148},"end":{"line":151}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":158},"end":{"line":158}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"Adhoc Query","raw":"Adhoc Query"},"loc":{"start":{"line":160},"end":{"line":160}}}],"loc":{"start":{"line":159},"end":{"line":161}}},"code":"\npublic String getTitle() {\n    return (\"Adhoc Query\");\n}","loc":{"start":{"line":158},"end":{"line":161}}}],"loc":{"start":{"line":48},"end":{"line":162}}}],"loc":{"start":{"line":2},"end":{"line":162}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/admin/ViewDatabase.java"}