{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"DBCrossSiteScripting"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"DeleteProfile"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"EditProfile"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"FindProfile"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"LessonAction"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"ListStaff"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"Login"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"Logout"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"SearchStaff"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"ViewProfile"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"ParameterNotFoundException"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"UnauthenticatedException"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"UnauthorizedException"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"ValidationException"},"loc":{"start":{"line":21},"end":{"line":21}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":22},"end":{"line":22}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"DBCrossSiteScripting"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":54},"end":{"line":54}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":56},"end":{"line":56}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":56},"end":{"line":56}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":56},"end":{"line":56}}},"arguments":[{"type":"Literal","value":100,"raw":100}],"loc":{"start":{"line":56},"end":{"line":56}}},"loc":{"start":{"line":56},"end":{"line":56}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE1","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":58},"end":{"line":58}}},"init":{"type":"Literal","value":"Stored XSS","raw":"Stored XSS"},"loc":{"start":{"line":58},"end":{"line":58}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE2","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":60},"end":{"line":60}}},"init":{"type":"Literal","value":"Block Stored XSS using DB Input Validation","raw":"Block Stored XSS using DB Input Validation"},"loc":{"start":{"line":60},"end":{"line":60}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"registerActions"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"className","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":62},"end":{"line":62}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":64},"end":{"line":64}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ListStaff","loc":{"start":{"line":64},"end":{"line":64}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":64},"end":{"line":64}}},{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":64},"end":{"line":64}}}],"loc":{"start":{"line":64},"end":{"line":64}}}],"loc":{"start":{"line":64},"end":{"line":64}}},"loc":{"start":{"line":64},"end":{"line":64}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":65},"end":{"line":65}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"SearchStaff","loc":{"start":{"line":65},"end":{"line":65}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":65},"end":{"line":65}}},{"type":"Identifier","name":"SEARCHSTAFF_ACTION","loc":{"start":{"line":65},"end":{"line":65}}}],"loc":{"start":{"line":65},"end":{"line":65}}}],"loc":{"start":{"line":65},"end":{"line":65}}},"loc":{"start":{"line":65},"end":{"line":65}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ViewProfile","loc":{"start":{"line":66},"end":{"line":66}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":66},"end":{"line":66}}},{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":66},"end":{"line":66}}}],"loc":{"start":{"line":66},"end":{"line":66}}},"loc":{"start":{"line":66},"end":{"line":66}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":67},"end":{"line":67}}},{"type":"Identifier","name":"EDITPROFILE_ACTION","loc":{"start":{"line":67},"end":{"line":67}}}],"loc":{"start":{"line":67},"end":{"line":67}}}],"loc":{"start":{"line":67},"end":{"line":67}}},"loc":{"start":{"line":67},"end":{"line":67}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":68},"end":{"line":68}}},{"type":"Identifier","name":"CREATEPROFILE_ACTION","loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Login","loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":71},"end":{"line":71}}},{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":71},"end":{"line":71}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":71},"end":{"line":71}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":71},"end":{"line":71}}}],"loc":{"start":{"line":71},"end":{"line":71}}}],"loc":{"start":{"line":71},"end":{"line":71}}}],"loc":{"start":{"line":71},"end":{"line":71}}},"loc":{"start":{"line":71},"end":{"line":71}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Logout","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":72},"end":{"line":72}}},{"type":"Identifier","name":"LOGOUT_ACTION","loc":{"start":{"line":72},"end":{"line":72}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":72},"end":{"line":72}}},"arguments":[{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}}],"loc":{"start":{"line":72},"end":{"line":72}}},"loc":{"start":{"line":72},"end":{"line":72}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"FindProfile","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":73},"end":{"line":73}}},{"type":"Identifier","name":"FINDPROFILE_ACTION","loc":{"start":{"line":73},"end":{"line":73}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UpdateProfile","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":74},"end":{"line":74}}},{"type":"Identifier","name":"UPDATEPROFILE_ACTION","loc":{"start":{"line":74},"end":{"line":74}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":74},"end":{"line":74}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}}],"loc":{"start":{"line":74},"end":{"line":74}}},"loc":{"start":{"line":74},"end":{"line":74}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"DeleteProfile","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":75},"end":{"line":75}}},{"type":"Identifier","name":"DELETEPROFILE_ACTION","loc":{"start":{"line":75},"end":{"line":75}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":75},"end":{"line":75}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":75},"end":{"line":75}}},"loc":{"start":{"line":75},"end":{"line":75}}}],"loc":{"start":{"line":63},"end":{"line":76}}},"code":"\nprotected void registerActions(String className) {\n    registerAction(new ListStaff(this, className, LISTSTAFF_ACTION));\n    registerAction(new SearchStaff(this, className, SEARCHSTAFF_ACTION));\n    registerAction(new ViewProfile(this, className, VIEWPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, EDITPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, CREATEPROFILE_ACTION));\n    registerAction(new Login(this, className, LOGIN_ACTION, getAction(LISTSTAFF_ACTION)));\n    registerAction(new Logout(this, className, LOGOUT_ACTION, getAction(LOGIN_ACTION)));\n    registerAction(new FindProfile(this, className, FINDPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new UpdateProfile(this, className, UPDATEPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new DeleteProfile(this, className, DELETEPROFILE_ACTION, getAction(LISTSTAFF_ACTION)));\n}","loc":{"start":{"line":62},"end":{"line":76}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":83},"end":{"line":83}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":85},"end":{"line":85}}},"property":{"type":"Identifier","name":"XSS"},"loc":{"start":{"line":85},"end":{"line":85}}},"loc":{"start":{"line":85},"end":{"line":85}}}],"loc":{"start":{"line":84},"end":{"line":86}}},"code":"\npublic Category getDefaultCategory() {\n    return Category.XSS;\n}","loc":{"start":{"line":83},"end":{"line":86}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":93},"end":{"line":93}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":93},"end":{"line":93}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":95},"end":{"line":95}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":95},"end":{"line":95}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[],"loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":95},"end":{"line":95}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":98},"end":{"line":98}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":98},"end":{"line":98}}},"arguments":[{"type":"Literal","value":"You can put HTML tags in form input fields.","raw":"You can put HTML tags in form input fields."}],"loc":{"start":{"line":98},"end":{"line":98}}},"loc":{"start":{"line":98},"end":{"line":98}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":99},"end":{"line":99}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":99},"end":{"line":99}}},"arguments":[{"type":"Literal","value":"Bury a SCRIPT tag in the field to attack anyone who reads it.","raw":"Bury a SCRIPT tag in the field to attack anyone who reads it."}],"loc":{"start":{"line":99},"end":{"line":99}}},"loc":{"start":{"line":99},"end":{"line":99}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":100},"end":{"line":100}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":100},"end":{"line":101}}},"arguments":[{"type":"Literal","value":"Enter this: \u0026lt;script language\u003d\"javascript\" type\u003d\"text/javascript\"\u0026gt;alert(\"Ha Ha Ha\");\u0026lt;/script\u0026gt; in message fields.","raw":"Enter this: \u0026lt;script language\u003d\"javascript\" type\u003d\"text/javascript\"\u0026gt;alert(\"Ha Ha Ha\");\u0026lt;/script\u0026gt; in message fields."}],"loc":{"start":{"line":100},"end":{"line":101}}},"loc":{"start":{"line":100},"end":{"line":101}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":102},"end":{"line":102}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":102},"end":{"line":102}}},"arguments":[{"type":"Literal","value":"Enter this: \u0026lt;script\u0026gtalert(\"document.cookie\");\u0026lt;/script\u0026gt; in message fields.","raw":"Enter this: \u0026lt;script\u0026gtalert(\"document.cookie\");\u0026lt;/script\u0026gt; in message fields."}],"loc":{"start":{"line":102},"end":{"line":102}}},"loc":{"start":{"line":102},"end":{"line":102}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":105},"end":{"line":105}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":105},"end":{"line":105}}},"arguments":[{"type":"Literal","value":"Many scripts rely on the use of special characters such as: \u0026lt;","raw":"Many scripts rely on the use of special characters such as: \u0026lt;"}],"loc":{"start":{"line":105},"end":{"line":105}}},"loc":{"start":{"line":105},"end":{"line":105}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":106},"end":{"line":106}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":106},"end":{"line":107}}},"arguments":[{"type":"Literal","value":"Allowing only a certain set of characters (positive filtering) is preferred to blocking a set of characters (negative filtering).","raw":"Allowing only a certain set of characters (positive filtering) is preferred to blocking a set of characters (negative filtering)."}],"loc":{"start":{"line":106},"end":{"line":107}}},"loc":{"start":{"line":106},"end":{"line":107}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[{"type":"Literal","value":"Oracle 10 supports a regular expression matching function : REGEXP_LIKE(text, pattern).","raw":"Oracle 10 supports a regular expression matching function : REGEXP_LIKE(text, pattern)."}],"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":110},"end":{"line":110}}},"loc":{"start":{"line":110},"end":{"line":110}}}],"loc":{"start":{"line":94},"end":{"line":111}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"You can put HTML tags in form input fields.\");\n    hints.add(\"Bury a SCRIPT tag in the field to attack anyone who reads it.\");\n    hints.add(\"Enter this: \u0026lt;script language\u003d\\\"javascript\\\" type\u003d\\\"text/javascript\\\"\u0026gt;alert(\\\"Ha Ha Ha\\\");\u0026lt;/script\u0026gt; in message fields.\");\n    hints.add(\"Enter this: \u0026lt;script\u0026gtalert(\\\"document.cookie\\\");\u0026lt;/script\u0026gt; in message fields.\");\n    hints.add(\"Many scripts rely on the use of special characters such as: \u0026lt;\");\n    hints.add(\"Allowing only a certain set of characters (positive filtering) is preferred to blocking a set of characters (negative filtering).\");\n    hints.add(\"Oracle 10 supports a regular expression matching function : REGEXP_LIKE(text, pattern).\");\n    return hints;\n}","loc":{"start":{"line":93},"end":{"line":111}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":118},"end":{"line":118}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":118},"end":{"line":118}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":120},"end":{"line":120}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":120},"end":{"line":120}}},"init":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":120},"end":{"line":120}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":122},"end":{"line":122}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":122},"end":{"line":122}}}],"loc":{"start":{"line":122},"end":{"line":122}}},"property":{"type":"Identifier","name":"getCompleted"},"loc":{"start":{"line":122},"end":{"line":122}}},"arguments":[],"loc":{"start":{"line":122},"end":{"line":122}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":122},"end":{"line":122}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":124},"end":{"line":124}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":124},"end":{"line":124}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":124},"end":{"line":124}}}],"loc":{"start":{"line":124},"end":{"line":124}}},"loc":{"start":{"line":124},"end":{"line":124}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":125},"end":{"line":125}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":125},"end":{"line":125}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":125},"end":{"line":125}}}],"loc":{"start":{"line":125},"end":{"line":125}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":127},"end":{"line":127}}},"right":{"type":"Literal","value":"Stage 1: Execute a Stored Cross Site Scripting (XSS) attack.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr/\u003e\u003cbr/\u003eAs \u0027Tom\u0027, execute a Stored XSS attack against the Street field on the Edit Profile page.  Verify that \u0027Jerry\u0027 is affected by the attack. A sample JavaScript snippet you can use is: \u0026lt;SCRIPT\u0026gt;alert(\u0027bang!\u0027);\u0026lt;/SCRIPT\u0026gt;.","raw":"Stage 1: Execute a Stored Cross Site Scripting (XSS) attack.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr/\u003e\u003cbr/\u003eAs \u0027Tom\u0027, execute a Stored XSS attack against the Street field on the Edit Profile page.  Verify that \u0027Jerry\u0027 is affected by the attack. A sample JavaScript snippet you can use is: \u0026lt;SCRIPT\u0026gt;alert(\u0027bang!\u0027);\u0026lt;/SCRIPT\u0026gt;."},"loc":{"start":{"line":127},"end":{"line":131}}},"loc":{"start":{"line":127},"end":{"line":131}}}],"loc":{"start":{"line":126},"end":{"line":132}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":133},"end":{"line":133}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":133},"end":{"line":133}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":133},"end":{"line":133}}}],"loc":{"start":{"line":133},"end":{"line":133}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":135},"end":{"line":135}}},"right":{"type":"Literal","value":"Stage 2: Block Stored XSS using Input Validation.\u003cbr\u003eImplement a fix in the stored procedure to prevent the stored XSS from being written to the database. ","raw":"Stage 2: Block Stored XSS using Input Validation.\u003cbr\u003eImplement a fix in the stored procedure to prevent the stored XSS from being written to the database. "},"loc":{"start":{"line":135},"end":{"line":136}}},"loc":{"start":{"line":135},"end":{"line":136}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":137},"end":{"line":137}}},"arguments":[],"loc":{"start":{"line":137},"end":{"line":137}}},"property":{"type":"Identifier","name":"getDatabaseDriver"},"loc":{"start":{"line":137},"end":{"line":137}}},"arguments":[],"loc":{"start":{"line":137},"end":{"line":137}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":137},"end":{"line":137}}},"arguments":[{"type":"Literal","value":"jtds","raw":"jtds"}],"loc":{"start":{"line":137},"end":{"line":137}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"Assignement","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":138},"end":{"line":138}}},"right":{"type":"Literal","value":"Use the provided user-defined function RegexMatch to test the data against a pattern. ","raw":"Use the provided user-defined function RegexMatch to test the data against a pattern. "},"loc":{"start":{"line":138},"end":{"line":138}}},"loc":{"start":{"line":138},"end":{"line":138}}},"loc":{"start":{"line":137},"end":{"line":138}}},{"type":"ExpressionStatement","expression":{"type":"Assignement","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":139},"end":{"line":139}}},"right":{"type":"Literal","value":"A sample regular expression pattern: ^[a-zA-Z0-9,\\. ]{0,80}$ Repeat stage 1 as \u0027Eric\u0027 with \u0027David\u0027 as the manager.  Verify that \u0027David\u0027 is not affected by the attack.","raw":"A sample regular expression pattern: ^[a-zA-Z0-9,\\. ]{0,80}$ Repeat stage 1 as \u0027Eric\u0027 with \u0027David\u0027 as the manager.  Verify that \u0027David\u0027 is not affected by the attack."},"loc":{"start":{"line":139},"end":{"line":140}}},"loc":{"start":{"line":139},"end":{"line":140}}}],"loc":{"start":{"line":134},"end":{"line":141}}},"loc":{"start":{"line":133},"end":{"line":141}}},"loc":{"start":{"line":125},"end":{"line":141}}}],"loc":{"start":{"line":123},"end":{"line":142}}},"loc":{"start":{"line":122},"end":{"line":142}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":144},"end":{"line":144}}},"loc":{"start":{"line":144},"end":{"line":144}}}],"loc":{"start":{"line":119},"end":{"line":146}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"\";\n    if (!getLessonTracker(s).getCompleted()) {\n        String stage \u003d getStage(s);\n        if (STAGE1.equals(stage)) {\n            instructions \u003d \"Stage 1: Execute a Stored Cross Site Scripting (XSS) attack.\u003cbr\u003e\u003cbr\u003e\u003cb\u003e\u003cfont color\u003dblue\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr/\u003e\u003cbr/\u003eAs \\\u0027Tom\\\u0027, execute a Stored XSS attack against the Street field on the Edit Profile page.  Verify that \\\u0027Jerry\\\u0027 is affected by the attack. A sample JavaScript snippet you can use is: \u0026lt;SCRIPT\u0026gt;alert(\\\u0027bang!\\\u0027);\u0026lt;/SCRIPT\u0026gt;.\";\n        } else if (STAGE2.equals(stage)) {\n            instructions \u003d \"Stage 2: Block Stored XSS using Input Validation.\u003cbr\u003eImplement a fix in the stored procedure to prevent the stored XSS from being written to the database. \";\n            if (getWebgoatContext().getDatabaseDriver().contains(\"jtds\")) instructions +\u003d \"Use the provided user-defined function RegexMatch to test the data against a pattern. \";\n            instructions +\u003d \"A sample regular expression pattern: ^[a-zA-Z0-9,\\\\. ]{0,80}$ Repeat stage 1 as \\\u0027Eric\\\u0027 with \\\u0027David\\\u0027 as the manager.  Verify that \\\u0027David\\\u0027 is not affected by the attack.\";\n        }\n    }\n    return instructions;\n}","loc":{"start":{"line":118},"end":{"line":146}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getStages"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":148},"end":{"line":148}}},"arguments":[]}]},"restype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":149},"end":{"line":149}}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":151},"end":{"line":151}}},"arguments":[],"loc":{"start":{"line":151},"end":{"line":151}}},"property":{"type":"Identifier","name":"isCodingExercises"},"loc":{"start":{"line":151},"end":{"line":151}}},"arguments":[],"loc":{"start":{"line":151},"end":{"line":151}}},"consequent":{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":151},"end":{"line":151}}},{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":151},"end":{"line":151}}}],"loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}},{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":152},"end":{"line":152}}}],"loc":{"start":{"line":152},"end":{"line":152}}},"loc":{"start":{"line":152},"end":{"line":152}}}],"loc":{"start":{"line":150},"end":{"line":153}}},"code":"\n@Override()\npublic String[] getStages() {\n    if (getWebgoatContext().isCodingExercises()) return new String[]{STAGE1, STAGE2};\n    return new String[]{STAGE1};\n}","loc":{"start":{"line":148},"end":{"line":153}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"handleRequest"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":155},"end":{"line":155}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":157},"end":{"line":157}}},"property":{"type":"Identifier","name":"getLessonSession"},"loc":{"start":{"line":157},"end":{"line":157}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":157},"end":{"line":157}}},"right":{"type":"Literal"},"loc":{"start":{"line":157},"end":{"line":157}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":157},"end":{"line":157}}},"property":{"type":"Identifier","name":"openLessonSession"},"loc":{"start":{"line":157},"end":{"line":157}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":157},"end":{"line":157}}},"loc":{"start":{"line":157},"end":{"line":157}}},"loc":{"start":{"line":157},"end":{"line":157}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"requestedActionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":159},"end":{"line":159}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":159},"end":{"line":159}}},"init":{"type":"Literal"},"loc":{"start":{"line":159},"end":{"line":159}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":163},"end":{"line":163}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":166},"end":{"line":166}}},"right":{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":166},"end":{"line":166}}},"loc":{"start":{"line":166},"end":{"line":166}}},"loc":{"start":{"line":166},"end":{"line":166}}}],"loc":{"start":{"line":164},"end":{"line":167}}},"loc":{"start":{"line":163},"end":{"line":167}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":162},"end":{"line":162}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[],"loc":{"start":{"line":162},"end":{"line":162}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":162},"end":{"line":162}}},"arguments":[{"type":"Literal","value":"action","raw":"action"}],"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}},"loc":{"start":{"line":162},"end":{"line":162}}}],"loc":{"start":{"line":161},"end":{"line":163}}},"loc":{"start":{"line":160},"end":{"line":167}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":169},"end":{"line":169}}},"right":{"type":"Literal"},"loc":{"start":{"line":169},"end":{"line":169}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":187},"end":{"line":187}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pnfe","loc":{"start":{"line":190},"end":{"line":190}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[],"loc":{"start":{"line":190},"end":{"line":190}}},"loc":{"start":{"line":190},"end":{"line":190}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":191},"end":{"line":191}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":191},"end":{"line":191}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":191},"end":{"line":191}}}],"loc":{"start":{"line":191},"end":{"line":191}}},"loc":{"start":{"line":191},"end":{"line":191}}}],"loc":{"start":{"line":188},"end":{"line":192}}},"loc":{"start":{"line":187},"end":{"line":192}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ve","vartype":{"type":"Identifier","name":"ValidationException","loc":{"start":{"line":192},"end":{"line":192}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ve","loc":{"start":{"line":195},"end":{"line":195}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":195},"end":{"line":195}}},"arguments":[],"loc":{"start":{"line":195},"end":{"line":195}}},"loc":{"start":{"line":195},"end":{"line":195}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":196},"end":{"line":196}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":196},"end":{"line":196}}}],"loc":{"start":{"line":196},"end":{"line":196}}},"loc":{"start":{"line":196},"end":{"line":196}}}],"loc":{"start":{"line":193},"end":{"line":197}}},"loc":{"start":{"line":192},"end":{"line":197}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue","vartype":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":197},"end":{"line":197}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":199},"end":{"line":199}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":199},"end":{"line":199}}},"arguments":[{"type":"Literal","value":"Login failed","raw":"Login failed"}],"loc":{"start":{"line":199},"end":{"line":199}}},"loc":{"start":{"line":199},"end":{"line":199}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue","loc":{"start":{"line":201},"end":{"line":201}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":201},"end":{"line":201}}},"arguments":[],"loc":{"start":{"line":201},"end":{"line":201}}},"loc":{"start":{"line":201},"end":{"line":201}}}],"loc":{"start":{"line":198},"end":{"line":202}}},"loc":{"start":{"line":197},"end":{"line":202}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue2","vartype":{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":202},"end":{"line":202}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":204},"end":{"line":204}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":204},"end":{"line":204}}},"arguments":[{"type":"Literal","value":"You are not authorized to perform this function","raw":"You are not authorized to perform this function"}],"loc":{"start":{"line":204},"end":{"line":204}}},"loc":{"start":{"line":204},"end":{"line":204}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue2","loc":{"start":{"line":206},"end":{"line":206}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":206},"end":{"line":206}}},"arguments":[],"loc":{"start":{"line":206},"end":{"line":206}}},"loc":{"start":{"line":206},"end":{"line":206}}}],"loc":{"start":{"line":203},"end":{"line":207}}},"loc":{"start":{"line":202},"end":{"line":207}}},{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":207},"end":{"line":207}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":211},"end":{"line":211}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":211},"end":{"line":211}}},"arguments":[],"loc":{"start":{"line":211},"end":{"line":211}}},"loc":{"start":{"line":211},"end":{"line":211}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":212},"end":{"line":212}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":212},"end":{"line":212}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":212},"end":{"line":212}}}],"loc":{"start":{"line":212},"end":{"line":212}}},"loc":{"start":{"line":212},"end":{"line":212}}}],"loc":{"start":{"line":208},"end":{"line":213}}},"loc":{"start":{"line":207},"end":{"line":213}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"action","vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":173},"end":{"line":173}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":173},"end":{"line":173}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":173},"end":{"line":173}}},"arguments":[{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":173},"end":{"line":173}}}],"loc":{"start":{"line":173},"end":{"line":173}}},"loc":{"start":{"line":173},"end":{"line":173}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"action","loc":{"start":{"line":175},"end":{"line":175}}},"right":{"type":"Literal"},"loc":{"start":{"line":175},"end":{"line":175}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"requiresAuthentication"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[],"loc":{"start":{"line":177},"end":{"line":177}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":177},"end":{"line":177}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":177},"end":{"line":177}}},"property":{"type":"Identifier","name":"isAuthenticated"},"loc":{"start":{"line":177},"end":{"line":177}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":177},"end":{"line":177}}}],"loc":{"start":{"line":177},"end":{"line":177}}},"loc":{"start":{"line":177},"end":{"line":177}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":179},"end":{"line":179}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":179},"end":{"line":179}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":179},"end":{"line":179}}}],"loc":{"start":{"line":179},"end":{"line":179}}},"loc":{"start":{"line":179},"end":{"line":179}}}],"loc":{"start":{"line":178},"end":{"line":181}}},"loc":{"start":{"line":177},"end":{"line":181}}}],"loc":{"start":{"line":176},"end":{"line":182}}},"alternate":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":185},"end":{"line":185}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":185},"end":{"line":185}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":185},"end":{"line":185}}}],"loc":{"start":{"line":185},"end":{"line":185}}},"loc":{"start":{"line":185},"end":{"line":185}}}],"loc":{"start":{"line":184},"end":{"line":186}}},"loc":{"start":{"line":175},"end":{"line":186}}}],"loc":{"start":{"line":172},"end":{"line":187}}},"loc":{"start":{"line":171},"end":{"line":213}}}],"loc":{"start":{"line":170},"end":{"line":214}}},"loc":{"start":{"line":169},"end":{"line":214}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setContent","loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":217},"end":{"line":217}}},"arguments":[],"loc":{"start":{"line":217},"end":{"line":217}}}],"loc":{"start":{"line":217},"end":{"line":217}}},"loc":{"start":{"line":217},"end":{"line":217}}}],"loc":{"start":{"line":156},"end":{"line":218}}},"code":"\npublic void handleRequest(WebSession s) {\n    if (s.getLessonSession(this) \u003d\u003d null) s.openLessonSession(this);\n    String requestedActionName \u003d null;\n    try {\n        requestedActionName \u003d s.getParser().getStringParameter(\"action\");\n    } catch (ParameterNotFoundException pnfe) {\n        requestedActionName \u003d LOGIN_ACTION;\n    }\n    if (requestedActionName !\u003d null) {\n        try {\n            LessonAction action \u003d getAction(requestedActionName);\n            if (action !\u003d null) {\n                if (!action.requiresAuthentication() || action.isAuthenticated(s)) {\n                    action.handleRequest(s);\n                }\n            } else {\n                setCurrentAction(s, ERROR_ACTION);\n            }\n        } catch (ParameterNotFoundException pnfe) {\n            pnfe.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (ValidationException ve) {\n            ve.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (UnauthenticatedException ue) {\n            s.setMessage(\"Login failed\");\n            ue.printStackTrace();\n        } catch (UnauthorizedException ue2) {\n            s.setMessage(\"You are not authorized to perform this function\");\n            ue2.printStackTrace();\n        } catch (Exception e) {\n            e.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        }\n    }\n    setContent(new ElementContainer());\n}","loc":{"start":{"line":155},"end":{"line":218}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":220},"end":{"line":220}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":222},"end":{"line":222}}},"loc":{"start":{"line":222},"end":{"line":222}}}],"loc":{"start":{"line":221},"end":{"line":223}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":220},"end":{"line":223}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":230},"end":{"line":230}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"LAB: DB Cross Site Scripting (XSS)","raw":"LAB: DB Cross Site Scripting (XSS)"},"loc":{"start":{"line":232},"end":{"line":232}}}],"loc":{"start":{"line":231},"end":{"line":233}}},"code":"\npublic String getTitle() {\n    return \"LAB: DB Cross Site Scripting (XSS)\";\n}","loc":{"start":{"line":230},"end":{"line":233}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultHidden"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":235},"end":{"line":235}}},"arguments":[]}]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"driver","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":238},"end":{"line":238}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":238},"end":{"line":238}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":238},"end":{"line":238}}},"arguments":[],"loc":{"start":{"line":238},"end":{"line":238}}},"property":{"type":"Identifier","name":"getDatabaseDriver"},"loc":{"start":{"line":238},"end":{"line":238}}},"arguments":[],"loc":{"start":{"line":238},"end":{"line":238}}},"loc":{"start":{"line":238},"end":{"line":238}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hidden","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"argument":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"driver","loc":{"start":{"line":239},"end":{"line":239}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":239},"end":{"line":239}}},"arguments":[{"type":"Literal","value":"oracle","raw":"oracle"}],"loc":{"start":{"line":239},"end":{"line":239}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"driver","loc":{"start":{"line":239},"end":{"line":239}}},"property":{"type":"Identifier","name":"contains"},"loc":{"start":{"line":239},"end":{"line":239}}},"arguments":[{"type":"Literal","value":"jtds","raw":"jtds"}],"loc":{"start":{"line":239},"end":{"line":239}}},"loc":{"start":{"line":239},"end":{"line":239}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":239},"end":{"line":239}}},"loc":{"start":{"line":239},"end":{"line":239}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hidden","loc":{"start":{"line":240},"end":{"line":240}}},"loc":{"start":{"line":240},"end":{"line":240}}}],"loc":{"start":{"line":237},"end":{"line":241}}},"code":"\n@Override()\nprotected boolean getDefaultHidden() {\n    String driver \u003d getWebgoatContext().getDatabaseDriver();\n    boolean hidden \u003d !(driver.contains(\"oracle\") || driver.contains(\"jtds\"));\n    return hidden;\n}","loc":{"start":{"line":235},"end":{"line":241}}}],"loc":{"start":{"line":54},"end":{"line":243}}}],"loc":{"start":{"line":2},"end":{"line":243}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/DBCrossSiteScripting/DBCrossSiteScripting.java"}