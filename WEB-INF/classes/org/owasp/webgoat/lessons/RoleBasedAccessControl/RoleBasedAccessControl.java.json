{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"RoleBasedAccessControl"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"BufferedReader"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"FileReader"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"ArrayList"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"util"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"List"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"apache"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ecs"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"ElementContainer"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"Category"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"DefaultLessonAction"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":12},"end":{"line":12}}},"property":{"type":"Identifier","name":"FindProfile"},"loc":{"start":{"line":12},"end":{"line":12}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":13},"end":{"line":13}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":13},"end":{"line":13}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":14},"end":{"line":14}}},"property":{"type":"Identifier","name":"LessonAction"},"loc":{"start":{"line":14},"end":{"line":14}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":15},"end":{"line":15}}},"property":{"type":"Identifier","name":"ListStaff"},"loc":{"start":{"line":15},"end":{"line":15}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":16},"end":{"line":16}}},"property":{"type":"Identifier","name":"Login"},"loc":{"start":{"line":16},"end":{"line":16}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":17},"end":{"line":17}}},"property":{"type":"Identifier","name":"Logout"},"loc":{"start":{"line":17},"end":{"line":17}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"GoatHillsFinancial"},"loc":{"start":{"line":18},"end":{"line":18}}},"property":{"type":"Identifier","name":"SearchStaff"},"loc":{"start":{"line":18},"end":{"line":18}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":19},"end":{"line":19}}},"property":{"type":"Identifier","name":"ParameterNotFoundException"},"loc":{"start":{"line":19},"end":{"line":19}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":20},"end":{"line":20}}},"property":{"type":"Identifier","name":"UnauthenticatedException"},"loc":{"start":{"line":20},"end":{"line":20}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":21},"end":{"line":21}}},"property":{"type":"Identifier","name":"UnauthorizedException"},"loc":{"start":{"line":21},"end":{"line":21}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":22},"end":{"line":22}}},"property":{"type":"Identifier","name":"ValidationException"},"loc":{"start":{"line":22},"end":{"line":22}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":23},"end":{"line":23}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":23},"end":{"line":23}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"RoleBasedAccessControl"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"GoatHillsFinancial","loc":{"start":{"line":53},"end":{"line":53}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"DEFAULT_RANKING","vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":55},"end":{"line":55}}}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":55},"end":{"line":55}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Integer","loc":{"start":{"line":55},"end":{"line":55}}},"arguments":[{"type":"Literal","value":125,"raw":125}],"loc":{"start":{"line":55},"end":{"line":55}}},"loc":{"start":{"line":55},"end":{"line":55}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE1","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}},"init":{"type":"Literal","value":"Bypass Business Layer Access Control","raw":"Bypass Business Layer Access Control"},"loc":{"start":{"line":57},"end":{"line":57}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE2","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":59},"end":{"line":59}}},"init":{"type":"Literal","value":"Add Business Layer Access Control","raw":"Add Business Layer Access Control"},"loc":{"start":{"line":59},"end":{"line":59}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE3","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":61},"end":{"line":61}}},"init":{"type":"Literal","value":"Bypass Data Layer Access Control","raw":"Bypass Data Layer Access Control"},"loc":{"start":{"line":61},"end":{"line":61}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"STAGE4","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":63},"end":{"line":63}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":63},"end":{"line":63}}},"init":{"type":"Literal","value":"Add Data Layer Access Control","raw":"Add Data Layer Access Control"},"loc":{"start":{"line":63},"end":{"line":63}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"registerActions"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"className","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":65},"end":{"line":65}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ListStaff","loc":{"start":{"line":67},"end":{"line":67}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":67},"end":{"line":67}}},{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":67},"end":{"line":67}}}],"loc":{"start":{"line":67},"end":{"line":67}}}],"loc":{"start":{"line":67},"end":{"line":67}}},"loc":{"start":{"line":67},"end":{"line":67}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"SearchStaff","loc":{"start":{"line":68},"end":{"line":68}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":68},"end":{"line":68}}},{"type":"Identifier","name":"SEARCHSTAFF_ACTION","loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}}],"loc":{"start":{"line":68},"end":{"line":68}}},"loc":{"start":{"line":68},"end":{"line":68}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ViewProfile","loc":{"start":{"line":69},"end":{"line":69}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":69},"end":{"line":69}}},{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":69},"end":{"line":69}}}],"loc":{"start":{"line":69},"end":{"line":69}}},"loc":{"start":{"line":69},"end":{"line":69}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":70},"end":{"line":70}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":70},"end":{"line":70}}},{"type":"Identifier","name":"EDITPROFILE_ACTION","loc":{"start":{"line":70},"end":{"line":70}}}],"loc":{"start":{"line":70},"end":{"line":70}}}],"loc":{"start":{"line":70},"end":{"line":70}}},"loc":{"start":{"line":70},"end":{"line":70}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"EditProfile","loc":{"start":{"line":73},"end":{"line":73}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":73},"end":{"line":73}}},{"type":"Identifier","name":"CREATEPROFILE_ACTION","loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}}],"loc":{"start":{"line":73},"end":{"line":73}}},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":76},"end":{"line":76}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Login","loc":{"start":{"line":76},"end":{"line":76}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":76},"end":{"line":76}}},{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":76},"end":{"line":76}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":76},"end":{"line":76}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":76},"end":{"line":76}}}],"loc":{"start":{"line":76},"end":{"line":76}}},"loc":{"start":{"line":76},"end":{"line":76}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":77},"end":{"line":77}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"Logout","loc":{"start":{"line":77},"end":{"line":77}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":77},"end":{"line":77}}},{"type":"Identifier","name":"LOGOUT_ACTION","loc":{"start":{"line":77},"end":{"line":77}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":77},"end":{"line":77}}},"arguments":[{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":77},"end":{"line":77}}}],"loc":{"start":{"line":77},"end":{"line":77}}}],"loc":{"start":{"line":77},"end":{"line":77}}}],"loc":{"start":{"line":77},"end":{"line":77}}},"loc":{"start":{"line":77},"end":{"line":77}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"FindProfile","loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":78},"end":{"line":78}}},{"type":"Identifier","name":"FINDPROFILE_ACTION","loc":{"start":{"line":78},"end":{"line":78}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":78},"end":{"line":78}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}}],"loc":{"start":{"line":78},"end":{"line":78}}},"loc":{"start":{"line":78},"end":{"line":78}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UpdateProfile","loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":79},"end":{"line":79}}},{"type":"Identifier","name":"UPDATEPROFILE_ACTION","loc":{"start":{"line":79},"end":{"line":79}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":79},"end":{"line":79}}},"arguments":[{"type":"Identifier","name":"VIEWPROFILE_ACTION","loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}}],"loc":{"start":{"line":79},"end":{"line":79}}},"loc":{"start":{"line":79},"end":{"line":79}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"registerAction","loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"DeleteProfile","loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"ThisExpression"},{"type":"Identifier","name":"className","loc":{"start":{"line":80},"end":{"line":80}}},{"type":"Identifier","name":"DELETEPROFILE_ACTION","loc":{"start":{"line":80},"end":{"line":80}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":80},"end":{"line":80}}},"arguments":[{"type":"Identifier","name":"LISTSTAFF_ACTION","loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":80},"end":{"line":80}}},"loc":{"start":{"line":80},"end":{"line":80}}}],"loc":{"start":{"line":66},"end":{"line":81}}},"code":"\nprotected void registerActions(String className) {\n    registerAction(new ListStaff(this, className, LISTSTAFF_ACTION));\n    registerAction(new SearchStaff(this, className, SEARCHSTAFF_ACTION));\n    registerAction(new ViewProfile(this, className, VIEWPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, EDITPROFILE_ACTION));\n    registerAction(new EditProfile(this, className, CREATEPROFILE_ACTION));\n    registerAction(new Login(this, className, LOGIN_ACTION, getAction(LISTSTAFF_ACTION)));\n    registerAction(new Logout(this, className, LOGOUT_ACTION, getAction(LOGIN_ACTION)));\n    registerAction(new FindProfile(this, className, FINDPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new UpdateProfile(this, className, UPDATEPROFILE_ACTION, getAction(VIEWPROFILE_ACTION)));\n    registerAction(new DeleteProfile(this, className, DELETEPROFILE_ACTION, getAction(LISTSTAFF_ACTION)));\n}","loc":{"start":{"line":65},"end":{"line":81}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultCategory"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"Category","loc":{"start":{"line":88},"end":{"line":88}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"MemberExpression","object":{"type":"Identifier","name":"Category","loc":{"start":{"line":90},"end":{"line":90}}},"property":{"type":"Identifier","name":"ACCESS_CONTROL"},"loc":{"start":{"line":90},"end":{"line":90}}},"loc":{"start":{"line":90},"end":{"line":90}}}],"loc":{"start":{"line":89},"end":{"line":91}}},"code":"\npublic Category getDefaultCategory() {\n    return Category.ACCESS_CONTROL;\n}","loc":{"start":{"line":88},"end":{"line":91}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getHints"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"List","loc":{"start":{"line":98},"end":{"line":98}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":98},"end":{"line":98}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"hints","vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":100},"end":{"line":100}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"List","loc":{"start":{"line":100},"end":{"line":100}}},"init":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ArrayList","loc":{"start":{"line":100},"end":{"line":100}}},"arguments":[],"loc":{"start":{"line":100},"end":{"line":100}}},"loc":{"start":{"line":100},"end":{"line":100}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":101},"end":{"line":101}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":101},"end":{"line":101}}},"arguments":[{"type":"Literal","value":"Many sites attempt to restrict access to resources by role.","raw":"Many sites attempt to restrict access to resources by role."}],"loc":{"start":{"line":101},"end":{"line":101}}},"loc":{"start":{"line":101},"end":{"line":101}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":102},"end":{"line":102}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":102},"end":{"line":102}}},"arguments":[{"type":"Literal","value":"Developers frequently make mistakes implementing this scheme.","raw":"Developers frequently make mistakes implementing this scheme."}],"loc":{"start":{"line":102},"end":{"line":102}}},"loc":{"start":{"line":102},"end":{"line":102}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":103},"end":{"line":103}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":103},"end":{"line":103}}},"arguments":[{"type":"Literal","value":"Attempt combinations of users, roles, and resources.","raw":"Attempt combinations of users, roles, and resources."}],"loc":{"start":{"line":103},"end":{"line":103}}},"loc":{"start":{"line":103},"end":{"line":103}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":106},"end":{"line":106}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":106},"end":{"line":106}}},"arguments":[{"type":"Literal","value":"Stage1: How does the application know that the user selected the delete function?","raw":"Stage1: How does the application know that the user selected the delete function?"}],"loc":{"start":{"line":106},"end":{"line":106}}},"loc":{"start":{"line":106},"end":{"line":106}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Literal","value":"Stage2: You have to code to check the authorization of the user for the action.","raw":"Stage2: You have to code to check the authorization of the user for the action."}],"loc":{"start":{"line":109},"end":{"line":109}}},"loc":{"start":{"line":109},"end":{"line":109}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":113},"end":{"line":113}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":113},"end":{"line":113}}},"arguments":[{"type":"Literal","value":"Stage3: How does the application know that the user selected any particular employee to view?","raw":"Stage3: How does the application know that the user selected any particular employee to view?"}],"loc":{"start":{"line":113},"end":{"line":113}}},"loc":{"start":{"line":113},"end":{"line":113}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":116},"end":{"line":116}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":116},"end":{"line":116}}},"arguments":[{"type":"Literal","value":"Note that the contents of the staff listing change depending on who is logged in.","raw":"Note that the contents of the staff listing change depending on who is logged in."}],"loc":{"start":{"line":116},"end":{"line":116}}},"loc":{"start":{"line":116},"end":{"line":116}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"hints","loc":{"start":{"line":118},"end":{"line":118}}},"property":{"type":"Identifier","name":"add"},"loc":{"start":{"line":118},"end":{"line":119}}},"arguments":[{"type":"Literal","value":"Stage4: You have to code to check the authorization of the user for the action on a certain employee.","raw":"Stage4: You have to code to check the authorization of the user for the action on a certain employee."}],"loc":{"start":{"line":118},"end":{"line":119}}},"loc":{"start":{"line":118},"end":{"line":119}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"hints","loc":{"start":{"line":121},"end":{"line":121}}},"loc":{"start":{"line":121},"end":{"line":121}}}],"loc":{"start":{"line":99},"end":{"line":122}}},"code":"\nprotected List\u003cString\u003e getHints(WebSession s) {\n    List\u003cString\u003e hints \u003d new ArrayList\u003cString\u003e();\n    hints.add(\"Many sites attempt to restrict access to resources by role.\");\n    hints.add(\"Developers frequently make mistakes implementing this scheme.\");\n    hints.add(\"Attempt combinations of users, roles, and resources.\");\n    hints.add(\"Stage1: How does the application know that the user selected the delete function?\");\n    hints.add(\"Stage2: You have to code to check the authorization of the user for the action.\");\n    hints.add(\"Stage3: How does the application know that the user selected any particular employee to view?\");\n    hints.add(\"Note that the contents of the staff listing change depending on who is logged in.\");\n    hints.add(\"Stage4: You have to code to check the authorization of the user for the action on a certain employee.\");\n    return hints;\n}","loc":{"start":{"line":98},"end":{"line":122}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getStages"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":124},"end":{"line":124}}},"arguments":[]}]},"restype":{"type":"TypeArray","elemtype":{"type":"Identifier","name":"String","loc":{"start":{"line":125},"end":{"line":125}}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getWebgoatContext","loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[],"loc":{"start":{"line":127},"end":{"line":127}}},"property":{"type":"Identifier","name":"isCodingExercises"},"loc":{"start":{"line":127},"end":{"line":127}}},"arguments":[],"loc":{"start":{"line":127},"end":{"line":127}}},"consequent":{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":127},"end":{"line":127}}},{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":127},"end":{"line":127}}},{"type":"Identifier","name":"STAGE3","loc":{"start":{"line":127},"end":{"line":127}}},{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":127},"end":{"line":127}}}],"loc":{"start":{"line":127},"end":{"line":127}}},"loc":{"start":{"line":127},"end":{"line":127}}},"loc":{"start":{"line":127},"end":{"line":127}}},{"type":"ReturnStatement","argument":{"type":"ArrayExpression","elements":[{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":128},"end":{"line":128}}},{"type":"Identifier","name":"STAGE3","loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":128},"end":{"line":128}}},"loc":{"start":{"line":128},"end":{"line":128}}}],"loc":{"start":{"line":126},"end":{"line":129}}},"code":"\n@Override()\npublic String[] getStages() {\n    if (getWebgoatContext().isCodingExercises()) return new String[]{STAGE1, STAGE2, STAGE3, STAGE4};\n    return new String[]{STAGE1, STAGE3};\n}","loc":{"start":{"line":124},"end":{"line":129}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getInstructions"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":136},"end":{"line":136}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":136},"end":{"line":136}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"instructions","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":138},"end":{"line":138}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":138},"end":{"line":138}}},"init":{"type":"Literal","value":"","raw":""},"loc":{"start":{"line":138},"end":{"line":138}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonTracker","loc":{"start":{"line":140},"end":{"line":140}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":140},"end":{"line":140}}}],"loc":{"start":{"line":140},"end":{"line":140}}},"property":{"type":"Identifier","name":"getCompleted"},"loc":{"start":{"line":140},"end":{"line":140}}},"arguments":[],"loc":{"start":{"line":140},"end":{"line":140}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":140},"end":{"line":140}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":142},"end":{"line":142}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":142},"end":{"line":142}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":142},"end":{"line":142}}}],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE1","loc":{"start":{"line":143},"end":{"line":143}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":143},"end":{"line":143}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":143},"end":{"line":143}}}],"loc":{"start":{"line":143},"end":{"line":143}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":145},"end":{"line":145}}},"right":{"type":"Literal","value":"Stage 1: Bypass Presentational Layer Access Control.\u003cbr /\u003eAs regular employee \u0027Tom\u0027, exploit weak access control to use the Delete function from the Staff List page. Verify that Tom\u0027s profile can be deleted. The passwords for users are their given names in lowercase (e.g. the password for Tom Cat is \"tom\").","raw":"Stage 1: Bypass Presentational Layer Access Control.\u003cbr /\u003eAs regular employee \u0027Tom\u0027, exploit weak access control to use the Delete function from the Staff List page. Verify that Tom\u0027s profile can be deleted. The passwords for users are their given names in lowercase (e.g. the password for Tom Cat is \"tom\")."},"loc":{"start":{"line":145},"end":{"line":148}}},"loc":{"start":{"line":145},"end":{"line":148}}}],"loc":{"start":{"line":144},"end":{"line":149}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":150},"end":{"line":150}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":150},"end":{"line":150}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":150},"end":{"line":150}}}],"loc":{"start":{"line":150},"end":{"line":150}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":152},"end":{"line":152}}},"right":{"type":"Literal","value":"Stage 2: Add Business Layer Access Control.\u003cbr\u003e\u003cbr /\u003e\u003cb\u003e\u003cfont color\u003d\"blue\"\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr /\u003e\u003cbr /\u003eImplement a fix to deny unauthorized access to the Delete function. To do this, you will have to alter the WebGoat code. Once you have done this, repeat stage 1 and verify that access to DeleteProfile functionality is properly denied.","raw":"Stage 2: Add Business Layer Access Control.\u003cbr\u003e\u003cbr /\u003e\u003cb\u003e\u003cfont color\u003d\"blue\"\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr /\u003e\u003cbr /\u003eImplement a fix to deny unauthorized access to the Delete function. To do this, you will have to alter the WebGoat code. Once you have done this, repeat stage 1 and verify that access to DeleteProfile functionality is properly denied."},"loc":{"start":{"line":152},"end":{"line":156}}},"loc":{"start":{"line":152},"end":{"line":156}}}],"loc":{"start":{"line":151},"end":{"line":157}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE3","loc":{"start":{"line":158},"end":{"line":158}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":158},"end":{"line":158}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":158},"end":{"line":158}}}],"loc":{"start":{"line":158},"end":{"line":158}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":160},"end":{"line":160}}},"right":{"type":"Literal","value":"Stage 3: Breaking Data Layer Access Control.\u003cbr /\u003eAs regular employee \u0027Tom\u0027, exploit weak access control to View another employee\u0027s profile. Verify the access.","raw":"Stage 3: Breaking Data Layer Access Control.\u003cbr /\u003eAs regular employee \u0027Tom\u0027, exploit weak access control to View another employee\u0027s profile. Verify the access."},"loc":{"start":{"line":160},"end":{"line":161}}},"loc":{"start":{"line":160},"end":{"line":161}}}],"loc":{"start":{"line":159},"end":{"line":162}}},"alternate":{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":163},"end":{"line":163}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":163},"end":{"line":163}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":163},"end":{"line":163}}}],"loc":{"start":{"line":163},"end":{"line":163}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"instructions","loc":{"start":{"line":165},"end":{"line":165}}},"right":{"type":"Literal","value":"Stage 4: Add Data Layer Access Control.\u003cbr\u003e\u003cbr /\u003e\u003cb\u003e\u003cfont color\u003d\"blue\"\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr /\u003e\u003cbr /\u003eImplement a fix to deny unauthorized access to this data. Once you have done this, repeat stage 3, and verify that access to other employee\u0027s profiles is properly denied.","raw":"Stage 4: Add Data Layer Access Control.\u003cbr\u003e\u003cbr /\u003e\u003cb\u003e\u003cfont color\u003d\"blue\"\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr /\u003e\u003cbr /\u003eImplement a fix to deny unauthorized access to this data. Once you have done this, repeat stage 3, and verify that access to other employee\u0027s profiles is properly denied."},"loc":{"start":{"line":165},"end":{"line":168}}},"loc":{"start":{"line":165},"end":{"line":168}}}],"loc":{"start":{"line":164},"end":{"line":169}}},"loc":{"start":{"line":163},"end":{"line":169}}},"loc":{"start":{"line":158},"end":{"line":169}}},"loc":{"start":{"line":150},"end":{"line":169}}},"loc":{"start":{"line":143},"end":{"line":169}}}],"loc":{"start":{"line":141},"end":{"line":170}}},"loc":{"start":{"line":140},"end":{"line":170}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"instructions","loc":{"start":{"line":172},"end":{"line":172}}},"loc":{"start":{"line":172},"end":{"line":172}}}],"loc":{"start":{"line":137},"end":{"line":173}}},"code":"\npublic String getInstructions(WebSession s) {\n    String instructions \u003d \"\";\n    if (!getLessonTracker(s).getCompleted()) {\n        String stage \u003d getStage(s);\n        if (STAGE1.equals(stage)) {\n            instructions \u003d \"Stage 1: Bypass Presentational Layer Access Control.\u003cbr /\u003eAs regular employee \\\u0027Tom\\\u0027, exploit weak access control to use the Delete function from the Staff List page. Verify that Tom\\\u0027s profile can be deleted. The passwords for users are their given names in lowercase (e.g. the password for Tom Cat is \\\"tom\\\").\";\n        } else if (STAGE2.equals(stage)) {\n            instructions \u003d \"Stage 2: Add Business Layer Access Control.\u003cbr\u003e\u003cbr /\u003e\u003cb\u003e\u003cfont color\u003d\\\"blue\\\"\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr /\u003e\u003cbr /\u003eImplement a fix to deny unauthorized access to the Delete function. To do this, you will have to alter the WebGoat code. Once you have done this, repeat stage 1 and verify that access to DeleteProfile functionality is properly denied.\";\n        } else if (STAGE3.equals(stage)) {\n            instructions \u003d \"Stage 3: Breaking Data Layer Access Control.\u003cbr /\u003eAs regular employee \\\u0027Tom\\\u0027, exploit weak access control to View another employee\\\u0027s profile. Verify the access.\";\n        } else if (STAGE4.equals(stage)) {\n            instructions \u003d \"Stage 4: Add Data Layer Access Control.\u003cbr\u003e\u003cbr /\u003e\u003cb\u003e\u003cfont color\u003d\\\"blue\\\"\u003e THIS LESSON ONLY WORKS WITH THE DEVELOPER VERSION OF WEBGOAT\u003c/font\u003e\u003c/b\u003e\u003cbr /\u003e\u003cbr /\u003eImplement a fix to deny unauthorized access to this data. Once you have done this, repeat stage 3, and verify that access to other employee\\\u0027s profiles is properly denied.\";\n        }\n    }\n    return instructions;\n}","loc":{"start":{"line":136},"end":{"line":173}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getLessonSolutionFileName"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":175},"end":{"line":175}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":175},"end":{"line":175}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"solutionFileName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":177},"end":{"line":177}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":177},"end":{"line":177}}},"init":{"type":"Literal"},"loc":{"start":{"line":177},"end":{"line":177}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":178},"end":{"line":178}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":178},"end":{"line":178}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":178},"end":{"line":178}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":178},"end":{"line":178}}}],"loc":{"start":{"line":178},"end":{"line":178}}},"loc":{"start":{"line":178},"end":{"line":178}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"solutionFileName","loc":{"start":{"line":179},"end":{"line":179}}},"right":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"/lesson_solutions/Lab Access Control/Lab ","raw":"/lesson_solutions/Lab Access Control/Lab "},"right":{"type":"Identifier","name":"stage","loc":{"start":{"line":179},"end":{"line":179}}},"loc":{"start":{"line":179},"end":{"line":179}}},"right":{"type":"Literal","value":".html","raw":".html"},"loc":{"start":{"line":179},"end":{"line":179}}},"loc":{"start":{"line":179},"end":{"line":179}}},"loc":{"start":{"line":179},"end":{"line":179}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"solutionFileName","loc":{"start":{"line":180},"end":{"line":180}}},"loc":{"start":{"line":180},"end":{"line":180}}}],"loc":{"start":{"line":176},"end":{"line":181}}},"code":"\npublic String getLessonSolutionFileName(WebSession s) {\n    String solutionFileName \u003d null;\n    String stage \u003d getStage(s);\n    solutionFileName \u003d \"/lesson_solutions/Lab Access Control/Lab \" + stage + \".html\";\n    return solutionFileName;\n}","loc":{"start":{"line":175},"end":{"line":181}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSolution"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[{"type":"Annotation","annotationType":{"type":"Identifier","name":"Override","loc":{"start":{"line":183},"end":{"line":183}}},"arguments":[]}]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":184},"end":{"line":184}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":184},"end":{"line":184}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"src","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":186},"end":{"line":186}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":186},"end":{"line":186}}},"init":{"type":"Literal"},"loc":{"start":{"line":186},"end":{"line":186}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"IOException","loc":{"start":{"line":192},"end":{"line":192}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":194},"end":{"line":194}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":194},"end":{"line":194}}},"arguments":[{"type":"Literal","value":"Could not find the solution file","raw":"Could not find the solution file"}],"loc":{"start":{"line":194},"end":{"line":194}}},"loc":{"start":{"line":194},"end":{"line":194}}},{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"src","loc":{"start":{"line":195},"end":{"line":195}}},"right":{"type":"Literal","value":"Could not find the solution file","raw":"Could not find the solution file"},"loc":{"start":{"line":195},"end":{"line":195}}},"loc":{"start":{"line":195},"end":{"line":195}}}],"loc":{"start":{"line":193},"end":{"line":196}}},"loc":{"start":{"line":192},"end":{"line":196}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"src","loc":{"start":{"line":190},"end":{"line":190}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"readFromFile","loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"BufferedReader","loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"FileReader","loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":190},"end":{"line":190}}},"property":{"type":"Identifier","name":"getWebResource"},"loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonSolutionFileName","loc":{"start":{"line":190},"end":{"line":190}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":190},"end":{"line":190}}}],"loc":{"start":{"line":190},"end":{"line":190}}}],"loc":{"start":{"line":190},"end":{"line":190}}}],"loc":{"start":{"line":190},"end":{"line":190}}}],"loc":{"start":{"line":190},"end":{"line":190}}},{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":190},"end":{"line":191}}},"loc":{"start":{"line":190},"end":{"line":191}}},"loc":{"start":{"line":190},"end":{"line":191}}}],"loc":{"start":{"line":189},"end":{"line":192}}},"loc":{"start":{"line":188},"end":{"line":196}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"src","loc":{"start":{"line":197},"end":{"line":197}}},"loc":{"start":{"line":197},"end":{"line":197}}}],"loc":{"start":{"line":185},"end":{"line":198}}},"code":"\n@Override()\npublic String getSolution(WebSession s) {\n    String src \u003d null;\n    try {\n        src \u003d readFromFile(new BufferedReader(new FileReader(s.getWebResource(getLessonSolutionFileName(s)))), false);\n    } catch (IOException e) {\n        s.setMessage(\"Could not find the solution file\");\n        src \u003d (\"Could not find the solution file\");\n    }\n    return src;\n}","loc":{"start":{"line":183},"end":{"line":198}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"handleRequest"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":200},"end":{"line":200}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":206},"end":{"line":206}}},"property":{"type":"Identifier","name":"getLessonSession"},"loc":{"start":{"line":206},"end":{"line":206}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":206},"end":{"line":206}}},"right":{"type":"Literal"},"loc":{"start":{"line":206},"end":{"line":206}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":206},"end":{"line":206}}},"property":{"type":"Identifier","name":"openLessonSession"},"loc":{"start":{"line":206},"end":{"line":206}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":206},"end":{"line":206}}},"loc":{"start":{"line":206},"end":{"line":206}}},"loc":{"start":{"line":206},"end":{"line":206}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"requestedActionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":208},"end":{"line":208}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":208},"end":{"line":208}}},"init":{"type":"Literal"},"loc":{"start":{"line":208},"end":{"line":208}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":212},"end":{"line":212}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":215},"end":{"line":215}}},"right":{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":215},"end":{"line":215}}},"loc":{"start":{"line":215},"end":{"line":215}}},"loc":{"start":{"line":215},"end":{"line":215}}}],"loc":{"start":{"line":213},"end":{"line":216}}},"loc":{"start":{"line":212},"end":{"line":216}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":211},"end":{"line":211}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":211},"end":{"line":211}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":211},"end":{"line":211}}},"arguments":[],"loc":{"start":{"line":211},"end":{"line":211}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":211},"end":{"line":211}}},"arguments":[{"type":"Literal","value":"action","raw":"action"}],"loc":{"start":{"line":211},"end":{"line":211}}},"loc":{"start":{"line":211},"end":{"line":211}}},"loc":{"start":{"line":211},"end":{"line":211}}}],"loc":{"start":{"line":210},"end":{"line":212}}},"loc":{"start":{"line":209},"end":{"line":216}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":246},"end":{"line":246}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pnfe","loc":{"start":{"line":249},"end":{"line":249}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":249},"end":{"line":249}}},"arguments":[],"loc":{"start":{"line":249},"end":{"line":249}}},"loc":{"start":{"line":249},"end":{"line":249}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":250},"end":{"line":250}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":250},"end":{"line":250}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":250},"end":{"line":250}}}],"loc":{"start":{"line":250},"end":{"line":250}}},"loc":{"start":{"line":250},"end":{"line":250}}}],"loc":{"start":{"line":247},"end":{"line":251}}},"loc":{"start":{"line":246},"end":{"line":251}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ve","vartype":{"type":"Identifier","name":"ValidationException","loc":{"start":{"line":251},"end":{"line":251}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ve","loc":{"start":{"line":254},"end":{"line":254}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":254},"end":{"line":254}}},"arguments":[],"loc":{"start":{"line":254},"end":{"line":254}}},"loc":{"start":{"line":254},"end":{"line":254}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":255},"end":{"line":255}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":255},"end":{"line":255}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":255},"end":{"line":255}}}],"loc":{"start":{"line":255},"end":{"line":255}}},"loc":{"start":{"line":255},"end":{"line":255}}}],"loc":{"start":{"line":252},"end":{"line":256}}},"loc":{"start":{"line":251},"end":{"line":256}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue","vartype":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":256},"end":{"line":256}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":258},"end":{"line":258}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":258},"end":{"line":258}}},"arguments":[{"type":"Literal","value":"Login failed","raw":"Login failed"}],"loc":{"start":{"line":258},"end":{"line":258}}},"loc":{"start":{"line":258},"end":{"line":258}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue","loc":{"start":{"line":260},"end":{"line":260}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":260},"end":{"line":260}}},"arguments":[],"loc":{"start":{"line":260},"end":{"line":260}}},"loc":{"start":{"line":260},"end":{"line":260}}}],"loc":{"start":{"line":257},"end":{"line":261}}},"loc":{"start":{"line":256},"end":{"line":261}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue2","vartype":{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":261},"end":{"line":261}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":263},"end":{"line":263}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":263},"end":{"line":263}}},"arguments":[{"type":"Literal","value":"You are not authorized to perform this function","raw":"You are not authorized to perform this function"}],"loc":{"start":{"line":263},"end":{"line":263}}},"loc":{"start":{"line":263},"end":{"line":263}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":266},"end":{"line":266}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":266},"end":{"line":266}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":266},"end":{"line":266}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":266},"end":{"line":266}}}],"loc":{"start":{"line":266},"end":{"line":266}}},"loc":{"start":{"line":266},"end":{"line":266}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":267},"end":{"line":267}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":267},"end":{"line":267}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":267},"end":{"line":267}}}],"loc":{"start":{"line":267},"end":{"line":267}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":276},"end":{"line":276}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pnfe","loc":{"start":{"line":278},"end":{"line":278}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":278},"end":{"line":278}}},"arguments":[],"loc":{"start":{"line":278},"end":{"line":278}}},"loc":{"start":{"line":278},"end":{"line":278}}}],"loc":{"start":{"line":277},"end":{"line":279}}},"loc":{"start":{"line":276},"end":{"line":279}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":271},"end":{"line":271}}},"property":{"type":"Identifier","name":"DELETEPROFILE_ACTION"},"loc":{"start":{"line":271},"end":{"line":271}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":271},"end":{"line":271}}},"arguments":[{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":271},"end":{"line":271}}}],"loc":{"start":{"line":271},"end":{"line":271}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"isAuthorized","loc":{"start":{"line":272},"end":{"line":272}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":272},"end":{"line":272}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getUserId","loc":{"start":{"line":272},"end":{"line":272}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":272},"end":{"line":272}}}],"loc":{"start":{"line":272},"end":{"line":272}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":272},"end":{"line":272}}},"property":{"type":"Identifier","name":"DELETEPROFILE_ACTION"},"loc":{"start":{"line":272},"end":{"line":272}}}],"loc":{"start":{"line":272},"end":{"line":272}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":272},"end":{"line":272}}},"loc":{"start":{"line":271},"end":{"line":272}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setStageComplete","loc":{"start":{"line":274},"end":{"line":274}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":274},"end":{"line":274}}},{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":274},"end":{"line":274}}}],"loc":{"start":{"line":274},"end":{"line":274}}},"loc":{"start":{"line":274},"end":{"line":274}}}],"loc":{"start":{"line":273},"end":{"line":275}}},"loc":{"start":{"line":271},"end":{"line":275}}}],"loc":{"start":{"line":270},"end":{"line":276}}},"loc":{"start":{"line":269},"end":{"line":279}}}],"loc":{"start":{"line":268},"end":{"line":280}}},"loc":{"start":{"line":267},"end":{"line":280}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":283},"end":{"line":283}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":283},"end":{"line":283}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":283},"end":{"line":283}}}],"loc":{"start":{"line":283},"end":{"line":283}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":297},"end":{"line":297}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":298},"end":{"line":301}}},"loc":{"start":{"line":297},"end":{"line":301}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"action","vartype":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":288},"end":{"line":288}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":288},"end":{"line":288}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":288},"end":{"line":288}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":288},"end":{"line":288}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getCurrentAction","loc":{"start":{"line":288},"end":{"line":288}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":288},"end":{"line":288}}}],"loc":{"start":{"line":288},"end":{"line":288}}}],"loc":{"start":{"line":288},"end":{"line":288}}},"loc":{"start":{"line":288},"end":{"line":288}}},"loc":{"start":{"line":288},"end":{"line":288}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Integer","loc":{"start":{"line":289},"end":{"line":289}}},"property":{"type":"Identifier","name":"parseInt"},"loc":{"start":{"line":289},"end":{"line":289}}},"arguments":[{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":289},"end":{"line":289}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":289},"end":{"line":289}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":289},"end":{"line":289}}},"arguments":[],"loc":{"start":{"line":289},"end":{"line":289}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":289},"end":{"line":289}}},"arguments":[],"loc":{"start":{"line":289},"end":{"line":289}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":289},"end":{"line":290}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonName","loc":{"start":{"line":290},"end":{"line":290}}},"arguments":[],"loc":{"start":{"line":290},"end":{"line":290}}},"right":{"type":"Literal","value":".","raw":"."},"loc":{"start":{"line":290},"end":{"line":290}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":290},"end":{"line":290}}},"property":{"type":"Identifier","name":"USER_ID"},"loc":{"start":{"line":290},"end":{"line":290}}},"loc":{"start":{"line":290},"end":{"line":290}}}],"loc":{"start":{"line":289},"end":{"line":290}}},"loc":{"start":{"line":289},"end":{"line":290}}}],"loc":{"start":{"line":289},"end":{"line":290}}},"loc":{"start":{"line":289},"end":{"line":290}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"employeeId","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":291},"end":{"line":291}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":291},"end":{"line":291}}},"arguments":[],"loc":{"start":{"line":291},"end":{"line":291}}},"property":{"type":"Identifier","name":"getIntParameter"},"loc":{"start":{"line":291},"end":{"line":291}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":291},"end":{"line":291}}},"property":{"type":"Identifier","name":"EMPLOYEE_ID"},"loc":{"start":{"line":291},"end":{"line":291}}}],"loc":{"start":{"line":291},"end":{"line":291}}},"loc":{"start":{"line":291},"end":{"line":291}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":293},"end":{"line":293}}},"property":{"type":"Identifier","name":"isAuthorizedForEmployee"},"loc":{"start":{"line":293},"end":{"line":293}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":293},"end":{"line":293}}},{"type":"Identifier","name":"userId","loc":{"start":{"line":293},"end":{"line":293}}},{"type":"Identifier","name":"employeeId","loc":{"start":{"line":293},"end":{"line":293}}}],"loc":{"start":{"line":293},"end":{"line":293}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":293},"end":{"line":293}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setStageComplete","loc":{"start":{"line":295},"end":{"line":295}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":295},"end":{"line":295}}},{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":295},"end":{"line":295}}}],"loc":{"start":{"line":295},"end":{"line":295}}},"loc":{"start":{"line":295},"end":{"line":295}}}],"loc":{"start":{"line":294},"end":{"line":296}}},"loc":{"start":{"line":293},"end":{"line":296}}}],"loc":{"start":{"line":286},"end":{"line":297}}},"loc":{"start":{"line":285},"end":{"line":301}}}],"loc":{"start":{"line":284},"end":{"line":302}}},"loc":{"start":{"line":283},"end":{"line":302}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":305},"end":{"line":305}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":305},"end":{"line":305}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":305},"end":{"line":305}}}],"loc":{"start":{"line":305},"end":{"line":305}}},"loc":{"start":{"line":305},"end":{"line":305}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue2","loc":{"start":{"line":306},"end":{"line":306}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":306},"end":{"line":306}}},"arguments":[],"loc":{"start":{"line":306},"end":{"line":306}}},"loc":{"start":{"line":306},"end":{"line":306}}}],"loc":{"start":{"line":262},"end":{"line":307}}},"loc":{"start":{"line":261},"end":{"line":307}}},{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":307},"end":{"line":307}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":311},"end":{"line":311}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":311},"end":{"line":311}}},"arguments":[],"loc":{"start":{"line":311},"end":{"line":311}}},"loc":{"start":{"line":311},"end":{"line":311}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":312},"end":{"line":312}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":312},"end":{"line":312}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":312},"end":{"line":312}}}],"loc":{"start":{"line":312},"end":{"line":312}}},"loc":{"start":{"line":312},"end":{"line":312}}}],"loc":{"start":{"line":308},"end":{"line":313}}},"loc":{"start":{"line":307},"end":{"line":313}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"action","vartype":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":221},"end":{"line":221}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":221},"end":{"line":221}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":221},"end":{"line":221}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":221},"end":{"line":221}}},"arguments":[{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":221},"end":{"line":221}}}],"loc":{"start":{"line":221},"end":{"line":221}}},"loc":{"start":{"line":221},"end":{"line":221}}},"loc":{"start":{"line":221},"end":{"line":221}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"action","loc":{"start":{"line":222},"end":{"line":222}}},"right":{"type":"Literal"},"loc":{"start":{"line":222},"end":{"line":222}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":226},"end":{"line":226}}},"property":{"type":"Identifier","name":"requiresAuthentication"},"loc":{"start":{"line":226},"end":{"line":226}}},"arguments":[],"loc":{"start":{"line":226},"end":{"line":226}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":226},"end":{"line":226}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":229},"end":{"line":229}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":229},"end":{"line":229}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":229},"end":{"line":229}}}],"loc":{"start":{"line":229},"end":{"line":229}}},"loc":{"start":{"line":229},"end":{"line":229}}}],"loc":{"start":{"line":227},"end":{"line":230}}},"alternate":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":236},"end":{"line":236}}},"property":{"type":"Identifier","name":"isAuthenticated"},"loc":{"start":{"line":236},"end":{"line":236}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":236},"end":{"line":236}}}],"loc":{"start":{"line":236},"end":{"line":236}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":238},"end":{"line":238}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":238},"end":{"line":238}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":238},"end":{"line":238}}}],"loc":{"start":{"line":238},"end":{"line":238}}},"loc":{"start":{"line":238},"end":{"line":238}}}],"loc":{"start":{"line":237},"end":{"line":239}}},"alternate":{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":241},"end":{"line":241}}},"arguments":[],"loc":{"start":{"line":241},"end":{"line":241}}},"loc":{"start":{"line":241},"end":{"line":241}}},"loc":{"start":{"line":236},"end":{"line":241}}}],"loc":{"start":{"line":232},"end":{"line":242}}},"loc":{"start":{"line":226},"end":{"line":242}}}],"loc":{"start":{"line":223},"end":{"line":243}}},"alternate":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":245},"end":{"line":245}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":245},"end":{"line":245}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":245},"end":{"line":245}}}],"loc":{"start":{"line":245},"end":{"line":245}}},"loc":{"start":{"line":245},"end":{"line":245}}},"loc":{"start":{"line":222},"end":{"line":245}}}],"loc":{"start":{"line":220},"end":{"line":246}}},"loc":{"start":{"line":219},"end":{"line":313}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setContent","loc":{"start":{"line":316},"end":{"line":316}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":316},"end":{"line":316}}},"arguments":[],"loc":{"start":{"line":316},"end":{"line":316}}}],"loc":{"start":{"line":316},"end":{"line":316}}},"loc":{"start":{"line":316},"end":{"line":316}}}],"loc":{"start":{"line":201},"end":{"line":317}}},"code":"\npublic void handleRequest(WebSession s) {\n    if (s.getLessonSession(this) \u003d\u003d null) s.openLessonSession(this);\n    String requestedActionName \u003d null;\n    try {\n        requestedActionName \u003d s.getParser().getStringParameter(\"action\");\n    } catch (ParameterNotFoundException pnfe) {\n        requestedActionName \u003d LOGIN_ACTION;\n    }\n    try {\n        DefaultLessonAction action \u003d (DefaultLessonAction)getAction(requestedActionName);\n        if (action !\u003d null) {\n            if (!action.requiresAuthentication()) {\n                action.handleRequest(s);\n            } else {\n                if (action.isAuthenticated(s)) {\n                    action.handleRequest(s);\n                } else throw new UnauthenticatedException();\n            }\n        } else setCurrentAction(s, ERROR_ACTION);\n    } catch (ParameterNotFoundException pnfe) {\n        pnfe.printStackTrace();\n        setCurrentAction(s, ERROR_ACTION);\n    } catch (ValidationException ve) {\n        ve.printStackTrace();\n        setCurrentAction(s, ERROR_ACTION);\n    } catch (UnauthenticatedException ue) {\n        s.setMessage(\"Login failed\");\n        ue.printStackTrace();\n    } catch (UnauthorizedException ue2) {\n        s.setMessage(\"You are not authorized to perform this function\");\n        String stage \u003d getStage(s);\n        if (STAGE2.equals(stage)) {\n            try {\n                if (RoleBasedAccessControl.DELETEPROFILE_ACTION.equals(requestedActionName) \u0026\u0026 !isAuthorized(s, getUserId(s), RoleBasedAccessControl.DELETEPROFILE_ACTION)) {\n                    setStageComplete(s, STAGE2);\n                }\n            } catch (ParameterNotFoundException pnfe) {\n                pnfe.printStackTrace();\n            }\n        }\n        if (STAGE4.equals(stage)) {\n            try {\n                DefaultLessonAction action \u003d (DefaultLessonAction)getAction(getCurrentAction(s));\n                int userId \u003d Integer.parseInt((String)s.getRequest().getSession().getAttribute(getLessonName() + \".\" + RoleBasedAccessControl.USER_ID));\n                int employeeId \u003d s.getParser().getIntParameter(RoleBasedAccessControl.EMPLOYEE_ID);\n                if (!action.isAuthorizedForEmployee(s, userId, employeeId)) {\n                    setStageComplete(s, STAGE4);\n                }\n            } catch (Exception e) {\n            }\n        }\n        setCurrentAction(s, ERROR_ACTION);\n        ue2.printStackTrace();\n    } catch (Exception e) {\n        e.printStackTrace();\n        setCurrentAction(s, ERROR_ACTION);\n    }\n    setContent(new ElementContainer());\n}","loc":{"start":{"line":200},"end":{"line":317}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"handleRequest_BACKUP"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":319},"end":{"line":319}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"getLessonSession"},"loc":{"start":{"line":325},"end":{"line":325}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":325},"end":{"line":325}}},"right":{"type":"Literal"},"loc":{"start":{"line":325},"end":{"line":325}}},"consequent":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":325},"end":{"line":325}}},"property":{"type":"Identifier","name":"openLessonSession"},"loc":{"start":{"line":325},"end":{"line":325}}},"arguments":[{"type":"ThisExpression"}],"loc":{"start":{"line":325},"end":{"line":325}}},"loc":{"start":{"line":325},"end":{"line":325}}},"loc":{"start":{"line":325},"end":{"line":325}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"requestedActionName","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":327},"end":{"line":327}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":327},"end":{"line":327}}},"init":{"type":"Literal"},"loc":{"start":{"line":327},"end":{"line":327}}},{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":331},"end":{"line":331}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":334},"end":{"line":334}}},"right":{"type":"Identifier","name":"LOGIN_ACTION","loc":{"start":{"line":334},"end":{"line":334}}},"loc":{"start":{"line":334},"end":{"line":334}}},"loc":{"start":{"line":334},"end":{"line":334}}}],"loc":{"start":{"line":332},"end":{"line":335}}},"loc":{"start":{"line":331},"end":{"line":335}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":330},"end":{"line":330}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":330},"end":{"line":330}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":330},"end":{"line":330}}},"arguments":[],"loc":{"start":{"line":330},"end":{"line":330}}},"property":{"type":"Identifier","name":"getStringParameter"},"loc":{"start":{"line":330},"end":{"line":330}}},"arguments":[{"type":"Literal","value":"action","raw":"action"}],"loc":{"start":{"line":330},"end":{"line":330}}},"loc":{"start":{"line":330},"end":{"line":330}}},"loc":{"start":{"line":330},"end":{"line":330}}}],"loc":{"start":{"line":329},"end":{"line":331}}},"loc":{"start":{"line":328},"end":{"line":335}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":338},"end":{"line":338}}},"right":{"type":"Literal"},"loc":{"start":{"line":338},"end":{"line":338}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":372},"end":{"line":372}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pnfe","loc":{"start":{"line":375},"end":{"line":375}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":375},"end":{"line":375}}},"arguments":[],"loc":{"start":{"line":375},"end":{"line":375}}},"loc":{"start":{"line":375},"end":{"line":375}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":376},"end":{"line":376}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":376},"end":{"line":376}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":376},"end":{"line":376}}}],"loc":{"start":{"line":376},"end":{"line":376}}},"loc":{"start":{"line":376},"end":{"line":376}}}],"loc":{"start":{"line":373},"end":{"line":377}}},"loc":{"start":{"line":372},"end":{"line":377}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ve","vartype":{"type":"Identifier","name":"ValidationException","loc":{"start":{"line":377},"end":{"line":377}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ve","loc":{"start":{"line":380},"end":{"line":380}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":380},"end":{"line":380}}},"arguments":[],"loc":{"start":{"line":380},"end":{"line":380}}},"loc":{"start":{"line":380},"end":{"line":380}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":381},"end":{"line":381}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":381},"end":{"line":381}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":381},"end":{"line":381}}}],"loc":{"start":{"line":381},"end":{"line":381}}},"loc":{"start":{"line":381},"end":{"line":381}}}],"loc":{"start":{"line":378},"end":{"line":382}}},"loc":{"start":{"line":377},"end":{"line":382}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue","vartype":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":382},"end":{"line":382}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":384},"end":{"line":384}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":384},"end":{"line":384}}},"arguments":[{"type":"Literal","value":"Login failed","raw":"Login failed"}],"loc":{"start":{"line":384},"end":{"line":384}}},"loc":{"start":{"line":384},"end":{"line":384}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue","loc":{"start":{"line":386},"end":{"line":386}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":386},"end":{"line":386}}},"arguments":[],"loc":{"start":{"line":386},"end":{"line":386}}},"loc":{"start":{"line":386},"end":{"line":386}}}],"loc":{"start":{"line":383},"end":{"line":387}}},"loc":{"start":{"line":382},"end":{"line":387}}},{"type":"CatchClause","param":{"type":"Identifier","name":"ue2","vartype":{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":387},"end":{"line":387}}}},"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"stage","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":389},"end":{"line":389}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":389},"end":{"line":389}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getStage","loc":{"start":{"line":389},"end":{"line":389}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":389},"end":{"line":389}}}],"loc":{"start":{"line":389},"end":{"line":389}}},"loc":{"start":{"line":389},"end":{"line":389}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":391},"end":{"line":391}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":391},"end":{"line":391}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":391},"end":{"line":391}}}],"loc":{"start":{"line":391},"end":{"line":391}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"pnfe","vartype":{"type":"Identifier","name":"ParameterNotFoundException","loc":{"start":{"line":400},"end":{"line":400}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"pnfe","loc":{"start":{"line":402},"end":{"line":402}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":402},"end":{"line":402}}},"arguments":[],"loc":{"start":{"line":402},"end":{"line":402}}},"loc":{"start":{"line":402},"end":{"line":402}}}],"loc":{"start":{"line":401},"end":{"line":403}}},"loc":{"start":{"line":400},"end":{"line":403}}}],"block":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_AND","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":395},"end":{"line":395}}},"property":{"type":"Identifier","name":"DELETEPROFILE_ACTION"},"loc":{"start":{"line":395},"end":{"line":395}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":395},"end":{"line":395}}},"arguments":[{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":395},"end":{"line":395}}}],"loc":{"start":{"line":395},"end":{"line":395}}},"right":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"isAuthorized","loc":{"start":{"line":396},"end":{"line":396}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":396},"end":{"line":396}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getUserId","loc":{"start":{"line":396},"end":{"line":396}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":396},"end":{"line":396}}}],"loc":{"start":{"line":396},"end":{"line":396}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":396},"end":{"line":396}}},"property":{"type":"Identifier","name":"DELETEPROFILE_ACTION"},"loc":{"start":{"line":396},"end":{"line":396}}}],"loc":{"start":{"line":396},"end":{"line":396}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":396},"end":{"line":396}}},"loc":{"start":{"line":395},"end":{"line":396}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setStageComplete","loc":{"start":{"line":398},"end":{"line":398}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":398},"end":{"line":398}}},{"type":"Identifier","name":"STAGE2","loc":{"start":{"line":398},"end":{"line":398}}}],"loc":{"start":{"line":398},"end":{"line":398}}},"loc":{"start":{"line":398},"end":{"line":398}}}],"loc":{"start":{"line":397},"end":{"line":399}}},"loc":{"start":{"line":395},"end":{"line":399}}}],"loc":{"start":{"line":394},"end":{"line":400}}},"loc":{"start":{"line":393},"end":{"line":403}}}],"loc":{"start":{"line":392},"end":{"line":404}}},"loc":{"start":{"line":391},"end":{"line":404}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":407},"end":{"line":407}}},"property":{"type":"Identifier","name":"equals"},"loc":{"start":{"line":407},"end":{"line":407}}},"arguments":[{"type":"Identifier","name":"stage","loc":{"start":{"line":407},"end":{"line":407}}}],"loc":{"start":{"line":407},"end":{"line":407}}},"consequent":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":421},"end":{"line":421}}}},"body":{"type":"BlockStatement","body":[],"loc":{"start":{"line":422},"end":{"line":425}}},"loc":{"start":{"line":421},"end":{"line":425}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"action","vartype":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":412},"end":{"line":412}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":412},"end":{"line":412}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"DefaultLessonAction","loc":{"start":{"line":412},"end":{"line":412}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":412},"end":{"line":412}}},"arguments":[{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getCurrentAction","loc":{"start":{"line":412},"end":{"line":412}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":412},"end":{"line":412}}}],"loc":{"start":{"line":412},"end":{"line":412}}}],"loc":{"start":{"line":412},"end":{"line":412}}},"loc":{"start":{"line":412},"end":{"line":412}}},"loc":{"start":{"line":412},"end":{"line":412}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"Integer","loc":{"start":{"line":413},"end":{"line":413}}},"property":{"type":"Identifier","name":"parseInt"},"loc":{"start":{"line":413},"end":{"line":413}}},"arguments":[{"type":"TypeCast","clazz":{"type":"Identifier","name":"String","loc":{"start":{"line":413},"end":{"line":413}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":413},"end":{"line":413}}},"property":{"type":"Identifier","name":"getRequest"},"loc":{"start":{"line":413},"end":{"line":413}}},"arguments":[],"loc":{"start":{"line":413},"end":{"line":413}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":413},"end":{"line":413}}},"arguments":[],"loc":{"start":{"line":413},"end":{"line":413}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":413},"end":{"line":414}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getLessonName","loc":{"start":{"line":414},"end":{"line":414}}},"arguments":[],"loc":{"start":{"line":414},"end":{"line":414}}},"right":{"type":"Literal","value":".","raw":"."},"loc":{"start":{"line":414},"end":{"line":414}}},"right":{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":414},"end":{"line":414}}},"property":{"type":"Identifier","name":"USER_ID"},"loc":{"start":{"line":414},"end":{"line":414}}},"loc":{"start":{"line":414},"end":{"line":414}}}],"loc":{"start":{"line":413},"end":{"line":414}}},"loc":{"start":{"line":413},"end":{"line":414}}}],"loc":{"start":{"line":413},"end":{"line":414}}},"loc":{"start":{"line":413},"end":{"line":414}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"employeeId","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":415},"end":{"line":415}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":415},"end":{"line":415}}},"arguments":[],"loc":{"start":{"line":415},"end":{"line":415}}},"property":{"type":"Identifier","name":"getIntParameter"},"loc":{"start":{"line":415},"end":{"line":415}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"RoleBasedAccessControl","loc":{"start":{"line":415},"end":{"line":415}}},"property":{"type":"Identifier","name":"EMPLOYEE_ID"},"loc":{"start":{"line":415},"end":{"line":415}}}],"loc":{"start":{"line":415},"end":{"line":415}}},"loc":{"start":{"line":415},"end":{"line":415}}},{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":417},"end":{"line":417}}},"property":{"type":"Identifier","name":"isAuthorizedForEmployee"},"loc":{"start":{"line":417},"end":{"line":417}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":417},"end":{"line":417}}},{"type":"Identifier","name":"userId","loc":{"start":{"line":417},"end":{"line":417}}},{"type":"Identifier","name":"employeeId","loc":{"start":{"line":417},"end":{"line":417}}}],"loc":{"start":{"line":417},"end":{"line":417}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":417},"end":{"line":417}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setStageComplete","loc":{"start":{"line":419},"end":{"line":419}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":419},"end":{"line":419}}},{"type":"Identifier","name":"STAGE4","loc":{"start":{"line":419},"end":{"line":419}}}],"loc":{"start":{"line":419},"end":{"line":419}}},"loc":{"start":{"line":419},"end":{"line":419}}}],"loc":{"start":{"line":418},"end":{"line":420}}},"loc":{"start":{"line":417},"end":{"line":420}}}],"loc":{"start":{"line":410},"end":{"line":421}}},"loc":{"start":{"line":409},"end":{"line":425}}}],"loc":{"start":{"line":408},"end":{"line":426}}},"loc":{"start":{"line":407},"end":{"line":426}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":428},"end":{"line":428}}},"property":{"type":"Identifier","name":"setMessage"},"loc":{"start":{"line":428},"end":{"line":428}}},"arguments":[{"type":"Literal","value":"You are not authorized to perform this function","raw":"You are not authorized to perform this function"}],"loc":{"start":{"line":428},"end":{"line":428}}},"loc":{"start":{"line":428},"end":{"line":428}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":430},"end":{"line":430}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":430},"end":{"line":430}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":430},"end":{"line":430}}}],"loc":{"start":{"line":430},"end":{"line":430}}},"loc":{"start":{"line":430},"end":{"line":430}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"ue2","loc":{"start":{"line":431},"end":{"line":431}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":431},"end":{"line":431}}},"arguments":[],"loc":{"start":{"line":431},"end":{"line":431}}},"loc":{"start":{"line":431},"end":{"line":431}}}],"loc":{"start":{"line":388},"end":{"line":432}}},"loc":{"start":{"line":387},"end":{"line":432}}},{"type":"CatchClause","param":{"type":"Identifier","name":"e","vartype":{"type":"Identifier","name":"Exception","loc":{"start":{"line":432},"end":{"line":432}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"e","loc":{"start":{"line":436},"end":{"line":436}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":436},"end":{"line":436}}},"arguments":[],"loc":{"start":{"line":436},"end":{"line":436}}},"loc":{"start":{"line":436},"end":{"line":436}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":437},"end":{"line":437}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":437},"end":{"line":437}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":437},"end":{"line":437}}}],"loc":{"start":{"line":437},"end":{"line":437}}},"loc":{"start":{"line":437},"end":{"line":437}}}],"loc":{"start":{"line":433},"end":{"line":438}}},"loc":{"start":{"line":432},"end":{"line":438}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"action","vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":342},"end":{"line":342}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"LessonAction","loc":{"start":{"line":342},"end":{"line":342}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getAction","loc":{"start":{"line":342},"end":{"line":342}}},"arguments":[{"type":"Identifier","name":"requestedActionName","loc":{"start":{"line":342},"end":{"line":342}}}],"loc":{"start":{"line":342},"end":{"line":342}}},"loc":{"start":{"line":342},"end":{"line":342}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"action","loc":{"start":{"line":343},"end":{"line":343}}},"right":{"type":"Literal"},"loc":{"start":{"line":343},"end":{"line":343}}},"consequent":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":347},"end":{"line":347}}},"property":{"type":"Identifier","name":"requiresAuthentication"},"loc":{"start":{"line":347},"end":{"line":347}}},"arguments":[],"loc":{"start":{"line":347},"end":{"line":347}}},"operator":"LOGICAL_COMPLEMENT","type":"UnaryExpression","loc":{"start":{"line":347},"end":{"line":347}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":350},"end":{"line":350}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":350},"end":{"line":350}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":350},"end":{"line":350}}}],"loc":{"start":{"line":350},"end":{"line":350}}},"loc":{"start":{"line":350},"end":{"line":350}}}],"loc":{"start":{"line":348},"end":{"line":351}}},"alternate":{"type":"BlockStatement","body":[{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":354},"end":{"line":354}}},"property":{"type":"Identifier","name":"isAuthenticated"},"loc":{"start":{"line":354},"end":{"line":354}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":354},"end":{"line":354}}}],"loc":{"start":{"line":354},"end":{"line":354}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"userId","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":356},"end":{"line":356}}},"property":{"type":"Identifier","name":"getUserId"},"loc":{"start":{"line":356},"end":{"line":356}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":356},"end":{"line":356}}}],"loc":{"start":{"line":356},"end":{"line":356}}},"loc":{"start":{"line":356},"end":{"line":356}}},{"type":"IfStatement","test":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":357},"end":{"line":357}}},"property":{"type":"Identifier","name":"isAuthorized"},"loc":{"start":{"line":357},"end":{"line":357}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":357},"end":{"line":357}}},{"type":"Identifier","name":"userId","loc":{"start":{"line":357},"end":{"line":357}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":357},"end":{"line":357}}},"property":{"type":"Identifier","name":"getActionName"},"loc":{"start":{"line":357},"end":{"line":357}}},"arguments":[],"loc":{"start":{"line":357},"end":{"line":357}}}],"loc":{"start":{"line":357},"end":{"line":357}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"action","loc":{"start":{"line":359},"end":{"line":359}}},"property":{"type":"Identifier","name":"handleRequest"},"loc":{"start":{"line":359},"end":{"line":359}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":359},"end":{"line":359}}}],"loc":{"start":{"line":359},"end":{"line":359}}},"loc":{"start":{"line":359},"end":{"line":359}}}],"loc":{"start":{"line":358},"end":{"line":360}}},"alternate":{"type":"BlockStatement","body":[{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UnauthorizedException","loc":{"start":{"line":363},"end":{"line":363}}},"arguments":[],"loc":{"start":{"line":363},"end":{"line":363}}},"loc":{"start":{"line":363},"end":{"line":363}}}],"loc":{"start":{"line":362},"end":{"line":364}}},"loc":{"start":{"line":357},"end":{"line":364}}}],"loc":{"start":{"line":355},"end":{"line":365}}},"alternate":{"type":"ThrowStatement","argument":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"UnauthenticatedException","loc":{"start":{"line":367},"end":{"line":367}}},"arguments":[],"loc":{"start":{"line":367},"end":{"line":367}}},"loc":{"start":{"line":367},"end":{"line":367}}},"loc":{"start":{"line":354},"end":{"line":367}}}],"loc":{"start":{"line":353},"end":{"line":368}}},"loc":{"start":{"line":347},"end":{"line":368}}}],"loc":{"start":{"line":344},"end":{"line":369}}},"alternate":{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setCurrentAction","loc":{"start":{"line":371},"end":{"line":371}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":371},"end":{"line":371}}},{"type":"Identifier","name":"ERROR_ACTION","loc":{"start":{"line":371},"end":{"line":371}}}],"loc":{"start":{"line":371},"end":{"line":371}}},"loc":{"start":{"line":371},"end":{"line":371}}},"loc":{"start":{"line":343},"end":{"line":371}}}],"loc":{"start":{"line":341},"end":{"line":372}}},"loc":{"start":{"line":340},"end":{"line":438}}}],"loc":{"start":{"line":339},"end":{"line":439}}},"loc":{"start":{"line":338},"end":{"line":439}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"setContent","loc":{"start":{"line":442},"end":{"line":442}}},"arguments":[{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"ElementContainer","loc":{"start":{"line":442},"end":{"line":442}}},"arguments":[],"loc":{"start":{"line":442},"end":{"line":442}}}],"loc":{"start":{"line":442},"end":{"line":442}}},"loc":{"start":{"line":442},"end":{"line":442}}}],"loc":{"start":{"line":320},"end":{"line":443}}},"code":"\npublic void handleRequest_BACKUP(WebSession s) {\n    if (s.getLessonSession(this) \u003d\u003d null) s.openLessonSession(this);\n    String requestedActionName \u003d null;\n    try {\n        requestedActionName \u003d s.getParser().getStringParameter(\"action\");\n    } catch (ParameterNotFoundException pnfe) {\n        requestedActionName \u003d LOGIN_ACTION;\n    }\n    if (requestedActionName !\u003d null) {\n        try {\n            LessonAction action \u003d getAction(requestedActionName);\n            if (action !\u003d null) {\n                if (!action.requiresAuthentication()) {\n                    action.handleRequest(s);\n                } else {\n                    if (action.isAuthenticated(s)) {\n                        int userId \u003d action.getUserId(s);\n                        if (action.isAuthorized(s, userId, action.getActionName())) {\n                            action.handleRequest(s);\n                        } else {\n                            throw new UnauthorizedException();\n                        }\n                    } else throw new UnauthenticatedException();\n                }\n            } else setCurrentAction(s, ERROR_ACTION);\n        } catch (ParameterNotFoundException pnfe) {\n            pnfe.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (ValidationException ve) {\n            ve.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        } catch (UnauthenticatedException ue) {\n            s.setMessage(\"Login failed\");\n            ue.printStackTrace();\n        } catch (UnauthorizedException ue2) {\n            String stage \u003d getStage(s);\n            if (STAGE2.equals(stage)) {\n                try {\n                    if (RoleBasedAccessControl.DELETEPROFILE_ACTION.equals(requestedActionName) \u0026\u0026 !isAuthorized(s, getUserId(s), RoleBasedAccessControl.DELETEPROFILE_ACTION)) {\n                        setStageComplete(s, STAGE2);\n                    }\n                } catch (ParameterNotFoundException pnfe) {\n                    pnfe.printStackTrace();\n                }\n            }\n            if (STAGE4.equals(stage)) {\n                try {\n                    DefaultLessonAction action \u003d (DefaultLessonAction)getAction(getCurrentAction(s));\n                    int userId \u003d Integer.parseInt((String)s.getRequest().getSession().getAttribute(getLessonName() + \".\" + RoleBasedAccessControl.USER_ID));\n                    int employeeId \u003d s.getParser().getIntParameter(RoleBasedAccessControl.EMPLOYEE_ID);\n                    if (!action.isAuthorizedForEmployee(s, userId, employeeId)) {\n                        setStageComplete(s, STAGE4);\n                    }\n                } catch (Exception e) {\n                }\n            }\n            s.setMessage(\"You are not authorized to perform this function\");\n            setCurrentAction(s, ERROR_ACTION);\n            ue2.printStackTrace();\n        } catch (Exception e) {\n            e.printStackTrace();\n            setCurrentAction(s, ERROR_ACTION);\n        }\n    }\n    setContent(new ElementContainer());\n}","loc":{"start":{"line":319},"end":{"line":443}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getDefaultRanking"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"Integer","loc":{"start":{"line":445},"end":{"line":445}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Identifier","name":"DEFAULT_RANKING","loc":{"start":{"line":447},"end":{"line":447}}},"loc":{"start":{"line":447},"end":{"line":447}}}],"loc":{"start":{"line":446},"end":{"line":448}}},"code":"\nprotected Integer getDefaultRanking() {\n    return DEFAULT_RANKING;\n}","loc":{"start":{"line":445},"end":{"line":448}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getTitle"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":455},"end":{"line":455}}},"typarams":[],"params":[],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"Literal","value":"LAB: Role Based Access Control","raw":"LAB: Role Based Access Control"},"loc":{"start":{"line":457},"end":{"line":457}}}],"loc":{"start":{"line":456},"end":{"line":458}}},"code":"\npublic String getTitle() {\n    return \"LAB: Role Based Access Control\";\n}","loc":{"start":{"line":455},"end":{"line":458}}}],"loc":{"start":{"line":53},"end":{"line":459}}}],"loc":{"start":{"line":2},"end":{"line":459}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/lessons/RoleBasedAccessControl/RoleBasedAccessControl.java"}