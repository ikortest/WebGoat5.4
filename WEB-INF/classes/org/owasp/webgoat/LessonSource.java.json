{"language":"Java","type":"CompilationUnit","pid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":2},"end":{"line":2}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":2},"end":{"line":2}}},"annotations":[],"definitions":[{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":4},"end":{"line":4}}},"property":{"type":"Identifier","name":"IOException"},"loc":{"start":{"line":4},"end":{"line":4}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"java","loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"io"},"loc":{"start":{"line":5},"end":{"line":5}}},"property":{"type":"Identifier","name":"PrintWriter"},"loc":{"start":{"line":5},"end":{"line":5}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":6},"end":{"line":6}}},"property":{"type":"Identifier","name":"ServletException"},"loc":{"start":{"line":6},"end":{"line":6}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":7},"end":{"line":7}}},"property":{"type":"Identifier","name":"HttpServletRequest"},"loc":{"start":{"line":7},"end":{"line":7}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"javax","loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"servlet"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"http"},"loc":{"start":{"line":8},"end":{"line":8}}},"property":{"type":"Identifier","name":"HttpServletResponse"},"loc":{"start":{"line":8},"end":{"line":8}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"lessons"},"loc":{"start":{"line":9},"end":{"line":9}}},"property":{"type":"Identifier","name":"AbstractLesson"},"loc":{"start":{"line":9},"end":{"line":9}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":10},"end":{"line":10}}},"property":{"type":"Identifier","name":"Course"},"loc":{"start":{"line":10},"end":{"line":10}}}},{"type":"Import","qualid":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"MemberExpression","object":{"type":"Identifier","name":"org","loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"owasp"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"webgoat"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"session"},"loc":{"start":{"line":11},"end":{"line":11}}},"property":{"type":"Identifier","name":"WebSession"},"loc":{"start":{"line":11},"end":{"line":11}}}},{"type":"ClassDeclaration","id":{"type":"Identifier","name":"LessonSource"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"extending":{"type":"Identifier","name":"HammerHead","loc":{"start":{"line":44},"end":{"line":44}}},"definitions":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"serialVersionUID","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":["private","static","final"],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"Literal","value":2588430536196446145,"raw":2588430536196446145},"loc":{"start":{"line":50},"end":{"line":50}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"START_SOURCE_SKIP","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":55},"end":{"line":55}}},"init":{"type":"Literal","value":"START_OMIT_SOURCE","raw":"START_OMIT_SOURCE"},"loc":{"start":{"line":55},"end":{"line":55}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"END_SOURCE_SKIP","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}}},"modifiers":{"type":"Modifiers","modifiers":["public","static","final"],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":57},"end":{"line":57}}},"init":{"type":"Literal","value":"END_OMIT_SOURCE","raw":"END_OMIT_SOURCE"},"loc":{"start":{"line":57},"end":{"line":57}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"doPost"},"modifiers":{"type":"Modifiers","modifiers":["public"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"request","vartype":{"type":"Identifier","name":"HttpServletRequest","loc":{"start":{"line":71},"end":{"line":71}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":71},"end":{"line":71}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":71},"end":{"line":71}}},{"type":"Identifier","name":"ServletException","loc":{"start":{"line":71},"end":{"line":71}}}],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"source","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":73},"end":{"line":73}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":73},"end":{"line":73}}},"init":{"type":"Literal"},"loc":{"start":{"line":73},"end":{"line":73}}},{"type":"TryStatement","finalizer":{"type":"BlockStatement","body":[{"type":"TryStatement","handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"thr","vartype":{"type":"Identifier","name":"Throwable","loc":{"start":{"line":120},"end":{"line":120}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"thr","loc":{"start":{"line":122},"end":{"line":122}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":122},"end":{"line":122}}},"arguments":[],"loc":{"start":{"line":122},"end":{"line":122}}},"loc":{"start":{"line":122},"end":{"line":122}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":123},"end":{"line":123}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":123},"end":{"line":123}}},{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Could not write error screen: ","raw":"Could not write error screen: "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"thr","loc":{"start":{"line":123},"end":{"line":123}}},"property":{"type":"Identifier","name":"getMessage"},"loc":{"start":{"line":123},"end":{"line":123}}},"arguments":[],"loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}}],"loc":{"start":{"line":123},"end":{"line":123}}},"loc":{"start":{"line":123},"end":{"line":123}}}],"loc":{"start":{"line":121},"end":{"line":124}}},"loc":{"start":{"line":120},"end":{"line":124}}}],"block":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"writeSource"},"loc":{"start":{"line":119},"end":{"line":119}}},"arguments":[{"type":"Identifier","name":"source","loc":{"start":{"line":119},"end":{"line":119}}},{"type":"Identifier","name":"response","loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":119},"end":{"line":119}}},"loc":{"start":{"line":119},"end":{"line":119}}}],"loc":{"start":{"line":118},"end":{"line":120}}},"loc":{"start":{"line":117},"end":{"line":124}}}],"loc":{"start":{"line":116},"end":{"line":127}}},"handlers":[{"type":"CatchClause","param":{"type":"Identifier","name":"t","vartype":{"type":"Identifier","name":"Throwable","loc":{"start":{"line":111},"end":{"line":111}}}},"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"t","loc":{"start":{"line":113},"end":{"line":113}}},"property":{"type":"Identifier","name":"printStackTrace"},"loc":{"start":{"line":113},"end":{"line":113}}},"arguments":[],"loc":{"start":{"line":113},"end":{"line":113}}},"loc":{"start":{"line":113},"end":{"line":113}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"log","loc":{"start":{"line":114},"end":{"line":114}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"ERROR: ","raw":"ERROR: "},"right":{"type":"Identifier","name":"t","loc":{"start":{"line":114},"end":{"line":114}}},"loc":{"start":{"line":114},"end":{"line":114}}}],"loc":{"start":{"line":114},"end":{"line":114}}},"loc":{"start":{"line":114},"end":{"line":114}}}],"loc":{"start":{"line":112},"end":{"line":115}}},"loc":{"start":{"line":111},"end":{"line":115}}}],"block":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"session","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":82},"end":{"line":82}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":82},"end":{"line":82}}},"init":{"type":"TypeCast","clazz":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":82},"end":{"line":82}}},"expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"request","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"getSession"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"getAttribute"},"loc":{"start":{"line":82},"end":{"line":82}}},"arguments":[{"type":"MemberExpression","object":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":82},"end":{"line":82}}},"property":{"type":"Identifier","name":"SESSION"},"loc":{"start":{"line":82},"end":{"line":82}}}],"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}},"loc":{"start":{"line":82},"end":{"line":82}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":84},"end":{"line":84}}},"property":{"type":"Identifier","name":"update"},"loc":{"start":{"line":84},"end":{"line":84}}},"arguments":[{"type":"Identifier","name":"request","loc":{"start":{"line":84},"end":{"line":84}}},{"type":"Identifier","name":"response","loc":{"start":{"line":84},"end":{"line":84}}},{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"ThisExpression"},"property":{"type":"Identifier","name":"getServletName"},"loc":{"start":{"line":84},"end":{"line":84}}},"arguments":[],"loc":{"start":{"line":84},"end":{"line":84}}}],"loc":{"start":{"line":84},"end":{"line":84}}},"loc":{"start":{"line":84},"end":{"line":84}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"showSolution","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[],"loc":{"start":{"line":86},"end":{"line":86}}},"property":{"type":"Identifier","name":"getBooleanParameter"},"loc":{"start":{"line":86},"end":{"line":86}}},"arguments":[{"type":"Literal","value":"solution","raw":"solution"},{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":86},"end":{"line":86}}},"loc":{"start":{"line":86},"end":{"line":86}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"showSource","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"getParser"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[],"loc":{"start":{"line":87},"end":{"line":87}}},"property":{"type":"Identifier","name":"getBooleanParameter"},"loc":{"start":{"line":87},"end":{"line":87}}},"arguments":[{"type":"Literal","value":"source","raw":"source"},{"type":"Literal","value":0,"raw":0}],"loc":{"start":{"line":87},"end":{"line":87}}},"loc":{"start":{"line":87},"end":{"line":87}}},{"type":"IfStatement","test":{"type":"Identifier","name":"showSolution","loc":{"start":{"line":88},"end":{"line":88}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"source","loc":{"start":{"line":92},"end":{"line":92}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getSolution","loc":{"start":{"line":92},"end":{"line":92}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":92},"end":{"line":92}}}],"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}},"loc":{"start":{"line":92},"end":{"line":92}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":94},"end":{"line":94}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":94},"end":{"line":94}}},"arguments":[],"loc":{"start":{"line":94},"end":{"line":94}}},"loc":{"start":{"line":94},"end":{"line":94}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":95},"end":{"line":95}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":95},"end":{"line":95}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":95},"end":{"line":95}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":95},"end":{"line":95}}},"arguments":[],"loc":{"start":{"line":95},"end":{"line":95}}},"loc":{"start":{"line":95},"end":{"line":95}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":96},"end":{"line":96}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":96},"end":{"line":96}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":96},"end":{"line":96}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":96},"end":{"line":96}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":96},"end":{"line":96}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":96},"end":{"line":96}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":96},"end":{"line":96}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":96},"end":{"line":96}}}],"loc":{"start":{"line":96},"end":{"line":96}}},"loc":{"start":{"line":96},"end":{"line":96}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":97},"end":{"line":97}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":97},"end":{"line":97}}}],"loc":{"start":{"line":97},"end":{"line":97}}},"property":{"type":"Identifier","name":"setViewedSolution"},"loc":{"start":{"line":97},"end":{"line":97}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":97},"end":{"line":97}}},"loc":{"start":{"line":97},"end":{"line":97}}}],"loc":{"start":{"line":89},"end":{"line":99}}},"alternate":{"type":"IfStatement","test":{"type":"Identifier","name":"showSource","loc":{"start":{"line":100},"end":{"line":100}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"source","loc":{"start":{"line":104},"end":{"line":104}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"Identifier","name":"getSource","loc":{"start":{"line":104},"end":{"line":104}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":104},"end":{"line":104}}}],"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}},"loc":{"start":{"line":104},"end":{"line":104}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":106},"end":{"line":106}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":106},"end":{"line":106}}},"arguments":[],"loc":{"start":{"line":106},"end":{"line":106}}},"loc":{"start":{"line":106},"end":{"line":106}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":107},"end":{"line":107}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":107},"end":{"line":107}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"session","loc":{"start":{"line":107},"end":{"line":107}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":107},"end":{"line":107}}},"arguments":[],"loc":{"start":{"line":107},"end":{"line":107}}},"loc":{"start":{"line":107},"end":{"line":107}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":108},"end":{"line":108}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":108},"end":{"line":108}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":108},"end":{"line":108}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":108},"end":{"line":108}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":108},"end":{"line":108}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":108},"end":{"line":108}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":108},"end":{"line":108}}}],"loc":{"start":{"line":108},"end":{"line":108}}},"loc":{"start":{"line":108},"end":{"line":108}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"getLessonTracker"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Identifier","name":"session","loc":{"start":{"line":109},"end":{"line":109}}}],"loc":{"start":{"line":109},"end":{"line":109}}},"property":{"type":"Identifier","name":"setViewedSource"},"loc":{"start":{"line":109},"end":{"line":109}}},"arguments":[{"type":"Literal","value":1,"raw":1}],"loc":{"start":{"line":109},"end":{"line":109}}},"loc":{"start":{"line":109},"end":{"line":109}}}],"loc":{"start":{"line":101},"end":{"line":110}}},"loc":{"start":{"line":100},"end":{"line":110}}},"loc":{"start":{"line":88},"end":{"line":110}}}],"loc":{"start":{"line":76},"end":{"line":111}}},"loc":{"start":{"line":75},"end":{"line":127}}}],"loc":{"start":{"line":72},"end":{"line":128}}},"code":"\npublic void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    String source \u003d null;\n    try {\n        WebSession session \u003d (WebSession)request.getSession(true).getAttribute(WebSession.SESSION);\n        session.update(request, response, this.getServletName());\n        boolean showSolution \u003d session.getParser().getBooleanParameter(\"solution\", false);\n        boolean showSource \u003d session.getParser().getBooleanParameter(\"source\", false);\n        if (showSolution) {\n            source \u003d getSolution(session);\n            int scr \u003d session.getCurrentScreen();\n            Course course \u003d session.getCourse();\n            AbstractLesson lesson \u003d course.getLesson(session, scr, AbstractLesson.USER_ROLE);\n            lesson.getLessonTracker(session).setViewedSolution(true);\n        } else if (showSource) {\n            source \u003d getSource(session);\n            int scr \u003d session.getCurrentScreen();\n            Course course \u003d session.getCourse();\n            AbstractLesson lesson \u003d course.getLesson(session, scr, AbstractLesson.USER_ROLE);\n            lesson.getLessonTracker(session).setViewedSource(true);\n        }\n    } catch (Throwable t) {\n        t.printStackTrace();\n        log(\"ERROR: \" + t);\n    } finally {\n        try {\n            this.writeSource(source, response);\n        } catch (Throwable thr) {\n            thr.printStackTrace();\n            log(request, \"Could not write error screen: \" + thr.getMessage());\n        }\n    }\n}","loc":{"start":{"line":71},"end":{"line":128}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSource"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":137},"end":{"line":137}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":137},"end":{"line":137}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"source","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":140},"end":{"line":140}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":140},"end":{"line":140}}},"init":{"type":"Literal"},"loc":{"start":{"line":140},"end":{"line":140}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":141},"end":{"line":141}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":141},"end":{"line":141}}},"arguments":[],"loc":{"start":{"line":141},"end":{"line":141}}},"loc":{"start":{"line":141},"end":{"line":141}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":142},"end":{"line":142}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":142},"end":{"line":142}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":142},"end":{"line":142}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":142},"end":{"line":142}}},"arguments":[],"loc":{"start":{"line":142},"end":{"line":142}}},"loc":{"start":{"line":142},"end":{"line":142}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":144},"end":{"line":144}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":144},"end":{"line":144}}},"arguments":[],"loc":{"start":{"line":144},"end":{"line":144}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":144},"end":{"line":144}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":144},"end":{"line":144}}},"arguments":[],"loc":{"start":{"line":144},"end":{"line":144}}},"loc":{"start":{"line":144},"end":{"line":144}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":147},"end":{"line":147}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":147},"end":{"line":147}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":147},"end":{"line":147}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":147},"end":{"line":147}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":147},"end":{"line":147}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":147},"end":{"line":147}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":147},"end":{"line":147}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":147},"end":{"line":147}}}],"loc":{"start":{"line":147},"end":{"line":147}}},"loc":{"start":{"line":147},"end":{"line":147}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":149},"end":{"line":149}}},"right":{"type":"Literal"},"loc":{"start":{"line":149},"end":{"line":149}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"source","loc":{"start":{"line":151},"end":{"line":151}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":151},"end":{"line":151}}},"property":{"type":"Identifier","name":"getSource"},"loc":{"start":{"line":151},"end":{"line":151}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":151},"end":{"line":151}}}],"loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}},"loc":{"start":{"line":151},"end":{"line":151}}}],"loc":{"start":{"line":150},"end":{"line":152}}},"loc":{"start":{"line":149},"end":{"line":152}}}],"loc":{"start":{"line":145},"end":{"line":153}}},"loc":{"start":{"line":144},"end":{"line":153}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"source","loc":{"start":{"line":154},"end":{"line":154}}},"right":{"type":"Literal"},"loc":{"start":{"line":154},"end":{"line":154}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Source code is not available. Contact ","raw":"Source code is not available. Contact "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"getWebgoatContext"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[],"loc":{"start":{"line":155},"end":{"line":155}}},"property":{"type":"Identifier","name":"getFeedbackAddressHTML"},"loc":{"start":{"line":155},"end":{"line":155}}},"arguments":[],"loc":{"start":{"line":155},"end":{"line":155}}},"loc":{"start":{"line":154},"end":{"line":155}}},"loc":{"start":{"line":154},"end":{"line":155}}}],"loc":{"start":{"line":154},"end":{"line":155}}},"loc":{"start":{"line":154},"end":{"line":155}}},{"type":"ReturnStatement","argument":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"source","loc":{"start":{"line":156},"end":{"line":156}}},"property":{"type":"Identifier","name":"replaceAll"},"loc":{"start":{"line":156},"end":{"line":156}}},"arguments":[{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"(?s)","raw":"(?s)"},"right":{"type":"Identifier","name":"START_SOURCE_SKIP","loc":{"start":{"line":156},"end":{"line":156}}},"loc":{"start":{"line":156},"end":{"line":156}}},"right":{"type":"Literal","value":".*","raw":".*"},"loc":{"start":{"line":156},"end":{"line":156}}},"right":{"type":"Identifier","name":"END_SOURCE_SKIP","loc":{"start":{"line":156},"end":{"line":156}}},"loc":{"start":{"line":156},"end":{"line":156}}},{"type":"Literal","value":"Code Section Deliberately Omitted","raw":"Code Section Deliberately Omitted"}],"loc":{"start":{"line":156},"end":{"line":157}}},"loc":{"start":{"line":156},"end":{"line":157}}}],"loc":{"start":{"line":138},"end":{"line":158}}},"code":"\nprotected String getSource(WebSession s) {\n    String source \u003d null;\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n        if (lesson !\u003d null) {\n            source \u003d lesson.getSource(s);\n        }\n    }\n    if (source \u003d\u003d null) {\n        return \"Source code is not available. Contact \" + s.getWebgoatContext().getFeedbackAddressHTML();\n    }\n    return (source.replaceAll(\"(?s)\" + START_SOURCE_SKIP + \".*\" + END_SOURCE_SKIP, \"Code Section Deliberately Omitted\"));\n}","loc":{"start":{"line":137},"end":{"line":158}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"getSolution"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"Identifier","name":"String","loc":{"start":{"line":160},"end":{"line":160}}},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"WebSession","loc":{"start":{"line":160},"end":{"line":160}}}}],"thrown":[],"body":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"source","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":163},"end":{"line":163}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":163},"end":{"line":163}}},"init":{"type":"Literal"},"loc":{"start":{"line":163},"end":{"line":163}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"scr","vartype":{"type":"PrimitiveType"}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"PrimitiveType"},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":164},"end":{"line":164}}},"property":{"type":"Identifier","name":"getCurrentScreen"},"loc":{"start":{"line":164},"end":{"line":164}}},"arguments":[],"loc":{"start":{"line":164},"end":{"line":164}}},"loc":{"start":{"line":164},"end":{"line":164}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"course","vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":165},"end":{"line":165}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"Course","loc":{"start":{"line":165},"end":{"line":165}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":165},"end":{"line":165}}},"property":{"type":"Identifier","name":"getCourse"},"loc":{"start":{"line":165},"end":{"line":165}}},"arguments":[],"loc":{"start":{"line":165},"end":{"line":165}}},"loc":{"start":{"line":165},"end":{"line":165}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"CONDITIONAL_OR","left":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":167},"end":{"line":167}}},"property":{"type":"Identifier","name":"isUser"},"loc":{"start":{"line":167},"end":{"line":167}}},"arguments":[],"loc":{"start":{"line":167},"end":{"line":167}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":167},"end":{"line":167}}},"property":{"type":"Identifier","name":"isChallenge"},"loc":{"start":{"line":167},"end":{"line":167}}},"arguments":[],"loc":{"start":{"line":167},"end":{"line":167}}},"loc":{"start":{"line":167},"end":{"line":167}}},"consequent":{"type":"BlockStatement","body":[{"type":"VariableDeclarator","id":{"type":"Identifier","name":"lesson","vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":170},"end":{"line":170}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":170},"end":{"line":170}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"course","loc":{"start":{"line":170},"end":{"line":170}}},"property":{"type":"Identifier","name":"getLesson"},"loc":{"start":{"line":170},"end":{"line":170}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":170},"end":{"line":170}}},{"type":"Identifier","name":"scr","loc":{"start":{"line":170},"end":{"line":170}}},{"type":"MemberExpression","object":{"type":"Identifier","name":"AbstractLesson","loc":{"start":{"line":170},"end":{"line":170}}},"property":{"type":"Identifier","name":"USER_ROLE"},"loc":{"start":{"line":170},"end":{"line":170}}}],"loc":{"start":{"line":170},"end":{"line":170}}},"loc":{"start":{"line":170},"end":{"line":170}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"NOT_EQUAL_TO","left":{"type":"Identifier","name":"lesson","loc":{"start":{"line":172},"end":{"line":172}}},"right":{"type":"Literal"},"loc":{"start":{"line":172},"end":{"line":172}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"source","loc":{"start":{"line":174},"end":{"line":174}}},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"lesson","loc":{"start":{"line":174},"end":{"line":174}}},"property":{"type":"Identifier","name":"getSolution"},"loc":{"start":{"line":174},"end":{"line":174}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":174},"end":{"line":174}}}],"loc":{"start":{"line":174},"end":{"line":174}}},"loc":{"start":{"line":174},"end":{"line":174}}},"loc":{"start":{"line":174},"end":{"line":174}}}],"loc":{"start":{"line":173},"end":{"line":175}}},"loc":{"start":{"line":172},"end":{"line":175}}}],"loc":{"start":{"line":168},"end":{"line":176}}},"loc":{"start":{"line":167},"end":{"line":176}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"source","loc":{"start":{"line":177},"end":{"line":177}}},"right":{"type":"Literal"},"loc":{"start":{"line":177},"end":{"line":177}}},"consequent":{"type":"BlockStatement","body":[{"type":"ReturnStatement","argument":{"type":"BinaryExpression","operator":"PLUS","left":{"type":"Literal","value":"Solution  is not available. Contact ","raw":"Solution  is not available. Contact "},"right":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"s","loc":{"start":{"line":178},"end":{"line":178}}},"property":{"type":"Identifier","name":"getWebgoatContext"},"loc":{"start":{"line":178},"end":{"line":178}}},"arguments":[],"loc":{"start":{"line":178},"end":{"line":178}}},"property":{"type":"Identifier","name":"getFeedbackAddressHTML"},"loc":{"start":{"line":178},"end":{"line":178}}},"arguments":[],"loc":{"start":{"line":178},"end":{"line":178}}},"loc":{"start":{"line":177},"end":{"line":178}}},"loc":{"start":{"line":177},"end":{"line":178}}}],"loc":{"start":{"line":177},"end":{"line":178}}},"loc":{"start":{"line":177},"end":{"line":178}}},{"type":"ReturnStatement","argument":{"type":"Identifier","name":"source","loc":{"start":{"line":179},"end":{"line":179}}},"loc":{"start":{"line":179},"end":{"line":179}}}],"loc":{"start":{"line":161},"end":{"line":180}}},"code":"\nprotected String getSolution(WebSession s) {\n    String source \u003d null;\n    int scr \u003d s.getCurrentScreen();\n    Course course \u003d s.getCourse();\n    if (s.isUser() || s.isChallenge()) {\n        AbstractLesson lesson \u003d course.getLesson(s, scr, AbstractLesson.USER_ROLE);\n        if (lesson !\u003d null) {\n            source \u003d lesson.getSolution(s);\n        }\n    }\n    if (source \u003d\u003d null) {\n        return \"Solution  is not available. Contact \" + s.getWebgoatContext().getFeedbackAddressHTML();\n    }\n    return (source);\n}","loc":{"start":{"line":160},"end":{"line":180}}},{"type":"FunctionDeclaration","id":{"type":"Identifier","name":"writeSource"},"modifiers":{"type":"Modifiers","modifiers":["protected"],"annotations":[]},"restype":{"type":"PrimitiveType"},"typarams":[],"params":[{"type":"Identifier","name":"s","vartype":{"type":"Identifier","name":"String","loc":{"start":{"line":192},"end":{"line":192}}}},{"type":"Identifier","name":"response","vartype":{"type":"Identifier","name":"HttpServletResponse","loc":{"start":{"line":192},"end":{"line":192}}}}],"thrown":[{"type":"Identifier","name":"IOException","loc":{"start":{"line":192},"end":{"line":192}}}],"body":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":194},"end":{"line":194}}},"property":{"type":"Identifier","name":"setContentType"},"loc":{"start":{"line":194},"end":{"line":194}}},"arguments":[{"type":"Literal","value":"text/html","raw":"text/html"}],"loc":{"start":{"line":194},"end":{"line":194}}},"loc":{"start":{"line":194},"end":{"line":194}}},{"type":"VariableDeclarator","id":{"type":"Identifier","name":"out","vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":196},"end":{"line":196}}}},"modifiers":{"type":"Modifiers","modifiers":[],"annotations":[]},"vartype":{"type":"Identifier","name":"PrintWriter","loc":{"start":{"line":196},"end":{"line":196}}},"init":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"response","loc":{"start":{"line":196},"end":{"line":196}}},"property":{"type":"Identifier","name":"getWriter"},"loc":{"start":{"line":196},"end":{"line":196}}},"arguments":[],"loc":{"start":{"line":196},"end":{"line":196}}},"loc":{"start":{"line":196},"end":{"line":196}}},{"type":"IfStatement","test":{"type":"BinaryExpression","operator":"EQUAL_TO","left":{"type":"Identifier","name":"s","loc":{"start":{"line":198},"end":{"line":198}}},"right":{"type":"Literal"},"loc":{"start":{"line":198},"end":{"line":198}}},"consequent":{"type":"BlockStatement","body":[{"type":"ExpressionStatement","expression":{"type":"AssignmentExpression","left":{"type":"Identifier","name":"s","loc":{"start":{"line":200},"end":{"line":200}}},"right":{"type":"NewExpression","typeargs":[],"callee":{"type":"Identifier","name":"String","loc":{"start":{"line":200},"end":{"line":200}}},"arguments":[],"loc":{"start":{"line":200},"end":{"line":200}}},"loc":{"start":{"line":200},"end":{"line":200}}},"loc":{"start":{"line":200},"end":{"line":200}}}],"loc":{"start":{"line":199},"end":{"line":201}}},"loc":{"start":{"line":198},"end":{"line":201}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"out","loc":{"start":{"line":203},"end":{"line":203}}},"property":{"type":"Identifier","name":"print"},"loc":{"start":{"line":203},"end":{"line":203}}},"arguments":[{"type":"Identifier","name":"s","loc":{"start":{"line":203},"end":{"line":203}}}],"loc":{"start":{"line":203},"end":{"line":203}}},"loc":{"start":{"line":203},"end":{"line":203}}},{"type":"ExpressionStatement","expression":{"type":"CallExpression","typeargs":[],"callee":{"type":"MemberExpression","object":{"type":"Identifier","name":"out","loc":{"start":{"line":204},"end":{"line":204}}},"property":{"type":"Identifier","name":"close"},"loc":{"start":{"line":204},"end":{"line":204}}},"arguments":[],"loc":{"start":{"line":204},"end":{"line":204}}},"loc":{"start":{"line":204},"end":{"line":204}}}],"loc":{"start":{"line":193},"end":{"line":205}}},"code":"\nprotected void writeSource(String s, HttpServletResponse response) throws IOException {\n    response.setContentType(\"text/html\");\n    PrintWriter out \u003d response.getWriter();\n    if (s \u003d\u003d null) {\n        s \u003d new String();\n    }\n    out.print(s);\n    out.close();\n}","loc":{"start":{"line":192},"end":{"line":205}}}],"loc":{"start":{"line":44},"end":{"line":206}}}],"loc":{"start":{"line":2},"end":{"line":206}},"sourcefile":"/Users/gli/codiscope/jacks.engine/WebGoat-5.4/WEB-INF/classes/org/owasp/webgoat/LessonSource.java"}